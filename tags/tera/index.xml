<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>baozongwi's blog</title><link>https://baozongwi.xyz/tags/tera/</link><description>baozongwi's blog</description><lastBuildDate>Thu, 12 Feb 2026 20:58:39 +0800</lastBuildDate><atom:link href="https://baozongwi.xyz/tags/tera/" rel="self" type="application/rss+xml"/><item><title>DASCTF2024最后一战</title><link>https://baozongwi.xyz/p/dasctf-2024-final-battle/</link><guid>https://baozongwi.xyz/p/dasctf-2024-final-battle/</guid><pubDate>Sat, 21 Dec 2024 18:33:44 +0000</pubDate><description>早上师傅问的时候我还在床上
因为介于我之前的表现，我的DAS是基本没啥输出的，然后吃了一碗芝麻糊，就跑到工作室开始看题了
const_python 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 import builtins import io import sys import uuid from flask import Flask, request,jsonify,session import pickle import base64 app = Flask(__name__) app.config[&amp;amp;#39;SECRET_KEY&amp;amp;#39;] = str(uuid.uuid4()).replace(&amp;amp;#34;-&amp;amp;#34;, &amp;amp;#34;&amp;amp;#34;) class User: def __init__(self, username, password, auth=&amp;amp;#39;ctfer&amp;amp;#39;): self.username = username self.password = password self.auth = auth password = str(uuid.uuid4()).replace(&amp;amp;#34;-&amp;amp;#34;, &amp;amp;#34;&amp;amp;#34;) Admin = User(&amp;amp;#39;admin&amp;amp;#39;, password,&amp;amp;#34;admin&amp;amp;#34;) @app.route(&amp;amp;#39;/&amp;amp;#39;) def index(): return &amp;amp;#34;Welcome to my application&amp;amp;#34; @app.route(&amp;amp;#39;/login&amp;amp;#39;, methods=[&amp;amp;#39;GET&amp;amp;#39;, &amp;amp;#39;POST&amp;amp;#39;]) def post_login(): if request.method == &amp;amp;#39;POST&amp;amp;#39;: username = request.form[&amp;amp;#39;username&amp;amp;#39;] password = request.form[&amp;amp;#39;password&amp;amp;#39;] if username == &amp;amp;#39;admin&amp;amp;#39; : if password == admin.password: session[&amp;amp;#39;username&amp;amp;#39;] = &amp;amp;#34;admin&amp;amp;#34; return &amp;amp;#34;Welcome Admin&amp;amp;#34; else: return &amp;amp;#34;Invalid Credentials&amp;amp;#34; else: session[&amp;amp;#39;username&amp;amp;#39;] = username return &amp;amp;#39;&amp;amp;#39;&amp;amp;#39; &amp;amp;lt;form method=&amp;amp;#34;post&amp;amp;#34;&amp;amp;gt; &amp;amp;lt;!-- /src may help you&amp;amp;gt; Username: &amp;amp;lt;input type=&amp;amp;#34;text&amp;amp;#34; name=&amp;amp;#34;username&amp;amp;#34;&amp;amp;gt;&amp;amp;lt;br&amp;amp;gt; Password: &amp;amp;lt;input type=&amp;amp;#34;password&amp;amp;#34; name=&amp;amp;#34;password&amp;amp;#34;&amp;amp;gt;&amp;amp;lt;br&amp;amp;gt; &amp;amp;lt;input type=&amp;amp;#34;submit&amp;amp;#34; value=&amp;amp;#34;Login&amp;amp;#34;&amp;amp;gt; &amp;amp;lt;/form&amp;amp;gt; &amp;amp;#39;&amp;amp;#39;&amp;amp;#39; @app.route(&amp;amp;#39;/ppicklee&amp;amp;#39;, methods=[&amp;amp;#39;POST&amp;amp;#39;]) def ppicklee(): data = request.form[&amp;amp;#39;data&amp;amp;#39;] sys.modules[&amp;amp;#39;os&amp;amp;#39;] = &amp;amp;#34;not allowed&amp;amp;#34; sys.modules[&amp;amp;#39;sys&amp;amp;#39;] = &amp;amp;#34;not allowed&amp;amp;#34; try: pickle_data = base64.b64decode(data) for i in {&amp;amp;#34;os&amp;amp;#34;, &amp;amp;#34;system&amp;amp;#34;, &amp;amp;#34;eval&amp;amp;#34;, &amp;amp;#39;setstate&amp;amp;#39;, &amp;amp;#34;globals&amp;amp;#34;, &amp;amp;#39;exec&amp;amp;#39;, &amp;amp;#39;__builtins__&amp;amp;#39;, &amp;amp;#39;template&amp;amp;#39;, &amp;amp;#39;render&amp;amp;#39;, &amp;amp;#39;\\&amp;amp;#39;, &amp;amp;#39;compile&amp;amp;#39;, &amp;amp;#39;requests&amp;amp;#39;, &amp;amp;#39;exit&amp;amp;#39;, &amp;amp;#39;pickle&amp;amp;#39;,&amp;amp;#34;class&amp;amp;#34;,&amp;amp;#34;mro&amp;amp;#34;,&amp;amp;#34;flask&amp;amp;#34;,&amp;amp;#34;sys&amp;amp;#34;,&amp;amp;#34;base&amp;amp;#34;,&amp;amp;#34;init&amp;amp;#34;,&amp;amp;#34;config&amp;amp;#34;,&amp;amp;#34;session&amp;amp;#34;}: if i.encode() in pickle_data: return i+&amp;amp;#34; waf !!!!!!!&amp;amp;#34; pickle.loads(pickle_data) return &amp;amp;#34;success pickle&amp;amp;#34; except Exception as e: return &amp;amp;#34;fail pickle&amp;amp;#34; @app.route(&amp;amp;#39;/admin&amp;amp;#39;, methods=[&amp;amp;#39;POST&amp;amp;#39;]) def admin(): username = session[&amp;amp;#39;username&amp;amp;#39;] if username != &amp;amp;#34;admin&amp;amp;#34;: return jsonify({&amp;amp;#34;message&amp;amp;#34;: &amp;amp;#39;You are not admin!&amp;amp;#39;}) return &amp;amp;#34;Welcome Admin&amp;amp;#34; @app.route(&amp;amp;#39;/src&amp;amp;#39;) def src(): return open(&amp;amp;#34;app.py&amp;amp;#34;, &amp;amp;#34;r&amp;amp;#34;,encoding=&amp;amp;#34;utf-8&amp;amp;#34;).read() if __name__ == &amp;amp;#39;__main__&amp;amp;#39;: app.run(host=&amp;amp;#39;0.0.0.0&amp;amp;#39;, debug=False, port=5000) 本地起好环境之后，发包先随便session，因为我发现如果直接发admin的包是直接500错误了</description><content:encoded>早上师傅问的时候我还在床上
因为介于我之前的表现，我的DAS是基本没啥输出的，然后吃了一碗芝麻糊，就跑到工作室开始看题了
const_python 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 …</content:encoded></item></channel></rss>